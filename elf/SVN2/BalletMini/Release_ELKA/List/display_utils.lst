##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    07/Nov/2009  17:56:52 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  D:\pasha\elf\SVN2\BalletMini\display_utils.c         #
#    Command line    =  D:\pasha\elf\SVN2\BalletMini\display_utils.c -D      #
#                       NEWSGOLD -D ELKA -lC D:\pasha\elf\SVN2\BalletMini\Re #
#                       lease_ELKA\List\ -o D:\pasha\elf\SVN2\BalletMini\Rel #
#                       ease_ELKA\Obj\ -s9 --no_unroll --no_inline           #
#                       --cpu_mode arm --endian little --cpu ARM926EJ-S      #
#                       --stack_align 4 --interwork -e --fpu None            #
#                       --dlib_config "D:\pasha\Embedded Workbench 4.0       #
#                       Evaluation2\ARM\LIB\dl5tpainl8n.h" -I                #
#                       "D:\pasha\Embedded Workbench 4.0                     #
#                       Evaluation2\ARM\INC\"                                #
#    List file       =  D:\pasha\elf\SVN2\BalletMini\Release_ELKA\List\displ #
#                       ay_utils.lst                                         #
#    Object file     =  D:\pasha\elf\SVN2\BalletMini\Release_ELKA\Obj\displa #
#                       y_utils.r79                                          #
#                                                                            #
#                                                                            #
##############################################################################

D:\pasha\elf\SVN2\BalletMini\display_utils.c
      1          #include "../inc/swilib.h"
      2          #include "view.h"
      3          #include "display_utils.h"
      4          #include "siemens_unicode.h"
      5          #include "string_works.h"
      6          #include "rect_patcher.h" 

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_header(HEADER_DESC const *)
   \                     patch_header:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B000C4E1           STRH     R0,[R4, #+0]
   \   00000010   1800A0E3           MOV      R0,#+24
   \   00000014   B200C4E1           STRH     R0,[R4, #+2]
   \   00000018   888100EF           SWI      +33160
   \   0000001C   010040E2           SUB      R0,R0,#+1
   \   00000020   B400C4E1           STRH     R0,[R4, #+4]
   \   00000024   8A8100EF           SWI      +33162
   \   00000028   170080E2           ADD      R0,R0,#+23
   \   0000002C   B600C4E1           STRH     R0,[R4, #+6]
   \   00000030   1080BDE8           POP      {R4,PC}          ;; return

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_input(INPUTDIA_DESC const *)
   \                     patch_input:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B801C4E1           STRH     R0,[R4, #+24]
   \   00000010   8A8100EF           SWI      +33162
   \   00000014   190080E2           ADD      R0,R0,#+25
   \   00000018   BA01C4E1           STRH     R0,[R4, #+26]
   \   0000001C   888100EF           SWI      +33160
   \   00000020   010040E2           SUB      R0,R0,#+1
   \   00000024   BC01C4E1           STRH     R0,[R4, #+28]
   \   00000028   898100EF           SWI      +33161
   \   0000002C   0050A0E1           MOV      R5,R0
   \   00000030   8B8100EF           SWI      +33163
   \   00000034   000045E0           SUB      R0,R5,R0
   \   00000038   010040E2           SUB      R0,R0,#+1
   \   0000003C   BE01C4E1           STRH     R0,[R4, #+30]
   \   00000040   3080BDE8           POP      {R4,R5,PC}       ;; return
      7          #include "main.h"
      8          #include "file_works.h"
      9          #include "lang.h"
     10          
     11          extern int maincsm_id;
     12          
     13          extern const int scr_shift;
     14          

   \                                 In segment CODE, align 4, keep-with-next
     15          int GetFontHeight(int font, int atribute)
     16          {
   \                     GetFontHeight:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0140A0E1           MOV      R4,R1
     17            int height=GetFontYSIZE(font);
   \   00000008   C50100EF           SWI      +453
     18            if (atribute&TEXT_INVERT)   height+=1;
   \   0000000C   100014E3           TST      R4,#0x10
   \   00000010   01008012           ADDNE    R0,R0,#+1
     19            if (atribute&TEXT_UNDERLINE)   height+=1;
   \   00000014   080014E3           TST      R4,#0x8
   \   00000018   01008012           ADDNE    R0,R0,#+1
     20            if (atribute&TEXT_OUTLINE)  height+=2;
   \   0000001C   200014E3           TST      R4,#0x20
   \   00000020   02008012           ADDNE    R0,R0,#+2
     21            return height;
   \   00000024   1080BDE8           POP      {R4,PC}          ;; return
     22          }
     23          

   \                                 In segment CODE, align 4, keep-with-next
     24          unsigned int SearchNextDisplayLine(VIEWDATA *vd, LINECACHE *p/*, unsigned int *max_h*/)
     25          {
   \                     SearchNextDisplayLine:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
     26            int scrW = ScreenW()-MARGIN;
     27            int left=scrW;
     28            int c,h,cw,f=0;
   \   0000000C   0080A0E3           MOV      R8,#+0
   \   00000010   888100EF           SWI      +33160
   \   00000014   046040E2           SUB      R6,R0,#+4
     29            p->centerAtAll=0;
   \   00000018   BC00D5E1           LDRH     R0,[R5, #+12]
   \   0000001C   DF10A0E3           MOV      R1,#+223
   \   00000020   FF1C81E3           ORR      R1,R1,#0xFF00
   \   00000024   000001E0           AND      R0,R1,R0
   \   00000028   BC00C5E1           STRH     R0,[R5, #+12]
     30            p->pixheight=0;
   \   0000002C   0000A0E3           MOV      R0,#+0
   \   00000030   BE00C5E1           STRH     R0,[R5, #+14]
     31            p->pos=vd->lines_cache_pos;
   \   00000034   180094E5           LDR      R0,[R4, #+24]
   \   00000038   0670A0E1           MOV      R7,R6
   \   0000003C   000085E5           STR      R0,[R5, #+0]
   \   00000040   010000EA           B        ??SearchNextDisplayLine_0
     32            while(p->pos<vd->rawtext_size)
     33            {
     34              c=vd->rawtext[p->pos++];
     35              if ((c&0xFF00)==0xE100)
     36              {
     37                h=GetImgHeight(GetPicNByUnicodeSymbol(c));
     38              }
     39              else
     40              {
     41                h=GetFontHeight(p->bold?FONT_SMALL_BOLD:FONT_SMALL,p->underline?TEXT_UNDERLINE:0+p->ref?TEXT_INVERT:0);
     42              }
     43              switch(c)
     44              {
     45              case UTF16_NEWLINE:
     46                f=1;
     47                h=0;
     48                break;
     49              case UTF16_ENA_CENTER:
     50                p->center=1;
   \                     ??SearchNextDisplayLine_1:
   \   00000044   080082E3           ORR      R0,R2,#0x8
   \                     ??SearchNextDisplayLine_2:
   \   00000048   BC00C5E1           STRH     R0,[R5, #+12]
     51                continue;
   \                     ??SearchNextDisplayLine_0:
   \   0000004C   000095E5           LDR      R0,[R5, #+0]
   \   00000050   0C1094E5           LDR      R1,[R4, #+12]
   \   00000054   010050E1           CMP      R0,R1
   \   00000058   6700002A           BCS      ??SearchNextDisplayLine_3
   \   0000005C   011080E2           ADD      R1,R0,#+1
   \   00000060   001085E5           STR      R1,[R5, #+0]
   \   00000064   081094E5           LDR      R1,[R4, #+8]
   \   00000068   800081E0           ADD      R0,R1,R0, LSL #+1
   \   0000006C   B090D0E1           LDRH     R9,[R0, #+0]
   \   00000070   FF0C09E2           AND      R0,R9,#0xFF00
   \   00000074   E10C50E3           CMP      R0,#+57600
   \   00000078   0300001A           BNE      ??SearchNextDisplayLine_4
   \   0000007C   0900A0E1           MOV      R0,R9
   \   00000080   E40100EF           SWI      +484
   \   00000084   210000EF           SWI      +33
   \   00000088   0A0000EA           B        ??SearchNextDisplayLine_5
   \                     ??SearchNextDisplayLine_4:
   \   0000008C   BC00D5E1           LDRH     R0,[R5, #+12]
   \   00000090   020010E3           TST      R0,#0x2
   \   00000094   0810A013           MOVNE    R1,#+8
   \   00000098   0200001A           BNE      ??SearchNextDisplayLine_6
   \   0000009C   040010E3           TST      R0,#0x4
   \   000000A0   1010A013           MOVNE    R1,#+16
   \   000000A4   0010A003           MOVEQ    R1,#+0
   \                     ??SearchNextDisplayLine_6:
   \   000000A8   010010E3           TST      R0,#0x1
   \   000000AC   0900A013           MOVNE    R0,#+9
   \   000000B0   0800A003           MOVEQ    R0,#+8
   \   000000B4   ........           BL       GetFontHeight
   \                     ??SearchNextDisplayLine_5:
   \   000000B8   0C3094E5           LDR      R3,[R4, #+12]
   \   000000BC   BC20D5E1           LDRH     R2,[R5, #+12]
   \   000000C0   00A0A0E1           MOV      R10,R0
   \   000000C4   000095E5           LDR      R0,[R5, #+0]
   \   000000C8   02B043E2           SUB      R11,R3,#+2
   \   000000CC   011080E2           ADD      R1,R0,#+1
   \   000000D0   0A0059E3           CMP      R9,#+10
   \   000000D4   2A00000A           BEQ      ??SearchNextDisplayLine_7
   \   000000D8   01E0A0E3           MOV      LR,#+1
   \   000000DC   E0EC8EE3           ORR      LR,LR,#0xE000
   \   000000E0   0E0059E1           CMP      R9,LR
   \   000000E4   3C00000A           BEQ      ??SearchNextDisplayLine_8
   \   000000E8   01E08EE2           ADD      LR,LR,#+1
   \   000000EC   0E0059E1           CMP      R9,LR
   \   000000F0   3700000A           BEQ      ??SearchNextDisplayLine_9
   \   000000F4   02E08EE2           ADD      LR,LR,#+2
   \   000000F8   0E0059E1           CMP      R9,LR
   \   000000FC   2E00000A           BEQ      ??SearchNextDisplayLine_10
   \   00000100   01E08EE3           ORR      LR,LR,#0x1
   \   00000104   0E0059E1           CMP      R9,LR
   \   00000108   2F00000A           BEQ      ??SearchNextDisplayLine_11
   \   0000010C   01E08EE2           ADD      LR,LR,#+1
   \   00000110   0E0059E1           CMP      R9,LR
   \   00000114   3600000A           BEQ      ??SearchNextDisplayLine_12
   \   00000118   01E08EE3           ORR      LR,LR,#0x1
   \   0000011C   0E0059E1           CMP      R9,LR
   \   00000120   4200000A           BEQ      ??SearchNextDisplayLine_13
   \   00000124   01E08EE2           ADD      LR,LR,#+1
   \   00000128   0E0059E1           CMP      R9,LR
   \   0000012C   01E08E13           ORRNE    LR,LR,#0x1
   \   00000130   0E005911           CMPNE    R9,LR
   \   00000134   4A00000A           BEQ      ??SearchNextDisplayLine_14
   \   00000138   09E08EE2           ADD      LR,LR,#+9
   \   0000013C   0E0059E1           CMP      R9,LR
   \   00000140   2700000A           BEQ      ??SearchNextDisplayLine_15
   \   00000144   01E08EE3           ORR      LR,LR,#0x1
   \   00000148   0E0059E1           CMP      R9,LR
   \   0000014C   2600000A           BEQ      ??SearchNextDisplayLine_16
   \   00000150   09E08EE2           ADD      LR,LR,#+9
   \   00000154   0E0059E1           CMP      R9,LR
   \   00000158   1500000A           BEQ      ??SearchNextDisplayLine_17
   \   0000015C   01E08EE3           ORR      LR,LR,#0x1
   \   00000160   0E0059E1           CMP      R9,LR
   \   00000164   1000000A           BEQ      ??SearchNextDisplayLine_18
   \   00000168   01E08EE2           ADD      LR,LR,#+1
   \   0000016C   0E0059E1           CMP      R9,LR
   \   00000170   B3FFFF0A           BEQ      ??SearchNextDisplayLine_1
   \   00000174   01E08EE3           ORR      LR,LR,#0x1
   \   00000178   0E0059E1           CMP      R9,LR
   \   0000017C   0600000A           BEQ      ??SearchNextDisplayLine_19
   \   00000180   010000EA           B        ??SearchNextDisplayLine_20
   \                     ??SearchNextDisplayLine_7:
   \   00000184   0180A0E3           MOV      R8,#+1
   \   00000188   00A0A0E3           MOV      R10,#+0
     52              case UTF16_DIS_CENTER:
     53                p->center=0;
     54                continue;
     55              case UTF16_ALIGN_RIGHT:
     56                p->right=1;
     57                continue;
     58              case UTF16_ALIGN_LEFT:
     59                p->right=0;
     60                continue;
     61              case UTF16_DIS_INVERT:
     62                p->ref=0;
     63                continue;
     64              case UTF16_ENA_INVERT:
     65                p->ref=1;
     66                continue;
     67              case UTF16_DIS_UNDERLINE:
     68                p->underline=0;
     69                continue;
     70              case UTF16_ENA_UNDERLINE:
     71                p->underline=1;
     72                continue;
     73              case UTF16_FONT_SMALL:
     74                {
     75                  p->bold=0;
     76                }
     77                continue;
     78              case UTF16_FONT_SMALL_BOLD:
     79                {
     80                  p->bold=1;
     81                }
     82                continue;
     83              case UTF16_INK_RGBA:
     84                if (p->pos>(vd->rawtext_size-2)) return 0;
     85                p->ink1=vd->rawtext[p->pos++];
     86                p->ink2=vd->rawtext[p->pos++];
     87                continue;
     88              case UTF16_PAPER_RGBA:
     89                if (p->pos>(vd->rawtext_size-2)) return 0;
     90                p->paper1=vd->rawtext[p->pos++];
     91                p->paper2=vd->rawtext[p->pos++];
     92                continue;
     93              case UTF16_INK_INDEX:
     94              case UTF16_PAPER_INDEX:
     95                if (p->pos>=(vd->rawtext_size-1)) return 0;
     96                p->pos++;
     97                continue;
     98              }
     99              // компоновка элементов здесь
    100              cw=GetSymbolWidth(c,p->bold?FONT_SMALL_BOLD:FONT_SMALL);
   \                     ??SearchNextDisplayLine_20:
   \   0000018C   010012E3           TST      R2,#0x1
   \   00000190   0810A003           MOVEQ    R1,#+8
   \   00000194   0910A013           MOVNE    R1,#+9
   \   00000198   360000EA           B        ??SearchNextDisplayLine_21
   \                     ??SearchNextDisplayLine_19:
   \   0000019C   F710A0E3           MOV      R1,#+247
   \                     ??SearchNextDisplayLine_22:
   \   000001A0   FF1C81E3           ORR      R1,R1,#0xFF00
   \   000001A4   020001E0           AND      R0,R1,R2
   \   000001A8   A6FFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_18:
   \   000001AC   100082E3           ORR      R0,R2,#0x10
   \   000001B0   A4FFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_17:
   \   000001B4   EF10A0E3           MOV      R1,#+239
   \   000001B8   F8FFFFEA           B        ??SearchNextDisplayLine_22
   \                     ??SearchNextDisplayLine_10:
   \   000001BC   FB10A0E3           MOV      R1,#+251
   \   000001C0   FF1C81E3           ORR      R1,R1,#0xFF00
   \   000001C4   020001E0           AND      R0,R1,R2
   \   000001C8   9EFFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_11:
   \   000001CC   040082E3           ORR      R0,R2,#0x4
   \   000001D0   9CFFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_9:
   \   000001D4   FD10A0E3           MOV      R1,#+253
   \   000001D8   F0FFFFEA           B        ??SearchNextDisplayLine_22
   \                     ??SearchNextDisplayLine_8:
   \   000001DC   020082E3           ORR      R0,R2,#0x2
   \   000001E0   98FFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_15:
   \   000001E4   FE10A0E3           MOV      R1,#+254
   \   000001E8   ECFFFFEA           B        ??SearchNextDisplayLine_22
   \                     ??SearchNextDisplayLine_16:
   \   000001EC   010082E3           ORR      R0,R2,#0x1
   \   000001F0   94FFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_12:
   \   000001F4   00005BE1           CMP      R11,R0
   \   000001F8   0100002A           BCS      ??SearchNextDisplayLine_23
   \                     ??SearchNextDisplayLine_3:
   \   000001FC   0000A0E3           MOV      R0,#+0
   \   00000200   F08FBDE8           POP      {R4-R11,PC}
   \                     ??SearchNextDisplayLine_23:
   \   00000204   001085E5           STR      R1,[R5, #+0]
   \   00000208   082094E5           LDR      R2,[R4, #+8]
   \   0000020C   800082E0           ADD      R0,R2,R0, LSL #+1
   \   00000210   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000214   B400C5E1           STRH     R0,[R5, #+4]
   \   00000218   010081E2           ADD      R0,R1,#+1
   \   0000021C   000085E5           STR      R0,[R5, #+0]
   \   00000220   810082E0           ADD      R0,R2,R1, LSL #+1
   \   00000224   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000228   B600C5E1           STRH     R0,[R5, #+6]
   \   0000022C   86FFFFEA           B        ??SearchNextDisplayLine_0
   \                     ??SearchNextDisplayLine_13:
   \   00000230   00005BE1           CMP      R11,R0
   \   00000234   F0FFFF3A           BCC      ??SearchNextDisplayLine_3
   \   00000238   001085E5           STR      R1,[R5, #+0]
   \   0000023C   082094E5           LDR      R2,[R4, #+8]
   \   00000240   800082E0           ADD      R0,R2,R0, LSL #+1
   \   00000244   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000248   B800C5E1           STRH     R0,[R5, #+8]
   \   0000024C   010081E2           ADD      R0,R1,#+1
   \   00000250   000085E5           STR      R0,[R5, #+0]
   \   00000254   810082E0           ADD      R0,R2,R1, LSL #+1
   \   00000258   B000D0E1           LDRH     R0,[R0, #+0]
   \   0000025C   BA00C5E1           STRH     R0,[R5, #+10]
   \   00000260   79FFFFEA           B        ??SearchNextDisplayLine_0
   \                     ??SearchNextDisplayLine_14:
   \   00000264   012043E2           SUB      R2,R3,#+1
   \   00000268   020050E1           CMP      R0,R2
   \   0000026C   E2FFFF2A           BCS      ??SearchNextDisplayLine_3
   \   00000270   001085E5           STR      R1,[R5, #+0]
   \   00000274   74FFFFEA           B        ??SearchNextDisplayLine_0
   \                     ??SearchNextDisplayLine_21:
   \   00000278   0900A0E1           MOV      R0,R9
   \   0000027C   E10100EF           SWI      +481
   \   00000280   00B0A0E1           MOV      R11,R0
    101              left-=cw;
   \   00000284   0B7057E0           SUBS     R7,R7,R11
    102              if (left<0)
   \   00000288   0490A0E3           MOV      R9,#+4
   \   0000028C   E09C89E3           ORR      R9,R9,#0xE000
   \   00000290   3F00005A           BPL      ??SearchNextDisplayLine_24
    103              {
    104                int b=1;
    105                int cw=0;
    106                if (p->ref)
   \   00000294   BC00D5E1           LDRH     R0,[R5, #+12]
   \   00000298   0170A0E3           MOV      R7,#+1
   \   0000029C   0080A0E3           MOV      R8,#+0
   \   000002A0   866086E0           ADD      R6,R6,R6, LSL #+1
   \   000002A4   040010E3           TST      R0,#0x4
   \   000002A8   0400001A           BNE      ??SearchNextDisplayLine_25
   \   000002AC   240000EA           B        ??SearchNextDisplayLine_26
    107                {
    108                  while (1)
    109                  {
    110                    if (vd->rawtext[p->pos-b]==UTF16_SPACE) { b--; break;}
    111                    if (vd->rawtext[p->pos-b]==UTF16_ENA_INVERT) break;
    112                    if (vd->rawtext[p->pos-b]==UTF16_NEWLINE)
    113                    {
    114                      b++;
    115                      break;
    116                    }
    117                    if (cw>=(scrW*3/4))
    118                    {
    119                      b=1;
    120                      break;
    121                    }
    122                    cw+=GetSymbolWidth(vd->rawtext[p->pos-b],p->bold?FONT_SMALL_BOLD:FONT_SMALL);
   \                     ??SearchNextDisplayLine_27:
   \   000002B0   B000D0E1           LDRH     R0,[R0, #+0]
    123                    b++;
   \   000002B4   017087E2           ADD      R7,R7,#+1
   \   000002B8   E10100EF           SWI      +481
   \   000002BC   088080E0           ADD      R8,R0,R8
   \                     ??SearchNextDisplayLine_25:
   \   000002C0   000095E5           LDR      R0,[R5, #+0]
   \   000002C4   081094E5           LDR      R1,[R4, #+8]
   \   000002C8   070040E0           SUB      R0,R0,R7
   \   000002CC   800081E0           ADD      R0,R1,R0, LSL #+1
   \   000002D0   B010D0E1           LDRH     R1,[R0, #+0]
   \   000002D4   200051E3           CMP      R1,#+32
   \   000002D8   0300001A           BNE      ??SearchNextDisplayLine_28
   \                     ??SearchNextDisplayLine_29:
   \   000002DC   017047E2           SUB      R7,R7,#+1
    124                  }
    125                }
    126                else
    127                {
    128                  while (1)
    129                  {
    130                    if (vd->rawtext[p->pos-b]==UTF16_SPACE) { b--; break;}
    131                    if (vd->rawtext[p->pos-b]==UTF16_DIS_INVERT) break;
    132                    if (vd->rawtext[p->pos-b]==UTF16_NEWLINE)
    133                    {
    134                      b++;
    135                      break;
    136                    }
    137                    if (cw>=(scrW*3/4))
    138                    {
    139                      b=1;
    140                      break;
    141                    }
    142                    cw+=GetSymbolWidth(vd->rawtext[p->pos-b],p->bold?FONT_SMALL_BOLD:FONT_SMALL);
    143                    b++;
    144                  }
    145                }
    146                p->pos-=b;
   \                     ??SearchNextDisplayLine_30:
   \   000002E0   000095E5           LDR      R0,[R5, #+0]
   \   000002E4   070040E0           SUB      R0,R0,R7
   \   000002E8   4B0000EA           B        ??SearchNextDisplayLine_31
   \                     ??SearchNextDisplayLine_28:
   \   000002EC   012089E3           ORR      R2,R9,#0x1
   \   000002F0   020051E1           CMP      R1,R2
   \   000002F4   F9FFFF0A           BEQ      ??SearchNextDisplayLine_30
   \   000002F8   0A0051E3           CMP      R1,#+10
   \   000002FC   0100001A           BNE      ??SearchNextDisplayLine_32
   \                     ??SearchNextDisplayLine_33:
   \   00000300   017087E2           ADD      R7,R7,#+1
   \   00000304   F5FFFFEA           B        ??SearchNextDisplayLine_30
   \                     ??SearchNextDisplayLine_32:
   \   00000308   C610A0E1           ASR      R1,R6,#+1
   \   0000030C   211F86E0           ADD      R1,R6,R1, LSR #+30
   \   00000310   410158E1           CMP      R8,R1, ASR #+2
   \   00000314   010000BA           BLT      ??SearchNextDisplayLine_34
   \                     ??SearchNextDisplayLine_35:
   \   00000318   0170A0E3           MOV      R7,#+1
   \   0000031C   EFFFFFEA           B        ??SearchNextDisplayLine_30
   \                     ??SearchNextDisplayLine_34:
   \   00000320   BC10D5E1           LDRH     R1,[R5, #+12]
   \   00000324   010011E3           TST      R1,#0x1
   \   00000328   0810A003           MOVEQ    R1,#+8
   \   0000032C   0910A013           MOVNE    R1,#+9
   \   00000330   DEFFFFEA           B        ??SearchNextDisplayLine_27
   \                     ??SearchNextDisplayLine_36:
   \   00000334   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000338   017087E2           ADD      R7,R7,#+1
   \   0000033C   E10100EF           SWI      +481
   \   00000340   088080E0           ADD      R8,R0,R8
   \                     ??SearchNextDisplayLine_26:
   \   00000344   000095E5           LDR      R0,[R5, #+0]
   \   00000348   081094E5           LDR      R1,[R4, #+8]
   \   0000034C   070040E0           SUB      R0,R0,R7
   \   00000350   800081E0           ADD      R0,R1,R0, LSL #+1
   \   00000354   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000358   200051E3           CMP      R1,#+32
   \   0000035C   DEFFFF0A           BEQ      ??SearchNextDisplayLine_29
   \   00000360   090051E1           CMP      R1,R9
   \   00000364   DDFFFF0A           BEQ      ??SearchNextDisplayLine_30
   \   00000368   0A0051E3           CMP      R1,#+10
   \   0000036C   E3FFFF0A           BEQ      ??SearchNextDisplayLine_33
   \   00000370   C610A0E1           ASR      R1,R6,#+1
   \   00000374   211F86E0           ADD      R1,R6,R1, LSR #+30
   \   00000378   410158E1           CMP      R8,R1, ASR #+2
   \   0000037C   E5FFFFAA           BGE      ??SearchNextDisplayLine_35
   \   00000380   BC10D5E1           LDRH     R1,[R5, #+12]
   \   00000384   010011E3           TST      R1,#0x1
   \   00000388   0810A003           MOVEQ    R1,#+8
   \   0000038C   0910A013           MOVNE    R1,#+9
   \   00000390   E7FFFFEA           B        ??SearchNextDisplayLine_36
    147                return 1; // here can be a bug with line height
    148              }
    149              
    150              /*if (cw>=(scrW/2)||h>(GetFontHeight(FONT_SMALL,0)*2)) // Картинки отдельно
    151              {
    152                if ((left+cw)<scrW) // image is last character
    153                {
    154                  if (vd->rawtext[p->pos-1]==UTF16_ENA_INVERT)
    155                  {
    156                    p->pos-=2;
    157                    return 1;
    158                  }
    159                  else
    160                  {
    161                    p->pos-=1;
    162                    return 1;
    163                  }
    164                }
    165              }*/
    166              if (h>p->pixheight) p->pixheight=h;
   \                     ??SearchNextDisplayLine_24:
   \   00000394   BE00D5E1           LDRH     R0,[R5, #+14]
   \   00000398   0A0050E1           CMP      R0,R10
   \   0000039C   BEA0C5B1           STRHLT   R10,[R5, #+14]
    167                
    168              if ((cw>=scrW/2)&&h>(GetFontHeight(FONT_SMALL,0)*3)) // Картинки отдельно
   \   000003A0   A60F86E0           ADD      R0,R6,R6, LSR #+31
   \   000003A4   C0005BE1           CMP      R11,R0, ASR #+1
   \   000003A8   1E0000BA           BLT      ??SearchNextDisplayLine_37
   \   000003AC   0010A0E3           MOV      R1,#+0
   \   000003B0   0800A0E3           MOV      R0,#+8
   \   000003B4   ........           BL       GetFontHeight
   \   000003B8   800080E0           ADD      R0,R0,R0, LSL #+1
   \   000003BC   0A0050E1           CMP      R0,R10
   \   000003C0   180000AA           BGE      ??SearchNextDisplayLine_37
    169              {
    170                if ((left+cw)==scrW) // image is first character
   \   000003C4   07008BE0           ADD      R0,R11,R7
   \   000003C8   060050E1           CMP      R0,R6
   \   000003CC   1500001A           BNE      ??SearchNextDisplayLine_37
    171                {
    172                  if (p->pos>(vd->rawtext_size-1)) return 0;
   \   000003D0   000095E5           LDR      R0,[R5, #+0]
   \   000003D4   0C1094E5           LDR      R1,[R4, #+12]
   \   000003D8   011041E2           SUB      R1,R1,#+1
   \   000003DC   000051E1           CMP      R1,R0
   \   000003E0   85FFFF3A           BCC      ??SearchNextDisplayLine_3
    173                  p->centerAtAll=1;
   \   000003E4   BC10D5E1           LDRH     R1,[R5, #+12]
   \   000003E8   201081E3           ORR      R1,R1,#0x20
   \   000003EC   BC10C5E1           STRH     R1,[R5, #+12]
    174                  if (vd->rawtext[p->pos+1]==UTF16_DIS_INVERT)
   \   000003F0   081094E5           LDR      R1,[R4, #+8]
   \   000003F4   801081E0           ADD      R1,R1,R0, LSL #+1
   \   000003F8   B210D1E1           LDRH     R1,[R1, #+2]
   \   000003FC   090051E1           CMP      R1,R9
   \   00000400   0600001A           BNE      ??SearchNextDisplayLine_38
    175                  {
    176                    p->ref=0;
   \   00000404   BC10D5E1           LDRH     R1,[R5, #+12]
   \   00000408   FB20A0E3           MOV      R2,#+251
   \   0000040C   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000410   011002E0           AND      R1,R2,R1
   \   00000414   BC10C5E1           STRH     R1,[R5, #+12]
    177                    p->pos+=1;
   \   00000418   010080E2           ADD      R0,R0,#+1
   \                     ??SearchNextDisplayLine_31:
   \   0000041C   000085E5           STR      R0,[R5, #+0]
    178                    return 1;
   \                     ??SearchNextDisplayLine_38:
   \   00000420   0100A0E3           MOV      R0,#+1
   \   00000424   F08FBDE8           POP      {R4-R11,PC}
    179                  }
    180                  else
    181                  {
    182                    return 1;
    183                  }
    184                }
    185              }
    186              if (f) return 1;
   \                     ??SearchNextDisplayLine_37:
   \   00000428   000058E3           CMP      R8,#+0
   \   0000042C   06FFFF0A           BEQ      ??SearchNextDisplayLine_0
   \   00000430   0100A0E3           MOV      R0,#+1
   \   00000434   F08FBDE8           POP      {R4-R11,PC}
    187            }
    188            return 0;
    189          }
    190          
    191          #define LINESCACHECHUNK 256
    192          

   \                                 In segment CODE, align 4, keep-with-next
    193          static void newCacheLine(VIEWDATA *vd, LINECACHE *p)
    194          {
   \                     newCacheLine:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    195            if ((vd->lines_cache_size%LINESCACHECHUNK)==0)
   \   00000008   140094E5           LDR      R0,[R4, #+20]
   \   0000000C   0150A0E1           MOV      R5,R1
   \   00000010   001CB0E1           LSLS     R1,R0,#+24
   \   00000014   0400001A           BNE      ??newCacheLine_0
    196            {
    197              //Дошли до конца куска, реаллоцируем еще кусок
    198              vd->lines_cache=realloc(vd->lines_cache,(vd->lines_cache_size+LINESCACHECHUNK)*sizeof(LINECACHE));
   \   00000018   400F80E2           ADD      R0,R0,#+256
   \   0000001C   0012A0E1           LSL      R1,R0,#+4
   \   00000020   100094E5           LDR      R0,[R4, #+16]
   \   00000024   BA0000EF           SWI      +186
   \   00000028   100084E5           STR      R0,[R4, #+16]
    199            }
    200            memcpy(vd->lines_cache+(vd->lines_cache_size++),p,sizeof(LINECACHE));
   \                     ??newCacheLine_0:
   \   0000002C   140094E5           LDR      R0,[R4, #+20]
   \   00000030   1020A0E3           MOV      R2,#+16
   \   00000034   011080E2           ADD      R1,R0,#+1
   \   00000038   141084E5           STR      R1,[R4, #+20]
   \   0000003C   103094E5           LDR      R3,[R4, #+16]
   \   00000040   0510A0E1           MOV      R1,R5
   \   00000044   000283E0           ADD      R0,R3,R0, LSL #+4
   \   00000048   1E0100EF           SWI      +286
    201            vd->lines_cache_pos=p->pos;
   \   0000004C   000095E5           LDR      R0,[R5, #+0]
   \   00000050   180084E5           STR      R0,[R4, #+24]
    202          }
   \   00000054   3080BDE8           POP      {R4,R5,PC}       ;; return
    203          

   \                                 In segment CODE, align 4, keep-with-next
    204          int LineDown(VIEWDATA *vd)
    205          {
   \                     LineDown:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   10D04DE2           SUB      SP,SP,#+16
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   1C0094E5           LDR      R0,[R4, #+28]
   \   00000010   141094E5           LDR      R1,[R4, #+20]
   \   00000014   010080E2           ADD      R0,R0,#+1
   \   00000018   010050E1           CMP      R0,R1
   \   0000001C   2A00003A           BCC      ??LineDown_0
    206            LINECACHE lc;
    207            if (vd->view_line+1<vd->lines_cache_size)
    208            {
    209              vd->view_line++;
    210            }
    211            else
    212            {
    213              LINECACHE *plc;
    214              if (!vd->lines_cache_size)
   \   00000020   000051E3           CMP      R1,#+0
   \   00000024   1600001A           BNE      ??LineDown_1
    215              {
    216                lc.ink1=0x0000;
    217                lc.ink2=0x0064;
   \   00000028   6420A0E3           MOV      R2,#+100
   \   0000002C   B620CDE1           STRH     R2,[SP, #+6]
    218                lc.paper1=0xFFFF;
   \   00000030   FF20A0E3           MOV      R2,#+255
   \   00000034   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000038   B820CDE1           STRH     R2,[SP, #+8]
    219                lc.paper2=0xFF64;
   \   0000003C   9B20C2E3           BIC      R2,R2,#0x9B
   \   00000040   BA20CDE1           STRH     R2,[SP, #+10]
    220                lc.pixheight=0;
    221                lc.bold=0;
    222                lc.underline=0;
    223                lc.ref=0;
   \   00000044   BC20DDE1           LDRH     R2,[SP, #+12]
   \   00000048   0000A0E3           MOV      R0,#+0
   \   0000004C   B400CDE1           STRH     R0,[SP, #+4]
   \   00000050   BE00CDE1           STRH     R0,[SP, #+14]
   \   00000054   F830A0E3           MOV      R3,#+248
   \   00000058   FF3C83E3           ORR      R3,R3,#0xFF00
   \   0000005C   022003E0           AND      R2,R3,R2
   \   00000060   BC20CDE1           STRH     R2,[SP, #+12]
    224                lc.pos=0;
   \   00000064   00008DE5           STR      R0,[SP, #+0]
    225                lc.center=0;
    226                lc.right=0;
    227                lc.centerAtAll=0;
   \   00000068   0210A0E1           MOV      R1,R2
   \   0000006C   312043E2           SUB      R2,R3,#+49
   \   00000070   011002E0           AND      R1,R2,R1
   \   00000074   BC10CDE1           STRH     R1,[SP, #+12]
    228                newCacheLine(vd,&lc);
   \   00000078   0D10A0E1           MOV      R1,SP
   \   0000007C   0400A0E1           MOV      R0,R4
   \   00000080   ........           BL       newCacheLine
    229              }
    230              plc=vd->lines_cache+vd->lines_cache_size-1;
   \                     ??LineDown_1:
   \   00000084   140094E5           LDR      R0,[R4, #+20]
   \   00000088   101094E5           LDR      R1,[R4, #+16]
   \   0000008C   000281E0           ADD      R0,R1,R0, LSL #+4
   \   00000090   105040E2           SUB      R5,R0,#+16
    231              if (!SearchNextDisplayLine(vd,plc)) return 0; // can't caching futher
   \   00000094   0510A0E1           MOV      R1,R5
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   ........           BL       SearchNextDisplayLine
   \   000000A0   000050E3           CMP      R0,#+0
   \   000000A4   0A00000A           BEQ      ??LineDown_2
    232              memcpy(&lc,plc,sizeof(LINECACHE));
   \   000000A8   1020A0E3           MOV      R2,#+16
   \   000000AC   0510A0E1           MOV      R1,R5
   \   000000B0   0D00A0E1           MOV      R0,SP
   \   000000B4   1E0100EF           SWI      +286
    233              newCacheLine(vd,&lc);
   \   000000B8   0D10A0E1           MOV      R1,SP
   \   000000BC   0400A0E1           MOV      R0,R4
   \   000000C0   ........           BL       newCacheLine
    234              vd->view_line++;
   \   000000C4   1C0094E5           LDR      R0,[R4, #+28]
   \   000000C8   010080E2           ADD      R0,R0,#+1
   \                     ??LineDown_0:
   \   000000CC   1C0084E5           STR      R0,[R4, #+28]
    235            }
    236            return 1;
   \   000000D0   0100A0E3           MOV      R0,#+1
   \                     ??LineDown_2:
   \   000000D4   10D08DE2           ADD      SP,SP,#+16       ;; stack cleaning
   \   000000D8   3080BDE8           POP      {R4,R5,PC}       ;; return
    237          }
    238          // 0 page start

   \                                 In segment CODE, align 4, keep-with-next
    239          int LineUp(VIEWDATA *vd)
    240          {
    241            int vl=vd->view_line;
   \                     LineUp:
   \   00000000   1C1090E5           LDR      R1,[R0, #+28]
    242            if (vl)
   \   00000004   000051E3           CMP      R1,#+0
   \   00000008   0300000A           BEQ      ??LineUp_0
    243            {
    244              vl--;
    245              vd->view_line=vl;
   \   0000000C   011041E2           SUB      R1,R1,#+1
   \   00000010   1C1080E5           STR      R1,[R0, #+28]
    246              return 1;
   \   00000014   0100A0E3           MOV      R0,#+1
   \   00000018   1EFF2FE1           BX       LR
    247            }
    248            else
    249              return 0;
   \                     ??LineUp_0:
   \   0000001C   0000A0E3           MOV      R0,#+0
   \   00000020   1EFF2FE1           BX       LR               ;; return
    250          }
    251          

   \                                 In segment CODE, align 4, keep-with-next
    252          void scrollDown(VIEWDATA *vd, int amount)
    253          {
   \                     scrollDown:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    254            if (!RenderPage(vd,0)||vd->lines_cache_size==0) return;
   \   0000000C   0010A0E3           MOV      R1,#+0
   \   00000010   ........           BL       RenderPage
   \   00000014   000050E3           CMP      R0,#+0
   \   00000018   14009415           LDRNE    R0,[R4, #+20]
   \   0000001C   00005013           CMPNE    R0,#+0
   \   00000020   3080BD08           POPEQ    {R4,R5,PC}
    255            
    256            vd->pixdisp+=amount;
   \   00000024   200094E5           LDR      R0,[R4, #+32]
   \   00000028   000085E0           ADD      R0,R5,R0
   \   0000002C   200084E5           STR      R0,[R4, #+32]
   \   00000030   000000EA           B        ??scrollDown_0
    257            unsigned int cl_h;
    258          L1:
    259            cl_h=vd->lines_cache[vd->view_line].pixheight;
    260            if (vd->pixdisp>cl_h)
    261            {
    262              vd->pixdisp-=cl_h;
    263              unsigned int pd=vd->pixdisp;
    264              LineDown(vd);
    265              vd->pixdisp=0;
    266              if (!RenderPage(vd,0))
    267              {
    268                while(LineDown(vd)) ;
    269                vd->pixdisp=(vd->lines_cache+vd->lines_cache_size-1)->pixheight;
    270                scrollUp(vd,ScreenH()-1-scr_shift);
    271                return;
    272              }
    273              vd->pixdisp=pd;
   \                     ??scrollDown_1:
   \   00000034   205084E5           STR      R5,[R4, #+32]
    274              goto L1;
   \                     ??scrollDown_0:
   \   00000038   1C0094E5           LDR      R0,[R4, #+28]
   \   0000003C   101094E5           LDR      R1,[R4, #+16]
   \   00000040   000281E0           ADD      R0,R1,R0, LSL #+4
   \   00000044   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000048   201094E5           LDR      R1,[R4, #+32]
   \   0000004C   010050E1           CMP      R0,R1
   \   00000050   0F00002A           BCS      ??scrollDown_2
   \   00000054   005041E0           SUB      R5,R1,R0
   \   00000058   205084E5           STR      R5,[R4, #+32]
   \   0000005C   0400A0E1           MOV      R0,R4
   \   00000060   ........           BL       LineDown
   \   00000064   0000A0E3           MOV      R0,#+0
   \   00000068   200084E5           STR      R0,[R4, #+32]
   \   0000006C   0010A0E3           MOV      R1,#+0
   \   00000070   0400A0E1           MOV      R0,R4
   \   00000074   ........           BL       RenderPage
   \   00000078   000050E3           CMP      R0,#+0
   \   0000007C   ECFFFF1A           BNE      ??scrollDown_1
   \                     ??scrollDown_3:
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   ........           BL       LineDown
   \   00000088   000050E3           CMP      R0,#+0
   \   0000008C   FBFFFF1A           BNE      ??scrollDown_3
   \   00000090   080000EA           B        ??scrollDown_4
    275            }
    276            else
    277            {
    278              if (!RenderPage(vd,0))
   \                     ??scrollDown_2:
   \   00000094   0010A0E3           MOV      R1,#+0
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   ........           BL       RenderPage
   \   000000A0   000050E3           CMP      R0,#+0
   \   000000A4   3080BD18           POPNE    {R4,R5,PC}
    279              {
    280                while(LineDown(vd)) ;
   \                     ??scrollDown_5:
   \   000000A8   0400A0E1           MOV      R0,R4
   \   000000AC   ........           BL       LineDown
   \   000000B0   000050E3           CMP      R0,#+0
   \   000000B4   FBFFFF1A           BNE      ??scrollDown_5
    281                vd->pixdisp=(vd->lines_cache+vd->lines_cache_size-1)->pixheight;
   \                     ??scrollDown_4:
   \   000000B8   140094E5           LDR      R0,[R4, #+20]
   \   000000BC   101094E5           LDR      R1,[R4, #+16]
   \   000000C0   000281E0           ADD      R0,R1,R0, LSL #+4
   \   000000C4   B20050E1           LDRH     R0,[R0, #-2]
   \   000000C8   200084E5           STR      R0,[R4, #+32]
    282                scrollUp(vd,ScreenH()-1-scr_shift);
   \   000000CC   898100EF           SWI      +33161
   \   000000D0   ........           LDR      R1,??DataTable0  ;; scr_shift
   \   000000D4   010040E2           SUB      R0,R0,#+1
   \   000000D8   001091E5           LDR      R1,[R1, #+0]
   \   000000DC   011040E0           SUB      R1,R0,R1
   \   000000E0   0400A0E1           MOV      R0,R4
   \   000000E4   ........           BL       scrollUp
   \   000000E8   3080BDE8           POP      {R4,R5,PC}       ;; return
    283              }
    284            }
    285          }
    286          

   \                                 In segment CODE, align 4, keep-with-next
    287          void scrollUp(VIEWDATA *vd, int amount)
    288          {
   \                     scrollUp:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   040000EA           B        ??scrollUp_0
    289            while (vd->pixdisp-amount<0)
    290            {
    291              if (!LineUp(vd))
    292              {
    293                vd->pixdisp=0;
    294                return;
    295              }
    296              amount-=vd->lines_cache[vd->view_line].pixheight;
   \                     ??scrollUp_1:
   \   00000010   1C0094E5           LDR      R0,[R4, #+28]
   \   00000014   101094E5           LDR      R1,[R4, #+16]
   \   00000018   000281E0           ADD      R0,R1,R0, LSL #+4
   \   0000001C   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000020   005045E0           SUB      R5,R5,R0
   \                     ??scrollUp_0:
   \   00000024   200094E5           LDR      R0,[R4, #+32]
   \   00000028   050050E0           SUBS     R0,R0,R5
   \   0000002C   0300005A           BPL      ??scrollUp_2
   \   00000030   0400A0E1           MOV      R0,R4
   \   00000034   ........           BL       LineUp
   \   00000038   000050E3           CMP      R0,#+0
   \   0000003C   F3FFFF1A           BNE      ??scrollUp_1
    297            }
    298            vd->pixdisp-=amount;
   \                     ??scrollUp_2:
   \   00000040   200084E5           STR      R0,[R4, #+32]
    299          }
   \   00000044   3080BDE8           POP      {R4,R5,PC}       ;; return
    300          
    301          #define MAX_COLORS_IN_LINE 32
    302          typedef struct {
    303            char color[4];
    304            int start_x;
    305            int end_x;
    306          } COLOR_RC;
    307          
    308          

   \                                 In segment CODE, align 4, keep-with-next
    309          void renderForm(VIEWDATA *vd, REFCACHE *rf, int x, int y, int y2, int wchar)
    310          {
   \                     renderForm:
   \   00000000   F44F2DE9           PUSH     {R2,R4-R11,LR}
   \   00000004   0070A0E1           MOV      R7,R0
   \   00000008   0140A0E1           MOV      R4,R1
    311            if (rf->tag=='x'||rf->tag=='p')
   \   0000000C   080094E5           LDR      R0,[R4, #+8]
   \   00000010   0350A0E1           MOV      R5,R3
   \   00000014   780050E3           CMP      R0,#+120
   \   00000018   70005013           CMPNE    R0,#+112
   \   0000001C   4F00001A           BNE      ??renderForm_0
    312            {
    313              // calc pos
    314              int d=(GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_TEXT_FORM))-GetFontHeight(FONT_SMALL,0))/2;
   \   00000020   F80097E5           LDR      R0,[R7, #+248]
   \   00000024   E40100EF           SWI      +484
   \   00000028   210000EF           SWI      +33
   \   0000002C   0060A0E1           MOV      R6,R0
   \   00000030   0010A0E3           MOV      R1,#+0
   \   00000034   0800A0E3           MOV      R0,#+8
   \   00000038   ........           BL       GetFontHeight
   \   0000003C   000046E0           SUB      R0,R6,R0
   \   00000040   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   00000044   C060A0E1           ASR      R6,R0,#+1
    315              // count lenght
    316              int w=GetImgWidth(GetPicNByUnicodeSymbol(vd->WCHAR_TEXT_FORM))-(d*2);
   \   00000048   F80097E5           LDR      R0,[R7, #+248]
   \   0000004C   E40100EF           SWI      +484
   \   00000050   220000EF           SWI      +34
   \   00000054   869040E0           SUB      R9,R0,R6, LSL #+1
    317              WSHDR *ws2=AllocWS(((WSHDR *)rf->data)->wsbody[0]);
   \   00000058   180094E5           LDR      R0,[R4, #+24]
   \   0000005C   000090E5           LDR      R0,[R0, #+0]
   \   00000060   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000064   250100EF           SWI      +293
   \   00000068   0080A0E1           MOV      R8,R0
   \   0000006C   020000EA           B        ??renderForm_1
    318              for (;ws2->wsbody[0]<((WSHDR *)rf->data)->wsbody[0];)
    319              {
    320                w-=GetSymbolWidth(((WSHDR *)rf->data)->wsbody[ws2->wsbody[0]+1],FONT_SMALL);
    321                if (w<=0)
    322                  break;
    323                ws2->wsbody[0]++;
    324                if (rf->tag=='p')
    325                  ws2->wsbody[ws2->wsbody[0]]='*';
   \                     ??renderForm_2:
   \   00000070   810080E0           ADD      R0,R0,R1, LSL #+1
   \   00000074   2A10A0E3           MOV      R1,#+42
   \   00000078   B010C0E1           STRH     R1,[R0, #+0]
   \                     ??renderForm_1:
   \   0000007C   180094E5           LDR      R0,[R4, #+24]
   \   00000080   002098E5           LDR      R2,[R8, #+0]
   \   00000084   003090E5           LDR      R3,[R0, #+0]
   \   00000088   B010D2E1           LDRH     R1,[R2, #+0]
   \   0000008C   B030D3E1           LDRH     R3,[R3, #+0]
   \   00000090   030051E1           CMP      R1,R3
   \   00000094   1800002A           BCS      ??renderForm_3
   \   00000098   B020D2E1           LDRH     R2,[R2, #+0]
   \   0000009C   000090E5           LDR      R0,[R0, #+0]
   \   000000A0   0810A0E3           MOV      R1,#+8
   \   000000A4   820080E0           ADD      R0,R0,R2, LSL #+1
   \   000000A8   B200D0E1           LDRH     R0,[R0, #+2]
   \   000000AC   E10100EF           SWI      +481
   \   000000B0   009049E0           SUB      R9,R9,R0
   \   000000B4   010059E3           CMP      R9,#+1
   \   000000B8   0F0000BA           BLT      ??renderForm_3
   \   000000BC   000098E5           LDR      R0,[R8, #+0]
   \   000000C0   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000C4   011081E2           ADD      R1,R1,#+1
   \   000000C8   B010C0E1           STRH     R1,[R0, #+0]
   \   000000CC   081094E5           LDR      R1,[R4, #+8]
   \   000000D0   700051E3           CMP      R1,#+112
   \   000000D4   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000D8   E4FFFF0A           BEQ      ??renderForm_2
    326                else
    327                  ws2->wsbody[ws2->wsbody[0]]=((WSHDR *)rf->data)->wsbody[ws2->wsbody[0]];
   \   000000DC   182094E5           LDR      R2,[R4, #+24]
   \   000000E0   811080E0           ADD      R1,R0,R1, LSL #+1
   \   000000E4   B000D0E1           LDRH     R0,[R0, #+0]
   \   000000E8   002092E5           LDR      R2,[R2, #+0]
   \   000000EC   800082E0           ADD      R0,R2,R0, LSL #+1
   \   000000F0   B000D0E1           LDRH     R0,[R0, #+0]
   \   000000F4   B000C1E1           STRH     R0,[R1, #+0]
   \   000000F8   DFFFFFEA           B        ??renderForm_1
    328              }
    329              DrawString(ws2,x+d,y+d,ScreenW(),ScreenH(),
    330                FONT_SMALL,TEXT_NOFORMAT,
    331                GetPaletteAdrByColorIndex(2),
    332                GetPaletteAdrByColorIndex(23));
   \                     ??renderForm_3:
   \   000000FC   1700A0E3           MOV      R0,#+23
   \   00000100   2E0100EF           SWI      +302
   \   00000104   00A0A0E1           MOV      R10,R0
   \   00000108   0200A0E3           MOV      R0,#+2
   \   0000010C   2E0100EF           SWI      +302
   \   00000110   00B0A0E1           MOV      R11,R0
   \   00000114   898100EF           SWI      +33161
   \   00000118   0090A0E1           MOV      R9,R0
   \   0000011C   888100EF           SWI      +33160
   \   00000120   0030A0E1           MOV      R3,R0
   \   00000124   00042DE9           PUSH     {R10}
   \   00000128   00082DE9           PUSH     {R11}
   \   0000012C   8000A0E3           MOV      R0,#+128
   \   00000130   01002DE9           PUSH     {R0}
   \   00000134   052086E0           ADD      R2,R6,R5
   \   00000138   0800A0E3           MOV      R0,#+8
   \   0000013C   01002DE9           PUSH     {R0}
   \   00000140   00022DE9           PUSH     {R9}
   \   00000144   14009DE5           LDR      R0,[SP, #+20]
   \   00000148   001086E0           ADD      R1,R6,R0
   \   0000014C   0800A0E1           MOV      R0,R8
   \   00000150   4C0100EF           SWI      +332
    333              FreeWS(ws2);
   \   00000154   0800A0E1           MOV      R0,R8
   \   00000158   290100EF           SWI      +297
   \   0000015C   14D08DE2           ADD      SP,SP,#+20
    334            }
    335            if (rf->tag=='s'&&rf->value!=_NOREF)
   \                     ??renderForm_0:
   \   00000160   080094E5           LDR      R0,[R4, #+8]
   \   00000164   730050E3           CMP      R0,#+115
   \   00000168   5300001A           BNE      ??renderForm_4
   \   0000016C   100094E5           LDR      R0,[R4, #+16]
   \   00000170   010070E3           CMN      R0,#+1
   \   00000174   F18FBD08           POPEQ    {R0,R4-R11,PC}
    336            {
    337              // calc pos
    338              int d=(GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM))-GetFontHeight(FONT_SMALL,0))/2;
   \   00000178   FC0097E5           LDR      R0,[R7, #+252]
   \   0000017C   E40100EF           SWI      +484
   \   00000180   210000EF           SWI      +33
   \   00000184   0060A0E1           MOV      R6,R0
   \   00000188   0010A0E3           MOV      R1,#+0
   \   0000018C   0800A0E3           MOV      R0,#+8
   \   00000190   ........           BL       GetFontHeight
   \   00000194   000046E0           SUB      R0,R6,R0
   \   00000198   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   0000019C   C060A0E1           ASR      R6,R0,#+1
    339              // count lenght
    340              int w=GetImgWidth(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM))-(d*2)-GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM));
   \   000001A0   FC0097E5           LDR      R0,[R7, #+252]
   \   000001A4   E40100EF           SWI      +484
   \   000001A8   220000EF           SWI      +34
   \   000001AC   0080A0E1           MOV      R8,R0
   \   000001B0   FC0097E5           LDR      R0,[R7, #+252]
   \   000001B4   868048E0           SUB      R8,R8,R6, LSL #+1
   \   000001B8   E40100EF           SWI      +484
   \   000001BC   210000EF           SWI      +33
    341              int count=_rshort2(vd->oms+rf->value);
   \   000001C0   3C1097E5           LDR      R1,[R7, #+60]
   \   000001C4   009048E0           SUB      R9,R8,R0
   \   000001C8   100094E5           LDR      R0,[R4, #+16]
   \   000001CC   010080E0           ADD      R0,R0,R1
   \   000001D0   ........           _BLF     _rshort2,??_rshort2??rA
    342              char *c=extract_omstr(vd,rf->value);
   \   000001D4   101094E5           LDR      R1,[R4, #+16]
   \   000001D8   00A0A0E1           MOV      R10,R0
   \   000001DC   0700A0E1           MOV      R0,R7
   \   000001E0   ........           _BLF     extract_omstr,??extract_omstr??rA
   \   000001E4   0070A0E1           MOV      R7,R0
    343              WSHDR *ws2=AllocWS(count);
   \   000001E8   0A00A0E1           MOV      R0,R10
   \   000001EC   250100EF           SWI      +293
   \   000001F0   0080A0E1           MOV      R8,R0
    344              oms2ws(ws2,c,count);
   \   000001F4   0A20A0E1           MOV      R2,R10
   \   000001F8   0710A0E1           MOV      R1,R7
   \   000001FC   ........           _BLF     oms2ws,??oms2ws??rA
    345              count=ws2->wsbody[0];
   \   00000200   000098E5           LDR      R0,[R8, #+0]
    346              ws2->wsbody[0]=0;
   \   00000204   0010A0E3           MOV      R1,#+0
   \   00000208   B0A0D0E1           LDRH     R10,[R0, #+0]
   \   0000020C   020000EA           B        ??renderForm_5
    347              for (;ws2->wsbody[0]<count;)
    348              {
    349                w-=GetSymbolWidth(ws2->wsbody[ws2->wsbody[0]+1],FONT_SMALL);
    350                if (w<=0)
    351                  break;
    352                ws2->wsbody[0]++;
   \                     ??renderForm_6:
   \   00000210   000098E5           LDR      R0,[R8, #+0]
   \   00000214   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000218   011081E2           ADD      R1,R1,#+1
   \                     ??renderForm_5:
   \   0000021C   B010C0E1           STRH     R1,[R0, #+0]
   \   00000220   000098E5           LDR      R0,[R8, #+0]
   \   00000224   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000228   0A0051E1           CMP      R1,R10
   \   0000022C   070000AA           BGE      ??renderForm_7
   \   00000230   B020D0E1           LDRH     R2,[R0, #+0]
   \   00000234   0810A0E3           MOV      R1,#+8
   \   00000238   820080E0           ADD      R0,R0,R2, LSL #+1
   \   0000023C   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000240   E10100EF           SWI      +481
   \   00000244   009049E0           SUB      R9,R9,R0
   \   00000248   010059E3           CMP      R9,#+1
   \   0000024C   EFFFFFAA           BGE      ??renderForm_6
    353              }
    354              DrawString(ws2,x+d,y+d,ScreenW(),ScreenH(),
    355                FONT_SMALL,TEXT_NOFORMAT,
    356                GetPaletteAdrByColorIndex(1),
    357                GetPaletteAdrByColorIndex(23));
   \                     ??renderForm_7:
   \   00000250   1700A0E3           MOV      R0,#+23
   \   00000254   2E0100EF           SWI      +302
   \   00000258   0090A0E1           MOV      R9,R0
   \   0000025C   0100A0E3           MOV      R0,#+1
   \   00000260   2E0100EF           SWI      +302
   \   00000264   00A0A0E1           MOV      R10,R0
   \   00000268   898100EF           SWI      +33161
   \   0000026C   00B0A0E1           MOV      R11,R0
   \   00000270   888100EF           SWI      +33160
   \   00000274   00022DE9           PUSH     {R9}
   \   00000278   00042DE9           PUSH     {R10}
   \   0000027C   8010A0E3           MOV      R1,#+128
   \   00000280   02002DE9           PUSH     {R1}
   \   00000284   0030A0E1           MOV      R3,R0
   \   00000288   052086E0           ADD      R2,R6,R5
   \   0000028C   0810A0E3           MOV      R1,#+8
   \   00000290   02002DE9           PUSH     {R1}
   \   00000294   00082DE9           PUSH     {R11}
   \   00000298   14009DE5           LDR      R0,[SP, #+20]
   \   0000029C   001086E0           ADD      R1,R6,R0
   \   000002A0   0800A0E1           MOV      R0,R8
   \   000002A4   4C0100EF           SWI      +332
    358              FreeWS(ws2);
   \   000002A8   0800A0E1           MOV      R0,R8
   \   000002AC   290100EF           SWI      +297
    359              mfree(c);
   \   000002B0   0700A0E1           MOV      R0,R7
   \   000002B4   150000EF           SWI      +21
   \   000002B8   14D08DE2           ADD      SP,SP,#+20
    360            }
    361            if (rf->tag=='u')
   \                     ??renderForm_4:
   \   000002BC   080094E5           LDR      R0,[R4, #+8]
   \   000002C0   750050E3           CMP      R0,#+117
   \   000002C4   F18FBD18           POPNE    {R0,R4-R11,PC}
    362            {
    363              DrawString((WSHDR *)rf->data,x+4,y+3+(y2-y-GetImgHeight(GetPicNByUnicodeSymbol(wchar))),ScreenW(),ScreenH(),
    364                FONT_SMALL,TEXT_NOFORMAT,
    365                GetPaletteAdrByColorIndex(1),
    366                GetPaletteAdrByColorIndex(23));
   \   000002C8   1700A0E3           MOV      R0,#+23
   \   000002CC   2E0100EF           SWI      +302
   \   000002D0   0060A0E1           MOV      R6,R0
   \   000002D4   0100A0E3           MOV      R0,#+1
   \   000002D8   2E0100EF           SWI      +302
   \   000002DC   0070A0E1           MOV      R7,R0
   \   000002E0   898100EF           SWI      +33161
   \   000002E4   0080A0E1           MOV      R8,R0
   \   000002E8   888100EF           SWI      +33160
   \   000002EC   0090A0E1           MOV      R9,R0
   \   000002F0   2C009DE5           LDR      R0,[SP, #+44]
   \   000002F4   E40100EF           SWI      +484
   \   000002F8   210000EF           SWI      +33
   \   000002FC   40002DE9           PUSH     {R6}
   \   00000300   80002DE9           PUSH     {R7}
   \   00000304   8010A0E3           MOV      R1,#+128
   \   00000308   02002DE9           PUSH     {R1}
   \   0000030C   0930A0E1           MOV      R3,R9
   \   00000310   0810A0E3           MOV      R1,#+8
   \   00000314   02002DE9           PUSH     {R1}
   \   00000318   00012DE9           PUSH     {R8}
   \   0000031C   3C109DE5           LDR      R1,[SP, #+60]
   \   00000320   051081E0           ADD      R1,R1,R5
   \   00000324   031081E2           ADD      R1,R1,#+3
   \   00000328   051041E0           SUB      R1,R1,R5
   \   0000032C   002041E0           SUB      R2,R1,R0
   \   00000330   14009DE5           LDR      R0,[SP, #+20]
   \   00000334   041080E2           ADD      R1,R0,#+4
   \   00000338   180094E5           LDR      R0,[R4, #+24]
   \   0000033C   4C0100EF           SWI      +332
   \   00000340   14D08DE2           ADD      SP,SP,#+20
    367            }
    368          }
   \   00000344   F18FBDE8           POP      {R0,R4-R11,PC}   ;; return
    369          // возвращает 1, если видна последняя строка
    370          // возвращает 2, если виден конец страницы

   \                                 In segment CODE, align 4, keep-with-next
    371          int RenderPage(VIEWDATA *vd, int do_draw)
    372          {
   \                     RenderPage:
   \   00000000   F24F2DE9           PUSH     {R1,R4-R11,LR}
   \   00000004   5CD04DE2           SUB      SP,SP,#+92
   \   00000008   40DE4DE2           SUB      SP,SP,#+1024
   \   0000000C   0040A0E1           MOV      R4,R0
    373            int scr_w=ScreenW()-MARGIN/2-1;
   \   00000010   888100EF           SWI      +33160
   \   00000014   030040E2           SUB      R0,R0,#+3
   \   00000018   1C008DE5           STR      R0,[SP, #+28]
    374            int scr_h=ScreenH()-1;
   \   0000001C   898100EF           SWI      +33161
   \   00000020   010040E2           SUB      R0,R0,#+1
   \   00000024   2C008DE5           STR      R0,[SP, #+44]
    375            int sc=0;
    376            int dc;
    377            WSHDR *ws=vd->ws;
   \   00000028   241094E5           LDR      R1,[R4, #+36]
   \   0000002C   0090A0E3           MOV      R9,#+0
   \   00000030   40108DE5           STR      R1,[SP, #+64]
    378            LINECACHE *lc;
    379            int ypos=scr_shift-vd->pixdisp;
   \   00000034   ........           LDR      R1,??DataTable1  ;; scr_shift
    380            unsigned int vl;
    381            unsigned int store_line=vl=vd->view_line;
    382            unsigned int len;
    383            unsigned int y2;
    384            
    385            char def_ink[4];
    386            COLOR_RC rc[MAX_COLORS_IN_LINE];
    387            int cur_rc;
    388            int ws_width;
    389            
    390            int c;
    391            int ena_ref=0;
   \   00000038   0050A0E3           MOV      R5,#+0
   \   0000003C   001091E5           LDR      R1,[R1, #+0]
   \   00000040   30108DE5           STR      R1,[SP, #+48]
   \   00000044   0100A0E1           MOV      R0,R1
   \   00000048   201094E5           LDR      R1,[R4, #+32]
   \   0000004C   016040E0           SUB      R6,R0,R1
   \   00000050   1C1094E5           LDR      R1,[R4, #+28]
   \   00000054   20108DE5           STR      R1,[SP, #+32]
   \   00000058   58108DE5           STR      R1,[SP, #+88]
    392            int isBold = 0;
   \   0000005C   0510A0E1           MOV      R1,R5
   \   00000060   34108DE5           STR      R1,[SP, #+52]
    393            int isUnderline = 0;
   \   00000064   44108DE5           STR      R1,[SP, #+68]
   \   00000068   38108DE5           STR      R1,[SP, #+56]
   \   0000006C   0100E0E1           MVN      R0,R1
   \   00000070   2C0084E5           STR      R0,[R4, #+44]
    394            int max_ref_height;
    395            
    396            unsigned int flag=0;
    397            
    398            vd->pos_first_ref=0xFFFFFFFF;
    399            vd->pos_last_ref=0xFFFFFFFF;
   \   00000074   300084E5           STR      R0,[R4, #+48]
    400            vd->pos_prev_ref=0xFFFFFFFF;
   \   00000078   340084E5           STR      R0,[R4, #+52]
    401            vd->pos_next_ref=0xFFFFFFFF;
   \   0000007C   380084E5           STR      R0,[R4, #+56]
    402            
    403            int dfh=GetFontHeight(FONT_SMALL,0)*2; //double font height
   \   00000080   0800A0E3           MOV      R0,#+8
   \   00000084   ........           BL       GetFontHeight
   \   00000088   8000A0E1           LSL      R0,R0,#+1
   \   0000008C   48008DE5           STR      R0,[SP, #+72]
    404            
    405            typedef struct
    406            {
    407              REFCACHE *form_rf;
    408              int       form_x;
    409              int       form_char;
    410            }tFormData;
    411            
    412            REFCACHE *rnd_rf;
    413            tFormData form_data[32];
    414            int form_num;
    415            
    416            RECT rcs[32]; // cursor
    417            RECT rcs_work;
    418            int  rcs_num=0;
   \   00000090   0510A0E1           MOV      R1,R5
   \   00000094   14108DE5           STR      R1,[SP, #+20]
    419            
    420            int lcheck=0; // last line checker
   \   00000098   10108DE5           STR      R1,[SP, #+16]
    421            int lprev=0; // prev line
   \   0000009C   54108DE5           STR      R1,[SP, #+84]
   \   000000A0   380000EA           B        ??RenderPage_0
    422            
    423            int x;
    424            
    425            
    426            while(ypos<=scr_h)
    427            {
    428              if (!lcheck) 
    429                lcheck=!LineDown(vd);
    430              else 
    431                lcheck++;
    432              if (lcheck<=1&&vd->lines_cache_size>0)
    433              {
    434          
    435                lc=vd->lines_cache+vl;
    436                if (vl) lprev=-1;
    437                dc=0;
    438                ws_width=0;
    439                cur_rc=1;
    440                rnd_rf=NULL;
    441                zeromem(&rcs_work,sizeof(RECT));
    442                zeromem(&form_data, 32*sizeof(tFormData));
    443                form_num = 0;
    444                max_ref_height = 0;
    445                rc[0].start_x=MARGIN/2;
    446                rc[0].end_x=scr_w;
    447                rc[0].color[0]=lc[lprev].paper1>>8;
    448                rc[0].color[1]=lc[lprev].paper1;
    449                rc[0].color[2]=lc[lprev].paper2>>8;
    450                rc[0].color[3]=lc[lprev].paper2;
    451                
    452                if (vl) sc=lc[lprev].pos;
    453                len=lc->pos-sc;
    454                
    455                if (lc[lprev].bold)
    456                {
    457                  isBold = 1;
    458                }
    459                
    460                if (lc[lprev].underline)
    461                {
    462                  isUnderline = 1;
    463                }
    464                    
    465                while(len>0&&dc<250)
    466                {
    467                  c=vd->rawtext[sc];
    468                  
    469                  if (c==UTF16_ENA_INVERT)
    470                  {
    471                    if ((lc->pixheight<dfh)?(ypos<0):(ypos+lc->pixheight-dfh<0))
    472                      goto L1;
    473                    if ((lc->pixheight<dfh)?(ypos+lc->pixheight>scr_h):(ypos+dfh>scr_h))
    474                      goto L1;
    475                    if (vd->pos_cur_ref==sc)
    476                    { 
    477                      flag=1;
    478                      ena_ref=1;
    479                      rcs_work.x=ws_width;
    480                    }
    481                    else
    482                    {
    483                      if (vd->pos_first_ref==0xFFFFFFFF) vd->pos_first_ref=sc;
    484                      if (flag==0) vd->pos_prev_ref=sc;
    485                      if (flag==1)
    486                      {
    487                        vd->pos_next_ref=sc;
    488                        flag=2;
    489                      }
    490                      vd->pos_last_ref=sc;
    491                      if (ena_ref) ena_ref++;
    492                      goto L1;
    493                    }
    494                    goto L1;
    495                  }
    496                  if (c==UTF16_DIS_INVERT)
    497                  {
    498                    if (ena_ref!=1)
    499                    {
    500                      if (ena_ref) ena_ref--;
    501                      goto L1;
    502                    }
    503                    rcs_work.x2=ws_width;
    504                    ena_ref=0;
    505                    goto L1;
    506                  }
    507                  if (c==UTF16_PAPER_RGBA)
    508                  {
    509                    if (cur_rc<MAX_COLORS_IN_LINE)
    510                    {
    511                      COLOR_RC *prev=rc+cur_rc-1;
    512                      rc[cur_rc].color[0]=vd->rawtext[sc+1]>>8;
    513                      rc[cur_rc].color[1]=vd->rawtext[sc+1];
    514                      rc[cur_rc].color[2]=vd->rawtext[sc+2]>>8;
    515                      rc[cur_rc].color[3]=vd->rawtext[sc+2];
    516                      if (memcmp((void *)rc[cur_rc].color,(void *)prev->color,4))  // Только если цвет не равен предыдущему (очередь объектов не резиновая ;))
    517                      {
    518                        if (ws_width)
    519                          prev->end_x=ws_width-1+MARGIN/2;
    520                        else
    521                          prev->end_x = MARGIN/2;
    522                        rc[cur_rc].start_x=ws_width+MARGIN/2;
    523                        rc[cur_rc].end_x=scr_w;
    524                        cur_rc++;
    525                      }
    526                    }
    527                  }
    528                  if (c==UTF16_ALIGN_LEFT||c==UTF16_ALIGN_RIGHT||c==UTF16_ENA_CENTER|| \
    529                      c==UTF16_DIS_CENTER||c==UTF16_NEWLINE)
    530                  {
    531                    goto L1;
    532                  }
    533                  if ((c&0xFF00)==0xE100)
    534                  {
    535                    rnd_rf=FindReferenceByBegin(vd,sc-1);         
    536                    if ((rnd_rf) && (c==vd->WCHAR_TEXT_FORM||c==vd->WCHAR_LIST_FORM||rnd_rf->tag == 'u'))
    537                    {
    538                      form_data[form_num].form_rf = rnd_rf;
    539                      form_data[form_num].form_x = ws_width;
    540                      form_data[form_num].form_char = c;
    541                      form_num++;    
    542                    }  
    543                  }
    544                  if (c==UTF16_ENA_UNDERLINE)
    545                  {
    546                    isUnderline = 1;
    547                  }
    548                  if (c==UTF16_DIS_UNDERLINE)
    549                  {
    550                    isUnderline = 0;
    551                  }
    552                  if (c==UTF16_FONT_SMALL_BOLD)
    553                  {
    554                    isBold = 1;
    555                  }
    556                  if (c==UTF16_FONT_SMALL)
    557                  {
    558                    isBold = 0;
    559                  }
    560                  ws->wsbody[++dc]=c;
    561                  ws_width+=GetSymbolWidth(c,isBold?FONT_SMALL_BOLD:FONT_SMALL);
    562                  if (ena_ref)
    563                  {
    564                    int th;
    565                    if ((c&0xFF00)==0xE100)
    566                    {
    567                      th=GetImgHeight(GetPicNByUnicodeSymbol(c));
    568                    }
    569                    else
    570                    {
    571                      th=GetFontHeight(isBold?FONT_SMALL_BOLD:FONT_SMALL,isUnderline?TEXT_UNDERLINE:0);
    572                    }
    573                    if ( th > max_ref_height)
    574                      max_ref_height = th;
    575                  }
    576          
    577                  if ((c==UTF16_PAPER_RGBA)||(c==UTF16_INK_RGBA))
    578                  {
    579                    len--;
    580                    ws->wsbody[++dc]=vd->rawtext[++sc];
    581                    len--;
    582                    ws->wsbody[++dc]=vd->rawtext[++sc];
    583                  }
    584                  L1:
    585                  sc++;
    586                  len--;
    587                }
    588                ws->wsbody[0]=dc;
    589                y2=lc->pixheight+ypos;
    590                if (do_draw)
    591                {
    592                  if (y2!=ypos)
    593                  {
    594                    x=MARGIN/2;
    595                    if (lc[lprev+1].right) x=scr_w-ws_width;
    596                    if (lc[lprev+1].center||lc->centerAtAll) x=(ScreenW()-ws_width)/2;
    597                    
    598                    def_ink[0]=lc[lprev].ink1>>8;
    599                    def_ink[1]=lc[lprev].ink1;
    600                    def_ink[2]=lc[lprev].ink2>>8;
    601                    def_ink[3]=lc[lprev].ink2;
    602                    
    603                    for (int i=0; i!=cur_rc; i++)
    604                    {
    605                      DrawRectangle(rc[i].start_x,ypos,rc[i].end_x,y2,
    606                                    RECT_FILL_WITH_PEN,rc[i].color,rc[i].color);
    607                    }
    608                    
    609                    if (ena_ref) rcs_work.x2=ws_width;
    610                    if ((rcs_work.x!=0||rcs_work.x2!=0)&&rcs_work.x!=rcs_work.x2)
    611                    {
    612                      rcs_work.y=y2-max_ref_height;
    613                      rcs_work.y2=y2;
    614                      rcs_work.x+=x;
    615                      rcs_work.x2+=x;
    616                     
    617                      
    618                      rcs_work.x-=2;
    619                      rcs_work.x2++;
    620                      rcs_work.y--;
    621                      
    622                      if (rcs_work.x<0) rcs_work.x=0;
    623                      if (rcs_work.x2>(scr_w+1)) rcs_work.x2=scr_w+1;
    624                      
    625                      memcpy(&rcs[rcs_num],&rcs_work,sizeof(RECT));
    626                      rcs_num++;
    627                    }
    628           
    629                    DrawString(ws,x,ypos,scr_w,y2,
    630                               lc[lprev].bold?FONT_SMALL_BOLD:FONT_SMALL,
    631                               TEXT_NOFORMAT+(lc[lprev].underline?TEXT_UNDERLINE:0),
    632                               def_ink,GetPaletteAdrByColorIndex(23));
    633                    
    634                    for (int i = 0; form_data[i].form_rf != 0; i++)
    635                    {           
    636                      renderForm(vd, form_data[i].form_rf, form_data[i].form_x+x, ypos, y2, form_data[i].form_char);
    637                    }
    638                     
    639                  }
    640                  
    641                  
    642                  if (y2>=scr_h||lcheck)
    643                  {
    644                    if (rcs_num)
    645                    {
    646                      char cl[4];
    647                      setColor(0,0,170,100,cl);
    648                      REFCACHE *rf=FindReferenceByBegin(vd,vd->pos_cur_ref);
    649                      if (rf->tag=='Z') setColor(190,0,0,100,cl);
    650                      for (int i=0;i<rcs_num;i++)
    651                      {
    652           
    653                         DrawLine(rcs[i].x2  ,rcs[i].y  ,rcs[i].x2  ,rcs[i].y2  ,0,cl);
    654                         DrawLine(rcs[i].x2-1,rcs[i].y  ,rcs[i].x2-1,rcs[i].y2  ,0,cl);
    655                         if (i+1<rcs_num&&rcs[i].x<rcs[i+1].x2)
    656                         {
    657                           DrawLine(rcs[i].x2,rcs[i].y2,rcs[i+1].x2,rcs[i].y2,0,cl);
    658                           if (rcs[i].x2>rcs[i+1].x2)
    659                             DrawLine(rcs[i].x2-1,rcs[i].y2+1,rcs[i+1].x2+1,rcs[i].y2+1,0,cl);
    660                           else
    661                             DrawLine(rcs[i].x2+1,rcs[i].y2+1,rcs[i+1].x2-1,rcs[i].y2+1,0,cl);
    662                         }
    663                         else
    664                         {
    665                           DrawLine(rcs[i].x2  ,rcs[i].y2  ,rcs[i].x  ,rcs[i].y2  ,0,cl);
    666                           DrawLine(rcs[i].x2-1,rcs[i].y2+1,rcs[i].x+1,rcs[i].y2+1,0,cl);
    667                         }
    668                         DrawLine(rcs[i].x  ,rcs[i].y2  ,rcs[i].x  ,rcs[i].y  ,0,cl);
    669                         DrawLine(rcs[i].x+1,rcs[i].y2  ,rcs[i].x+1,rcs[i].y  ,0,cl);
    670                         if (i>0&&rcs[i].x2>rcs[i-1].x)
    671                         {
    672                           DrawLine(rcs[i].x,rcs[i].y,rcs[i-1].x,rcs[i].y,0,cl);
    673                           if (rcs[i].x<rcs[i-1].x)
    674                             DrawLine(rcs[i].x+1,rcs[i].y-1,rcs[i-1].x-1,rcs[i].y-1,0,cl);
    675                           else
    676                             DrawLine(rcs[i].x-1,rcs[i].y-1,rcs[i-1].x+1,rcs[i].y-1,0,cl);
    677                         }
    678                         else
    679                         {
    680                           DrawLine(rcs[i].x  ,rcs[i].y  ,rcs[i].x2 , rcs[i].y  ,0,cl);
    681                           DrawLine(rcs[i].x+1,rcs[i].y-1,rcs[i].x2-1,rcs[i].y-1,0,cl);
    682                         }
    683                      }
    684                    }
    685                    int b=((store_line?vd->lines_cache[store_line+lprev].pos:0)*1000)/vd->rawtext_size*(scr_h-scr_shift)/1000-2+scr_shift; // no float
   \                     ??RenderPage_1:
   \   000000A4   2C109DE5           LDR      R1,[SP, #+44]
   \   000000A8   30209DE5           LDR      R2,[SP, #+48]
   \   000000AC   0C3094E5           LDR      R3,[R4, #+12]
   \   000000B0   30609DE5           LDR      R6,[SP, #+48]
   \   000000B4   022041E0           SUB      R2,R1,R2
   \   000000B8   FA1FA0E3           MOV      R1,#+1000
   \   000000BC   910000E0           MUL      R0,R1,R0
   \   000000C0   0310A0E1           MOV      R1,R3
   \   000000C4   ........           _BLF     ??divu32_a,??rA??divu32_a
   \   000000C8   920100E0           MUL      R0,R2,R1
   \   000000CC   CC1B9FE5           LDR      R1,??RenderPage_2  ;; 0x10624dd3
   \   000000D0   91808AE0           UMULL    R8,R10,R1,R0
    686                    int e=(lc->pos*1000)/vd->rawtext_size*(scr_h-scr_shift)/1000+2+scr_shift;
   \   000000D4   FA1FA0E3           MOV      R1,#+1000
   \   000000D8   2AA3A0E1           LSR      R10,R10,#+6
   \   000000DC   06008AE0           ADD      R0,R10,R6
   \   000000E0   30A09DE5           LDR      R10,[SP, #+48]
   \   000000E4   026040E2           SUB      R6,R0,#+2
   \   000000E8   0C009DE5           LDR      R0,[SP, #+12]
   \   000000EC   000090E5           LDR      R0,[R0, #+0]
   \   000000F0   910000E0           MUL      R0,R1,R0
   \   000000F4   0310A0E1           MOV      R1,R3
   \   000000F8   ........           _BLF     ??divu32_a,??rA??divu32_a
   \   000000FC   920100E0           MUL      R0,R2,R1
   \   00000100   981B9FE5           LDR      R1,??RenderPage_2  ;; 0x10624dd3
   \   00000104   912083E0           UMULL    R2,R3,R1,R0
   \   00000108   2333A0E1           LSR      R3,R3,#+6
   \   0000010C   0A0083E0           ADD      R0,R3,R10
   \   00000110   020080E2           ADD      R0,R0,#+2
   \   00000114   3C008DE5           STR      R0,[SP, #+60]
    687                    if (!lcheck||b>scr_shift)
   \   00000118   10009DE5           LDR      R0,[SP, #+16]
   \   0000011C   000050E3           CMP      R0,#+0
   \   00000120   0100000A           BEQ      ??RenderPage_3
   \   00000124   06005AE1           CMP      R10,R6
   \   00000128   120000AA           BGE      ??RenderPage_4
    688                    {
    689          #ifdef ELKA
    690                      DrawRectangle(ScreenW()-2,b,ScreenW(),e,0,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(2));
   \                     ??RenderPage_3:
   \   0000012C   0200A0E3           MOV      R0,#+2
   \   00000130   2E0100EF           SWI      +302
   \   00000134   0080A0E1           MOV      R8,R0
   \   00000138   0200A0E3           MOV      R0,#+2
   \   0000013C   2E0100EF           SWI      +302
   \   00000140   00A0A0E1           MOV      R10,R0
   \   00000144   888100EF           SWI      +33160
   \   00000148   00B0A0E1           MOV      R11,R0
   \   0000014C   888100EF           SWI      +33160
   \   00000150   00012DE9           PUSH     {R8}
   \   00000154   00042DE9           PUSH     {R10}
   \   00000158   0010A0E3           MOV      R1,#+0
   \   0000015C   02002DE9           PUSH     {R1}
   \   00000160   48309DE5           LDR      R3,[SP, #+72]
   \   00000164   0B20A0E1           MOV      R2,R11
   \   00000168   020040E2           SUB      R0,R0,#+2
   \   0000016C   0610A0E1           MOV      R1,R6
   \   00000170   B40100EF           SWI      +436
   \   00000174   0CD08DE2           ADD      SP,SP,#+12
    691          #else
    692                      DrawRectangle(ScreenW()-1,b,ScreenW(),e,0,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(2));
    693          #endif
    694                    }
    695                    
    696          //        if (ballet_fexists("$ballet\\debug.txt"))
    697          //        {
    698          //          WSHDR *ws;
    699          //          ws=AllocWS(128);
    700          ////          for (int i=store_line;i<=vl;i++)
    701          ////          {
    702          ////            wsprintf(ws,"%u: %u %c%c h:%u",i,vd->lines_cache[i].pos,vd->lines_cache[i].center?'+':'-',vd->lines_cache[i].right?'>':'<',vd->lines_cache[i].pixheight);
    703          ////            DrawString(ws,3,(1+i-store_line)*14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(23));
    704          ////          }
    705          //          {
    706          //            wsprintf(ws,"%i",ws_width);
    707          //            DrawString(ws,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    708          //            wsprintf(ws,"%u %u",vd->pos_first_ref,vd->pos_last_ref);
    709          //            DrawString(ws,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    710          //            wsprintf(ws,"%u %u",vd->pos_prev_ref,vd->pos_next_ref);
    711          //            DrawString(ws,3,26,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    712          //            wsprintf(ws,"%u %c",vd->pos_cur_ref,FindReference(vd,vd->pos_cur_ref)?FindReference(vd,vd->pos_cur_ref)->tag:'0');
    713          //            DrawString(ws,3,38,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    714          //            wsprintf(ws,"%i",vd->pixdisp);
    715          //            DrawString(ws,3,50,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    716          ////            ws->wsbody[0]=10;
    717          ////            memcpy(&(ws->wsbody[1]),(vd->rawtext+store_pos),10);
    718          ////            DrawString(ws,3,50,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    719          //          }
    720          //          FreeWS(ws);
    721          //        }
    722                  }
    723                }
    724                ypos=y2;
    725                vl++;
   \                     ??RenderPage_4:
   \   00000178   20109DE5           LDR      R1,[SP, #+32]
   \   0000017C   0760A0E1           MOV      R6,R7
   \   00000180   011081E2           ADD      R1,R1,#+1
   \   00000184   20108DE5           STR      R1,[SP, #+32]
   \                     ??RenderPage_0:
   \   00000188   2C009DE5           LDR      R0,[SP, #+44]
   \   0000018C   060050E1           CMP      R0,R6
   \   00000190   B60200BA           BLT      ??RenderPage_5
   \   00000194   10009DE5           LDR      R0,[SP, #+16]
   \   00000198   000050E3           CMP      R0,#+0
   \   0000019C   0600001A           BNE      ??RenderPage_6
   \   000001A0   0400A0E1           MOV      R0,R4
   \   000001A4   ........           BL       LineDown
   \   000001A8   000050E3           CMP      R0,#+0
   \   000001AC   0600001A           BNE      ??RenderPage_7
   \   000001B0   0110A0E3           MOV      R1,#+1
   \   000001B4   10108DE5           STR      R1,[SP, #+16]
   \   000001B8   030000EA           B        ??RenderPage_7
   \                     ??RenderPage_6:
   \   000001BC   011080E2           ADD      R1,R0,#+1
   \   000001C0   10108DE5           STR      R1,[SP, #+16]
   \   000001C4   020051E3           CMP      R1,#+2
   \   000001C8   A80200AA           BGE      ??RenderPage_5
   \                     ??RenderPage_7:
   \   000001CC   140094E5           LDR      R0,[R4, #+20]
   \   000001D0   000050E3           CMP      R0,#+0
   \   000001D4   A502000A           BEQ      ??RenderPage_5
   \   000001D8   20109DE5           LDR      R1,[SP, #+32]
   \   000001DC   102094E5           LDR      R2,[R4, #+16]
   \   000001E0   0070A0E3           MOV      R7,#+0
   \   000001E4   011282E0           ADD      R1,R2,R1, LSL #+4
   \   000001E8   0C108DE5           STR      R1,[SP, #+12]
   \   000001EC   20009DE5           LDR      R0,[SP, #+32]
   \   000001F0   0080A0E3           MOV      R8,#+0
   \   000001F4   000050E3           CMP      R0,#+0
   \   000001F8   0010E013           MVNNE    R1,#+0
   \   000001FC   54108D15           STRNE    R1,[SP, #+84]
   \   00000200   0110A0E3           MOV      R1,#+1
   \   00000204   18108DE5           STR      R1,[SP, #+24]
   \   00000208   0810A0E3           MOV      R1,#+8
   \   0000020C   04008DE2           ADD      R0,SP,#+4
   \   00000210   1D0100EF           SWI      +285
   \   00000214   601FA0E3           MOV      R1,#+384
   \   00000218   770F8DE2           ADD      R0,SP,#+476
   \   0000021C   1D0100EF           SWI      +285
   \   00000220   0710A0E1           MOV      R1,R7
   \   00000224   4C108DE5           STR      R1,[SP, #+76]
   \   00000228   50108DE5           STR      R1,[SP, #+80]
   \   0000022C   0210A0E3           MOV      R1,#+2
   \   00000230   60108DE5           STR      R1,[SP, #+96]
   \   00000234   1C109DE5           LDR      R1,[SP, #+28]
   \   00000238   64108DE5           STR      R1,[SP, #+100]
   \   0000023C   54109DE5           LDR      R1,[SP, #+84]
   \   00000240   0C209DE5           LDR      R2,[SP, #+12]
   \   00000244   011282E0           ADD      R1,R2,R1, LSL #+4
   \   00000248   00108DE5           STR      R1,[SP, #+0]
   \   0000024C   B810D1E1           LDRH     R1,[R1, #+8]
   \   00000250   2114A0E1           LSR      R1,R1,#+8
   \   00000254   5C10CDE5           STRB     R1,[SP, #+92]
   \   00000258   00109DE5           LDR      R1,[SP, #+0]
   \   0000025C   B810D1E1           LDRH     R1,[R1, #+8]
   \   00000260   5D10CDE5           STRB     R1,[SP, #+93]
   \   00000264   00109DE5           LDR      R1,[SP, #+0]
   \   00000268   BA10D1E1           LDRH     R1,[R1, #+10]
   \   0000026C   2114A0E1           LSR      R1,R1,#+8
   \   00000270   5E10CDE5           STRB     R1,[SP, #+94]
   \   00000274   00109DE5           LDR      R1,[SP, #+0]
   \   00000278   BA10D1E1           LDRH     R1,[R1, #+10]
   \   0000027C   5F10CDE5           STRB     R1,[SP, #+95]
   \   00000280   20009DE5           LDR      R0,[SP, #+32]
   \   00000284   001092E5           LDR      R1,[R2, #+0]
   \   00000288   000050E3           CMP      R0,#+0
   \   0000028C   00009D15           LDRNE    R0,[SP, #+0]
   \   00000290   00909015           LDRNE    R9,[R0, #+0]
   \   00000294   091041E0           SUB      R1,R1,R9
   \   00000298   24108DE5           STR      R1,[SP, #+36]
   \   0000029C   00009DE5           LDR      R0,[SP, #+0]
   \   000002A0   BC00D0E1           LDRH     R0,[R0, #+12]
   \   000002A4   010010E3           TST      R0,#0x1
   \   000002A8   0110A013           MOVNE    R1,#+1
   \   000002AC   34108D15           STRNE    R1,[SP, #+52]
   \   000002B0   00009DE5           LDR      R0,[SP, #+0]
   \   000002B4   BC00D0E1           LDRH     R0,[R0, #+12]
   \   000002B8   020010E3           TST      R0,#0x2
   \   000002BC   2200000A           BEQ      ??RenderPage_8
   \   000002C0   0110A0E3           MOV      R1,#+1
   \   000002C4   44108DE5           STR      R1,[SP, #+68]
   \   000002C8   1F0000EA           B        ??RenderPage_8
   \                     ??RenderPage_9:
   \   000002CC   ........           BL       GetFontHeight
   \                     ??RenderPage_10:
   \   000002D0   50109DE5           LDR      R1,[SP, #+80]
   \   000002D4   000051E1           CMP      R1,R0
   \   000002D8   50008DB5           STRLT    R0,[SP, #+80]
   \                     ??RenderPage_11:
   \   000002DC   0700A0E3           MOV      R0,#+7
   \   000002E0   E00C80E3           ORR      R0,R0,#0xE000
   \   000002E4   00005AE1           CMP      R10,R0
   \   000002E8   0100C013           BICNE    R0,R0,#0x1
   \   000002EC   00005A11           CMPNE    R10,R0
   \   000002F0   1100001A           BNE      ??RenderPage_12
   \   000002F4   080094E5           LDR      R0,[R4, #+8]
   \   000002F8   40309DE5           LDR      R3,[SP, #+64]
   \   000002FC   012089E2           ADD      R2,R9,#+1
   \   00000300   003093E5           LDR      R3,[R3, #+0]
   \   00000304   829080E0           ADD      R9,R0,R2, LSL #+1
   \   00000308   B090D9E1           LDRH     R9,[R9, #+0]
   \   0000030C   011087E2           ADD      R1,R7,#+1
   \   00000310   817083E0           ADD      R7,R3,R1, LSL #+1
   \   00000314   B090C7E1           STRH     R9,[R7, #+0]
   \   00000318   24909DE5           LDR      R9,[SP, #+36]
   \   0000031C   017081E2           ADD      R7,R1,#+1
   \   00000320   029049E2           SUB      R9,R9,#+2
   \   00000324   24908DE5           STR      R9,[SP, #+36]
   \   00000328   019082E2           ADD      R9,R2,#+1
   \   0000032C   890080E0           ADD      R0,R0,R9, LSL #+1
   \   00000330   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000334   871083E0           ADD      R1,R3,R7, LSL #+1
   \   00000338   B000C1E1           STRH     R0,[R1, #+0]
   \                     ??RenderPage_12:
   \   0000033C   24109DE5           LDR      R1,[SP, #+36]
   \   00000340   019089E2           ADD      R9,R9,#+1
   \   00000344   011041E2           SUB      R1,R1,#+1
   \   00000348   24108DE5           STR      R1,[SP, #+36]
   \                     ??RenderPage_8:
   \   0000034C   24009DE5           LDR      R0,[SP, #+36]
   \   00000350   000050E3           CMP      R0,#+0
   \   00000354   CA00000A           BEQ      ??RenderPage_13
   \   00000358   FA0057E3           CMP      R7,#+250
   \   0000035C   C80000AA           BGE      ??RenderPage_13
   \   00000360   080094E5           LDR      R0,[R4, #+8]
   \   00000364   0510A0E3           MOV      R1,#+5
   \   00000368   890080E0           ADD      R0,R0,R9, LSL #+1
   \   0000036C   B0A0D0E1           LDRH     R10,[R0, #+0]
   \   00000370   E01C81E3           ORR      R1,R1,#0xE000
   \   00000374   01005AE1           CMP      R10,R1
   \   00000378   3200001A           BNE      ??RenderPage_14
   \   0000037C   0C009DE5           LDR      R0,[SP, #+12]
   \   00000380   48109DE5           LDR      R1,[SP, #+72]
   \   00000384   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000388   010050E1           CMP      R0,R1
   \   0000038C   020000AA           BGE      ??RenderPage_15
   \   00000390   000056E3           CMP      R6,#+0
   \   00000394   0500005A           BPL      ??RenderPage_16
   \   00000398   E7FFFFEA           B        ??RenderPage_12
   \                     ??RenderPage_15:
   \   0000039C   0C009DE5           LDR      R0,[SP, #+12]
   \   000003A0   BE00D0E1           LDRH     R0,[R0, #+14]
   \   000003A4   060080E0           ADD      R0,R0,R6
   \   000003A8   010050E0           SUBS     R0,R0,R1
   \   000003AC   E2FFFF4A           BMI      ??RenderPage_12
   \                     ??RenderPage_16:
   \   000003B0   0C009DE5           LDR      R0,[SP, #+12]
   \   000003B4   BE00D0E1           LDRH     R0,[R0, #+14]
   \   000003B8   010050E1           CMP      R0,R1
   \   000003BC   2C009DE5           LDR      R0,[SP, #+44]
   \   000003C0   050000AA           BGE      ??RenderPage_17
   \   000003C4   0C109DE5           LDR      R1,[SP, #+12]
   \   000003C8   BE10D1E1           LDRH     R1,[R1, #+14]
   \   000003CC   061081E0           ADD      R1,R1,R6
   \   000003D0   010050E1           CMP      R0,R1
   \   000003D4   030000AA           BGE      ??RenderPage_18
   \   000003D8   D7FFFFEA           B        ??RenderPage_12
   \                     ??RenderPage_17:
   \   000003DC   061081E0           ADD      R1,R1,R6
   \   000003E0   010050E1           CMP      R0,R1
   \   000003E4   D4FFFFBA           BLT      ??RenderPage_12
   \                     ??RenderPage_18:
   \   000003E8   280094E5           LDR      R0,[R4, #+40]
   \   000003EC   090050E1           CMP      R0,R9
   \   000003F0   0400001A           BNE      ??RenderPage_19
   \   000003F4   0110A0E3           MOV      R1,#+1
   \   000003F8   38108DE5           STR      R1,[SP, #+56]
   \   000003FC   0150A0E3           MOV      R5,#+1
   \   00000400   B480CDE1           STRH     R8,[SP, #+4]
   \   00000404   CCFFFFEA           B        ??RenderPage_12
   \                     ??RenderPage_19:
   \   00000408   2C0094E5           LDR      R0,[R4, #+44]
   \   0000040C   010070E3           CMN      R0,#+1
   \   00000410   2C908405           STREQ    R9,[R4, #+44]
   \   00000414   38009DE5           LDR      R0,[SP, #+56]
   \   00000418   000050E3           CMP      R0,#+0
   \   0000041C   34908405           STREQ    R9,[R4, #+52]
   \   00000420   0300000A           BEQ      ??RenderPage_20
   \   00000424   010050E3           CMP      R0,#+1
   \   00000428   38908405           STREQ    R9,[R4, #+56]
   \   0000042C   0210A003           MOVEQ    R1,#+2
   \   00000430   38108D05           STREQ    R1,[SP, #+56]
   \                     ??RenderPage_20:
   \   00000434   309084E5           STR      R9,[R4, #+48]
   \   00000438   000055E3           CMP      R5,#+0
   \   0000043C   BEFFFF0A           BEQ      ??RenderPage_12
   \   00000440   015085E2           ADD      R5,R5,#+1
   \   00000444   BCFFFFEA           B        ??RenderPage_12
   \                     ??RenderPage_14:
   \   00000448   0110C1E3           BIC      R1,R1,#0x1
   \   0000044C   01005AE1           CMP      R10,R1
   \   00000450   0800001A           BNE      ??RenderPage_21
   \   00000454   010055E3           CMP      R5,#+1
   \   00000458   0300000A           BEQ      ??RenderPage_22
   \   0000045C   000055E3           CMP      R5,#+0
   \   00000460   B5FFFF0A           BEQ      ??RenderPage_12
   \   00000464   015045E2           SUB      R5,R5,#+1
   \   00000468   B3FFFFEA           B        ??RenderPage_12
   \                     ??RenderPage_22:
   \   0000046C   B880CDE1           STRH     R8,[SP, #+8]
   \   00000470   0050A0E3           MOV      R5,#+0
   \   00000474   B0FFFFEA           B        ??RenderPage_12
   \                     ??RenderPage_21:
   \   00000478   031081E3           ORR      R1,R1,#0x3
   \   0000047C   01005AE1           CMP      R10,R1
   \   00000480   2A00001A           BNE      ??RenderPage_23
   \   00000484   18109DE5           LDR      R1,[SP, #+24]
   \   00000488   200051E3           CMP      R1,#+32
   \   0000048C   310000AA           BGE      ??RenderPage_24
   \   00000490   0C20A0E3           MOV      R2,#+12
   \   00000494   5C308DE2           ADD      R3,SP,#+92
   \   00000498   92312BE0           MLA      R11,R2,R1,R3
   \   0000049C   0C204BE2           SUB      R2,R11,#+12
   \   000004A0   3C208DE5           STR      R2,[SP, #+60]
   \   000004A4   B200D0E1           LDRH     R0,[R0, #+2]
   \   000004A8   0420A0E3           MOV      R2,#+4
   \   000004AC   2004A0E1           LSR      R0,R0,#+8
   \   000004B0   0000CBE5           STRB     R0,[R11, #+0]
   \   000004B4   080094E5           LDR      R0,[R4, #+8]
   \   000004B8   890080E0           ADD      R0,R0,R9, LSL #+1
   \   000004BC   B200D0E1           LDRH     R0,[R0, #+2]
   \   000004C0   0100CBE5           STRB     R0,[R11, #+1]
   \   000004C4   080094E5           LDR      R0,[R4, #+8]
   \   000004C8   890080E0           ADD      R0,R0,R9, LSL #+1
   \   000004CC   B400D0E1           LDRH     R0,[R0, #+4]
   \   000004D0   2004A0E1           LSR      R0,R0,#+8
   \   000004D4   0200CBE5           STRB     R0,[R11, #+2]
   \   000004D8   080094E5           LDR      R0,[R4, #+8]
   \   000004DC   890080E0           ADD      R0,R0,R9, LSL #+1
   \   000004E0   B400D0E1           LDRH     R0,[R0, #+4]
   \   000004E4   0300CBE5           STRB     R0,[R11, #+3]
   \   000004E8   3C109DE5           LDR      R1,[SP, #+60]
   \   000004EC   0B00A0E1           MOV      R0,R11
   \   000004F0   1C0100EF           SWI      +284
   \   000004F4   000050E3           CMP      R0,#+0
   \   000004F8   1600000A           BEQ      ??RenderPage_24
   \   000004FC   3C109DE5           LDR      R1,[SP, #+60]
   \   00000500   000058E3           CMP      R8,#+0
   \   00000504   01008812           ADDNE    R0,R8,#+1
   \   00000508   0200A003           MOVEQ    R0,#+2
   \   0000050C   080081E5           STR      R0,[R1, #+8]
   \   00000510   020088E2           ADD      R0,R8,#+2
   \   00000514   04008BE5           STR      R0,[R11, #+4]
   \   00000518   1C009DE5           LDR      R0,[SP, #+28]
   \   0000051C   08008BE5           STR      R0,[R11, #+8]
   \   00000520   18109DE5           LDR      R1,[SP, #+24]
   \   00000524   011081E2           ADD      R1,R1,#+1
   \   00000528   18108DE5           STR      R1,[SP, #+24]
   \   0000052C   090000EA           B        ??RenderPage_24
   \                     ??RenderPage_23:
   \   00000530   150081E2           ADD      R0,R1,#+21
   \   00000534   00005AE1           CMP      R10,R0
   \   00000538   01008013           ORRNE    R0,R0,#0x1
   \   0000053C   00005A11           CMPNE    R10,R0
   \   00000540   01008012           ADDNE    R0,R0,#+1
   \   00000544   00005A11           CMPNE    R10,R0
   \   00000548   01008013           ORRNE    R0,R0,#0x1
   \   0000054C   00005A11           CMPNE    R10,R0
   \   00000550   0A005A13           CMPNE    R10,#+10
   \   00000554   78FFFF0A           BEQ      ??RenderPage_12
   \                     ??RenderPage_24:
   \   00000558   FF0C0AE2           AND      R0,R10,#0xFF00
   \   0000055C   E10C50E3           CMP      R0,#+57600
   \   00000560   1500001A           BNE      ??RenderPage_25
   \   00000564   011049E2           SUB      R1,R9,#+1
   \   00000568   0400A0E1           MOV      R0,R4
   \   0000056C   ........           BL       FindReferenceByBegin
   \   00000570   000050E3           CMP      R0,#+0
   \   00000574   1000000A           BEQ      ??RenderPage_25
   \   00000578   F81094E5           LDR      R1,[R4, #+248]
   \   0000057C   01005AE1           CMP      R10,R1
   \   00000580   FC109415           LDRNE    R1,[R4, #+252]
   \   00000584   01005A11           CMPNE    R10,R1
   \   00000588   08109015           LDRNE    R1,[R0, #+8]
   \   0000058C   75005113           CMPNE    R1,#+117
   \   00000590   0900001A           BNE      ??RenderPage_25
   \   00000594   4C109DE5           LDR      R1,[SP, #+76]
   \   00000598   0C20A0E3           MOV      R2,#+12
   \   0000059C   773F8DE2           ADD      R3,SP,#+476
   \   000005A0   923121E0           MLA      R1,R2,R1,R3
   \   000005A4   000081E5           STR      R0,[R1, #+0]
   \   000005A8   048081E5           STR      R8,[R1, #+4]
   \   000005AC   08A081E5           STR      R10,[R1, #+8]
   \   000005B0   4C109DE5           LDR      R1,[SP, #+76]
   \   000005B4   011081E2           ADD      R1,R1,#+1
   \   000005B8   4C108DE5           STR      R1,[SP, #+76]
   \                     ??RenderPage_25:
   \   000005BC   0100A0E3           MOV      R0,#+1
   \   000005C0   E00C80E3           ORR      R0,R0,#0xE000
   \   000005C4   00005AE1           CMP      R10,R0
   \   000005C8   0200001A           BNE      ??RenderPage_26
   \   000005CC   0110A0E3           MOV      R1,#+1
   \                     ??RenderPage_27:
   \   000005D0   44108DE5           STR      R1,[SP, #+68]
   \   000005D4   0C0000EA           B        ??RenderPage_28
   \                     ??RenderPage_26:
   \   000005D8   010080E2           ADD      R0,R0,#+1
   \   000005DC   00005AE1           CMP      R10,R0
   \   000005E0   0010A003           MOVEQ    R1,#+0
   \   000005E4   F9FFFF0A           BEQ      ??RenderPage_27
   \   000005E8   110080E3           ORR      R0,R0,#0x11
   \   000005EC   00005AE1           CMP      R10,R0
   \   000005F0   0110A003           MOVEQ    R1,#+1
   \   000005F4   0300000A           BEQ      ??RenderPage_29
   \   000005F8   0100C0E3           BIC      R0,R0,#0x1
   \   000005FC   00005AE1           CMP      R10,R0
   \   00000600   0100001A           BNE      ??RenderPage_28
   \   00000604   0010A0E3           MOV      R1,#+0
   \                     ??RenderPage_29:
   \   00000608   34108DE5           STR      R1,[SP, #+52]
   \                     ??RenderPage_28:
   \   0000060C   40009DE5           LDR      R0,[SP, #+64]
   \   00000610   017087E2           ADD      R7,R7,#+1
   \   00000614   000090E5           LDR      R0,[R0, #+0]
   \   00000618   870080E0           ADD      R0,R0,R7, LSL #+1
   \   0000061C   B0A0C0E1           STRH     R10,[R0, #+0]
   \   00000620   34009DE5           LDR      R0,[SP, #+52]
   \   00000624   000050E3           CMP      R0,#+0
   \   00000628   0910A013           MOVNE    R1,#+9
   \   0000062C   0810A003           MOVEQ    R1,#+8
   \   00000630   0A00A0E1           MOV      R0,R10
   \   00000634   E10100EF           SWI      +481
   \   00000638   088080E0           ADD      R8,R0,R8
   \   0000063C   000055E3           CMP      R5,#+0
   \   00000640   25FFFF0A           BEQ      ??RenderPage_11
   \   00000644   FF0C0AE2           AND      R0,R10,#0xFF00
   \   00000648   E10C50E3           CMP      R0,#+57600
   \   0000064C   0300001A           BNE      ??RenderPage_30
   \   00000650   0A00A0E1           MOV      R0,R10
   \   00000654   E40100EF           SWI      +484
   \   00000658   210000EF           SWI      +33
   \   0000065C   1BFFFFEA           B        ??RenderPage_10
   \                     ??RenderPage_30:
   \   00000660   44009DE5           LDR      R0,[SP, #+68]
   \   00000664   000050E3           CMP      R0,#+0
   \   00000668   34009DE5           LDR      R0,[SP, #+52]
   \   0000066C   0810A013           MOVNE    R1,#+8
   \   00000670   0010A003           MOVEQ    R1,#+0
   \   00000674   000050E3           CMP      R0,#+0
   \   00000678   0800A003           MOVEQ    R0,#+8
   \   0000067C   0900A013           MOVNE    R0,#+9
   \   00000680   11FFFFEA           B        ??RenderPage_9
   \                     ??RenderPage_13:
   \   00000684   40009DE5           LDR      R0,[SP, #+64]
   \   00000688   000090E5           LDR      R0,[R0, #+0]
   \   0000068C   B070C0E1           STRH     R7,[R0, #+0]
   \   00000690   0C009DE5           LDR      R0,[SP, #+12]
   \   00000694   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000698   007086E0           ADD      R7,R6,R0
   \   0000069C   5C049DE5           LDR      R0,[SP, #+1116]
   \   000006A0   000050E3           CMP      R0,#+0
   \   000006A4   B3FEFF0A           BEQ      ??RenderPage_4
   \   000006A8   060057E1           CMP      R7,R6
   \   000006AC   9200000A           BEQ      ??RenderPage_31
   \   000006B0   00009DE5           LDR      R0,[SP, #+0]
   \   000006B4   02A0A0E3           MOV      R10,#+2
   \   000006B8   BC01D0E1           LDRH     R0,[R0, #+28]
   \   000006BC   100010E3           TST      R0,#0x10
   \   000006C0   1C009D15           LDRNE    R0,[SP, #+28]
   \   000006C4   08A04010           SUBNE    R10,R0,R8
   \   000006C8   00009DE5           LDR      R0,[SP, #+0]
   \   000006CC   BC01D0E1           LDRH     R0,[R0, #+28]
   \   000006D0   080010E3           TST      R0,#0x8
   \   000006D4   0300001A           BNE      ??RenderPage_32
   \   000006D8   0C009DE5           LDR      R0,[SP, #+12]
   \   000006DC   BC00D0E1           LDRH     R0,[R0, #+12]
   \   000006E0   200010E3           TST      R0,#0x20
   \   000006E4   0300000A           BEQ      ??RenderPage_33
   \                     ??RenderPage_32:
   \   000006E8   888100EF           SWI      +33160
   \   000006EC   080040E0           SUB      R0,R0,R8
   \   000006F0   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   000006F4   C0A0A0E1           ASR      R10,R0,#+1
   \                     ??RenderPage_33:
   \   000006F8   00109DE5           LDR      R1,[SP, #+0]
   \   000006FC   00B0A0E3           MOV      R11,#+0
   \   00000700   B410D1E1           LDRH     R1,[R1, #+4]
   \   00000704   2114A0E1           LSR      R1,R1,#+8
   \   00000708   2810CDE5           STRB     R1,[SP, #+40]
   \   0000070C   00109DE5           LDR      R1,[SP, #+0]
   \   00000710   B410D1E1           LDRH     R1,[R1, #+4]
   \   00000714   2910CDE5           STRB     R1,[SP, #+41]
   \   00000718   00109DE5           LDR      R1,[SP, #+0]
   \   0000071C   B610D1E1           LDRH     R1,[R1, #+6]
   \   00000720   2114A0E1           LSR      R1,R1,#+8
   \   00000724   2A10CDE5           STRB     R1,[SP, #+42]
   \   00000728   00109DE5           LDR      R1,[SP, #+0]
   \   0000072C   B610D1E1           LDRH     R1,[R1, #+6]
   \   00000730   2B10CDE5           STRB     R1,[SP, #+43]
   \   00000734   18009DE5           LDR      R0,[SP, #+24]
   \   00000738   000050E3           CMP      R0,#+0
   \   0000073C   1100000A           BEQ      ??RenderPage_34
   \                     ??RenderPage_35:
   \   00000740   0C10A0E3           MOV      R1,#+12
   \   00000744   5C008DE2           ADD      R0,SP,#+92
   \   00000748   910B20E0           MLA      R0,R1,R11,R0
   \   0000074C   0730A0E1           MOV      R3,R7
   \   00000750   0010A0E1           MOV      R1,R0
   \   00000754   02002DE9           PUSH     {R1}
   \   00000758   02002DE9           PUSH     {R1}
   \   0000075C   01B08BE2           ADD      R11,R11,#+1
   \   00000760   0210A0E3           MOV      R1,#+2
   \   00000764   02002DE9           PUSH     {R1}
   \   00000768   082090E5           LDR      R2,[R0, #+8]
   \   0000076C   040090E5           LDR      R0,[R0, #+4]
   \   00000770   0610A0E1           MOV      R1,R6
   \   00000774   B40100EF           SWI      +436
   \   00000778   24009DE5           LDR      R0,[SP, #+36]
   \   0000077C   0CD08DE2           ADD      SP,SP,#+12
   \   00000780   00005BE1           CMP      R11,R0
   \   00000784   EDFFFF1A           BNE      ??RenderPage_35
   \                     ??RenderPage_34:
   \   00000788   000055E3           CMP      R5,#+0
   \   0000078C   B880CD11           STRHNE   R8,[SP, #+8]
   \   00000790   F800DDE1           LDRSH    R0,[SP, #+8]
   \   00000794   F410DDE1           LDRSH    R1,[SP, #+4]
   \   00000798   000051E3           CMP      R1,#+0
   \   0000079C   00005003           CMPEQ    R0,#+0
   \   000007A0   00005111           CMPNE    R1,R0
   \   000007A4   2300000A           BEQ      ??RenderPage_36
   \   000007A8   50209DE5           LDR      R2,[SP, #+80]
   \   000007AC   00008AE0           ADD      R0,R10,R0
   \   000007B0   021047E0           SUB      R1,R7,R2
   \   000007B4   B610CDE1           STRH     R1,[SP, #+6]
   \   000007B8   BA70CDE1           STRH     R7,[SP, #+10]
   \   000007BC   F430DDE1           LDRSH    R3,[SP, #+4]
   \   000007C0   011041E2           SUB      R1,R1,#+1
   \   000007C4   03308AE0           ADD      R3,R10,R3
   \   000007C8   B430CDE1           STRH     R3,[SP, #+4]
   \   000007CC   B800CDE1           STRH     R0,[SP, #+8]
   \   000007D0   F430DDE1           LDRSH    R3,[SP, #+4]
   \   000007D4   010080E2           ADD      R0,R0,#+1
   \   000007D8   023043E2           SUB      R3,R3,#+2
   \   000007DC   B430CDE1           STRH     R3,[SP, #+4]
   \   000007E0   B800CDE1           STRH     R0,[SP, #+8]
   \   000007E4   B610CDE1           STRH     R1,[SP, #+6]
   \   000007E8   F410DDE1           LDRSH    R1,[SP, #+4]
   \   000007EC   0008A0E1           MOV      R0,R0, LSL #+16
   \   000007F0   D73F8DE2           ADD      R3,SP,#+860
   \   000007F4   000051E3           CMP      R1,#+0
   \   000007F8   0020A043           MOVMI    R2,#+0
   \   000007FC   B420CD41           STRHMI   R2,[SP, #+4]
   \   00000800   1C109DE5           LDR      R1,[SP, #+28]
   \   00000804   0820A0E3           MOV      R2,#+8
   \   00000808   011081E2           ADD      R1,R1,#+1
   \   0000080C   400851E1           CMP      R1,R0, ASR #+16
   \   00000810   1C109DB5           LDRLT    R1,[SP, #+28]
   \   00000814   011081B2           ADDLT    R1,R1,#+1
   \   00000818   B810CDB1           STRHLT   R1,[SP, #+8]
   \   0000081C   14009DE5           LDR      R0,[SP, #+20]
   \   00000820   04108DE2           ADD      R1,SP,#+4
   \   00000824   800183E0           ADD      R0,R3,R0, LSL #+3
   \   00000828   1E0100EF           SWI      +286
   \   0000082C   14109DE5           LDR      R1,[SP, #+20]
   \   00000830   011081E2           ADD      R1,R1,#+1
   \   00000834   14108DE5           STR      R1,[SP, #+20]
   \                     ??RenderPage_36:
   \   00000838   1700A0E3           MOV      R0,#+23
   \   0000083C   2E0100EF           SWI      +302
   \   00000840   00109DE5           LDR      R1,[SP, #+0]
   \   00000844   00209DE5           LDR      R2,[SP, #+0]
   \   00000848   BC10D1E1           LDRH     R1,[R1, #+12]
   \   0000084C   BC20D2E1           LDRH     R2,[R2, #+12]
   \   00000850   01002DE9           PUSH     {R0}
   \   00000854   020011E3           TST      R1,#0x2
   \   00000858   0810A013           MOVNE    R1,#+8
   \   0000085C   0010A003           MOVEQ    R1,#+0
   \   00000860   2C008DE2           ADD      R0,SP,#+44
   \   00000864   01002DE9           PUSH     {R0}
   \   00000868   010012E3           TST      R2,#0x1
   \   0000086C   0920A013           MOVNE    R2,#+9
   \   00000870   0820A003           MOVEQ    R2,#+8
   \   00000874   800081E2           ADD      R0,R1,#+128
   \   00000878   01002DE9           PUSH     {R0}
   \   0000087C   04002DE9           PUSH     {R2}
   \   00000880   0A10A0E1           MOV      R1,R10
   \   00000884   0700A0E1           MOV      R0,R7
   \   00000888   01002DE9           PUSH     {R0}
   \   0000088C   30309DE5           LDR      R3,[SP, #+48]
   \   00000890   54009DE5           LDR      R0,[SP, #+84]
   \   00000894   0620A0E1           MOV      R2,R6
   \   00000898   4C0100EF           SWI      +332
   \   0000089C   F0019DE5           LDR      R0,[SP, #+496]
   \   000008A0   0080A0E3           MOV      R8,#+0
   \   000008A4   000050E3           CMP      R0,#+0
   \   000008A8   14D08DE2           ADD      SP,SP,#+20
   \   000008AC   0C00001A           BNE      ??RenderPage_37
   \   000008B0   110000EA           B        ??RenderPage_31
   \                     ??RenderPage_38:
   \   000008B4   081090E5           LDR      R1,[R0, #+8]
   \   000008B8   0630A0E1           MOV      R3,R6
   \   000008BC   02002DE9           PUSH     {R1}
   \   000008C0   018088E2           ADD      R8,R8,#+1
   \   000008C4   0710A0E1           MOV      R1,R7
   \   000008C8   02002DE9           PUSH     {R1}
   \   000008CC   041090E5           LDR      R1,[R0, #+4]
   \   000008D0   01208AE0           ADD      R2,R10,R1
   \   000008D4   001090E5           LDR      R1,[R0, #+0]
   \   000008D8   0400A0E1           MOV      R0,R4
   \   000008DC   ........           BL       renderForm
   \   000008E0   08D08DE2           ADD      SP,SP,#+8
   \                     ??RenderPage_37:
   \   000008E4   0C10A0E3           MOV      R1,#+12
   \   000008E8   770F8DE2           ADD      R0,SP,#+476
   \   000008EC   910820E0           MLA      R0,R1,R8,R0
   \   000008F0   001090E5           LDR      R1,[R0, #+0]
   \   000008F4   000051E3           CMP      R1,#+0
   \   000008F8   EDFFFF1A           BNE      ??RenderPage_38
   \                     ??RenderPage_31:
   \   000008FC   2C009DE5           LDR      R0,[SP, #+44]
   \   00000900   000057E1           CMP      R7,R0
   \   00000904   0200002A           BCS      ??RenderPage_39
   \   00000908   10009DE5           LDR      R0,[SP, #+16]
   \   0000090C   000050E3           CMP      R0,#+0
   \   00000910   18FEFF0A           BEQ      ??RenderPage_4
   \                     ??RenderPage_39:
   \   00000914   14009DE5           LDR      R0,[SP, #+20]
   \   00000918   000050E3           CMP      R0,#+0
   \   0000091C   1900000A           BEQ      ??RenderPage_40
   \   00000920   0D00A0E1           MOV      R0,SP
   \   00000924   01002DE9           PUSH     {R0}
   \   00000928   6430A0E3           MOV      R3,#+100
   \   0000092C   AA20A0E3           MOV      R2,#+170
   \   00000930   0010A0E3           MOV      R1,#+0
   \   00000934   0000A0E3           MOV      R0,#+0
   \   00000938   310100EF           SWI      +305
   \   0000093C   281094E5           LDR      R1,[R4, #+40]
   \   00000940   0400A0E1           MOV      R0,R4
   \   00000944   ........           BL       FindReferenceByBegin
   \   00000948   080090E5           LDR      R0,[R0, #+8]
   \   0000094C   04D08DE2           ADD      SP,SP,#+4
   \   00000950   5A0050E3           CMP      R0,#+90
   \   00000954   0700001A           BNE      ??RenderPage_41
   \   00000958   0D00A0E1           MOV      R0,SP
   \   0000095C   01002DE9           PUSH     {R0}
   \   00000960   6430A0E3           MOV      R3,#+100
   \   00000964   0020A0E3           MOV      R2,#+0
   \   00000968   0010A0E3           MOV      R1,#+0
   \   0000096C   BE00A0E3           MOV      R0,#+190
   \   00000970   310100EF           SWI      +305
   \   00000974   04D08DE2           ADD      SP,SP,#+4
   \                     ??RenderPage_41:
   \   00000978   14009DE5           LDR      R0,[SP, #+20]
   \   0000097C   00B0A0E3           MOV      R11,#+0
   \   00000980   010050E3           CMP      R0,#+1
   \   00000984   1F0000AA           BGE      ??RenderPage_42
   \                     ??RenderPage_40:
   \   00000988   58009DE5           LDR      R0,[SP, #+88]
   \   0000098C   000050E3           CMP      R0,#+0
   \   00000990   C3FDFF0A           BEQ      ??RenderPage_1
   \   00000994   54109DE5           LDR      R1,[SP, #+84]
   \   00000998   000081E0           ADD      R0,R1,R0
   \   0000099C   101094E5           LDR      R1,[R4, #+16]
   \   000009A0   000291E7           LDR      R0,[R1, +R0, LSL #+4]
   \   000009A4   BEFDFFEA           B        ??RenderPage_1
   \                     ??RenderPage_43:
   \   000009A8   0D00A0E1           MOV      R0,SP
   \   000009AC   01002DE9           PUSH     {R0}
   \   000009B0   0000A0E3           MOV      R0,#+0
   \   000009B4   01002DE9           PUSH     {R0}
   \   000009B8   F030D8E1           LDRSH    R3,[R8, #+0]
   \   000009BC   F220D8E1           LDRSH    R2,[R8, #+2]
   \   000009C0   F000D6E1           LDRSH    R0,[R6, #+0]
   \   000009C4   0310A0E1           MOV      R1,R3
   \   000009C8   B30100EF           SWI      +435
   \   000009CC   08008DE2           ADD      R0,SP,#+8
   \   000009D0   01002DE9           PUSH     {R0}
   \   000009D4   0000A0E3           MOV      R0,#+0
   \   000009D8   01002DE9           PUSH     {R0}
   \   000009DC   F000D8E1           LDRSH    R0,[R8, #+0]
   \   000009E0   013040E2           SUB      R3,R0,#+1
   \   000009E4   F200D8E1           LDRSH    R0,[R8, #+2]
   \   000009E8   012040E2           SUB      R2,R0,#+1
   \   000009EC   F000D8E1           LDRSH    R0,[R8, #+0]
   \   000009F0   011040E2           SUB      R1,R0,#+1
   \   000009F4   F000D6E1           LDRSH    R0,[R6, #+0]
   \   000009F8   010080E2           ADD      R0,R0,#+1
   \   000009FC   B30100EF           SWI      +435
   \   00000A00   10D08DE2           ADD      SP,SP,#+16
   \                     ??RenderPage_44:
   \   00000A04   0AB0A0E1           MOV      R11,R10
   \                     ??RenderPage_42:
   \   00000A08   14009DE5           LDR      R0,[SP, #+20]
   \   00000A0C   00005BE1           CMP      R11,R0
   \   00000A10   DCFFFFAA           BGE      ??RenderPage_40
   \   00000A14   D70F8DE2           ADD      R0,SP,#+860
   \   00000A18   8B6180E0           ADD      R6,R0,R11, LSL #+3
   \   00000A1C   0D00A0E1           MOV      R0,SP
   \   00000A20   01002DE9           PUSH     {R0}
   \   00000A24   028086E2           ADD      R8,R6,#+2
   \   00000A28   01A08BE2           ADD      R10,R11,#+1
   \   00000A2C   0000A0E3           MOV      R0,#+0
   \   00000A30   01002DE9           PUSH     {R0}
   \   00000A34   F220D8E1           LDRSH    R2,[R8, #+2]
   \   00000A38   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000A3C   F010D8E1           LDRSH    R1,[R8, #+0]
   \   00000A40   0200A0E1           MOV      R0,R2
   \   00000A44   B30100EF           SWI      +435
   \   00000A48   08008DE2           ADD      R0,SP,#+8
   \   00000A4C   01002DE9           PUSH     {R0}
   \   00000A50   0000A0E3           MOV      R0,#+0
   \   00000A54   01002DE9           PUSH     {R0}
   \   00000A58   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000A5C   F010D8E1           LDRSH    R1,[R8, #+0]
   \   00000A60   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000A64   012040E2           SUB      R2,R0,#+1
   \   00000A68   010040E2           SUB      R0,R0,#+1
   \   00000A6C   B30100EF           SWI      +435
   \   00000A70   24009DE5           LDR      R0,[SP, #+36]
   \   00000A74   10D08DE2           ADD      SP,SP,#+16
   \   00000A78   00005AE1           CMP      R10,R0
   \   00000A7C   260000AA           BGE      ??RenderPage_45
   \   00000A80   F000D6E1           LDRSH    R0,[R6, #+0]
   \   00000A84   FA10D8E1           LDRSH    R1,[R8, #+10]
   \   00000A88   010050E1           CMP      R0,R1
   \   00000A8C   220000AA           BGE      ??RenderPage_45
   \   00000A90   0D00A0E1           MOV      R0,SP
   \   00000A94   01002DE9           PUSH     {R0}
   \   00000A98   0000A0E3           MOV      R0,#+0
   \   00000A9C   01002DE9           PUSH     {R0}
   \   00000AA0   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000AA4   FA20D8E1           LDRSH    R2,[R8, #+10]
   \   00000AA8   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000AAC   0310A0E1           MOV      R1,R3
   \   00000AB0   B30100EF           SWI      +435
   \   00000AB4   FA00D8E1           LDRSH    R0,[R8, #+10]
   \   00000AB8   F210D8E1           LDRSH    R1,[R8, #+2]
   \   00000ABC   08D08DE2           ADD      SP,SP,#+8
   \   00000AC0   010050E1           CMP      R0,R1
   \   00000AC4   0D00A0E1           MOV      R0,SP
   \   00000AC8   01002DE9           PUSH     {R0}
   \   00000ACC   0000A0E3           MOV      R0,#+0
   \   00000AD0   01002DE9           PUSH     {R0}
   \   00000AD4   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000AD8   013080E2           ADD      R3,R0,#+1
   \   00000ADC   FA00D8E1           LDRSH    R0,[R8, #+10]
   \   00000AE0   070000AA           BGE      ??RenderPage_46
   \   00000AE4   012080E2           ADD      R2,R0,#+1
   \   00000AE8   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000AEC   011080E2           ADD      R1,R0,#+1
   \   00000AF0   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000AF4   010040E2           SUB      R0,R0,#+1
   \                     ??RenderPage_47:
   \   00000AF8   B30100EF           SWI      +435
   \   00000AFC   08D08DE2           ADD      SP,SP,#+8
   \   00000B00   1C0000EA           B        ??RenderPage_48
   \                     ??RenderPage_46:
   \   00000B04   012040E2           SUB      R2,R0,#+1
   \   00000B08   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000B0C   011080E2           ADD      R1,R0,#+1
   \   00000B10   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000B14   010080E2           ADD      R0,R0,#+1
   \   00000B18   F6FFFFEA           B        ??RenderPage_47
   \                     ??RenderPage_45:
   \   00000B1C   0D00A0E1           MOV      R0,SP
   \   00000B20   01002DE9           PUSH     {R0}
   \   00000B24   0000A0E3           MOV      R0,#+0
   \   00000B28   01002DE9           PUSH     {R0}
   \   00000B2C   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000B30   F020D6E1           LDRSH    R2,[R6, #+0]
   \   00000B34   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000B38   0310A0E1           MOV      R1,R3
   \   00000B3C   B30100EF           SWI      +435
   \   00000B40   08008DE2           ADD      R0,SP,#+8
   \   00000B44   01002DE9           PUSH     {R0}
   \   00000B48   0000A0E3           MOV      R0,#+0
   \   00000B4C   01002DE9           PUSH     {R0}
   \   00000B50   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000B54   013080E2           ADD      R3,R0,#+1
   \   00000B58   F000D6E1           LDRSH    R0,[R6, #+0]
   \   00000B5C   012080E2           ADD      R2,R0,#+1
   \   00000B60   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000B64   011080E2           ADD      R1,R0,#+1
   \   00000B68   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000B6C   010040E2           SUB      R0,R0,#+1
   \   00000B70   B30100EF           SWI      +435
   \   00000B74   10D08DE2           ADD      SP,SP,#+16
   \                     ??RenderPage_48:
   \   00000B78   0D00A0E1           MOV      R0,SP
   \   00000B7C   01002DE9           PUSH     {R0}
   \   00000B80   0000A0E3           MOV      R0,#+0
   \   00000B84   01002DE9           PUSH     {R0}
   \   00000B88   F020D6E1           LDRSH    R2,[R6, #+0]
   \   00000B8C   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000B90   F410D8E1           LDRSH    R1,[R8, #+4]
   \   00000B94   0200A0E1           MOV      R0,R2
   \   00000B98   B30100EF           SWI      +435
   \   00000B9C   08008DE2           ADD      R0,SP,#+8
   \   00000BA0   01002DE9           PUSH     {R0}
   \   00000BA4   0000A0E3           MOV      R0,#+0
   \   00000BA8   01002DE9           PUSH     {R0}
   \   00000BAC   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000BB0   F410D8E1           LDRSH    R1,[R8, #+4]
   \   00000BB4   F000D6E1           LDRSH    R0,[R6, #+0]
   \   00000BB8   012080E2           ADD      R2,R0,#+1
   \   00000BBC   010080E2           ADD      R0,R0,#+1
   \   00000BC0   B30100EF           SWI      +435
   \   00000BC4   01005BE3           CMP      R11,#+1
   \   00000BC8   10D08DE2           ADD      SP,SP,#+16
   \   00000BCC   75FFFFBA           BLT      ??RenderPage_43
   \   00000BD0   F210D8E1           LDRSH    R1,[R8, #+2]
   \   00000BD4   07B0E0E3           MVN      R11,#+7
   \   00000BD8   F6009BE1           LDRSH    R0,[R11, +R6]
   \   00000BDC   010050E1           CMP      R0,R1
   \   00000BE0   70FFFFAA           BGE      ??RenderPage_43
   \   00000BE4   0D00A0E1           MOV      R0,SP
   \   00000BE8   01002DE9           PUSH     {R0}
   \   00000BEC   0000A0E3           MOV      R0,#+0
   \   00000BF0   01002DE9           PUSH     {R0}
   \   00000BF4   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000BF8   F6209BE1           LDRSH    R2,[R11, +R6]
   \   00000BFC   F000D6E1           LDRSH    R0,[R6, #+0]
   \   00000C00   0310A0E1           MOV      R1,R3
   \   00000C04   B30100EF           SWI      +435
   \   00000C08   F000D6E1           LDRSH    R0,[R6, #+0]
   \   00000C0C   F6109BE1           LDRSH    R1,[R11, +R6]
   \   00000C10   08D08DE2           ADD      SP,SP,#+8
   \   00000C14   010050E1           CMP      R0,R1
   \   00000C18   0D00A0E1           MOV      R0,SP
   \   00000C1C   01002DE9           PUSH     {R0}
   \   00000C20   0000A0E3           MOV      R0,#+0
   \   00000C24   01002DE9           PUSH     {R0}
   \   00000C28   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000C2C   013040E2           SUB      R3,R0,#+1
   \   00000C30   F6009BE1           LDRSH    R0,[R11, +R6]
   \   00000C34   070000AA           BGE      ??RenderPage_49
   \   00000C38   012040E2           SUB      R2,R0,#+1
   \   00000C3C   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000C40   011040E2           SUB      R1,R0,#+1
   \   00000C44   F000D6E1           LDRSH    R0,[R6, #+0]
   \   00000C48   010080E2           ADD      R0,R0,#+1
   \                     ??RenderPage_50:
   \   00000C4C   B30100EF           SWI      +435
   \   00000C50   08D08DE2           ADD      SP,SP,#+8
   \   00000C54   6AFFFFEA           B        ??RenderPage_44
   \                     ??RenderPage_49:
   \   00000C58   012080E2           ADD      R2,R0,#+1
   \   00000C5C   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000C60   011040E2           SUB      R1,R0,#+1
   \   00000C64   F000D6E1           LDRSH    R0,[R6, #+0]
   \   00000C68   010040E2           SUB      R0,R0,#+1
   \   00000C6C   F6FFFFEA           B        ??RenderPage_50
    726              }
    727              else
    728              {
    729                break;
    730              }
    731            }
    732            
    733           
    734          
    735            if (flag==0) vd->pos_cur_ref=0xFFFFFFFF;
   \                     ??RenderPage_5:
   \   00000C70   38009DE5           LDR      R0,[SP, #+56]
   \   00000C74   000050E3           CMP      R0,#+0
   \   00000C78   0000E003           MVNEQ    R0,#+0
   \   00000C7C   28008405           STREQ    R0,[R4, #+40]
    736            vd->view_line=store_line;
   \   00000C80   58009DE5           LDR      R0,[SP, #+88]
   \   00000C84   1C0084E5           STR      R0,[R4, #+28]
    737            
    738          //  WSHDR *ws2;
    739          //  ws2=AllocWS(128);
    740          //  wsprintf(ws2,"lcheck:%i",lcheck);
    741          //  DrawString(ws2,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    742          //  FreeWS(ws2);
    743            
    744            if (lcheck==2)
   \   00000C88   10009DE5           LDR      R0,[SP, #+16]
    745              return 0;
    746            else
    747              return 1;
   \   00000C8C   46DE8DE2           ADD      SP,SP,#+1120
   \   00000C90   020050E3           CMP      R0,#+2
   \   00000C94   0000A003           MOVEQ    R0,#+0
   \   00000C98   0100A013           MOVNE    R0,#+1
   \   00000C9C   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??RenderPage_2:
   \   00000CA0   D34D6210           DC32     0x10624dd3
    748          }
    749          

   \                                 In segment CODE, align 4, keep-with-next
    750          REFCACHE *FindReferenceByBegin(VIEWDATA *vd, unsigned int pos)
    751          {
    752            int i=vd->ref_cache_size;
   \                     FindReferenceByBegin:
   \   00000000   D02090E5           LDR      R2,[R0, #+208]
    753            REFCACHE *rf;
    754            if (!i) return NULL;
   \   00000004   000052E3           CMP      R2,#+0
   \   00000008   0100001A           BNE      ??FindReferenceByBegin_0
   \                     ??FindReferenceByBegin_1:
   \   0000000C   0000A0E3           MOV      R0,#+0
   \   00000010   1EFF2FE1           BX       LR
    755            rf=vd->ref_cache;
   \                     ??FindReferenceByBegin_0:
   \   00000014   CC0090E5           LDR      R0,[R0, #+204]
   \   00000018   020000EA           B        ??FindReferenceByBegin_2
    756            do
    757            {
    758              if (rf->begin==pos) return rf;
    759              rf++;
   \                     ??FindReferenceByBegin_3:
   \   0000001C   280080E2           ADD      R0,R0,#+40
    760            }
    761            while(--i);
   \   00000020   012052E2           SUBS     R2,R2,#+1
   \   00000024   F8FFFF0A           BEQ      ??FindReferenceByBegin_1
   \                     ??FindReferenceByBegin_2:
   \   00000028   003090E5           LDR      R3,[R0, #+0]
   \   0000002C   010053E1           CMP      R3,R1
   \   00000030   F9FFFF1A           BNE      ??FindReferenceByBegin_3
   \   00000034   1EFF2FE1           BX       LR               ;; return
    762            return NULL;
    763          }
    764          

   \                                 In segment CODE, align 4, keep-with-next
    765          REFCACHE *FindReferenceFirst(VIEWDATA *vd, unsigned int pos)
    766          {
   \                     FindReferenceFirst:
   \   00000000   0530A0E3           MOV      R3,#+5
   \   00000004   E03C83E3           ORR      R3,R3,#0xE000
   \   00000008   000000EA           B        ??FindReferenceFirst_0
    767            while (pos<vd->rawtext_size&&vd->rawtext[pos]!=UTF16_ENA_INVERT)
    768              pos++;
   \                     ??FindReferenceFirst_1:
   \   0000000C   011081E2           ADD      R1,R1,#+1
   \                     ??FindReferenceFirst_0:
   \   00000010   0C2090E5           LDR      R2,[R0, #+12]
   \   00000014   020051E1           CMP      R1,R2
   \   00000018   0400002A           BCS      ??FindReferenceFirst_2
   \   0000001C   082090E5           LDR      R2,[R0, #+8]
   \   00000020   812082E0           ADD      R2,R2,R1, LSL #+1
   \   00000024   B020D2E1           LDRH     R2,[R2, #+0]
   \   00000028   030052E1           CMP      R2,R3
   \   0000002C   F6FFFF1A           BNE      ??FindReferenceFirst_1
    769            return FindReferenceByBegin(vd,pos);
   \                     ??FindReferenceFirst_2:
   \   00000030   ........           B        FindReferenceByBegin  ;; tailcall
    770          }
    771          

   \                                 In segment CODE, align 4, keep-with-next
    772          REFCACHE *FindReference(VIEWDATA *vd, unsigned int pos)
    773          {
   \                     FindReference:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    774            REFCACHE *rf=FindReferenceByBegin(vd,pos);
   \   0000000C   ........           BL       FindReferenceByBegin
    775            if (rf!=NULL) return rf;
   \   00000010   000050E3           CMP      R0,#+0
   \   00000014   3080BD18           POPNE    {R4,R5,PC}
    776            else
    777            {
    778              int i=vd->ref_cache_size;
   \   00000018   D01094E5           LDR      R1,[R4, #+208]
    779              if (!i) return NULL;
   \   0000001C   000051E3           CMP      R1,#+0
   \   00000020   0000A003           MOVEQ    R0,#+0
   \   00000024   3080BD08           POPEQ    {R4,R5,PC}
    780              rf=vd->ref_cache;
   \   00000028   CC0094E5           LDR      R0,[R4, #+204]
    781              do
    782              {
    783                if ((rf->begin<=pos)&&(pos<rf->end)) return rf;
   \                     ??FindReference_0:
   \   0000002C   002090E5           LDR      R2,[R0, #+0]
   \   00000030   020055E1           CMP      R5,R2
   \   00000034   0200003A           BCC      ??FindReference_1
   \   00000038   042090E5           LDR      R2,[R0, #+4]
   \   0000003C   020055E1           CMP      R5,R2
   \   00000040   3080BD38           POPCC    {R4,R5,PC}
    784                rf++;
   \                     ??FindReference_1:
   \   00000044   280080E2           ADD      R0,R0,#+40
    785              }
    786              while(--i);
   \   00000048   011051E2           SUBS     R1,R1,#+1
   \   0000004C   F6FFFF1A           BNE      ??FindReference_0
   \   00000050   0000A0E3           MOV      R0,#+0
   \   00000054   3080BDE8           POP      {R4,R5,PC}
    787            }
    788            return NULL;
    789          }
    790          

   \                                 In segment CODE, align 4, keep-with-next
    791          int FindReferenceById(VIEWDATA *vd, unsigned int id, int i) // Находит index'ы всех ref'ов с заданным id
    792          {
   \                     FindReferenceById:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
    793            unsigned int sz=*(vd->oms+id);
    794            sz<<=8;
    795            sz|=*(vd->oms+id+1);
   \   00000010   000000EA           B        ??FindReferenceById_0
    796            while(i<vd->ref_cache_size)
    797            {
    798              if (!omstrcmp(vd,(vd->ref_cache+i)->id,id)) return i;
    799              i++;
   \                     ??FindReferenceById_1:
   \   00000014   016086E2           ADD      R6,R6,#+1
   \                     ??FindReferenceById_0:
   \   00000018   D00094E5           LDR      R0,[R4, #+208]
   \   0000001C   000056E1           CMP      R6,R0
   \   00000020   0A0000AA           BGE      ??FindReferenceById_2
   \   00000024   CC1094E5           LDR      R1,[R4, #+204]
   \   00000028   2800A0E3           MOV      R0,#+40
   \   0000002C   901621E0           MLA      R1,R0,R6,R1
   \   00000030   0520A0E1           MOV      R2,R5
   \   00000034   0C1091E5           LDR      R1,[R1, #+12]
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   ........           _BLF     omstrcmp,??omstrcmp??rA
   \   00000040   000050E3           CMP      R0,#+0
   \   00000044   F2FFFF1A           BNE      ??FindReferenceById_1
   \   00000048   0600A0E1           MOV      R0,R6
   \   0000004C   7080BDE8           POP      {R4-R6,PC}
    800            }
    801            return -1;
   \                     ??FindReferenceById_2:
   \   00000050   0000E0E3           MVN      R0,#+0
   \   00000054   7080BDE8           POP      {R4-R6,PC}       ;; return
    802          }
    803          
    804          /*******************************************************************************
    805            Templates menu
    806          *******************************************************************************/
    807          //GUI *paste_gui;
    808          
    809          //Templates
    810          char * templates_chars; //Собственно файл
    811          char ** templates_lines; //Массив указателей на строки
    812          

   \                                 In segment CODE, align 4, keep-with-next
    813          void FreeTemplates(void)
    814          {
   \                     FreeTemplates:
   \   00000000   10402DE9           PUSH     {R4,LR}
    815            if (templates_lines) mfree(templates_lines);
   \   00000004   ........           LDR      R4,??DataTable3  ;; templates_chars
   \   00000008   040094E5           LDR      R0,[R4, #+4]
   \   0000000C   000050E3           CMP      R0,#+0
   \   00000010   0000000A           BEQ      ??FreeTemplates_0
   \   00000014   150000EF           SWI      +21
    816            if (templates_chars) mfree(templates_chars);
   \                     ??FreeTemplates_0:
   \   00000018   000094E5           LDR      R0,[R4, #+0]
   \   0000001C   000050E3           CMP      R0,#+0
   \   00000020   0100000A           BEQ      ??FreeTemplates_1
   \   00000024   150000EF           SWI      +21
    817            templates_lines=NULL;
   \   00000028   0000A0E3           MOV      R0,#+0
   \                     ??FreeTemplates_1:
   \   0000002C   040084E5           STR      R0,[R4, #+4]
    818            templates_chars=NULL;
   \   00000030   000084E5           STR      R0,[R4, #+0]
    819          }
   \   00000034   1080BDE8           POP      {R4,PC}          ;; return
    820          
    821          extern const char TEMPLATES_PATH[];
    822          

   \                                 In segment CODE, align 4, keep-with-next
    823          int LoadTemplates()
    824          {
    825            FSTATS fstat;
    826            int hFile;
    827            unsigned int io_error = NULL;
    828            int templates_num = NULL;
    829            char * p;
    830            char * pp;
    831            int c;
    832            char * templates_file = getSymbolicPath("$ballet\\templates.txt");
   \                     LoadTemplates:
   \   00000000   08019FE5           LDR      R0,??LoadTemplates_0  ;; `?<Constant "$ballet\\\\templates.txt">`
   \   00000004   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000008   2CD04DE2           SUB      SP,SP,#+44
   \   0000000C   0040A0E3           MOV      R4,#+0
   \   00000010   00408DE5           STR      R4,[SP, #+0]
   \   00000014   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
   \   00000018   0060A0E1           MOV      R6,R0
    833          
    834            FreeTemplates();
   \   0000001C   ........           BL       FreeTemplates
    835            if (GetFileStats(templates_file, &fstat, &io_error) != -1)
   \   00000020   0470E0E1           MVN      R7,R4
   \   00000024   0D20A0E1           MOV      R2,SP
   \   00000028   04108DE2           ADD      R1,SP,#+4
   \   0000002C   0600A0E1           MOV      R0,R6
   \   00000030   840000EF           SWI      +132
   \   00000034   070050E1           CMP      R0,R7
    836            {
    837              if (fstat.size > 0)
   \   00000038   08009D15           LDRNE    R0,[SP, #+8]
   \   0000003C   0050A0E3           MOV      R5,#+0
   \   00000040   00005013           CMPNE    R0,#+0
   \   00000044   2C00000A           BEQ      ??LoadTemplates_1
    838              {
    839                if ((hFile = fopen(templates_file, A_ReadOnly + A_BIN, P_READ, &io_error)) != -1)
   \   00000048   0D30A0E1           MOV      R3,SP
   \   0000004C   8020A0E3           MOV      R2,#+128
   \   00000050   801CA0E3           MOV      R1,#+32768
   \   00000054   0600A0E1           MOV      R0,R6
   \   00000058   0A0000EF           SWI      +10
   \   0000005C   0090A0E1           MOV      R9,R0
   \   00000060   070059E1           CMP      R9,R7
   \   00000064   2400000A           BEQ      ??LoadTemplates_1
    840                {
    841                  p = templates_chars = malloc(fstat.size + 1);
   \   00000068   ........           LDR      R7,??DataTable3  ;; templates_chars
   \   0000006C   08009DE5           LDR      R0,[SP, #+8]
   \   00000070   010080E2           ADD      R0,R0,#+1
   \   00000074   140000EF           SWI      +20
   \   00000078   000087E5           STR      R0,[R7, #+0]
    842                  p[fread(hFile, p, fstat.size, &io_error)] = NULL;
   \   0000007C   08209DE5           LDR      R2,[SP, #+8]
   \   00000080   0080A0E1           MOV      R8,R0
   \   00000084   0D30A0E1           MOV      R3,SP
   \   00000088   0810A0E1           MOV      R1,R8
   \   0000008C   0900A0E1           MOV      R0,R9
   \   00000090   0B0000EF           SWI      +11
   \   00000094   0840C0E7           STRB     R4,[R0, +R8]
    843                  fclose(hFile, &io_error);
   \   00000098   0D10A0E1           MOV      R1,SP
   \   0000009C   0900A0E1           MOV      R0,R9
   \   000000A0   0D0000EF           SWI      +13
    844                  pp = p;
   \   000000A4   0890A0E1           MOV      R9,R8
   \   000000A8   020000EA           B        ??LoadTemplates_2
    845                  for(;;)
    846                  {
    847                    c = *p;
    848                    if (c < 32)
    849                    {
    850                      if (pp && (pp != p))
    851                      {
    852                        templates_lines = realloc(templates_lines,(templates_num + 1)*sizeof(char *));
    853                        templates_lines[templates_num ++] = pp;
    854                      }
    855                      pp = NULL;
    856                      if (!c) break;
    857                      *p = NULL;
    858                    }
    859                    else
    860                    {
    861                      if (!pp) pp = p;
   \                     ??LoadTemplates_3:
   \   000000AC   000059E3           CMP      R9,#+0
   \   000000B0   0890A001           MOVEQ    R9,R8
    862                    }
    863                    p++;
   \                     ??LoadTemplates_4:
   \   000000B4   018088E2           ADD      R8,R8,#+1
   \                     ??LoadTemplates_2:
   \   000000B8   00A0D8E5           LDRB     R10,[R8, #+0]
   \   000000BC   20005AE3           CMP      R10,#+32
   \   000000C0   F9FFFFAA           BGE      ??LoadTemplates_3
   \   000000C4   000059E3           CMP      R9,#+0
   \   000000C8   08005911           CMPNE    R9,R8
   \   000000CC   0600000A           BEQ      ??LoadTemplates_5
   \   000000D0   040097E5           LDR      R0,[R7, #+4]
   \   000000D4   01B085E2           ADD      R11,R5,#+1
   \   000000D8   0B11A0E1           LSL      R1,R11,#+2
   \   000000DC   BA0000EF           SWI      +186
   \   000000E0   040087E5           STR      R0,[R7, #+4]
   \   000000E4   059180E7           STR      R9,[R0, +R5, LSL #+2]
   \   000000E8   0B50A0E1           MOV      R5,R11
   \                     ??LoadTemplates_5:
   \   000000EC   0090A0E3           MOV      R9,#+0
   \   000000F0   00005AE3           CMP      R10,#+0
   \   000000F4   0040C815           STRBNE   R4,[R8, #+0]
   \   000000F8   EDFFFF1A           BNE      ??LoadTemplates_4
    864                  }
    865                }
    866              }
    867            }
    868            mfree(templates_file);
   \                     ??LoadTemplates_1:
   \   000000FC   0600A0E1           MOV      R0,R6
   \   00000100   150000EF           SWI      +21
    869            return templates_num;
   \   00000104   0500A0E1           MOV      R0,R5
   \   00000108   2CD08DE2           ADD      SP,SP,#+44
   \   0000010C   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??LoadTemplates_0:
   \   00000110   ........           DC32     `?<Constant "$ballet\\\\templates.txt">`
    870          }

   \                                 In segment DATA_Z, align 4, align-sorted
   \                     templates_chars:
   \   00000000                      DS8 4
   \                     templates_lines:
   \   00000004                      DS8 4
    871          
    872          int curpos;
   \                     curpos:
   \   00000008                      DS8 4
    873          int curpos_changed = 0;
   \                     curpos_changed:
   \   0000000C                      DS8 4
    874          

   \                                 In segment CODE, align 4, keep-with-next
    875          int templates_menu_onkey(void *gui, GUI_MSG *msg)
    876          {
   \                     templates_menu_onkey:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0060A0E1           MOV      R6,R0
    877            if (msg->keys == 0x3D || msg->keys == 0x18)
   \   0000000C   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000010   3D0050E3           CMP      R0,#+61
   \   00000014   18005013           CMPNE    R0,#+24
   \   00000018   2600001A           BNE      ??templates_menu_onkey_0
    878            {
    879              int i = GetCurMenuItem(gui);
    880              if (templates_lines[i])
   \   0000001C   ........           LDR      R5,??DataTable8  ;; templates_chars
   \   00000020   0600A0E1           MOV      R0,R6
   \   00000024   8F0100EF           SWI      +399
   \   00000028   0040A0E1           MOV      R4,R0
   \   0000002C   040095E5           LDR      R0,[R5, #+4]
   \   00000030   040190E7           LDR      R0,[R0, +R4, LSL #+2]
   \   00000034   000050E3           CMP      R0,#+0
   \   00000038   1B00000A           BEQ      ??templates_menu_onkey_1
    881              {
    882                GUI* paste_gui = (GUI*)MenuGetUserPointer(gui);
   \   0000003C   0600A0E1           MOV      R0,R6
   \   00000040   E00100EF           SWI      +480
   \   00000044   0060A0E1           MOV      R6,R0
    883                EDITCONTROL ec;
    884                ExtractEditControl(paste_gui, 1, &ec);
   \   00000048   0D20A0E1           MOV      R2,SP
   \   0000004C   0110A0E3           MOV      R1,#+1
   \   00000050   690100EF           SWI      +361
    885                curpos=EDIT_GetCursorPos(paste_gui);
   \   00000054   0600A0E1           MOV      R0,R6
   \   00000058   D30100EF           SWI      +467
   \   0000005C   080085E5           STR      R0,[R5, #+8]
   \   00000060   070000EA           B        ??templates_menu_onkey_2
    886                char c;
    887                while((c=*(templates_lines[i])++))
    888                {
    889                  wsInsertChar(ec.pWS,char8to16(c),curpos++);
   \                     ??templates_menu_onkey_3:
   \   00000064   086095E5           LDR      R6,[R5, #+8]
   \   00000068   011086E2           ADD      R1,R6,#+1
   \   0000006C   081085E5           STR      R1,[R5, #+8]
   \   00000070   ........           _BLF     char8to16,??char8to16??rA
   \   00000074   0620A0E1           MOV      R2,R6
   \   00000078   0010A0E1           MOV      R1,R0
   \   0000007C   28009DE5           LDR      R0,[SP, #+40]
   \   00000080   1D0000EF           SWI      +29
   \                     ??templates_menu_onkey_2:
   \   00000084   040095E5           LDR      R0,[R5, #+4]
   \   00000088   040180E0           ADD      R0,R0,R4, LSL #+2
   \   0000008C   001090E5           LDR      R1,[R0, #+0]
   \   00000090   012081E2           ADD      R2,R1,#+1
   \   00000094   002080E5           STR      R2,[R0, #+0]
   \   00000098   0000D1E5           LDRB     R0,[R1, #+0]
   \   0000009C   0010B0E1           MOVS     R1,R0
   \   000000A0   EFFFFF1A           BNE      ??templates_menu_onkey_3
    890                }
    891                curpos_changed = 1;
   \   000000A4   0100A0E3           MOV      R0,#+1
   \   000000A8   0C0085E5           STR      R0,[R5, #+12]
    892              }
    893              return (1);
   \                     ??templates_menu_onkey_1:
   \   000000AC   0100A0E3           MOV      R0,#+1
   \   000000B0   2CD08DE2           ADD      SP,SP,#+44
   \   000000B4   7080BDE8           POP      {R4-R6,PC}
    894            }
    895            return (0);
   \                     ??templates_menu_onkey_0:
   \   000000B8   0000A0E3           MOV      R0,#+0
   \   000000BC   2CD08DE2           ADD      SP,SP,#+44
   \   000000C0   7080BDE8           POP      {R4-R6,PC}       ;; return
    896          }
    897          

   \                                 In segment CODE, align 4, keep-with-next
    898          void templates_menu_ghook(void *gui, int cmd)
    899          {
   \                     templates_menu_ghook:
   \   00000000   00402DE9           PUSH     {LR}
    900            if (cmd == TI_CMD_DESTROY) // free
   \   00000004   030051E3           CMP      R1,#+3
   \   00000008   0100001A           BNE      ??templates_menu_ghook_0
    901            {
    902              FreeTemplates();
   \   0000000C   0040BDE8           POP      {LR}             ;; Pop
   \   00000010   ........           B        FreeTemplates    ;; tailcall
    903            }
    904            if (cmd == TI_CMD_FOCUS)
   \                     ??templates_menu_ghook_0:
   \   00000014   0A0051E3           CMP      R1,#+10
   \   00000018   0080BD18           POPNE    {PC}
    905            {
    906              DisableIDLETMR();
   \   0000001C   7F0100EF           SWI      +383
    907            }
    908          }
   \   00000020   0080BDE8           POP      {PC}             ;; return

   \                                 In segment CODE, align 4, keep-with-next
    909          void templates_menu_iconhndl(void *gui, int cur_item, void *user_pointer)
    910          {
   \                     templates_menu_iconhndl:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
    911            int len = strlen(templates_lines[cur_item]);
   \   00000004   ........           LDR      R6,??DataTable8  ;; templates_chars
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   040096E5           LDR      R0,[R6, #+4]
   \   00000010   0150A0E1           MOV      R5,R1
   \   00000014   050190E7           LDR      R0,[R0, +R5, LSL #+2]
   \   00000018   1B0000EF           SWI      +27
    912            WSHDR * ws = AllocMenuWS(gui, len + 4);
   \   0000001C   041080E2           ADD      R1,R0,#+4
   \   00000020   0400A0E1           MOV      R0,R4
   \   00000024   980100EF           SWI      +408
   \   00000028   0070A0E1           MOV      R7,R0
    913            void * item = AllocMenuItem(gui);
   \   0000002C   0400A0E1           MOV      R0,R4
   \   00000030   970100EF           SWI      +407
   \   00000034   0080A0E1           MOV      R8,R0
    914            ascii2ws(ws, templates_lines[cur_item]);
   \   00000038   040096E5           LDR      R0,[R6, #+4]
   \   0000003C   051190E7           LDR      R1,[R0, +R5, LSL #+2]
   \   00000040   0700A0E1           MOV      R0,R7
   \   00000044   ........           _BLF     ascii2ws,??ascii2ws??rA
    915            SetMenuItemText(gui, item, ws, cur_item);
   \   00000048   0530A0E1           MOV      R3,R5
   \   0000004C   0720A0E1           MOV      R2,R7
   \   00000050   0810A0E1           MOV      R1,R8
   \   00000054   0400A0E1           MOV      R0,R4
   \   00000058   9A0100EF           SWI      +410
    916          }
   \   0000005C   F081BDE8           POP      {R4-R8,PC}       ;; return
    917          

   \                                 In segment DATA_I, align 4, align-sorted
    918          int templates_menu_softkeys[]={0,1,2};
   \                     templates_menu_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for templates_menu_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
    919          SOFTKEY_DESC templates_menu_sk[]=
   \                     templates_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for templates_menu_sk>`
    920          {
    921            {0x0018,0x0000,(int)"Select"},
    922            {0x0001,0x0000,(int)"Close"},
    923            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    924          };
    925          
    926          SOFTKEYSTAB templates_menu_skt=
    927          {
    928            templates_menu_sk,0
    929          };
    930          
    931          HEADER_DESC templates_menu_header={0,0,0,0,NULL,(int)"Выбор",LGP_NULL};
   \                     templates_menu_header:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for templates_menu_header>`
    932          
    933          MENU_DESC templates_menu_struct=
   \                     templates_menu_struct:
   \   0000002C                      DS8 44
   \   00000058                      REQUIRE `?<Initializer for templates_menu_struct>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     templates_menu_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for templates_menu_skt>`
    934          {
    935            8, templates_menu_onkey, templates_menu_ghook, NULL,
    936            templates_menu_softkeys,
    937            &templates_menu_skt,
    938            0x10,
    939            templates_menu_iconhndl,
    940            NULL,   //Items
    941            NULL,   //Procs
    942            0   //n
    943          };
    944          

   \                                 In segment CODE, align 4, keep-with-next
    945          void createTemplatesMenu(void* data)
    946          {
   \                     createTemplatesMenu:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
    947            patch_header(&templates_menu_header);
   \   00000004   50509FE5           LDR      R5,??createTemplatesMenu_0  ;; templates_menu_sk
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   180085E2           ADD      R0,R5,#+24
   \   00000010   ........           _BLF     patch_header,??patch_header??rA
    948            
    949            templates_menu_sk[0].lgp_id=(int)lgpData[LGP_Select];
   \   00000014   ........           LDR      R0,??DataTable26  ;; lgpData
   \   00000018   5C1090E5           LDR      R1,[R0, #+92]
   \   0000001C   041085E5           STR      R1,[R5, #+4]
    950            templates_menu_sk[1].lgp_id=(int)lgpData[LGP_Back];
   \   00000020   B41090E5           LDR      R1,[R0, #+180]
    951            templates_menu_header.lgp_id=(int)lgpData[LGP_Templates];
   \   00000024   6C0090E5           LDR      R0,[R0, #+108]
   \   00000028   0C1085E5           STR      R1,[R5, #+12]
   \   0000002C   240085E5           STR      R0,[R5, #+36]
    952            
    953            CreateMenu(0, 0, &templates_menu_struct, &templates_menu_header, 0, LoadTemplates(), data, 0);
   \   00000030   ........           BL       LoadTemplates
   \   00000034   0010A0E3           MOV      R1,#+0
   \   00000038   02002DE9           PUSH     {R1}
   \   0000003C   10002DE9           PUSH     {R4}
   \   00000040   01002DE9           PUSH     {R0}
   \   00000044   183085E2           ADD      R3,R5,#+24
   \   00000048   2C2085E2           ADD      R2,R5,#+44
   \   0000004C   0000A0E3           MOV      R0,#+0
   \   00000050   01002DE9           PUSH     {R0}
   \   00000054   520100EF           SWI      +338
    954          }
   \   00000058   3F80BDE8           POP      {R0-R5,PC}       ;; return
   \                     ??createTemplatesMenu_0:
   \   0000005C   ........           DC32     templates_menu_sk
    955          
    956          // EDIT BOX
    957          REFCACHE *cur_ref;
    958          VIEWDATA *cur_vd;
    959          
    960          extern char *goto_url;
    961          extern char *from_url;
    962          extern char *goto_params;
    963          
    964          char *collectItemsParams(VIEWDATA *vd, REFCACHE *rf);
    965          
    966          SOFTKEY_DESC input_box_menu_sk[]=
    967          {
    968            {0x0018,0x0000,(int)"Ok"},
    969            {0x0001,0x0000,(int)"Cancel"},
    970            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    971          };
    972          

   \                                 In segment DATA_C, align 4, align-sorted
    973          static const SOFTKEYSTAB input_box_menu_skt=
   \                     input_box_menu_skt:
   \   00000000   ........0000       DC32 input_box_menu_sk, 0
   \              0000        
    974          {
    975            input_box_menu_sk,0
    976          };
    977          
    978          HEADER_DESC input_box_hdr={0,0,0,0,NULL,(int)"Enter:",LGP_NULL};
    979          

   \                                 In segment CODE, align 4, keep-with-next
    980          static void input_box_ghook(GUI *data, int cmd)
    981          {
    982            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     input_box_ghook:
   \   00000000   70209FE5           LDR      R2,??input_box_ghook_0  ;; `?<Constant {4095, 0, 0}>_2`
   \   00000004   10402DE9           PUSH     {R4,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   0C0092E8           LDM      R2,{R2,R3}
   \   00000010   0040A0E1           MOV      R4,R0
   \   00000014   0D00A0E1           MOV      R0,SP
   \   00000018   0C0080E8           STM      R0,{R2,R3}
   \   0000001C   ........           LDR      R2,??DataTable25  ;; lgpData + 100
    983            if (cmd==0x0A)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   002092E5           LDR      R2,[R2, #+0]
   \   00000028   04208DE5           STR      R2,[SP, #+4]
   \   0000002C   0A00001A           BNE      ??input_box_ghook_1
    984            {
    985              DisableIDLETMR();
   \   00000030   7F0100EF           SWI      +383
    986            }
    987            if (cmd==7)
    988            {
    989              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
    990            }
    991            if(cmd==TI_CMD_FOCUS)
    992            {
    993              if (curpos_changed)
   \   00000034   ........           LDR      R0,??DataTable8  ;; templates_chars
   \   00000038   0C1090E5           LDR      R1,[R0, #+12]
   \   0000003C   000051E3           CMP      R1,#+0
   \   00000040   1380BD08           POPEQ    {R0,R1,R4,PC}
    994              {
    995                curpos_changed = 0;
   \   00000044   0010A0E3           MOV      R1,#+0
   \   00000048   0C1080E5           STR      R1,[R0, #+12]
    996                EDIT_SetCursorPos(data, curpos);
   \   0000004C   081090E5           LDR      R1,[R0, #+8]
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   D40100EF           SWI      +468
    997              }
    998            }
    999          }
   \   00000058   1380BDE8           POP      {R0,R1,R4,PC}    ;; return
   \                     ??input_box_ghook_1:
   \   0000005C   070051E3           CMP      R1,#+7
   \   00000060   1380BD18           POPNE    {R0,R1,R4,PC}
   \   00000064   0020A0E3           MOV      R2,#+0
   \   00000068   0D10A0E1           MOV      R1,SP
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   680100EF           SWI      +360
   \   00000074   1380BDE8           POP      {R0,R1,R4,PC}
   \                     ??input_box_ghook_0:
   \   00000078   ........           DC32     `?<Constant {4095, 0, 0}>_2`
   1000          

   \                                 In segment CODE, align 4, keep-with-next
   1001          static void input_box_locret(void){}
   \                     input_box_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1002          

   \                                 In segment CODE, align 4, keep-with-next
   1003          void input_box_onkey_options(USR_MENU_ITEM *item)
   1004          {
   \                     input_box_onkey_options:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   1005            if (item->type==0)
   \   00000008   0000D4E5           LDRB     R0,[R4, #+0]
   \   0000000C   000050E3           CMP      R0,#+0
   1006            {
   1007              switch(item->cur_item)
   \   00000010   B800D401           LDRHEQ   R0,[R4, #+8]
   \   00000014   00005003           CMPEQ    R0,#+0
   \   00000018   0300001A           BNE      ??input_box_onkey_options_0
   1008              {
   1009              case 0:
   1010                ascii2ws(item->ws,lgpData[LGP_Templates]);
   \   0000001C   28009FE5           LDR      R0,??input_box_onkey_options_1  ;; lgpData + 108
   \   00000020   001090E5           LDR      R1,[R0, #+0]
   \   00000024   0C0094E5           LDR      R0,[R4, #+12]
   \   00000028   ........           _BLF     ascii2ws,??ascii2ws??rA
   1011                break;
   1012              }
   1013            }
   1014            if (item->type==1)
   \                     ??input_box_onkey_options_0:
   \   0000002C   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000030   010050E3           CMP      R0,#+1
   1015            {
   1016              switch(item->cur_item)
   \   00000034   B800D401           LDRHEQ   R0,[R4, #+8]
   \   00000038   00005003           CMPEQ    R0,#+0
   \   0000003C   1080BD18           POPNE    {R4,PC}
   1017              {
   1018              case 0:
   1019                createTemplatesMenu(item->user_pointer);
   \   00000040   040094E5           LDR      R0,[R4, #+4]
   \   00000044   ........           BL       createTemplatesMenu
   1020                break;
   1021              }
   1022            }
   1023          }
   \   00000048   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??input_box_onkey_options_1:
   \   0000004C   ........           DC32     lgpData + 108
   1024          

   \                                 In segment CODE, align 4, keep-with-next
   1025          static int input_box_onkey(GUI *data, GUI_MSG *msg)
   1026          {
   \                     input_box_onkey:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   1027            EDITCONTROL ec;
   1028            if (msg->gbsmsg->msg==KEY_DOWN&&msg->gbsmsg->submess==ENTER_BUTTON)
   \   00000008   042091E5           LDR      R2,[R1, #+4]
   \   0000000C   9340A0E3           MOV      R4,#+147
   \   00000010   043092E5           LDR      R3,[R2, #+4]
   \   00000014   404F84E3           ORR      R4,R4,#0x100
   \   00000018   040053E1           CMP      R3,R4
   \   0000001C   08209205           LDREQ    R2,[R2, #+8]
   \   00000020   1A005203           CMPEQ    R2,#+26
   \   00000024   0500001A           BNE      ??input_box_onkey_0
   1029            {
   1030              //paste_gui=data;
   1031              EDIT_OpenOptionMenuWithUserItems(data,input_box_onkey_options,data,1);
   \   00000028   20119FE5           LDR      R1,??input_box_onkey_1  ;; input_box_onkey_options
   \   0000002C   0130A0E3           MOV      R3,#+1
   \   00000030   0020A0E1           MOV      R2,R0
   \   00000034   E50100EF           SWI      +485
   1032              return (-1);
   \   00000038   0000E0E3           MVN      R0,#+0
   \   0000003C   3E0000EA           B        ??input_box_onkey_2
   1033            }
   1034            if (msg->keys==0xFFF)
   \                     ??input_box_onkey_0:
   \   00000040   F210D1E1           LDRSH    R1,[R1, #+2]
   \   00000044   FF20A0E3           MOV      R2,#+255
   \   00000048   F02E82E3           ORR      R2,R2,#0xF00
   \   0000004C   020051E1           CMP      R1,R2
   \   00000050   3B00001A           BNE      ??input_box_onkey_3
   1035            {
   1036              // set value
   1037              ExtractEditControl(data,1,&ec);
   1038              FreeWS(((WSHDR *)cur_ref->data));
   \   00000054   ........           LDR      R4,??DataTable23  ;; sel_STRUCT
   \   00000058   0D20A0E1           MOV      R2,SP
   \   0000005C   0110A0E3           MOV      R1,#+1
   \   00000060   690100EF           SWI      +361
   \   00000064   8C0094E5           LDR      R0,[R4, #+140]
   1039              cur_ref->data=(void *)AllocWS(ec.pWS->wsbody[0]);
   1040              wstrcpy(((WSHDR *)cur_ref->data),ec.pWS);
   1041              if (!cur_ref->no_upload)
   \   00000068   0050A0E3           MOV      R5,#+0
   \   0000006C   180090E5           LDR      R0,[R0, #+24]
   \   00000070   290100EF           SWI      +297
   \   00000074   28009DE5           LDR      R0,[SP, #+40]
   \   00000078   000090E5           LDR      R0,[R0, #+0]
   \   0000007C   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000080   250100EF           SWI      +293
   \   00000084   8C1094E5           LDR      R1,[R4, #+140]
   \   00000088   180081E5           STR      R0,[R1, #+24]
   \   0000008C   8C0094E5           LDR      R0,[R4, #+140]
   \   00000090   28109DE5           LDR      R1,[SP, #+40]
   \   00000094   180090E5           LDR      R0,[R0, #+24]
   \   00000098   1F0100EF           SWI      +287
   \   0000009C   8C0094E5           LDR      R0,[R4, #+140]
   \   000000A0   2000D0E5           LDRB     R0,[R0, #+32]
   \   000000A4   010010E3           TST      R0,#0x1
   \   000000A8   1B00001A           BNE      ??input_box_onkey_4
   1042              {
   1043                goto_url=malloc(strlen(cur_vd->pageurl)+1);
   \   000000AC   900094E5           LDR      R0,[R4, #+144]
   \   000000B0   ........           LDR      R6,??DataTable19  ;; goto_url
   \   000000B4   E00090E5           LDR      R0,[R0, #+224]
   \   000000B8   1B0000EF           SWI      +27
   \   000000BC   010080E2           ADD      R0,R0,#+1
   \   000000C0   140000EF           SWI      +20
   \   000000C4   000086E5           STR      R0,[R6, #+0]
   1044                strcpy(goto_url,cur_vd->pageurl);
   \   000000C8   900094E5           LDR      R0,[R4, #+144]
   \   000000CC   E01090E5           LDR      R1,[R0, #+224]
   \   000000D0   000096E5           LDR      R0,[R6, #+0]
   1045                from_url=malloc(strlen(cur_vd->pageurl)+1);
   \   000000D4   ........           LDR      R6,??DataTable20  ;; from_url
   \   000000D8   1A0000EF           SWI      +26
   \   000000DC   900094E5           LDR      R0,[R4, #+144]
   \   000000E0   E00090E5           LDR      R0,[R0, #+224]
   \   000000E4   1B0000EF           SWI      +27
   \   000000E8   010080E2           ADD      R0,R0,#+1
   \   000000EC   140000EF           SWI      +20
   \   000000F0   000086E5           STR      R0,[R6, #+0]
   1046                strcpy(from_url,cur_vd->pageurl);
   \   000000F4   900094E5           LDR      R0,[R4, #+144]
   \   000000F8   E01090E5           LDR      R1,[R0, #+224]
   \   000000FC   000096E5           LDR      R0,[R6, #+0]
   \   00000100   1A0000EF           SWI      +26
   1047                goto_params=collectItemsParams(cur_vd,cur_ref);
   \   00000104   8C1094E5           LDR      R1,[R4, #+140]
   \   00000108   900094E5           LDR      R0,[R4, #+144]
   \   0000010C   ........           _BLF     collectItemsParams,??collectItemsParams??rA
   \   00000110   ........           LDR      R1,??DataTable21  ;; goto_params
   \   00000114   000081E5           STR      R0,[R1, #+0]
   \   00000118   040000EA           B        ??input_box_onkey_5
   1048              }
   1049              else
   1050              {
   1051                MAIN_CSM *main_csm;
   1052                if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     ??input_box_onkey_4:
   \   0000011C   ........           LDR      R0,??DataTable22  ;; maincsm_id
   \   00000120   000090E5           LDR      R0,[R0, #+0]
   \   00000124   080100EF           SWI      +264
   \   00000128   000050E3           CMP      R0,#+0
   1053                {
   1054                  main_csm->sel_bmk=0;
   \   0000012C   30508015           STRNE    R5,[R0, #+48]
   1055                }
   1056              }
   1057              cur_ref=NULL;
   \                     ??input_box_onkey_5:
   \   00000130   8C5084E5           STR      R5,[R4, #+140]
   1058              cur_vd=NULL;
   \   00000134   905084E5           STR      R5,[R4, #+144]
   1059              return (0xFF);
   \   00000138   FF00A0E3           MOV      R0,#+255
   \                     ??input_box_onkey_2:
   \   0000013C   2CD08DE2           ADD      SP,SP,#+44
   \   00000140   7080BDE8           POP      {R4-R6,PC}
   1060            }
   1061            return (0);
   \                     ??input_box_onkey_3:
   \   00000144   0000A0E3           MOV      R0,#+0
   \   00000148   2CD08DE2           ADD      SP,SP,#+44
   \   0000014C   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??input_box_onkey_1:
   \   00000150   ........           DC32     input_box_onkey_options
   1062          }
   1063          

   \                                 In segment DATA_C, align 4, align-sorted
   1064          static const INPUTDIA_DESC input_box_desc =
   \                     input_box_desc:
   \   00000000   01000000....       DC32 1, input_box_onkey, input_box_ghook, input_box_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 input_box_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1065          {
   1066            1,
   1067            input_box_onkey,
   1068            input_box_ghook,
   1069            (void *)input_box_locret,
   1070            0,
   1071            &input_box_menu_skt,
   1072            {0,0,0,0},
   1073            FONT_SMALL,
   1074            100,
   1075            101,
   1076            0,
   1077            //  0x00000001 - Выровнять по правому краю
   1078            //  0x00000002 - Выровнять по центру
   1079            //  0x00000004 - Инверсия знакомест
   1080            //  0x00000008 - UnderLine
   1081            //  0x00000020 - Не переносить слова
   1082            //  0x00000200 - bold
   1083            0,
   1084            //  0x00000002 - ReadOnly
   1085            //  0x00000004 - Не двигается курсор
   1086            //  0x40000000 - Поменять местами софт-кнопки
   1087            0x40000000
   1088          };
   1089          

   \                                 In segment CODE, align 4, keep-with-next
   1090          int CreateInputBox(VIEWDATA *vd, REFCACHE *rf)
   1091          {
   \                     CreateInputBox:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   1092            cur_ref=rf;
   \   00000004   ........           LDR      R4,??DataTable23  ;; sel_STRUCT
   \   00000008   2CD04DE2           SUB      SP,SP,#+44
   \   0000000C   0160A0E1           MOV      R6,R1
   \   00000010   8C6084E5           STR      R6,[R4, #+140]
   1093            cur_vd=vd;
   \   00000014   900084E5           STR      R0,[R4, #+144]
   1094            
   1095            void *ma=malloc_adr();
   \   00000018   148000EF           SWI      +32788
   \   0000001C   0070A0E1           MOV      R7,R0
   1096            void *eq;
   1097            EDITCONTROL ec;
   1098            
   1099            eq=AllocEQueue(ma,mfree_adr());
   \   00000020   158000EF           SWI      +32789
   \   00000024   0010A0E1           MOV      R1,R0
   \   00000028   0700A0E1           MOV      R0,R7
   \   0000002C   630100EF           SWI      +355
   \   00000030   0050A0E1           MOV      R5,R0
   1100            WSHDR *ews=AllocWS(16384);
   \   00000034   400CA0E3           MOV      R0,#+16384
   \   00000038   250100EF           SWI      +293
   1101            
   1102            wstrcpy(ews,((WSHDR *)rf->data));
   \   0000003C   181096E5           LDR      R1,[R6, #+24]
   \   00000040   0080A0E1           MOV      R8,R0
   \   00000044   1F0100EF           SWI      +287
   1103            
   1104            PrepareEditControl(&ec);
   \   00000048   0D00A0E1           MOV      R0,SP
   \   0000004C   640100EF           SWI      +356
   1105            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL|(rf->tag=='p'?ECF_PASSW:NULL),ews,16384);
   \   00000050   080096E5           LDR      R0,[R6, #+8]
   1106            AddEditControlToEditQend(eq,&ec,ma);
   1107          
   1108            FreeWS(ews);
   1109            patch_header(&input_box_hdr);
   1110            patch_input(&input_box_desc);
   \   00000054   8C609FE5           LDR      R6,??CreateInputBox_0  ;; input_box_desc
   \   00000058   401CA0E3           MOV      R1,#+16384
   \   0000005C   02002DE9           PUSH     {R1}
   \   00000060   700050E3           CMP      R0,#+112
   \   00000064   1000A003           MOVEQ    R0,#+16
   \   00000068   0000A013           MOVNE    R0,#+0
   \   0000006C   0830A0E1           MOV      R3,R8
   \   00000070   402080E3           ORR      R2,R0,#0x40
   \   00000074   0310A0E3           MOV      R1,#+3
   \   00000078   04008DE2           ADD      R0,SP,#+4
   \   0000007C   650100EF           SWI      +357
   \   00000080   0720A0E1           MOV      R2,R7
   \   00000084   04108DE2           ADD      R1,SP,#+4
   \   00000088   0500A0E1           MOV      R0,R5
   \   0000008C   660100EF           SWI      +358
   \   00000090   0800A0E1           MOV      R0,R8
   \   00000094   290100EF           SWI      +297
   \   00000098   440084E2           ADD      R0,R4,#+68
   \   0000009C   ........           _BLF     patch_header,??patch_header??rA
   \   000000A0   0600A0E1           MOV      R0,R6
   \   000000A4   ........           _BLF     patch_input,??patch_input??rA
   1111            input_box_hdr.lgp_id=(int)lgpData[LGP_EnterHeader];
   \   000000A8   ........           LDR      R0,??DataTable26  ;; lgpData
   1112            input_box_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   1113            input_box_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1114            return CreateInputTextDialog(&input_box_desc,&input_box_hdr,eq,1,0);
   \   000000AC   0130A0E3           MOV      R3,#+1
   \   000000B0   8C1090E5           LDR      R1,[R0, #+140]
   \   000000B4   0520A0E1           MOV      R2,R5
   \   000000B8   501084E5           STR      R1,[R4, #+80]
   \   000000BC   641090E5           LDR      R1,[R0, #+100]
   \   000000C0   680090E5           LDR      R0,[R0, #+104]
   \   000000C4   301084E5           STR      R1,[R4, #+48]
   \   000000C8   380084E5           STR      R0,[R4, #+56]
   \   000000CC   0000A0E3           MOV      R0,#+0
   \   000000D0   01002DE9           PUSH     {R0}
   \   000000D4   441084E2           ADD      R1,R4,#+68
   \   000000D8   0600A0E1           MOV      R0,R6
   \   000000DC   670100EF           SWI      +359
   \   000000E0   34D08DE2           ADD      SP,SP,#+52
   \   000000E4   F081BDE8           POP      {R4-R8,PC}       ;; return
   \                     ??CreateInputBox_0:
   \   000000E8   ........           DC32     input_box_desc
   1115          }
   1116          
   1117          // TEXT VIEW
   1118          SOFTKEY_DESC txtview_menu_sk[]=
   1119          {
   1120            {0x0018,0x0000,(int)"Ok"},
   1121            {0x0001,0x0000,(int)"Cancel"},
   1122            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1123          };
   1124          

   \                                 In segment DATA_C, align 4, align-sorted
   1125          static const SOFTKEYSTAB txtview_menu_skt=
   \                     txtview_menu_skt:
   \   00000000   ........0000       DC32 txtview_menu_sk, 0
   \              0000        
   1126          {
   1127            txtview_menu_sk,0
   1128          };
   1129          
   1130          HEADER_DESC txtview_hdr={0,0,0,0,NULL,(int)"Text :",LGP_NULL};
   1131          

   \                                 In segment CODE, align 4, keep-with-next
   1132          static void txtview_ghook(GUI *data, int cmd)
   1133          {
   1134            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     txtview_ghook:
   \   00000000   44309FE5           LDR      R3,??txtview_ghook_0  ;; `?<Constant {4095, 0, 0}>_1`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   300093E8           LDM      R3,{R4,R5}
   \   00000010   ........           LDR      R3,??DataTable25  ;; lgpData + 100
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   300082E8           STM      R2,{R4,R5}
   \   0000001C   003093E5           LDR      R3,[R3, #+0]
   1135            if (cmd==0x0A)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   04308DE5           STR      R3,[SP, #+4]
   \   00000028   0100001A           BNE      ??txtview_ghook_1
   1136            {
   1137              DisableIDLETMR();
   \   0000002C   7F0100EF           SWI      +383
   \   00000030   3380BDE8           POP      {R0,R1,R4,R5,PC}
   1138            }
   1139            if (cmd==7)
   \                     ??txtview_ghook_1:
   \   00000034   070051E3           CMP      R1,#+7
   \   00000038   3380BD18           POPNE    {R0,R1,R4,R5,PC}
   1140            {
   1141              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000003C   0020A0E3           MOV      R2,#+0
   \   00000040   0D10A0E1           MOV      R1,SP
   \   00000044   680100EF           SWI      +360
   1142            }
   1143          }
   \   00000048   3380BDE8           POP      {R0,R1,R4,R5,PC}  ;; return
   \                     ??txtview_ghook_0:
   \   0000004C   ........           DC32     `?<Constant {4095, 0, 0}>_1`
   1144          

   \                                 In segment CODE, align 4, keep-with-next
   1145          static void txtview_locret(void){}
   \                     txtview_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1146          

   \                                 In segment CODE, align 4, keep-with-next
   1147          static int txtview_onkey(GUI *data, GUI_MSG *msg)
   1148          {
   1149            if (msg->keys==0xFFF)
   \                     txtview_onkey:
   \   00000000   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000004   FF10A0E3           MOV      R1,#+255
   \   00000008   F01E81E3           ORR      R1,R1,#0xF00
   \   0000000C   010050E1           CMP      R0,R1
   1150            {
   1151              return (0xFF);
   \   00000010   FF00A003           MOVEQ    R0,#+255
   \   00000014   1EFF2F01           BXEQ     LR
   1152            }
   1153            return (0);
   \   00000018   0000A0E3           MOV      R0,#+0
   \   0000001C   1EFF2FE1           BX       LR               ;; return
   1154          }
   1155          

   \                                 In segment DATA_C, align 4, align-sorted
   1156          static const INPUTDIA_DESC txtview_desc =
   \                     txtview_desc:
   \   00000000   01000000....       DC32 1, txtview_onkey, txtview_ghook, txtview_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 txtview_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1157          {
   1158            1,
   1159            txtview_onkey,
   1160            txtview_ghook,
   1161            (void *)txtview_locret,
   1162            0,
   1163            &txtview_menu_skt,
   1164            {0,0,0,0},
   1165            FONT_SMALL,
   1166            100,
   1167            101,
   1168            0,
   1169            0,
   1170            0x40000000
   1171          };
   1172          

   \                                 In segment CODE, align 4, keep-with-next
   1173          void createTextView(WSHDR *ws)
   1174          {
   \                     createTextView:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   3CD04DE2           SUB      SP,SP,#+60
   \   00000008   0050A0E1           MOV      R5,R0
   1175            void *ma=malloc_adr();
   \   0000000C   148000EF           SWI      +32788
   \   00000010   0060A0E1           MOV      R6,R0
   1176            void *eq;
   1177            EDITCONTROL ec;
   1178            EDITC_OPTIONS ec_options;
   1179            eq=AllocEQueue(ma,mfree_adr());
   \   00000014   158000EF           SWI      +32789
   \   00000018   0010A0E1           MOV      R1,R0
   \   0000001C   0600A0E1           MOV      R0,R6
   \   00000020   630100EF           SWI      +355
   \   00000024   0040A0E1           MOV      R4,R0
   1180            if (!wstrlen(ws))
   \   00000028   0500A0E1           MOV      R0,R5
   \   0000002C   230100EF           SWI      +291
   \   00000030   000050E3           CMP      R0,#+0
   \   00000034   0300001A           BNE      ??createTextView_0
   1181            {
   1182              FreeWS(ws);
   \   00000038   0500A0E1           MOV      R0,R5
   \   0000003C   290100EF           SWI      +297
   1183              return;
   \   00000040   3CD08DE2           ADD      SP,SP,#+60
   \   00000044   7080BDE8           POP      {R4-R6,PC}
   1184            }
   1185            PrepareEditControl(&ec);
   \                     ??createTextView_0:
   \   00000048   10008DE2           ADD      R0,SP,#+16
   \   0000004C   640100EF           SWI      +356
   1186            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL,ws,2048);
   \   00000050   800EA0E3           MOV      R0,#+2048
   \   00000054   01002DE9           PUSH     {R0}
   \   00000058   0530A0E1           MOV      R3,R5
   \   0000005C   4020A0E3           MOV      R2,#+64
   \   00000060   0310A0E3           MOV      R1,#+3
   \   00000064   14008DE2           ADD      R0,SP,#+20
   \   00000068   650100EF           SWI      +357
   1187            PrepareEditCOptions(&ec_options);
   \   0000006C   04008DE2           ADD      R0,SP,#+4
   \   00000070   C80100EF           SWI      +456
   1188            SetFontToEditCOptions(&ec_options,FONT_SMALL);
   \   00000074   0810A0E3           MOV      R1,#+8
   \   00000078   04008DE2           ADD      R0,SP,#+4
   \   0000007C   CA0100EF           SWI      +458
   1189            CopyOptionsToEditControl(&ec,&ec_options);
   \   00000080   04108DE2           ADD      R1,SP,#+4
   \   00000084   14008DE2           ADD      R0,SP,#+20
   \   00000088   CE0100EF           SWI      +462
   1190            AddEditControlToEditQend(eq,&ec,ma);
   \   0000008C   0620A0E1           MOV      R2,R6
   1191            FreeWS(ws);
   1192            patch_header(&txtview_hdr);
   1193            patch_input(&txtview_desc);
   \   00000090   68609FE5           LDR      R6,??createTextView_1  ;; txtview_desc
   \   00000094   14108DE2           ADD      R1,SP,#+20
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   660100EF           SWI      +358
   \   000000A0   0500A0E1           MOV      R0,R5
   \   000000A4   58509FE5           LDR      R5,??createTextView_1+0x4  ;; txtview_menu_sk
   \   000000A8   290100EF           SWI      +297
   \   000000AC   180085E2           ADD      R0,R5,#+24
   \   000000B0   ........           _BLF     patch_header,??patch_header??rA
   \   000000B4   0600A0E1           MOV      R0,R6
   \   000000B8   ........           _BLF     patch_input,??patch_input??rA
   1194            txtview_hdr.lgp_id=(int)lgpData[LGP_TextHeader];
   \   000000BC   ........           LDR      R0,??DataTable26  ;; lgpData
   1195            txtview_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   1196            txtview_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1197            CreateInputTextDialog(&txtview_desc,&txtview_hdr,eq,1,0);
   \   000000C0   0130A0E3           MOV      R3,#+1
   \   000000C4   781090E5           LDR      R1,[R0, #+120]
   \   000000C8   0420A0E1           MOV      R2,R4
   \   000000CC   241085E5           STR      R1,[R5, #+36]
   \   000000D0   641090E5           LDR      R1,[R0, #+100]
   \   000000D4   680090E5           LDR      R0,[R0, #+104]
   \   000000D8   041085E5           STR      R1,[R5, #+4]
   \   000000DC   0C0085E5           STR      R0,[R5, #+12]
   \   000000E0   0000A0E3           MOV      R0,#+0
   \   000000E4   01002DE9           PUSH     {R0}
   \   000000E8   181085E2           ADD      R1,R5,#+24
   \   000000EC   0600A0E1           MOV      R0,R6
   \   000000F0   670100EF           SWI      +359
   1198          }
   \   000000F4   08D08DE2           ADD      SP,SP,#+8
   \   000000F8   3CD08DE2           ADD      SP,SP,#+60
   \   000000FC   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??createTextView_1:
   \   00000100   ........           DC32     txtview_desc
   \   00000104   ........           DC32     txtview_menu_sk
   1199          
   1200          // SELECTION MENU
   1201          typedef struct
   1202          {
   1203            void *next;
   1204            char name[256];
   1205            unsigned short value;
   1206            unsigned short id2;
   1207          }SEL_STRUCT;
   1208          

   \                                 In segment CODE, align 4, keep-with-next
   1209          int sel_menu_onkey(void *gui, GUI_MSG *msg)
   1210          {
   \                     sel_menu_onkey:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0140A0E1           MOV      R4,R1
   \   00000008   0060A0E1           MOV      R6,R0
   1211            SEL_STRUCT *ustop=MenuGetUserPointer(gui);
   \   0000000C   E00100EF           SWI      +480
   \   00000010   0070A0E1           MOV      R7,R0
   1212            if (msg->keys==0x3D || msg->keys==0x18)
   \   00000014   F200D4E1           LDRSH    R0,[R4, #+2]
   \   00000018   3D0050E3           CMP      R0,#+61
   \   0000001C   18005013           CMPNE    R0,#+24
   \   00000020   1E00001A           BNE      ??sel_menu_onkey_0
   1213            {
   1214              int i=GetCurMenuItem(gui);
   \   00000024   0600A0E1           MOV      R0,R6
   \   00000028   8F0100EF           SWI      +399
   1215              int n=0;
   \   0000002C   0010A0E3           MOV      R1,#+0
   \   00000030   000050E3           CMP      R0,#+0
   \   00000034   0300000A           BEQ      ??sel_menu_onkey_1
   1216              for (; n!=i; n++) ustop=ustop->next;
   \                     ??sel_menu_onkey_2:
   \   00000038   007097E5           LDR      R7,[R7, #+0]
   \   0000003C   011081E2           ADD      R1,R1,#+1
   \   00000040   000051E1           CMP      R1,R0
   \   00000044   FBFFFF1A           BNE      ??sel_menu_onkey_2
   1217              if (ustop)
   \                     ??sel_menu_onkey_1:
   \   00000048   000057E3           CMP      R7,#+0
   \   0000004C   1300000A           BEQ      ??sel_menu_onkey_0
   1218              {
   1219                if (cur_ref->multiselect)
   \   00000050   ........           LDR      R4,??DataTable23  ;; sel_STRUCT
   \   00000054   0050A0E3           MOV      R5,#+0
   \   00000058   8C2094E5           LDR      R2,[R4, #+140]
   \   0000005C   2030D2E5           LDRB     R3,[R2, #+32]
   \   00000060   020013E3           TST      R3,#0x2
   \   00000064   0F00000A           BEQ      ??sel_menu_onkey_3
   1220                {
   1221                  if(((char*)cur_ref->data)[n])
   \   00000068   182092E5           LDR      R2,[R2, #+24]
   \   0000006C   022081E0           ADD      R2,R1,R2
   \   00000070   0030D2E5           LDRB     R3,[R2, #+0]
   \   00000074   000053E3           CMP      R3,#+0
   1222                    ((char*)cur_ref->data)[n]=0;
   \   00000078   0050C215           STRBNE   R5,[R2, #+0]
   1223                  else
   1224                    ((char*)cur_ref->data)[n]=1;
   \   0000007C   0130A003           MOVEQ    R3,#+1
   \   00000080   0030C205           STRBEQ   R3,[R2, #+0]
   1225                  SetMenuItemIcon(gui,i,((char*)cur_ref->data)[n]);
   \   00000084   8C2094E5           LDR      R2,[R4, #+140]
   \   00000088   182092E5           LDR      R2,[R2, #+24]
   \   0000008C   0220D1E7           LDRB     R2,[R1, +R2]
   \   00000090   0010A0E1           MOV      R1,R0
   \   00000094   0600A0E1           MOV      R0,R6
   \   00000098   950100EF           SWI      +405
   1226                  RefreshGUI();
   \   0000009C   960100EF           SWI      +406
   1227                }
   1228                else
   1229                {
   1230                  cur_ref->value=ustop->value;
   1231                  cur_ref->id2=ustop->id2;
   1232                  if (!cur_ref->no_upload)
   1233                  {
   1234                    goto_url=malloc(strlen(cur_vd->pageurl)+1);
   1235                    strcpy(goto_url,cur_vd->pageurl);
   1236                    from_url=malloc(strlen(cur_vd->pageurl)+1);
   1237                    strcpy(from_url,cur_vd->pageurl);
   1238                    goto_params=collectItemsParams(cur_vd,cur_ref);
   1239                  }
   1240                  else
   1241                  {
   1242                    MAIN_CSM *main_csm;
   1243                    if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   1244                    {
   1245                      main_csm->sel_bmk=0;
   1246                    }
   1247                  }
   1248                  cur_ref=NULL;
   1249                  cur_vd=NULL;
   1250                  return 0xFF;
   1251                }
   1252              }
   1253            }
   1254            return (0);
   \                     ??sel_menu_onkey_0:
   \   000000A0   0000A0E3           MOV      R0,#+0
   \   000000A4   F080BDE8           POP      {R4-R7,PC}       ;; return
   \                     ??sel_menu_onkey_3:
   \   000000A8   410F87E2           ADD      R0,R7,#+260
   \   000000AC   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000B0   101082E5           STR      R1,[R2, #+16]
   \   000000B4   B200D0E1           LDRH     R0,[R0, #+2]
   \   000000B8   8C1094E5           LDR      R1,[R4, #+140]
   \   000000BC   140081E5           STR      R0,[R1, #+20]
   \   000000C0   8C0094E5           LDR      R0,[R4, #+140]
   \   000000C4   2000D0E5           LDRB     R0,[R0, #+32]
   \   000000C8   010010E3           TST      R0,#0x1
   \   000000CC   1B00001A           BNE      ??sel_menu_onkey_4
   \   000000D0   900094E5           LDR      R0,[R4, #+144]
   \   000000D4   ........           LDR      R6,??DataTable19  ;; goto_url
   \   000000D8   E00090E5           LDR      R0,[R0, #+224]
   \   000000DC   1B0000EF           SWI      +27
   \   000000E0   010080E2           ADD      R0,R0,#+1
   \   000000E4   140000EF           SWI      +20
   \   000000E8   000086E5           STR      R0,[R6, #+0]
   \   000000EC   900094E5           LDR      R0,[R4, #+144]
   \   000000F0   E01090E5           LDR      R1,[R0, #+224]
   \   000000F4   000096E5           LDR      R0,[R6, #+0]
   \   000000F8   ........           LDR      R6,??DataTable20  ;; from_url
   \   000000FC   1A0000EF           SWI      +26
   \   00000100   900094E5           LDR      R0,[R4, #+144]
   \   00000104   E00090E5           LDR      R0,[R0, #+224]
   \   00000108   1B0000EF           SWI      +27
   \   0000010C   010080E2           ADD      R0,R0,#+1
   \   00000110   140000EF           SWI      +20
   \   00000114   000086E5           STR      R0,[R6, #+0]
   \   00000118   900094E5           LDR      R0,[R4, #+144]
   \   0000011C   E01090E5           LDR      R1,[R0, #+224]
   \   00000120   000096E5           LDR      R0,[R6, #+0]
   \   00000124   1A0000EF           SWI      +26
   \   00000128   8C1094E5           LDR      R1,[R4, #+140]
   \   0000012C   900094E5           LDR      R0,[R4, #+144]
   \   00000130   ........           _BLF     collectItemsParams,??collectItemsParams??rA
   \   00000134   ........           LDR      R1,??DataTable21  ;; goto_params
   \   00000138   000081E5           STR      R0,[R1, #+0]
   \   0000013C   040000EA           B        ??sel_menu_onkey_5
   \                     ??sel_menu_onkey_4:
   \   00000140   ........           LDR      R0,??DataTable22  ;; maincsm_id
   \   00000144   000090E5           LDR      R0,[R0, #+0]
   \   00000148   080100EF           SWI      +264
   \   0000014C   000050E3           CMP      R0,#+0
   \   00000150   30508015           STRNE    R5,[R0, #+48]
   \                     ??sel_menu_onkey_5:
   \   00000154   8C5084E5           STR      R5,[R4, #+140]
   \   00000158   905084E5           STR      R5,[R4, #+144]
   \   0000015C   FF00A0E3           MOV      R0,#+255
   \   00000160   F080BDE8           POP      {R4-R7,PC}
   1255          }
   1256          

   \                                 In segment CODE, align 4, keep-with-next
   1257          void sel_menu_ghook(void *gui, int cmd)
   1258          {
   \                     sel_menu_ghook:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0140A0E1           MOV      R4,R1
   1259            SEL_STRUCT *ustop=MenuGetUserPointer(gui);
   \   00000008   E00100EF           SWI      +480
   \   0000000C   0050A0E1           MOV      R5,R0
   1260            if (cmd==3)
   \   00000010   030054E3           CMP      R4,#+3
   \   00000014   0500001A           BNE      ??sel_menu_ghook_0
   1261            {
   1262              while(ustop)
   \                     ??sel_menu_ghook_1:
   \   00000018   000055E3           CMP      R5,#+0
   \   0000001C   3080BD08           POPEQ    {R4,R5,PC}
   1263              {
   1264                SEL_STRUCT *us=ustop;
   \   00000020   0500A0E1           MOV      R0,R5
   1265                ustop=ustop->next;
   \   00000024   005095E5           LDR      R5,[R5, #+0]
   1266                mfree(us);
   \   00000028   150000EF           SWI      +21
   \   0000002C   F9FFFFEA           B        ??sel_menu_ghook_1
   1267              }    
   1268            }
   1269            if (cmd==0x0A)
   \                     ??sel_menu_ghook_0:
   \   00000030   0A0054E3           CMP      R4,#+10
   \   00000034   3080BD18           POPNE    {R4,R5,PC}
   1270            {
   1271              DisableIDLETMR();
   \   00000038   7F0100EF           SWI      +383
   1272            }
   1273          }
   \   0000003C   3080BDE8           POP      {R4,R5,PC}       ;; return
   1274          
   1275          static int icon_array[2];
   1276          

   \                                 In segment CODE, align 4, keep-with-next
   1277          void sel_menu_iconhndl(void *gui, int cur_item, void *user_pointer)
   1278          {
   \                     sel_menu_iconhndl:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0290A0E1           MOV      R9,R2
   1279            SEL_STRUCT *ustop=user_pointer;
   1280            WSHDR *ws;
   1281            int len;
   1282            int n=0;
   \   00000010   0060A0E3           MOV      R6,#+0
   \   00000014   000055E3           CMP      R5,#+0
   \   00000018   0300000A           BEQ      ??sel_menu_iconhndl_0
   1283            for (; n!=cur_item; n++) ustop=ustop->next;
   \                     ??sel_menu_iconhndl_1:
   \   0000001C   009099E5           LDR      R9,[R9, #+0]
   \   00000020   016086E2           ADD      R6,R6,#+1
   \   00000024   050056E1           CMP      R6,R5
   \   00000028   FBFFFF1A           BNE      ??sel_menu_iconhndl_1
   1284            void *item=AllocMenuItem(gui);
   \                     ??sel_menu_iconhndl_0:
   \   0000002C   970100EF           SWI      +407
   \   00000030   0070A0E1           MOV      R7,R0
   1285            if (ustop)
   \   00000034   000059E3           CMP      R9,#+0
   \   00000038   1900000A           BEQ      ??sel_menu_iconhndl_2
   1286            {
   1287              len=strlen(ustop->name);
   \   0000003C   040089E2           ADD      R0,R9,#+4
   \   00000040   1B0000EF           SWI      +27
   \   00000044   00A0A0E1           MOV      R10,R0
   1288              ws=AllocMenuWS(gui,len+4);
   \   00000048   04108AE2           ADD      R1,R10,#+4
   \   0000004C   0400A0E1           MOV      R0,R4
   \   00000050   980100EF           SWI      +408
   1289              oms2ws(ws,ustop->name,len);
   \   00000054   041089E2           ADD      R1,R9,#+4
   1290              if (cur_ref->multiselect)
   \   00000058   ........           LDR      R9,??DataTable23  ;; sel_STRUCT
   \   0000005C   0080A0E1           MOV      R8,R0
   \   00000060   0A20A0E1           MOV      R2,R10
   \   00000064   ........           _BLF     oms2ws,??oms2ws??rA
   \   00000068   8C0099E5           LDR      R0,[R9, #+140]
   \   0000006C   2000D0E5           LDRB     R0,[R0, #+32]
   \   00000070   020010E3           TST      R0,#0x2
   \   00000074   1200000A           BEQ      ??sel_menu_iconhndl_3
   1291              {
   1292                SetMenuItemIconArray(gui,item,icon_array);
   \   00000078   842089E2           ADD      R2,R9,#+132
   \   0000007C   0710A0E1           MOV      R1,R7
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   990100EF           SWI      +409
   1293                SetMenuItemIcon(gui,cur_item,((char*)cur_ref->data)[n]);
   \   00000088   8C0099E5           LDR      R0,[R9, #+140]
   \   0000008C   0510A0E1           MOV      R1,R5
   \   00000090   180090E5           LDR      R0,[R0, #+24]
   \   00000094   0020D6E7           LDRB     R2,[R6, +R0]
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   950100EF           SWI      +405
   \   000000A0   070000EA           B        ??sel_menu_iconhndl_3
   1294              }
   1295            }
   1296            else
   1297            {
   1298              ws=AllocMenuWS(gui,10);
   \                     ??sel_menu_iconhndl_2:
   \   000000A4   0A10A0E3           MOV      R1,#+10
   \   000000A8   0400A0E1           MOV      R0,R4
   \   000000AC   980100EF           SWI      +408
   \   000000B0   0080A0E1           MOV      R8,R0
   1299              ascii2ws(ws,lgpData[LGP_Error]);//"Ошибка");
   \   000000B4   20009FE5           LDR      R0,??sel_menu_iconhndl_4  ;; lgpData + 24
   \   000000B8   001090E5           LDR      R1,[R0, #+0]
   \   000000BC   0800A0E1           MOV      R0,R8
   \   000000C0   ........           _BLF     ascii2ws,??ascii2ws??rA
   1300            }
   1301            SetMenuItemText(gui, item, ws, cur_item);
   \                     ??sel_menu_iconhndl_3:
   \   000000C4   0530A0E1           MOV      R3,R5
   \   000000C8   0820A0E1           MOV      R2,R8
   \   000000CC   0710A0E1           MOV      R1,R7
   \   000000D0   0400A0E1           MOV      R0,R4
   \   000000D4   9A0100EF           SWI      +410
   1302          }
   \   000000D8   F087BDE8           POP      {R4-R10,PC}      ;; return
   \                     ??sel_menu_iconhndl_4:
   \   000000DC   ........           DC32     lgpData + 24

   \                                 In segment DATA_I, align 4, align-sorted
   1303          
   1304          int sel_softkeys[]={0,1,2};
   1305          SOFTKEY_DESC sel_sk[]=
   1306          {
   1307            {0x0018,0x0000,(int)"Select"},
   1308            {0x0001,0x0000,(int)"Close"},
   1309            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1310          };
   1311          
   1312          SOFTKEYSTAB sel_skt=
   1313          {
   1314            sel_sk,0
   1315          };
   1316          
   1317          HEADER_DESC sel_HDR={0,0,0,0,NULL,(int)"Select:",LGP_NULL};
   1318          
   1319          MENU_DESC sel_STRUCT=
   \                     sel_STRUCT:
   \   00000000                      DS8 44
   \   0000002C                      REQUIRE `?<Initializer for sel_STRUCT>`
   \                     input_box_menu_sk:
   \   0000002C                      DS8 24
   \   00000044                      REQUIRE `?<Initializer for input_box_menu_sk>`
   \                     input_box_hdr:
   \   00000044                      DS8 20
   \   00000058                      REQUIRE `?<Initializer for input_box_hdr>`
   \                     sel_sk:
   \   00000058                      DS8 24
   \   00000070                      REQUIRE `?<Initializer for sel_sk>`
   \                     sel_HDR:
   \   00000070                      DS8 20
   \   00000084                      REQUIRE `?<Initializer for sel_HDR>`
   \   00000084                      DS8 8
   \   0000008C                      REQUIRE `?<Initializer for icon_array>`
   \                     cur_ref:
   \   0000008C                      DS8 4
   \   00000090                      REQUIRE `?<Initializer for cur_ref>`
   \                     cur_vd:
   \   00000090                      DS8 4
   \   00000094                      REQUIRE `?<Initializer for cur_vd>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     txtview_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for txtview_menu_sk>`
   \                     txtview_hdr:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for txtview_hdr>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     sel_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for sel_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     sel_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for sel_skt>`
   1320          {
   1321            8,sel_menu_onkey,sel_menu_ghook,NULL,
   1322            sel_softkeys,
   1323            &sel_skt,
   1324            0x10,
   1325            sel_menu_iconhndl,
   1326            NULL,   //Items
   1327            NULL,   //Procs
   1328            0   //n
   1329          };
   1330          

   \                                 In segment CODE, align 4, keep-with-next
   1331          int ChangeMenuSelection(VIEWDATA *vd, REFCACHE *rf)
   1332          {
   \                     ChangeMenuSelection:
   \   00000000   F24F2DE9           PUSH     {R1,R4-R11,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0050A0E1           MOV      R5,R0
   1333            int start=0;
   1334            SEL_STRUCT *ustop=0, *usbot=0;
   \   0000000C   0060A0E3           MOV      R6,#+0
   \   00000010   00608DE5           STR      R6,[SP, #+0]
   1335            SEL_STRUCT *us;
   1336            unsigned short i;
   1337            vd->oms_pos=rf->id;
   \   00000014   0C0091E5           LDR      R0,[R1, #+12]
   \   00000018   0090A0E3           MOV      R9,#+0
   \   0000001C   440085E5           STR      R0,[R5, #+68]
   1338            i=_rshort2(vd->oms+vd->oms_pos);
   \   00000020   3C1095E5           LDR      R1,[R5, #+60]
   \   00000024   0670A0E1           MOV      R7,R6
   \   00000028   010080E0           ADD      R0,R0,R1
   \   0000002C   ........           _BLF     _rshort2,??_rshort2??rA
   1339            vd->oms_pos+=2+i+1;
   \   00000030   441095E5           LDR      R1,[R5, #+68]
   \   00000034   0008A0E1           MOV      R0,R0, LSL #+16
   \   00000038   2008A0E1           MOV      R0,R0, LSR #+16
   \   0000003C   030080E2           ADD      R0,R0,#+3
   \   00000040   010080E0           ADD      R0,R0,R1
   \   00000044   440085E5           STR      R0,[R5, #+68]
   1340            int n_sel=_rshort2(vd->oms+vd->oms_pos);
   \   00000048   3C1095E5           LDR      R1,[R5, #+60]
   1341            vd->oms_pos+=2;
   1342            for(int o=0;o<n_sel;o++)
   \   0000004C   0680A0E1           MOV      R8,R6
   \   00000050   010080E0           ADD      R0,R0,R1
   \   00000054   ........           _BLF     _rshort2,??_rshort2??rA
   \   00000058   0040A0E1           MOV      R4,R0
   \   0000005C   440095E5           LDR      R0,[R5, #+68]
   \   00000060   010054E3           CMP      R4,#+1
   \   00000064   020080E2           ADD      R0,R0,#+2
   \   00000068   440085E5           STR      R0,[R5, #+68]
   \   0000006C   130000AA           BGE      ??ChangeMenuSelection_0
   1343            {
   1344              while(*(vd->oms+vd->oms_pos)!='o') vd->oms_pos++; // '$'
   1345              vd->oms_pos++;
   1346              if (rf->value==vd->oms_pos) start=o;
   1347              us=malloc(sizeof(SEL_STRUCT));
   1348              char *d=extract_omstr(vd,vd->oms_pos);
   1349              strcpy(us->name,d);
   1350              mfree(d);
   1351              us->value=vd->oms_pos;
   1352              int i=_rshort2(vd->oms+vd->oms_pos);
   1353              vd->oms_pos+=2+i;
   1354              us->id2=vd->oms_pos;
   1355              i=_rshort2(vd->oms+vd->oms_pos);
   1356              vd->oms_pos+=2+i+1;
   1357              us->next=0;
   1358              if (usbot)
   1359              {
   1360                usbot->next=us;
   1361                usbot=us;
   1362              }
   1363              else
   1364              {
   1365                ustop=us;
   1366                usbot=us;
   1367              }
   1368            }
   1369            cur_ref=rf;
   \                     ??ChangeMenuSelection_1:
   \   00000070   64619FE5           LDR      R6,??ChangeMenuSelection_2  ;; sel_STRUCT
   \   00000074   04009DE5           LDR      R0,[SP, #+4]
   1370            cur_vd=vd;
   \   00000078   905086E5           STR      R5,[R6, #+144]
   \   0000007C   8C0086E5           STR      R0,[R6, #+140]
   1371            icon_array[0]=GetPicNByUnicodeSymbol(CBOX_UNCHECKED);
   \   00000080   1700A0E3           MOV      R0,#+23
   \   00000084   E10C80E3           ORR      R0,R0,#0xE100
   \   00000088   E40100EF           SWI      +484
   \   0000008C   840086E5           STR      R0,[R6, #+132]
   1372            icon_array[1]=GetPicNByUnicodeSymbol(CBOX_CHECKED);
   \   00000090   1600A0E3           MOV      R0,#+22
   \   00000094   E10C80E3           ORR      R0,R0,#0xE100
   \   00000098   E40100EF           SWI      +484
   \   0000009C   880086E5           STR      R0,[R6, #+136]
   1373            if (rf->multiselect) sel_STRUCT.flags2=0x11;
   \   000000A0   04009DE5           LDR      R0,[SP, #+4]
   \   000000A4   2000D0E5           LDRB     R0,[R0, #+32]
   \   000000A8   020010E3           TST      R0,#0x2
   \   000000AC   1000A003           MOVEQ    R0,#+16
   \   000000B0   1100A013           MOVNE    R0,#+17
   \   000000B4   310000EA           B        ??ChangeMenuSelection_3
   \                     ??ChangeMenuSelection_4:
   \   000000B8   0A70A0E1           MOV      R7,R10
   \   000000BC   018088E2           ADD      R8,R8,#+1
   \                     ??ChangeMenuSelection_0:
   \   000000C0   040058E1           CMP      R8,R4
   \   000000C4   E9FFFFAA           BGE      ??ChangeMenuSelection_1
   \                     ??ChangeMenuSelection_5:
   \   000000C8   441095E5           LDR      R1,[R5, #+68]
   \   000000CC   3C2095E5           LDR      R2,[R5, #+60]
   \   000000D0   010081E2           ADD      R0,R1,#+1
   \   000000D4   0210D1E7           LDRB     R1,[R1, +R2]
   \   000000D8   440085E5           STR      R0,[R5, #+68]
   \   000000DC   6F0051E3           CMP      R1,#+111
   \   000000E0   F8FFFF1A           BNE      ??ChangeMenuSelection_5
   \   000000E4   04109DE5           LDR      R1,[SP, #+4]
   \   000000E8   101091E5           LDR      R1,[R1, #+16]
   \   000000EC   000051E1           CMP      R1,R0
   \   000000F0   0890A001           MOVEQ    R9,R8
   \   000000F4   420FA0E3           MOV      R0,#+264
   \   000000F8   140000EF           SWI      +20
   \   000000FC   441095E5           LDR      R1,[R5, #+68]
   \   00000100   00A0A0E1           MOV      R10,R0
   \   00000104   0500A0E1           MOV      R0,R5
   \   00000108   ........           _BLF     extract_omstr,??extract_omstr??rA
   \   0000010C   00B0A0E1           MOV      R11,R0
   \   00000110   0B10A0E1           MOV      R1,R11
   \   00000114   04008AE2           ADD      R0,R10,#+4
   \   00000118   1A0000EF           SWI      +26
   \   0000011C   0B00A0E1           MOV      R0,R11
   \   00000120   150000EF           SWI      +21
   \   00000124   440095E5           LDR      R0,[R5, #+68]
   \   00000128   41BF8AE2           ADD      R11,R10,#+260
   \   0000012C   B000CBE1           STRH     R0,[R11, #+0]
   \   00000130   3C1095E5           LDR      R1,[R5, #+60]
   \   00000134   010080E0           ADD      R0,R0,R1
   \   00000138   ........           _BLF     _rshort2,??_rshort2??rA
   \   0000013C   441095E5           LDR      R1,[R5, #+68]
   \   00000140   020080E2           ADD      R0,R0,#+2
   \   00000144   010080E0           ADD      R0,R0,R1
   \   00000148   440085E5           STR      R0,[R5, #+68]
   \   0000014C   B200CBE1           STRH     R0,[R11, #+2]
   \   00000150   3C1095E5           LDR      R1,[R5, #+60]
   \   00000154   010080E0           ADD      R0,R0,R1
   \   00000158   ........           _BLF     _rshort2,??_rshort2??rA
   \   0000015C   441095E5           LDR      R1,[R5, #+68]
   \   00000160   030080E2           ADD      R0,R0,#+3
   \   00000164   010080E0           ADD      R0,R0,R1
   \   00000168   440085E5           STR      R0,[R5, #+68]
   \   0000016C   00608AE5           STR      R6,[R10, #+0]
   \   00000170   000057E3           CMP      R7,#+0
   \   00000174   00A08D05           STREQ    R10,[SP, #+0]
   \   00000178   00A08715           STRNE    R10,[R7, #+0]
   \   0000017C   CDFFFFEA           B        ??ChangeMenuSelection_4
   \                     ??ChangeMenuSelection_3:
   \   00000180   180086E5           STR      R0,[R6, #+24]
   1374            else sel_STRUCT.flags2=0x10;
   1375            patch_header(&sel_HDR);
   \   00000184   700086E2           ADD      R0,R6,#+112
   \   00000188   ........           _BLF     patch_header,??patch_header??rA
   1376            sel_HDR.lgp_id=(int)lgpData[LGP_SelectHeader];
   \   0000018C   ........           LDR      R0,??DataTable26  ;; lgpData
   1377            sel_sk[0].lgp_id=(int)lgpData[LGP_Select];
   1378            sel_sk[1].lgp_id=(int)lgpData[LGP_Close];
   1379            return CreateMenu(0,0,&sel_STRUCT,&sel_HDR,start,n_sel,ustop,0);
   \   00000190   703086E2           ADD      R3,R6,#+112
   \   00000194   881090E5           LDR      R1,[R0, #+136]
   \   00000198   0620A0E1           MOV      R2,R6
   \   0000019C   7C1086E5           STR      R1,[R6, #+124]
   \   000001A0   5C1090E5           LDR      R1,[R0, #+92]
   \   000001A4   600090E5           LDR      R0,[R0, #+96]
   \   000001A8   5C1086E5           STR      R1,[R6, #+92]
   \   000001AC   640086E5           STR      R0,[R6, #+100]
   \   000001B0   0000A0E3           MOV      R0,#+0
   \   000001B4   01002DE9           PUSH     {R0}
   \   000001B8   04009DE5           LDR      R0,[SP, #+4]
   \   000001BC   0010A0E3           MOV      R1,#+0
   \   000001C0   01002DE9           PUSH     {R0}
   \   000001C4   10002DE9           PUSH     {R4}
   \   000001C8   00022DE9           PUSH     {R9}
   \   000001CC   0000A0E3           MOV      R0,#+0
   \   000001D0   520100EF           SWI      +338
   \   000001D4   18D08DE2           ADD      SP,SP,#+24
   \   000001D8   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??ChangeMenuSelection_2:
   \   000001DC   ........           DC32     sel_STRUCT
   1380          }
   1381          
   1382          
   1383          SOFTKEY_DESC link_box_menu_sk[]=
   1384          {
   1385            {0x0018,0x0000,(int)"Ok"},
   1386            {0x0001,0x0000,(int)"Cancel"},
   1387            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1388          };
   1389          

   \                                 In segment DATA_C, align 4, align-sorted
   1390          static const SOFTKEYSTAB link_box_menu_skt=
   \                     link_box_menu_skt:
   \   00000000   ........0000       DC32 link_box_menu_sk, 0
   \              0000        

   \                                 In segment DATA_I, align 4, align-sorted
   \                     link_box_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for link_box_menu_sk>`
   1391          {
   1392            link_box_menu_sk,0
   1393          };
   1394          
   1395          HEADER_DESC link_box_hdr={0,0,0,0,NULL,(int)"Link:",LGP_NULL};
   \                     link_box_hdr:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for link_box_hdr>`
   1396          

   \                                 In segment CODE, align 4, keep-with-next
   1397          static void link_box_locret(void){}
   \                     link_box_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1398          

   \                                 In segment CODE, align 4, keep-with-next
   1399          static void link_box_ghook(GUI *data, int cmd)
   1400          {
   1401            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     link_box_ghook:
   \   00000000   44309FE5           LDR      R3,??link_box_ghook_0  ;; `?<Constant {4095, 0, 0}>`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   300093E8           LDM      R3,{R4,R5}
   \   00000010   ........           LDR      R3,??DataTable25  ;; lgpData + 100
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   300082E8           STM      R2,{R4,R5}
   \   0000001C   003093E5           LDR      R3,[R3, #+0]
   1402            if (cmd==0x0A)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   04308DE5           STR      R3,[SP, #+4]
   \   00000028   0100001A           BNE      ??link_box_ghook_1
   1403            {
   1404              DisableIDLETMR();
   \   0000002C   7F0100EF           SWI      +383
   \   00000030   3380BDE8           POP      {R0,R1,R4,R5,PC}
   1405            }
   1406            if (cmd==7)
   \                     ??link_box_ghook_1:
   \   00000034   070051E3           CMP      R1,#+7
   \   00000038   3380BD18           POPNE    {R0,R1,R4,R5,PC}
   1407            {
   1408              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000003C   0020A0E3           MOV      R2,#+0
   \   00000040   0D10A0E1           MOV      R1,SP
   \   00000044   680100EF           SWI      +360
   1409            }
   1410          }
   \   00000048   3380BDE8           POP      {R0,R1,R4,R5,PC}  ;; return
   \                     ??link_box_ghook_0:
   \   0000004C   ........           DC32     `?<Constant {4095, 0, 0}>`
   1411          

   \                                 In segment CODE, align 4, keep-with-next
   1412          static int link_box_onkey(GUI *data, GUI_MSG *msg)
   1413          {
   1414            if (msg->keys==0xFFF)
   \                     link_box_onkey:
   \   00000000   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000004   FF10A0E3           MOV      R1,#+255
   \   00000008   F01E81E3           ORR      R1,R1,#0xF00
   \   0000000C   010050E1           CMP      R0,R1
   1415            {
   1416              return (0xFF);
   \   00000010   FF00A003           MOVEQ    R0,#+255
   \   00000014   1EFF2F01           BXEQ     LR
   1417            }
   1418            return (0);
   \   00000018   0000A0E3           MOV      R0,#+0
   \   0000001C   1EFF2FE1           BX       LR               ;; return
   1419          }
   1420          

   \                                 In segment DATA_C, align 4, align-sorted
   1421          static const INPUTDIA_DESC link_box_desc =
   \                     link_box_desc:
   \   00000000   01000000....       DC32 1, link_box_onkey, link_box_ghook, link_box_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 link_box_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1422          {
   1423            1,
   1424            link_box_onkey,
   1425            link_box_ghook,
   1426            (void *)link_box_locret,
   1427            0,
   1428            &link_box_menu_skt,
   1429            {0,0,0,0},
   1430            FONT_SMALL,
   1431            100,
   1432            101,
   1433            0,
   1434            //  0x00000001 - Выровнять по правому краю
   1435            //  0x00000002 - Выровнять по центру
   1436            //  0x00000004 - Инверсия знакомест
   1437            //  0x00000008 - UnderLine
   1438            //  0x00000020 - Не переносить слова
   1439            //  0x00000200 - bold
   1440            0,
   1441            //  0x00000002 - ReadOnly
   1442            //  0x00000004 - Не двигается курсор
   1443            //  0x40000000 - Поменять местами софт-кнопки
   1444            0x40000000
   1445          };
   1446          

   \                                 In segment CODE, align 4, keep-with-next
   1447          int ShowLink(char *link)
   1448          {
   \                     ShowLink:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0040A0E1           MOV      R4,R0
   1449            
   1450            void *ma=malloc_adr();
   \   0000000C   148000EF           SWI      +32788
   \   00000010   0050A0E1           MOV      R5,R0
   1451            void *eq;
   1452            EDITCONTROL ec;
   1453            WSHDR* wslink = AllocWS(512);
   \   00000014   800FA0E3           MOV      R0,#+512
   \   00000018   250100EF           SWI      +293
   \   0000001C   0060A0E1           MOV      R6,R0
   1454            ascii2ws(wslink, link);
   \   00000020   0410A0E1           MOV      R1,R4
   \   00000024   ........           _BLF     ascii2ws,??ascii2ws??rA
   1455            
   1456            eq=AllocEQueue(ma,mfree_adr());
   \   00000028   158000EF           SWI      +32789
   \   0000002C   0010A0E1           MOV      R1,R0
   \   00000030   0500A0E1           MOV      R0,R5
   \   00000034   630100EF           SWI      +355
   \   00000038   0040A0E1           MOV      R4,R0
   1457            
   1458            PrepareEditControl(&ec);
   \   0000003C   0D00A0E1           MOV      R0,SP
   \   00000040   640100EF           SWI      +356
   1459            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL,wslink,512);
   \   00000044   800FA0E3           MOV      R0,#+512
   \   00000048   01002DE9           PUSH     {R0}
   \   0000004C   0630A0E1           MOV      R3,R6
   \   00000050   4020A0E3           MOV      R2,#+64
   \   00000054   0310A0E3           MOV      R1,#+3
   \   00000058   04008DE2           ADD      R0,SP,#+4
   \   0000005C   650100EF           SWI      +357
   1460            AddEditControlToEditQend(eq,&ec,ma);
   \   00000060   0520A0E1           MOV      R2,R5
   1461            FreeWS(wslink);
   1462          
   1463            patch_header(&link_box_hdr);
   \   00000064   5C509FE5           LDR      R5,??ShowLink_0  ;; link_box_menu_sk
   \   00000068   04108DE2           ADD      R1,SP,#+4
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   660100EF           SWI      +358
   \   00000074   0600A0E1           MOV      R0,R6
   1464            patch_input(&link_box_desc);
   \   00000078   4C609FE5           LDR      R6,??ShowLink_0+0x4  ;; link_box_desc
   \   0000007C   290100EF           SWI      +297
   \   00000080   180085E2           ADD      R0,R5,#+24
   \   00000084   ........           _BLF     patch_header,??patch_header??rA
   \   00000088   0600A0E1           MOV      R0,R6
   \   0000008C   ........           _BLF     patch_input,??patch_input??rA
   1465            link_box_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   \   00000090   ........           LDR      R0,??DataTable26  ;; lgpData
   1466            link_box_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1467            return CreateInputTextDialog(&link_box_desc,&link_box_hdr,eq,1,0);
   \   00000094   0130A0E3           MOV      R3,#+1
   \   00000098   641090E5           LDR      R1,[R0, #+100]
   \   0000009C   680090E5           LDR      R0,[R0, #+104]
   \   000000A0   041085E5           STR      R1,[R5, #+4]
   \   000000A4   0C0085E5           STR      R0,[R5, #+12]
   \   000000A8   0000A0E3           MOV      R0,#+0
   \   000000AC   01002DE9           PUSH     {R0}
   \   000000B0   0420A0E1           MOV      R2,R4
   \   000000B4   181085E2           ADD      R1,R5,#+24
   \   000000B8   0600A0E1           MOV      R0,R6
   \   000000BC   670100EF           SWI      +359
   \   000000C0   34D08DE2           ADD      SP,SP,#+52
   \   000000C4   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??ShowLink_0:
   \   000000C8   ........           DC32     link_box_menu_sk
   \   000000CC   ........           DC32     link_box_desc
   1468          }
   1469          

   \                                 In segment CODE, align 4, keep-with-next
   1470          void FindStringOnPage(VIEWDATA* cur_vd)
   1471          {
   \                     FindStringOnPage:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   1472              LineDown(cur_vd);
   1473              int i;
   1474              i = (cur_vd->lines_cache[cur_vd->view_line]).pos+1;
   1475              int j = 0;
   1476              int found = 0;
   \   00000008   0060A0E3           MOV      R6,#+0
   \   0000000C   0070A0E3           MOV      R7,#+0
   \   00000010   ........           BL       LineDown
   \   00000014   1C0094E5           LDR      R0,[R4, #+28]
   \   00000018   101094E5           LDR      R1,[R4, #+16]
   \   0000001C   000291E7           LDR      R0,[R1, +R0, LSL #+4]
   \   00000020   015080E2           ADD      R5,R0,#+1
   \   00000024   000000EA           B        ??FindStringOnPage_0
   1477              while ((i < cur_vd->rawtext_size) && (!found))
   1478              {
   1479                while ((j < wstrlen(cur_vd->search_string)) && 
   1480                       CompareWchar(cur_vd->rawtext[i+j], (cur_vd->search_string)->wsbody[1+j], cur_vd->search_isCaseSens))
   1481                  j++;
   1482                if (j == wstrlen(cur_vd->search_string))
   1483                {
   1484                  found = 1;
   \                     ??FindStringOnPage_1:
   \   00000028   0160A0E3           MOV      R6,#+1
   1485                }
   \                     ??FindStringOnPage_0:
   \   0000002C   0C0094E5           LDR      R0,[R4, #+12]
   \   00000030   000055E1           CMP      R5,R0
   \   00000034   0100002A           BCS      ??FindStringOnPage_2
   \   00000038   000056E3           CMP      R6,#+0
   \   0000003C   1200000A           BEQ      ??FindStringOnPage_3
   1486                else
   1487                {
   1488                  i += 1+j;
   1489                  j = 0;
   1490                }
   1491              }
   1492              if (found)
   \                     ??FindStringOnPage_2:
   \   00000040   000056E3           CMP      R6,#+0
   \   00000044   0C00000A           BEQ      ??FindStringOnPage_4
   1493              {
   1494                if (LineDown(cur_vd))
   \   00000048   0400A0E1           MOV      R0,R4
   \   0000004C   ........           BL       LineDown
   \   00000050   000050E3           CMP      R0,#+0
   \   00000054   0800000A           BEQ      ??FindStringOnPage_4
   1495                {
   1496                  while (((cur_vd->lines_cache[cur_vd->view_line]).pos < i) && (LineDown(cur_vd)));
   \                     ??FindStringOnPage_5:
   \   00000058   1C0094E5           LDR      R0,[R4, #+28]
   \   0000005C   101094E5           LDR      R1,[R4, #+16]
   \   00000060   000291E7           LDR      R0,[R1, +R0, LSL #+4]
   \   00000064   050050E1           CMP      R0,R5
   \   00000068   0300002A           BCS      ??FindStringOnPage_4
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   ........           BL       LineDown
   \   00000074   000050E3           CMP      R0,#+0
   \   00000078   F6FFFF1A           BNE      ??FindStringOnPage_5
   1497                }
   1498              }
   1499              LineUp(cur_vd);
   \                     ??FindStringOnPage_4:
   \   0000007C   0400A0E1           MOV      R0,R4
   \   00000080   ........           BL       LineUp
   1500          }
   \   00000084   F080BDE8           POP      {R4-R7,PC}       ;; return
   \                     ??FindStringOnPage_6:
   \   00000088   017087E2           ADD      R7,R7,#+1
   \                     ??FindStringOnPage_3:
   \   0000008C   000194E5           LDR      R0,[R4, #+256]
   \   00000090   230100EF           SWI      +291
   \   00000094   000057E1           CMP      R7,R0
   \   00000098   0B0000AA           BGE      ??FindStringOnPage_7
   \   0000009C   000194E5           LDR      R0,[R4, #+256]
   \   000000A0   083094E5           LDR      R3,[R4, #+8]
   \   000000A4   000090E5           LDR      R0,[R0, #+0]
   \   000000A8   042194E5           LDR      R2,[R4, #+260]
   \   000000AC   870080E0           ADD      R0,R0,R7, LSL #+1
   \   000000B0   F210D0E1           LDRSH    R1,[R0, #+2]
   \   000000B4   050087E0           ADD      R0,R7,R5
   \   000000B8   800083E0           ADD      R0,R3,R0, LSL #+1
   \   000000BC   F000D0E1           LDRSH    R0,[R0, #+0]
   \   000000C0   ........           _BLF     CompareWchar,??CompareWchar??rA
   \   000000C4   000050E3           CMP      R0,#+0
   \   000000C8   EEFFFF1A           BNE      ??FindStringOnPage_6
   \                     ??FindStringOnPage_7:
   \   000000CC   000194E5           LDR      R0,[R4, #+256]
   \   000000D0   230100EF           SWI      +291
   \   000000D4   000057E1           CMP      R7,R0
   \   000000D8   D2FFFF0A           BEQ      ??FindStringOnPage_1
   \   000000DC   010087E2           ADD      R0,R7,#+1
   \   000000E0   055080E0           ADD      R5,R0,R5
   \   000000E4   0070A0E3           MOV      R7,#+0
   \   000000E8   CFFFFFEA           B        ??FindStringOnPage_0

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable0:
   \   00000000   ........           DC32     scr_shift

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable1:
   \   00000000   ........           DC32     scr_shift

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable3:
   \   00000000   ........           DC32     templates_chars

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable8:
   \   00000000   ........           DC32     templates_chars

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable19:
   \   00000000   ........           DC32     goto_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable20:
   \   00000000   ........           DC32     from_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable21:
   \   00000000   ........           DC32     goto_params

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable22:
   \   00000000   ........           DC32     maincsm_id

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable23:
   \   00000000   ........           DC32     sel_STRUCT

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable25:
   \   00000000   ........           DC32     lgpData + 100

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable26:
   \   00000000   ........           DC32     lgpData

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templates_menu_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templates_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Select">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Close">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for templates_menu_header>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "\\302\\373\\341\\356\\360">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for templates_menu_struct>`:
   \   0000002C   08000000....       DC32 8, templates_menu_onkey, templates_menu_ghook, 0H
   \              ............
   \              00000000    
   \   0000003C   ............       DC32 templates_menu_softkeys, templates_menu_skt, 16
   \              ....10000000
   \   00000048   ........0000       DC32 templates_menu_iconhndl, 0H, 0H, 0
   \              000000000000
   \              00000000    

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templates_menu_skt>`:
   \   00000000   ........0000       DC32 templates_menu_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_STRUCT>`:
   \   00000000   08000000....       DC32 8, sel_menu_onkey, sel_menu_ghook, 0H, sel_softkeys, sel_skt, 16
   \              ............
   \              00000000....
   \              ............
   \              10000000    
   \   0000001C   ........0000       DC32 sel_menu_iconhndl, 0H, 0H, 0
   \              000000000000
   \              00000000    
   \                     `?<Initializer for input_box_menu_sk>`:
   \   0000002C   18000000           DC16 24, 0
   \   00000030   ........           DC32 `?<Constant "Ok">`
   \   00000034   01000000           DC16 1, 0
   \   00000038   ........           DC32 `?<Constant "Cancel">`
   \   0000003C   3D000000           DC16 61, 0
   \   00000040   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for input_box_hdr>`:
   \   00000044   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   0000004C   00000000....       DC32 0H, `?<Constant "Enter:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for sel_sk>`:
   \   00000058   18000000           DC16 24, 0
   \   0000005C   ........           DC32 `?<Constant "Select">`
   \   00000060   01000000           DC16 1, 0
   \   00000064   ........           DC32 `?<Constant "Close">`
   \   00000068   3D000000           DC16 61, 0
   \   0000006C   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for sel_HDR>`:
   \   00000070   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000078   00000000....       DC32 0H, `?<Constant "Select:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for icon_array>`:
   \   00000084   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0
   \              0000        
   \                     `?<Initializer for cur_ref>`:
   \   0000008C   00000000           DC8 0, 0, 0, 0
   \                     `?<Initializer for cur_vd>`:
   \   00000090   00000000           DC8 0, 0, 0, 0

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for txtview_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Ok">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Cancel">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for txtview_hdr>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "Text :">`, 2147483647
   \              ....FFFFFF7F

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_skt>`:
   \   00000000   ........0000       DC32 sel_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for link_box_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Ok">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Cancel">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for link_box_hdr>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "Link:">`, 2147483647
   \              ....FFFFFF7F

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Select:">`:
   \   00000000   53656C656374       DC8 "Select:"
   \              3A00        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\302\\373\\341\\356\\360">`:
   \   00000000   C2FBE1EEF000       DC8 "\302\373\341\356\360"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Close">`:
   \   00000000   436C6F736500       DC8 "Close"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Select">`:
   \   00000000   53656C656374       DC8 "Select"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_1`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_2`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "$ballet\\\\templates.txt">`:
   \   00000000   2462616C6C65       DC8 "$ballet\\templates.txt"
   \              745C74656D70
   \              6C617465732E
   \              74787400    
   \   00000016   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Link:">`:
   \   00000000   4C696E6B3A00       DC8 "Link:"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Text :">`:
   \   00000000   54657874203A       DC8 "Text :"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Enter:">`:
   \   00000000   456E7465723A       DC8 "Enter:"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Cancel">`:
   \   00000000   43616E63656C       DC8 "Cancel"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     `?<Constant "Ok">`:
   \   00000000   4F6B00             DC8 "Ok"

   Maximum stack usage in bytes:

     Function                CSTACK
     --------                ------
     ChangeMenuSelection        60
     CreateInputBox             76
     FindReference              12
     FindReferenceByBegin        0
     FindReferenceById          16
     FindReferenceFirst          4
     FindStringOnPage           20
     FreeTemplates               8
     GetFontHeight               8
     LineDown                   28
     LineUp                      0
     LoadTemplates              80
     RenderPage               1176
     SearchNextDisplayLine      36
     ShowLink                   68
     createTemplatesMenu        28
     createTextView             84
     input_box_ghook            16
     input_box_locret            0
     input_box_onkey            60
     input_box_onkey_options     8
     link_box_ghook             20
     link_box_locret             0
     link_box_onkey              0
     newCacheLine               12
     patch_header                8
     patch_input                12
     renderForm                 60
     scrollDown                 12
     scrollUp                   12
     sel_menu_ghook             12
     sel_menu_iconhndl          32
     sel_menu_onkey             20
     templates_menu_ghook        4
     templates_menu_iconhndl    24
     templates_menu_onkey       60
     txtview_ghook              20
     txtview_locret              0
     txtview_onkey               0


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     patch_header                     52
     patch_input                      68
     GetFontHeight                    40
     SearchNextDisplayLine          1080
     newCacheLine                     88
     LineDown                        220
     LineUp                           36
     scrollDown                      236
     scrollUp                         72
     renderForm                      840
     RenderPage                     3236
     FindReferenceByBegin             56
     FindReferenceFirst               52
     FindReference                    88
     FindReferenceById                88
     FreeTemplates                    56
     LoadTemplates                   276
     templates_chars                  16
     templates_menu_onkey            196
     templates_menu_ghook             36
     templates_menu_iconhndl          96
     templates_menu_softkeys          12
     templates_menu_sk                88
     templates_menu_skt                8
     createTemplatesMenu              96
     input_box_menu_skt                8
     input_box_ghook                 124
     input_box_locret                  4
     input_box_onkey_options          80
     input_box_onkey                 340
     input_box_desc                   56
     CreateInputBox                  236
     txtview_menu_skt                  8
     txtview_ghook                    80
     txtview_locret                    4
     txtview_onkey                    32
     txtview_desc                     56
     createTextView                  264
     sel_menu_onkey                  356
     sel_menu_ghook                   64
     sel_menu_iconhndl               224
     sel_STRUCT                      148
     txtview_menu_sk                  44
     sel_softkeys                     12
     sel_skt                           8
     ChangeMenuSelection             480
     link_box_menu_skt                 8
     link_box_menu_sk                 44
     link_box_locret                   4
     link_box_ghook                   80
     link_box_onkey                   32
     link_box_desc                    56
     ShowLink                        208
     FindStringOnPage                236
     ??DataTable0                      4
     ??DataTable1                      4
     ??DataTable3                      4
     ??DataTable8                      4
     ??DataTable19                     4
     ??DataTable20                     4
     ??DataTable21                     4
     ??DataTable22                     4
     ??DataTable23                     4
     ??DataTable25                     4
     ??DataTable26                     4
     ?<Initializer for templates_menu_softkeys>
                                      12
     ?<Initializer for templates_menu_sk>
                                      88
     ?<Initializer for templates_menu_skt>
                                       8
     ?<Initializer for sel_STRUCT>   148
     ?<Initializer for txtview_menu_sk>
                                      44
     ?<Initializer for sel_softkeys>
                                      12
     ?<Initializer for sel_skt>        8
     ?<Initializer for link_box_menu_sk>
                                      44
     ?<Constant "Select:">             8
     ?<Constant "\302\373\341\356\360">
                                       8
     ?<Constant "Close">               8
     ?<Constant "Select">              8
     ?<Constant {4095, 0, 0}>          8
     ?<Constant {4095, 0, 0}>_1        8
     ?<Constant {4095, 0, 0}>_2        8
     ?<Constant "$ballet\\templates.txt">
                                      24
     ?<Constant "Link:">               8
     ?<Constant "Text :">              8
     ?<Constant "Enter:">              8
     ?<Constant "Cancel">              8
     ?<Constant "Ok">                  3
      Others                         316

 
 10 192 bytes in segment CODE
    307 bytes in segment DATA_C
    364 bytes in segment DATA_I
    364 bytes in segment DATA_ID
     16 bytes in segment DATA_Z
     24 bytes in segment INITTAB
 
 9 780 bytes of CODE  memory (+ 436 bytes shared)
   671 bytes of CONST memory
   380 bytes of DATA  memory

Errors: none
Warnings: none
