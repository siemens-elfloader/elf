##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    07/Nov/2009  17:56:57 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  D:\pasha\elf\SVN2\BalletMini\mainmenu.c              #
#    Command line    =  D:\pasha\elf\SVN2\BalletMini\mainmenu.c -D NEWSGOLD  #
#                       -D ELKA -lC D:\pasha\elf\SVN2\BalletMini\Release_ELK #
#                       A\List\ -o D:\pasha\elf\SVN2\BalletMini\Release_ELKA #
#                       \Obj\ -s9 --no_unroll --no_inline --cpu_mode arm     #
#                       --endian little --cpu ARM926EJ-S --stack_align 4     #
#                       --interwork -e --fpu None --dlib_config              #
#                       "D:\pasha\Embedded Workbench 4.0                     #
#                       Evaluation2\ARM\LIB\dl5tpainl8n.h" -I                #
#                       "D:\pasha\Embedded Workbench 4.0                     #
#                       Evaluation2\ARM\INC\"                                #
#    List file       =  D:\pasha\elf\SVN2\BalletMini\Release_ELKA\List\mainm #
#                       enu.lst                                              #
#    Object file     =  D:\pasha\elf\SVN2\BalletMini\Release_ELKA\Obj\mainme #
#                       nu.r79                                               #
#                                                                            #
#                                                                            #
##############################################################################

D:\pasha\elf\SVN2\BalletMini\mainmenu.c
      1          #include "..\inc\swilib.h"
      2          #include "rect_patcher.h"

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_header(HEADER_DESC const *)
   \                     patch_header:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B000C4E1           STRH     R0,[R4, #+0]
   \   00000010   1800A0E3           MOV      R0,#+24
   \   00000014   B200C4E1           STRH     R0,[R4, #+2]
   \   00000018   888100EF           SWI      +33160
   \   0000001C   010040E2           SUB      R0,R0,#+1
   \   00000020   B400C4E1           STRH     R0,[R4, #+4]
   \   00000024   8A8100EF           SWI      +33162
   \   00000028   170080E2           ADD      R0,R0,#+23
   \   0000002C   B600C4E1           STRH     R0,[R4, #+6]
   \   00000030   1080BDE8           POP      {R4,PC}          ;; return

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_input(INPUTDIA_DESC const *)
   \                     patch_input:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B801C4E1           STRH     R0,[R4, #+24]
   \   00000010   8A8100EF           SWI      +33162
   \   00000014   190080E2           ADD      R0,R0,#+25
   \   00000018   BA01C4E1           STRH     R0,[R4, #+26]
   \   0000001C   888100EF           SWI      +33160
   \   00000020   010040E2           SUB      R0,R0,#+1
   \   00000024   BC01C4E1           STRH     R0,[R4, #+28]
   \   00000028   898100EF           SWI      +33161
   \   0000002C   0050A0E1           MOV      R5,R0
   \   00000030   8B8100EF           SWI      +33163
   \   00000034   000045E0           SUB      R0,R5,R0
   \   00000038   010040E2           SUB      R0,R0,#+1
   \   0000003C   BE01C4E1           STRH     R0,[R4, #+30]
   \   00000040   3080BDE8           POP      {R4,R5,PC}       ;; return

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_header_small(HEADER_DESC *)
   \                     patch_header_small:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0300A0E3           MOV      R0,#+3
   \   0000000C   B000C4E1           STRH     R0,[R4, #+0]
   \   00000010   888100EF           SWI      +33160
   \   00000014   060040E2           SUB      R0,R0,#+6
   \   00000018   B400C4E1           STRH     R0,[R4, #+4]
   \   0000001C   3B00A0E3           MOV      R0,#+59
   \   00000020   B200C4E1           STRH     R0,[R4, #+2]
   \   00000024   5D00A0E3           MOV      R0,#+93
   \   00000028   B600C4E1           STRH     R0,[R4, #+6]
   \   0000002C   1080BDE8           POP      {R4,PC}          ;; return
      3          #include "view.h"
      4          #include "main.h"
      5          #include "string_works.h"
      6          #include "mainmenu.h"
      7          #include "conf_loader.h"
      8          #include "urlstack.h"
      9          #include "history.h"
     10          #include "file_works.h"
     11          #include "lang.h"
     12          #include "url_utils.h"
     13          #include "display_utils.h"
     14          
     15          extern int view_url_mode;
     16          extern char *view_url;
     17          extern char *goto_url;
     18          extern int maincsm_id;
     19          
     20          //----------------------------------- Add bookmark -----------------------------
     21          
     22          const char* sEmpty = "";
     23          
     24          typedef enum
     25          {
     26            IS_BACK,
     27            IS_FOLDER,
     28            IS_FILE
     29          }BListType;
     30          
     31          char * bookmarks_current_folder;
     32          
     33          typedef struct
     34          {
     35            void * next;
     36            BListType type;
     37            char * fullname;  
     38            char * name;  
     39          }BList;
     40          
     41          typedef enum
     42          {
     43            EditBookmark,
     44            CreateBookmark,
     45            RenameFolder,
     46            CreateFolder
     47          }EditBookmarkMode;
     48          
     49          EditBookmarkMode edit_mode;
     50          
     51          SOFTKEY_DESC edit_bookmark_sk[]=
     52          {
     53            {0x0018,0x0000,(int)"Add"},
     54            {0x0001,0x0000,(int)"Cancel"},
     55            {0x003D,0x0000,(int)LGP_DOIT_PIC}
     56          };
     57          

   \                                 In segment DATA_C, align 4, align-sorted
     58          static const SOFTKEYSTAB edit_bookmark_skt=
   \                     edit_bookmark_skt:
   \   00000000   ........0000       DC32 edit_bookmark_sk, 0
   \              0000        
     59          {
     60            edit_bookmark_sk,0
     61          };
     62          
     63          HEADER_DESC edit_bookmark_hdr={0,0,0,0,NULL,(int)"Bookmark...",LGP_NULL};
     64          

   \                                 In segment CODE, align 4, keep-with-next
     65          static void edit_bookmark_ghook(GUI * gui, int cmd)
     66          {
   \                     edit_bookmark_ghook:
   \   00000000   D0402DE9           PUSH     {R4,R6,R7,LR}
   \   00000004   0040A0E1           MOV      R4,R0
     67            EDITCONTROL ec;
     68            SOFTKEY_DESC sk_ok={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \   00000008   B0009FE5           LDR      R0,??edit_bookmark_ghook_0  ;; `?<Constant {4095, 0, 0}>`
   \   0000000C   3CD04DE2           SUB      SP,SP,#+60
   \   00000010   C00090E8           LDM      R0,{R6,R7}
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   C00082E8           STM      R2,{R6,R7}
   \   0000001C   ........           LDR      R2,??DataTable7  ;; lgpData
     69            SOFTKEY_DESC sk_cancel={0x0FF0,0x0000,(int)lgpData[LGP_Cancel]};
   \   00000020   086090E5           LDR      R6,[R0, #+8]
   \   00000024   64C092E5           LDR      R12,[R2, #+100]
   \   00000028   0C7090E5           LDR      R7,[R0, #+12]
   \   0000002C   04C08DE5           STR      R12,[SP, #+4]
   \   00000030   08308DE2           ADD      R3,SP,#+8
   \   00000034   C00083E8           STM      R3,{R6,R7}
   \   00000038   682092E5           LDR      R2,[R2, #+104]
     70            if (cmd == TI_CMD_FOCUS)
   \   0000003C   0A0051E3           CMP      R1,#+10
   \   00000040   0C208DE5           STR      R2,[SP, #+12]
   \   00000044   0200001A           BNE      ??edit_bookmark_ghook_1
     71            {
     72              DisableIDLETMR();
   \   00000048   7F0100EF           SWI      +383
   \   0000004C   3CD08DE2           ADD      SP,SP,#+60
   \   00000050   D080BDE8           POP      {R4,R6,R7,PC}
     73            }
     74            if (cmd == TI_CMD_REDRAW)
   \                     ??edit_bookmark_ghook_1:
   \   00000054   070051E3           CMP      R1,#+7
   \   00000058   1600001A           BNE      ??edit_bookmark_ghook_2
     75            {
     76              SetSoftKey(gui, &sk_ok, SET_SOFT_KEY_N); // Устанавливаем на правый софткей текст "OK"
   \   0000005C   0020A0E3           MOV      R2,#+0
   \   00000060   0D10A0E1           MOV      R1,SP
   \   00000064   0400A0E1           MOV      R0,R4
   \   00000068   680100EF           SWI      +360
     77              ExtractEditControl(gui, EDIT_GetFocus(gui), &ec); // Извлекаем выделенный EDITCONTROL
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   820100EF           SWI      +386
   \   00000074   10208DE2           ADD      R2,SP,#+16
   \   00000078   0010A0E1           MOV      R1,R0
   \   0000007C   0400A0E1           MOV      R0,R4
   \   00000080   690100EF           SWI      +361
     78              if (ec.pWS->wsbody[0] == 0 || EDIT_GetCursorPos(gui) == 1) // Если строка пуста или курсор в начале строки
   \   00000084   38009DE5           LDR      R0,[SP, #+56]
   \   00000088   000090E5           LDR      R0,[R0, #+0]
   \   0000008C   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000090   000050E3           CMP      R0,#+0
   \   00000094   0300000A           BEQ      ??edit_bookmark_ghook_3
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   D30100EF           SWI      +467
   \   000000A0   010050E3           CMP      R0,#+1
   \   000000A4   0300001A           BNE      ??edit_bookmark_ghook_2
     79                SetSoftKey(gui, &sk_cancel, SET_SOFT_KEY_N==0?1:0); // Ставим на левй софткей текст "Cancel"
   \                     ??edit_bookmark_ghook_3:
   \   000000A8   0120A0E3           MOV      R2,#+1
   \   000000AC   08108DE2           ADD      R1,SP,#+8
   \   000000B0   0400A0E1           MOV      R0,R4
   \   000000B4   680100EF           SWI      +360
     80            }
     81          }
   \                     ??edit_bookmark_ghook_2:
   \   000000B8   3CD08DE2           ADD      SP,SP,#+60       ;; stack cleaning
   \   000000BC   D080BDE8           POP      {R4,R6,R7,PC}    ;; return
   \                     ??edit_bookmark_ghook_0:
   \   000000C0   ........           DC32     `?<Constant {4095, 0, 0}>`
     82          

   \                                 In segment CODE, align 4, keep-with-next
     83          static void edit_bookmark_locret(void){}
   \                     edit_bookmark_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
     84          

   \                                 In segment CODE, align 4, keep-with-next
     85          char * edit_bookmark_extract_name(GUI * gui)
     86          {
   \                     edit_bookmark_extract_name:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
     87            EDITCONTROL ec;
     88            char * tmp_name;
     89            char * full_name;
     90            
     91            ExtractEditControl(gui, 2, &ec);
   \   00000008   0D20A0E1           MOV      R2,SP
   \   0000000C   0210A0E3           MOV      R1,#+2
   \   00000010   690100EF           SWI      +361
     92            if(!ec.pWS->wsbody[0]) return NULL;
   \   00000014   28009DE5           LDR      R0,[SP, #+40]
   \   00000018   000090E5           LDR      R0,[R0, #+0]
   \   0000001C   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000020   000050E3           CMP      R0,#+0
   \   00000024   2100000A           BEQ      ??edit_bookmark_extract_name_0
     93            
     94            tmp_name = (char *)malloc(ec.maxlen);
   \   00000028   F801DDE1           LDRSH    R0,[SP, #+24]
     95            ws_2str(ec.pWS, tmp_name, ec.maxlen);
     96            full_name = (char *)malloc(strlen(bookmarks_current_folder) + strlen(tmp_name) + 13);
   \   0000002C   ........           LDR      R5,??DataTable15  ;; bookmarks_menu_sk
   \   00000030   140000EF           SWI      +20
   \   00000034   F821DDE1           LDRSH    R2,[SP, #+24]
   \   00000038   0040A0E1           MOV      R4,R0
   \   0000003C   28009DE5           LDR      R0,[SP, #+40]
   \   00000040   0410A0E1           MOV      R1,R4
   \   00000044   A30000EF           SWI      +163
   \   00000048   340095E5           LDR      R0,[R5, #+52]
   \   0000004C   1B0000EF           SWI      +27
   \   00000050   0060A0E1           MOV      R6,R0
   \   00000054   0400A0E1           MOV      R0,R4
   \   00000058   1B0000EF           SWI      +27
   \   0000005C   060080E0           ADD      R0,R0,R6
   \   00000060   0D0080E2           ADD      R0,R0,#+13
   \   00000064   140000EF           SWI      +20
     97            strcpy(full_name, bookmarks_current_folder);
   \   00000068   341095E5           LDR      R1,[R5, #+52]
   \   0000006C   0060A0E1           MOV      R6,R0
   \   00000070   1A0000EF           SWI      +26
     98            if(full_name[strlen(bookmarks_current_folder)-1] != '\\')
   \   00000074   340095E5           LDR      R0,[R5, #+52]
   \   00000078   1B0000EF           SWI      +27
   \   0000007C   060080E0           ADD      R0,R0,R6
   \   00000080   010050E5           LDRB     R0,[R0, #-1]
   \   00000084   5C0050E3           CMP      R0,#+92
   \   00000088   0200000A           BEQ      ??edit_bookmark_extract_name_1
     99              strcat(full_name, "\\");
   \   0000008C   091F8FE2           ADR      R1,??edit_bookmark_extract_name_2  ;; "\\"
   \   00000090   0600A0E1           MOV      R0,R6
   \   00000094   170000EF           SWI      +23
    100            strcat(full_name, tmp_name);
   \                     ??edit_bookmark_extract_name_1:
   \   00000098   0410A0E1           MOV      R1,R4
   \   0000009C   0600A0E1           MOV      R0,R6
   \   000000A0   170000EF           SWI      +23
    101            mfree(tmp_name);
   \   000000A4   0400A0E1           MOV      R0,R4
   \   000000A8   150000EF           SWI      +21
    102            return full_name;
   \   000000AC   0600A0E1           MOV      R0,R6
   \                     ??edit_bookmark_extract_name_0:
   \   000000B0   2CD08DE2           ADD      SP,SP,#+44       ;; stack cleaning
   \   000000B4   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??edit_bookmark_extract_name_2:
   \   000000B8   5C000000           DC8      "\\",+0,+0
    103          }
    104          

   \                                 In segment CODE, align 4, keep-with-next
    105          char * edit_bookmark_extract_link(GUI * gui)
    106          {
   \                     edit_bookmark_extract_link:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   30D04DE2           SUB      SP,SP,#+48
    107            EDITCONTROL ec;
    108            char * tmp_link;
    109            char * link;
    110            int link_len;
    111            
    112            ExtractEditControl(gui, 4, &ec);
   \   00000008   04208DE2           ADD      R2,SP,#+4
   \   0000000C   0410A0E3           MOV      R1,#+4
   \   00000010   690100EF           SWI      +361
    113            if(!ec.pWS->wsbody[0]) return NULL;
   \   00000014   2C009DE5           LDR      R0,[SP, #+44]
   \   00000018   000090E5           LDR      R0,[R0, #+0]
   \   0000001C   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000020   000050E3           CMP      R0,#+0
   \   00000024   1100000A           BEQ      ??edit_bookmark_extract_link_0
    114          
    115            tmp_link = (char *)malloc(ec.maxlen);
   \   00000028   FC01DDE1           LDRSH    R0,[SP, #+28]
   \   0000002C   140000EF           SWI      +20
   \   00000030   0040A0E1           MOV      R4,R0
    116            ws_2utf8(ec.pWS, tmp_link, &link_len, 511);
   \   00000034   2C009DE5           LDR      R0,[SP, #+44]
   \   00000038   FF30A0E3           MOV      R3,#+255
   \   0000003C   403F83E3           ORR      R3,R3,#0x100
   \   00000040   0D20A0E1           MOV      R2,SP
   \   00000044   0410A0E1           MOV      R1,R4
   \   00000048   E20100EF           SWI      +482
    117            link = (char *)malloc(link_len + 1);
   \   0000004C   00009DE5           LDR      R0,[SP, #+0]
   \   00000050   010080E2           ADD      R0,R0,#+1
   \   00000054   140000EF           SWI      +20
   \   00000058   0050A0E1           MOV      R5,R0
    118            strcpy(link, tmp_link);
   \   0000005C   0410A0E1           MOV      R1,R4
   \   00000060   1A0000EF           SWI      +26
    119            mfree(tmp_link);
   \   00000064   0400A0E1           MOV      R0,R4
   \   00000068   150000EF           SWI      +21
    120            return link;
   \   0000006C   0500A0E1           MOV      R0,R5
   \                     ??edit_bookmark_extract_link_0:
   \   00000070   30D08DE2           ADD      SP,SP,#+48       ;; stack cleaning
   \   00000074   3080BDE8           POP      {R4,R5,PC}       ;; return
    121          }
    122          

   \                                 In segment CODE, align 4, keep-with-next
    123          static int edit_bookmark_onkey(GUI * gui, GUI_MSG * msg)
    124          {
   \                     edit_bookmark_onkey:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0040A0E1           MOV      R4,R0
    125            unsigned int io_error;
    126            if (msg->keys==0xFF0)
   \   0000000C   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000010   FF0E50E3           CMP      R0,#+4080
   \   00000014   0100001A           BNE      ??edit_bookmark_onkey_0
    127            {
    128              return 1;
   \                     ??edit_bookmark_onkey_1:
   \   00000018   0100A0E3           MOV      R0,#+1
   \   0000001C   F281BDE8           POP      {R1,R4-R8,PC}
    129            }
    130            if(msg->keys==0xFFF)
   \                     ??edit_bookmark_onkey_0:
   \   00000020   FF10A0E3           MOV      R1,#+255
   \   00000024   F01E81E3           ORR      R1,R1,#0xF00
   \   00000028   010050E1           CMP      R0,R1
   \   0000002C   3400001A           BNE      ??edit_bookmark_onkey_2
    131            {
    132              BList * bl = (BList *)EDIT_GetUserPointer(gui);
    133              if(edit_mode == CreateFolder || edit_mode == RenameFolder)
   \   00000030   B4619FE5           LDR      R6,??edit_bookmark_onkey_3  ;; edit_bookmark_hdr
   \   00000034   ........           LDR      R7,??DataTable7  ;; lgpData
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   DF0100EF           SWI      +479
   \   00000040   0050A0E1           MOV      R5,R0
   \   00000044   1400D6E5           LDRB     R0,[R6, #+20]
   \   00000048   030050E3           CMP      R0,#+3
   \   0000004C   02005013           CMPNE    R0,#+2
   \   00000050   1A00001A           BNE      ??edit_bookmark_onkey_4
    134              {
    135                char * name;
    136                if (!(name = edit_bookmark_extract_name(gui))) goto NO_NAME;
   \   00000054   0400A0E1           MOV      R0,R4
   \   00000058   ........           BL       edit_bookmark_extract_name
   \   0000005C   0080B0E1           MOVS     R8,R0
   \   00000060   5F00000A           BEQ      ??edit_bookmark_onkey_5
    137                if (isdir(name, &io_error))
   \   00000064   0D10A0E1           MOV      R1,SP
   \   00000068   910000EF           SWI      +145
   \   0000006C   000050E3           CMP      R0,#+0
   \   00000070   0300000A           BEQ      ??edit_bookmark_onkey_6
    138                {
    139                  mfree(name);
   \   00000074   0800A0E1           MOV      R0,R8
   \   00000078   150000EF           SWI      +21
    140                  goto SAME_FOLDER;
    141                }
    142                if(edit_mode == CreateFolder)
    143                  mkdir(name, &io_error);
    144                if(edit_mode == RenameFolder)
    145                  fmove(bl->fullname, name, &io_error);
    146                mfree(name);
    147              }
    148              if(edit_mode == CreateBookmark || edit_mode == EditBookmark)
    149              {
    150                char * name;
    151                char * url;
    152                if (!(name = edit_bookmark_extract_name(gui))) goto NO_NAME;
    153                if (!(url = edit_bookmark_extract_link(gui)))
    154                {
    155                  mfree(name);
    156                  goto NO_URL;
    157                }
    158                strcat(name, ".url");
    159                if (edit_mode == CreateBookmark || strcmp(bl->fullname, name) != 0)
    160                {
    161                  if (ballet_fexists(name))
    162                  {
    163                    mfree(name);
    164                    mfree(url);
    165                    goto SAME_FILE;
    166                  }
    167                }
    168                if(edit_mode == EditBookmark)
    169                  unlink(bl->fullname, &io_error);
    170                int hFile = fopen(name, A_WriteOnly + A_Create + A_BIN, P_WRITE, &io_error);
    171                //url = ToWeb(url, 0);
    172                char * tmp_url = URL_reencode_escapes(url);
    173                fwrite(hFile, tmp_url, strlen(tmp_url), &io_error);
    174                fclose(hFile,&io_error);
    175                mfree(name);
    176                mfree(url);
    177                mfree(tmp_url);
    178              }
    179              return 1;
    180            }
    181            return 0;
    182          NO_NAME:
    183            MsgBoxError(1, (int)lgpData[LGP_EnterName]);
    184            return 0;
    185          NO_URL:
    186            MsgBoxError(1, (int)lgpData[LGP_EnterURL]);
    187            return 0;
    188          SAME_FOLDER:
    189            MsgBoxError(1, (int)lgpData[LGP_FolderExists]);
   \   0000007C   081197E5           LDR      R1,[R7, #+264]
   \   00000080   1D0000EA           B        ??edit_bookmark_onkey_7
   \                     ??edit_bookmark_onkey_6:
   \   00000084   1400D6E5           LDRB     R0,[R6, #+20]
   \   00000088   030050E3           CMP      R0,#+3
   \   0000008C   0200001A           BNE      ??edit_bookmark_onkey_8
   \   00000090   0D10A0E1           MOV      R1,SP
   \   00000094   0800A0E1           MOV      R0,R8
   \   00000098   100000EF           SWI      +16
   \                     ??edit_bookmark_onkey_8:
   \   0000009C   1400D6E5           LDRB     R0,[R6, #+20]
   \   000000A0   020050E3           CMP      R0,#+2
   \   000000A4   0300001A           BNE      ??edit_bookmark_onkey_9
   \   000000A8   080095E5           LDR      R0,[R5, #+8]
   \   000000AC   0D20A0E1           MOV      R2,SP
   \   000000B0   0810A0E1           MOV      R1,R8
   \   000000B4   8E0000EF           SWI      +142
   \                     ??edit_bookmark_onkey_9:
   \   000000B8   0800A0E1           MOV      R0,R8
   \   000000BC   150000EF           SWI      +21
   \                     ??edit_bookmark_onkey_4:
   \   000000C0   1400D6E5           LDRB     R0,[R6, #+20]
   \   000000C4   010050E3           CMP      R0,#+1
   \   000000C8   00005013           CMPNE    R0,#+0
   \   000000CC   D1FFFF1A           BNE      ??edit_bookmark_onkey_1
   \   000000D0   0400A0E1           MOV      R0,R4
   \   000000D4   ........           BL       edit_bookmark_extract_name
   \   000000D8   0080B0E1           MOVS     R8,R0
   \   000000DC   4000000A           BEQ      ??edit_bookmark_onkey_5
   \   000000E0   0400A0E1           MOV      R0,R4
   \   000000E4   ........           BL       edit_bookmark_extract_link
   \   000000E8   0040B0E1           MOVS     R4,R0
   \   000000EC   0600001A           BNE      ??edit_bookmark_onkey_10
   \   000000F0   0800A0E1           MOV      R0,R8
   \   000000F4   150000EF           SWI      +21
   \   000000F8   041197E5           LDR      R1,[R7, #+260]
   \                     ??edit_bookmark_onkey_7:
   \   000000FC   0100A0E3           MOV      R0,#+1
   \   00000100   4E0000EF           SWI      +78
   \                     ??edit_bookmark_onkey_2:
   \   00000104   0000A0E3           MOV      R0,#+0
   \   00000108   F281BDE8           POP      {R1,R4-R8,PC}
   \                     ??edit_bookmark_onkey_10:
   \   0000010C   DC109FE5           LDR      R1,??edit_bookmark_onkey_3+0x4  ;; `?<Constant ".url">`
   \   00000110   0800A0E1           MOV      R0,R8
   \   00000114   170000EF           SWI      +23
   \   00000118   1400D6E5           LDRB     R0,[R6, #+20]
   \   0000011C   010050E3           CMP      R0,#+1
   \   00000120   0400000A           BEQ      ??edit_bookmark_onkey_11
   \   00000124   080095E5           LDR      R0,[R5, #+8]
   \   00000128   0810A0E1           MOV      R1,R8
   \   0000012C   190000EF           SWI      +25
   \   00000130   000050E3           CMP      R0,#+0
   \   00000134   0900000A           BEQ      ??edit_bookmark_onkey_12
   \                     ??edit_bookmark_onkey_11:
   \   00000138   0800A0E1           MOV      R0,R8
   \   0000013C   ........           _BLF     ballet_fexists,??ballet_fexists??rA
   \   00000140   000050E3           CMP      R0,#+0
   \   00000144   0500000A           BEQ      ??edit_bookmark_onkey_12
   \   00000148   0800A0E1           MOV      R0,R8
   \   0000014C   150000EF           SWI      +21
   \   00000150   0400A0E1           MOV      R0,R4
   \   00000154   150000EF           SWI      +21
    190            return 0;
    191          SAME_FILE:
    192            MsgBoxError(1, (int)lgpData[LGP_FileExists]);
   \   00000158   0C1197E5           LDR      R1,[R7, #+268]
   \   0000015C   E6FFFFEA           B        ??edit_bookmark_onkey_7
   \                     ??edit_bookmark_onkey_12:
   \   00000160   1400D6E5           LDRB     R0,[R6, #+20]
   \   00000164   000050E3           CMP      R0,#+0
   \   00000168   0200001A           BNE      ??edit_bookmark_onkey_13
   \   0000016C   080095E5           LDR      R0,[R5, #+8]
   \   00000170   0D10A0E1           MOV      R1,SP
   \   00000174   6B0100EF           SWI      +363
   \                     ??edit_bookmark_onkey_13:
   \   00000178   0D30A0E1           MOV      R3,SP
   \   0000017C   402FA0E3           MOV      R2,#+256
   \   00000180   0110A0E3           MOV      R1,#+1
   \   00000184   811C81E3           ORR      R1,R1,#0x8100
   \   00000188   0800A0E1           MOV      R0,R8
   \   0000018C   0A0000EF           SWI      +10
   \   00000190   0050A0E1           MOV      R5,R0
   \   00000194   0400A0E1           MOV      R0,R4
   \   00000198   ........           _BLF     URL_reencode_escapes,??URL_reencode_escapes??rA
   \   0000019C   0060A0E1           MOV      R6,R0
   \   000001A0   1B0000EF           SWI      +27
   \   000001A4   0D30A0E1           MOV      R3,SP
   \   000001A8   0020A0E1           MOV      R2,R0
   \   000001AC   0610A0E1           MOV      R1,R6
   \   000001B0   0500A0E1           MOV      R0,R5
   \   000001B4   0C0000EF           SWI      +12
   \   000001B8   0D10A0E1           MOV      R1,SP
   \   000001BC   0500A0E1           MOV      R0,R5
   \   000001C0   0D0000EF           SWI      +13
   \   000001C4   0800A0E1           MOV      R0,R8
   \   000001C8   150000EF           SWI      +21
   \   000001CC   0400A0E1           MOV      R0,R4
   \   000001D0   150000EF           SWI      +21
   \   000001D4   0600A0E1           MOV      R0,R6
   \   000001D8   150000EF           SWI      +21
   \   000001DC   0100A0E3           MOV      R0,#+1
   \   000001E0   F281BDE8           POP      {R1,R4-R8,PC}
   \                     ??edit_bookmark_onkey_5:
   \   000001E4   001197E5           LDR      R1,[R7, #+256]
   \   000001E8   C3FFFFEA           B        ??edit_bookmark_onkey_7
   \                     ??edit_bookmark_onkey_3:
   \   000001EC   ........           DC32     edit_bookmark_hdr
   \   000001F0   ........           DC32     `?<Constant ".url">`
    193            return 0;
    194          }
    195          

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "">_1`:
   \   00000000   00                 DC8 ""
   \   00000001   000000             DC8 0, 0, 0
   \   00000004   01000000....       DC32 1, edit_bookmark_onkey, edit_bookmark_ghook, edit_bookmark_locret
   \              ............
   \              ........    
   \   00000014   00000000....       DC32 0, edit_bookmark_skt
   \              ....        
   \   0000001C   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000024   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
    196          static const INPUTDIA_DESC edit_bookmark_desc =
    197          {
    198            1,
    199            edit_bookmark_onkey,
    200            edit_bookmark_ghook,
    201            (void *)edit_bookmark_locret,
    202            0,
    203            &edit_bookmark_skt,
    204            {0,0,0,0},
    205            FONT_SMALL,
    206            100,
    207            101,
    208            0,
    209            0,
    210            0x40000000
    211          };
    212          
    213          

   \                                 In segment CODE, align 4, keep-with-next
    214          int show_edit_bookmark_menu(BList * bl, EditBookmarkMode mode)
    215          {
   \                     show_edit_bookmark_menu:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
    216            edit_mode = mode;
   \   00000004   F8539FE5           LDR      R5,??show_edit_bookmark_menu_0  ;; edit_bookmark_hdr
    217            void * ma = malloc_adr();
    218            void * eq = AllocEQueue(ma, mfree_adr());    // Extension
    219            MAIN_CSM * main_csm;
    220            VIEW_GUI * p;
    221            EDITCONTROL ec;
    222            const char empty_str[] = "";
   \   00000008   F8839FE5           LDR      R8,??show_edit_bookmark_menu_0+0x4  ;; `?<Constant "">_1`
   \   0000000C   60D04DE2           SUB      SP,SP,#+96
   \   00000010   0040A0E1           MOV      R4,R0
    223            WSHDR * ws = AllocWS(1024);
    224          
    225            ascii2ws(ws, lgpData[LGP_NameHeader]);
   \   00000014   ........           LDR      R10,??DataTable7  ;; lgpData
    226            PrepareEditControl(&ec);
    227            ConstructEditControl(&ec, ECT_HEADER, ECF_APPEND_EOL, ws, wstrlen(ws));
    228            AddEditControlToEditQend(eq,&ec,ma);
    229            
    230            switch(edit_mode)
   \   00000018   ........           LDR      R11,??DataTable4  ;; maincsm_id
   \   0000001C   1410C5E5           STRB     R1,[R5, #+20]
   \   00000020   148000EF           SWI      +32788
   \   00000024   0060A0E1           MOV      R6,R0
   \   00000028   158000EF           SWI      +32789
   \   0000002C   0010A0E1           MOV      R1,R0
   \   00000030   0600A0E1           MOV      R0,R6
   \   00000034   630100EF           SWI      +355
   \   00000038   0010D8E5           LDRB     R1,[R8, #0]
   \   0000003C   0070A0E1           MOV      R7,R0
   \   00000040   04008DE2           ADD      R0,SP,#+4
   \   00000044   0010C0E5           STRB     R1,[R0, #+0]
   \   00000048   400EA0E3           MOV      R0,#+1024
   \   0000004C   250100EF           SWI      +293
   \   00000050   70109AE5           LDR      R1,[R10, #+112]
   \   00000054   0090A0E1           MOV      R9,R0
   \   00000058   ........           _BLF     ascii2ws,??ascii2ws??rA
   \   0000005C   0C008DE2           ADD      R0,SP,#+12
   \   00000060   640100EF           SWI      +356
   \   00000064   0900A0E1           MOV      R0,R9
   \   00000068   230100EF           SWI      +291
   \   0000006C   01002DE9           PUSH     {R0}
   \   00000070   0930A0E1           MOV      R3,R9
   \   00000074   4020A0E3           MOV      R2,#+64
   \   00000078   0110A0E3           MOV      R1,#+1
   \   0000007C   10008DE2           ADD      R0,SP,#+16
   \   00000080   650100EF           SWI      +357
   \   00000084   0620A0E1           MOV      R2,R6
   \   00000088   10108DE2           ADD      R1,SP,#+16
   \   0000008C   0700A0E1           MOV      R0,R7
   \   00000090   660100EF           SWI      +358
   \   00000094   1400D5E5           LDRB     R0,[R5, #+20]
   \   00000098   04D08DE2           ADD      SP,SP,#+4
   \   0000009C   000050E3           CMP      R0,#+0
   \   000000A0   0300000A           BEQ      ??show_edit_bookmark_menu_1
   \   000000A4   010050E2           SUBS     R0,R0,#+1
   \   000000A8   0800000A           BEQ      ??show_edit_bookmark_menu_2
   \   000000AC   010050E2           SUBS     R0,R0,#+1
   \   000000B0   1600001A           BNE      ??show_edit_bookmark_menu_3
    231            {
    232            case EditBookmark:
    233            case RenameFolder:
    234              str_2ws(ws, bl->name, strlen(bl->name));
   \                     ??show_edit_bookmark_menu_1:
   \   000000B4   0C0094E5           LDR      R0,[R4, #+12]
   \   000000B8   1B0000EF           SWI      +27
   \   000000BC   0C1094E5           LDR      R1,[R4, #+12]
   \   000000C0   0020A0E1           MOV      R2,R0
   \   000000C4   0900A0E1           MOV      R0,R9
   \   000000C8   6C0100EF           SWI      +364
   \   000000CC   120000EA           B        ??show_edit_bookmark_menu_4
    235              break;
    236            case CreateBookmark:
    237              if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     ??show_edit_bookmark_menu_2:
   \   000000D0   00009BE5           LDR      R0,[R11, #+0]
   \   000000D4   080100EF           SWI      +264
   \   000000D8   000050E3           CMP      R0,#+0
   \   000000DC   0E00000A           BEQ      ??show_edit_bookmark_menu_4
    238              {
    239                p=FindGUIbyId(main_csm->view_id,NULL);
   \   000000E0   280090E5           LDR      R0,[R0, #+40]
   \   000000E4   0010A0E3           MOV      R1,#+0
   \   000000E8   090200EF           SWI      +521
    240                if (p->vd->title)
   \   000000EC   340090E5           LDR      R0,[R0, #+52]
   \   000000F0   E41090E5           LDR      R1,[R0, #+228]
   \   000000F4   000051E3           CMP      R1,#+0
   \   000000F8   0200000A           BEQ      ??show_edit_bookmark_menu_5
    241                  ascii2ws(ws, p->vd->title);
   \                     ??show_edit_bookmark_menu_6:
   \   000000FC   0900A0E1           MOV      R0,R9
   \   00000100   ........           _BLF     ascii2ws,??ascii2ws??rA
   \   00000104   040000EA           B        ??show_edit_bookmark_menu_4
    242                else
    243                  ascii2ws(ws, lgpData[LGP_NewBookmark]);
   \                     ??show_edit_bookmark_menu_5:
   \   00000108   9C109AE5           LDR      R1,[R10, #+156]
   \   0000010C   FAFFFFEA           B        ??show_edit_bookmark_menu_6
    244              }
    245              break;
    246            default: wsprintf(ws, empty_str);
   \                     ??show_edit_bookmark_menu_3:
   \   00000110   04108DE2           ADD      R1,SP,#+4
   \   00000114   0900A0E1           MOV      R0,R9
   \   00000118   240100EF           SWI      +292
    247            }
    248            PrepareEditControl(&ec);
   \                     ??show_edit_bookmark_menu_4:
   \   0000011C   0C008DE2           ADD      R0,SP,#+12
   \   00000120   640100EF           SWI      +356
    249            ConstructEditControl(&ec, ECT_NORMAL_TEXT, ECF_APPEND_EOL, ws, 64);
   \   00000124   4000A0E3           MOV      R0,#+64
   \   00000128   01002DE9           PUSH     {R0}
   \   0000012C   0930A0E1           MOV      R3,R9
   \   00000130   4020A0E3           MOV      R2,#+64
   \   00000134   0310A0E3           MOV      R1,#+3
   \   00000138   10008DE2           ADD      R0,SP,#+16
   \   0000013C   650100EF           SWI      +357
    250            AddEditControlToEditQend(eq,&ec,ma);
   \   00000140   0620A0E1           MOV      R2,R6
   \   00000144   10108DE2           ADD      R1,SP,#+16
   \   00000148   0700A0E1           MOV      R0,R7
   \   0000014C   660100EF           SWI      +358
    251            
    252            if(edit_mode == CreateBookmark || edit_mode == EditBookmark)
   \   00000150   1400D5E5           LDRB     R0,[R5, #+20]
   \   00000154   04D08DE2           ADD      SP,SP,#+4
   \   00000158   010050E3           CMP      R0,#+1
   \   0000015C   00005013           CMPNE    R0,#+0
   \   00000160   8900001A           BNE      ??show_edit_bookmark_menu_7
    253            {
    254              ascii2ws(ws, lgpData[LGP_LinkHeader]);
   \   00000164   74109AE5           LDR      R1,[R10, #+116]
   \   00000168   0900A0E1           MOV      R0,R9
   \   0000016C   ........           _BLF     ascii2ws,??ascii2ws??rA
    255              PrepareEditControl(&ec);
   \   00000170   0C008DE2           ADD      R0,SP,#+12
   \   00000174   640100EF           SWI      +356
    256              ConstructEditControl(&ec, ECT_HEADER, ECF_APPEND_EOL, ws, wstrlen(ws));
   \   00000178   0900A0E1           MOV      R0,R9
   \   0000017C   230100EF           SWI      +291
   \   00000180   01002DE9           PUSH     {R0}
   \   00000184   0930A0E1           MOV      R3,R9
   \   00000188   4020A0E3           MOV      R2,#+64
   \   0000018C   0110A0E3           MOV      R1,#+1
   \   00000190   10008DE2           ADD      R0,SP,#+16
   \   00000194   650100EF           SWI      +357
    257              AddEditControlToEditQend(eq,&ec,ma);
   \   00000198   0620A0E1           MOV      R2,R6
   \   0000019C   10108DE2           ADD      R1,SP,#+16
   \   000001A0   0700A0E1           MOV      R0,R7
   \   000001A4   660100EF           SWI      +358
    258              
    259              if (edit_mode == CreateBookmark) // Add new bookmark
   \   000001A8   1400D5E5           LDRB     R0,[R5, #+20]
   \   000001AC   04D08DE2           ADD      SP,SP,#+4
   \   000001B0   010050E3           CMP      R0,#+1
   \   000001B4   3C00001A           BNE      ??show_edit_bookmark_menu_8
    260              {
    261                if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \   000001B8   00009BE5           LDR      R0,[R11, #+0]
   \   000001BC   080100EF           SWI      +264
   \   000001C0   000050E3           CMP      R0,#+0
   \   000001C4   6100000A           BEQ      ??show_edit_bookmark_menu_9
    262                {
    263                  p=FindGUIbyId(main_csm->view_id,NULL);
   \   000001C8   280090E5           LDR      R0,[R0, #+40]
   \   000001CC   0010A0E3           MOV      R1,#+0
   \   000001D0   090200EF           SWI      +521
    264                  if (p->vd->pageurl)
   \   000001D4   340090E5           LDR      R0,[R0, #+52]
   \   000001D8   E01090E5           LDR      R1,[R0, #+224]
   \   000001DC   000051E3           CMP      R1,#+0
   \   000001E0   1300000A           BEQ      ??show_edit_bookmark_menu_10
    265                  {
    266                    char * url_start;
    267                    for(url_start = p->vd->pageurl; *url_start && *url_start != '/'; url_start++);
   \   000001E4   01B0A0E1           MOV      R11,R1
   \   000001E8   000000EA           B        ??show_edit_bookmark_menu_11
   \                     ??show_edit_bookmark_menu_12:
   \   000001EC   01B08BE2           ADD      R11,R11,#+1
   \                     ??show_edit_bookmark_menu_11:
   \   000001F0   0000DBE5           LDRB     R0,[R11, #+0]
   \   000001F4   000050E3           CMP      R0,#+0
   \   000001F8   2F005013           CMPNE    R0,#+47
   \   000001FC   FAFFFF1A           BNE      ??show_edit_bookmark_menu_12
    268                    for(; *url_start && *url_start == '/'; url_start++);
   \                     ??show_edit_bookmark_menu_13:
   \   00000200   0000DBE5           LDRB     R0,[R11, #+0]
   \   00000204   000050E3           CMP      R0,#+0
   \   00000208   0200000A           BEQ      ??show_edit_bookmark_menu_14
   \   0000020C   2F0050E3           CMP      R0,#+47
   \   00000210   01B08B02           ADDEQ    R11,R11,#+1
   \   00000214   F9FFFF0A           BEQ      ??show_edit_bookmark_menu_13
    269                    utf8_2ws(ws, url_start, strlen(url_start));
   \                     ??show_edit_bookmark_menu_14:
   \   00000218   0B00A0E1           MOV      R0,R11
   \   0000021C   1B0000EF           SWI      +27
   \   00000220   0020A0E1           MOV      R2,R0
   \   00000224   0B10A0E1           MOV      R1,R11
   \   00000228   0900A0E1           MOV      R0,R9
   \   0000022C   E30100EF           SWI      +483
   \   00000230   460000EA           B        ??show_edit_bookmark_menu_9
    270                  }
    271                  else // url не загружен
    272                  {
    273                    switch(view_url_mode)
   \                     ??show_edit_bookmark_menu_10:
   \   00000234   ........           LDR      R0,??DataTable12  ;; view_url
   \   00000238   00B090E5           LDR      R11,[R0, #+0]
   \   0000023C   ........           LDR      R0,??DataTable6  ;; view_url_mode
   \   00000240   000090E5           LDR      R0,[R0, #+0]
   \   00000244   000050E3           CMP      R0,#+0
   \   00000248   0200000A           BEQ      ??show_edit_bookmark_menu_15
   \   0000024C   010050E2           SUBS     R0,R0,#+1
   \   00000250   0600000A           BEQ      ??show_edit_bookmark_menu_16
   \   00000254   100000EA           B        ??show_edit_bookmark_menu_17
    274                    {
    275                    case MODE_FILE:
    276                      str_2ws(ws, view_url, 255);
   \                     ??show_edit_bookmark_menu_15:
   \   00000258   FF20A0E3           MOV      R2,#+255
   \   0000025C   0B10A0E1           MOV      R1,R11
   \   00000260   0900A0E1           MOV      R0,R9
   \   00000264   6C0100EF           SWI      +364
   \   00000268   380000EA           B        ??show_edit_bookmark_menu_9
    277                      break;
    278                    case MODE_URL:
    279                      {
    280                        char * url_start;
    281                        for(url_start = view_url; *url_start && *url_start != '/'; url_start++);
   \                     ??show_edit_bookmark_menu_18:
   \   0000026C   01B08BE2           ADD      R11,R11,#+1
   \                     ??show_edit_bookmark_menu_16:
   \   00000270   0000DBE5           LDRB     R0,[R11, #+0]
   \   00000274   000050E3           CMP      R0,#+0
   \   00000278   2F005013           CMPNE    R0,#+47
   \   0000027C   FAFFFF1A           BNE      ??show_edit_bookmark_menu_18
    282                        for(; *url_start && *url_start == '/'; url_start++);
   \                     ??show_edit_bookmark_menu_19:
   \   00000280   0000DBE5           LDRB     R0,[R11, #+0]
   \   00000284   000050E3           CMP      R0,#+0
   \   00000288   E2FFFF0A           BEQ      ??show_edit_bookmark_menu_14
   \   0000028C   2F0050E3           CMP      R0,#+47
   \   00000290   E0FFFF1A           BNE      ??show_edit_bookmark_menu_14
   \   00000294   01B08BE2           ADD      R11,R11,#+1
   \   00000298   F8FFFFEA           B        ??show_edit_bookmark_menu_19
    283                        utf8_2ws(ws, url_start, strlen(url_start));
    284                      }
    285                      break;
    286                    default:
    287                      ascii2ws(ws, lgpData[LGP_Absent]);
   \                     ??show_edit_bookmark_menu_17:
   \   0000029C   A4109AE5           LDR      R1,[R10, #+164]
   \   000002A0   0900A0E1           MOV      R0,R9
   \   000002A4   ........           _BLF     ascii2ws,??ascii2ws??rA
   \   000002A8   280000EA           B        ??show_edit_bookmark_menu_9
    288                      break;
    289                    }
    290                  }
    291                }
    292              }
    293              else // Edit exists bookmark
    294              {
    295                // read url file
    296                int hFile;
    297                unsigned int io_error;
    298                FSTATS fstat;
    299                if (GetFileStats(bl->fullname, &fstat, &io_error) != -1)
   \                     ??show_edit_bookmark_menu_8:
   \   000002AC   080094E5           LDR      R0,[R4, #+8]
   \   000002B0   00B0E0E3           MVN      R11,#+0
   \   000002B4   0D20A0E1           MOV      R2,SP
   \   000002B8   38108DE2           ADD      R1,SP,#+56
   \   000002BC   840000EF           SWI      +132
   \   000002C0   0B0050E1           CMP      R0,R11
    300                {
    301                  if (fstat.size > 0)
   \   000002C4   3C009D15           LDRNE    R0,[SP, #+60]
   \   000002C8   00005013           CMPNE    R0,#+0
   \   000002CC   F2FFFF0A           BEQ      ??show_edit_bookmark_menu_17
    302                  {
    303                    if ((hFile = fopen(bl->fullname, A_ReadOnly + A_BIN, P_READ, &io_error)) != -1)
   \   000002D0   080094E5           LDR      R0,[R4, #+8]
   \   000002D4   0D30A0E1           MOV      R3,SP
   \   000002D8   8020A0E3           MOV      R2,#+128
   \   000002DC   801CA0E3           MOV      R1,#+32768
   \   000002E0   0A0000EF           SWI      +10
   \   000002E4   08008DE5           STR      R0,[SP, #+8]
   \   000002E8   0B0050E1           CMP      R0,R11
   \   000002EC   EAFFFF0A           BEQ      ??show_edit_bookmark_menu_17
    304                    {
    305                      char * url = (char *)malloc(fstat.size + 1);
   \   000002F0   3C009DE5           LDR      R0,[SP, #+60]
   \   000002F4   010080E2           ADD      R0,R0,#+1
   \   000002F8   140000EF           SWI      +20
    306                      url[fread(hFile, url, fstat.size, &io_error)] = NULL;
   \   000002FC   3C209DE5           LDR      R2,[SP, #+60]
   \   00000300   00B0A0E1           MOV      R11,R0
   \   00000304   08009DE5           LDR      R0,[SP, #+8]
   \   00000308   0D30A0E1           MOV      R3,SP
   \   0000030C   0B10A0E1           MOV      R1,R11
   \   00000310   0B0000EF           SWI      +11
   \   00000314   0010A0E3           MOV      R1,#+0
   \   00000318   0B10C0E7           STRB     R1,[R0, +R11]
    307                      fclose(hFile, &io_error);
   \   0000031C   08009DE5           LDR      R0,[SP, #+8]
   \   00000320   0D10A0E1           MOV      R1,SP
   \   00000324   0D0000EF           SWI      +13
    308                      URL_unescape(url);
   \   00000328   0B00A0E1           MOV      R0,R11
   \   0000032C   ........           _BLF     URL_unescape,??URL_unescape??rA
    309                      utf8_2ws(ws, url, strlen(url));
   \   00000330   0B00A0E1           MOV      R0,R11
   \   00000334   1B0000EF           SWI      +27
   \   00000338   0020A0E1           MOV      R2,R0
   \   0000033C   0B10A0E1           MOV      R1,R11
   \   00000340   0900A0E1           MOV      R0,R9
   \   00000344   E30100EF           SWI      +483
    310                      mfree(url);
   \   00000348   0B00A0E1           MOV      R0,R11
   \   0000034C   150000EF           SWI      +21
    311                      goto Add_link;
    312                    }
    313                  }
    314                }
    315                ascii2ws(ws, lgpData[LGP_Absent]);
    316              }
    317            Add_link:
    318              PrepareEditControl(&ec);
   \                     ??show_edit_bookmark_menu_9:
   \   00000350   0C008DE2           ADD      R0,SP,#+12
   \   00000354   640100EF           SWI      +356
    319              ConstructEditControl(&ec, ECT_NORMAL_TEXT, ECF_APPEND_EOL, ws, 511);
   \   00000358   FF00A0E3           MOV      R0,#+255
   \   0000035C   400F80E3           ORR      R0,R0,#0x100
   \   00000360   01002DE9           PUSH     {R0}
   \   00000364   0930A0E1           MOV      R3,R9
   \   00000368   4020A0E3           MOV      R2,#+64
   \   0000036C   0310A0E3           MOV      R1,#+3
   \   00000370   10008DE2           ADD      R0,SP,#+16
   \   00000374   650100EF           SWI      +357
    320              AddEditControlToEditQend(eq,&ec,ma);
   \   00000378   0620A0E1           MOV      R2,R6
   \   0000037C   10108DE2           ADD      R1,SP,#+16
   \   00000380   0700A0E1           MOV      R0,R7
   \   00000384   660100EF           SWI      +358
   \   00000388   04D08DE2           ADD      SP,SP,#+4
    321            }
    322          
    323            FreeWS(ws);
   \                     ??show_edit_bookmark_menu_7:
   \   0000038C   0900A0E1           MOV      R0,R9
   \   00000390   290100EF           SWI      +297
    324            
    325            switch(edit_mode)
   \   00000394   1400D5E5           LDRB     R0,[R5, #+20]
   \   00000398   000050E3           CMP      R0,#+0
   \   0000039C   0600000A           BEQ      ??show_edit_bookmark_menu_20
   \   000003A0   010050E2           SUBS     R0,R0,#+1
   \   000003A4   0600000A           BEQ      ??show_edit_bookmark_menu_21
   \   000003A8   010050E2           SUBS     R0,R0,#+1
   \   000003AC   0200000A           BEQ      ??show_edit_bookmark_menu_20
   \   000003B0   010050E2           SUBS     R0,R0,#+1
   \   000003B4   0400000A           BEQ      ??show_edit_bookmark_menu_22
   \   000003B8   050000EA           B        ??show_edit_bookmark_menu_23
    326            {
    327            case EditBookmark:
    328            case RenameFolder:
    329              edit_bookmark_hdr.lgp_id=(int)lgpData[LGP_Edit];
   \                     ??show_edit_bookmark_menu_20:
   \   000003BC   AC009AE5           LDR      R0,[R10, #+172]
   \   000003C0   020000EA           B        ??show_edit_bookmark_menu_24
    330              break;
    331            case CreateBookmark:
    332              edit_bookmark_hdr.lgp_id=(int)lgpData[LGP_NewBookmark];
   \                     ??show_edit_bookmark_menu_21:
   \   000003C4   9C009AE5           LDR      R0,[R10, #+156]
   \   000003C8   000000EA           B        ??show_edit_bookmark_menu_24
    333              break;
    334            case CreateFolder:
    335              edit_bookmark_hdr.lgp_id=(int)lgpData[LGP_NewFolder];
   \                     ??show_edit_bookmark_menu_22:
   \   000003CC   A0009AE5           LDR      R0,[R10, #+160]
   \                     ??show_edit_bookmark_menu_24:
   \   000003D0   0C0085E5           STR      R0,[R5, #+12]
    336              break;
    337            }
    338          
    339            patch_header(&edit_bookmark_hdr);
   \                     ??show_edit_bookmark_menu_23:
   \   000003D4   0500A0E1           MOV      R0,R5
   \   000003D8   ........           _BLF     patch_header,??patch_header??rA
    340            patch_input(&edit_bookmark_desc);
   \   000003DC   040088E2           ADD      R0,R8,#+4
   \   000003E0   ........           _BLF     patch_input,??patch_input??rA
    341            return CreateInputTextDialog(&edit_bookmark_desc, &edit_bookmark_hdr, eq, 1, bl);
   \   000003E4   10002DE9           PUSH     {R4}
   \   000003E8   0130A0E3           MOV      R3,#+1
   \   000003EC   0720A0E1           MOV      R2,R7
   \   000003F0   0510A0E1           MOV      R1,R5
   \   000003F4   040088E2           ADD      R0,R8,#+4
   \   000003F8   670100EF           SWI      +359
   \   000003FC   64D08DE2           ADD      SP,SP,#+100
   \   00000400   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??show_edit_bookmark_menu_0:
   \   00000404   ........           DC32     edit_bookmark_hdr
   \   00000408   ........           DC32     `?<Constant "">_1`
    342          }
    343          
    344          //--------------------------- Bookmarks options --------------------------------
    345          

   \                                 In segment CODE, align 4, keep-with-next
    346          void bookmarks_options_edit(GUI * data)
    347          {
   \                     bookmarks_options_edit:
   \   00000000   10402DE9           PUSH     {R4,LR}
    348            BList * bl = (BList *)MenuGetUserPointer(data);
   \   00000004   E00100EF           SWI      +480
   \   00000008   0040A0E1           MOV      R4,R0
    349            if(bl->type == IS_FILE)
   \   0000000C   0400D4E5           LDRB     R0,[R4, #+4]
   \   00000010   020050E3           CMP      R0,#+2
   \   00000014   0200001A           BNE      ??bookmarks_options_edit_0
    350              show_edit_bookmark_menu(bl, EditBookmark);
   \   00000018   0010A0E3           MOV      R1,#+0
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       show_edit_bookmark_menu
    351            if(bl->type == IS_FOLDER)
   \                     ??bookmarks_options_edit_0:
   \   00000024   0400D4E5           LDRB     R0,[R4, #+4]
   \   00000028   010050E3           CMP      R0,#+1
   \   0000002C   0200001A           BNE      ??bookmarks_options_edit_1
    352              show_edit_bookmark_menu(bl, RenameFolder);
   \   00000030   0210A0E3           MOV      R1,#+2
   \   00000034   0400A0E1           MOV      R0,R4
   \   00000038   ........           BL       show_edit_bookmark_menu
    353            GeneralFuncF1(2);
   \                     ??bookmarks_options_edit_1:
   \   0000003C   0200A0E3           MOV      R0,#+2
   \   00000040   3B0100EF           SWI      +315
    354          }
   \   00000044   1080BDE8           POP      {R4,PC}          ;; return
    355          

   \                                 In segment CODE, align 4, keep-with-next
    356          void bookmarks_options_add_bookmark(GUI *data)
    357          {
   \                     bookmarks_options_add_bookmark:
   \   00000000   00402DE9           PUSH     {LR}
    358            BList * bl = (BList *)MenuGetUserPointer(data);
   \   00000004   E00100EF           SWI      +480
    359            show_edit_bookmark_menu(bl, CreateBookmark);
   \   00000008   0110A0E3           MOV      R1,#+1
   \   0000000C   ........           BL       show_edit_bookmark_menu
    360            GeneralFuncF1(2);
   \   00000010   0200A0E3           MOV      R0,#+2
   \   00000014   3B0100EF           SWI      +315
    361          }
   \   00000018   0080BDE8           POP      {PC}             ;; return
    362          

   \                                 In segment CODE, align 4, keep-with-next
    363          void bookmarks_options_add_folder(GUI *data)
    364          {
   \                     bookmarks_options_add_folder:
   \   00000000   00402DE9           PUSH     {LR}
    365            BList * bl = (BList *)MenuGetUserPointer(data);
   \   00000004   E00100EF           SWI      +480
    366            show_edit_bookmark_menu(bl, CreateFolder);
   \   00000008   0310A0E3           MOV      R1,#+3
   \   0000000C   ........           BL       show_edit_bookmark_menu
    367            GeneralFuncF1(2);
   \   00000010   0200A0E3           MOV      R0,#+2
   \   00000014   3B0100EF           SWI      +315
    368          }
   \   00000018   0080BDE8           POP      {PC}             ;; return
    369          

   \                                 In segment CODE, align 4, keep-with-next
    370          void bookmarks_options_delete(GUI *data)
    371          {
   \                     bookmarks_options_delete:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
    372            unsigned int io_error;
    373            BList * bl = (BList *)MenuGetUserPointer(data);
   \   00000008   E00100EF           SWI      +480
   \   0000000C   0040A0E1           MOV      R4,R0
    374            if(bl->type == IS_FOLDER)
   \   00000010   0400D4E5           LDRB     R0,[R4, #+4]
   \   00000014   010050E3           CMP      R0,#+1
   \   00000018   0800001A           BNE      ??bookmarks_options_delete_0
    375            {
    376              if(!rmdir(bl->fullname, &io_error))
   \   0000001C   080094E5           LDR      R0,[R4, #+8]
   \   00000020   0D10A0E1           MOV      R1,SP
   \   00000024   8F0000EF           SWI      +143
   \   00000028   000050E3           CMP      R0,#+0
   \   0000002C   0300001A           BNE      ??bookmarks_options_delete_0
    377                MsgBoxError(1, (int)lgpData[LGP_FolderNotEmpty]);
   \   00000030   2C009FE5           LDR      R0,??bookmarks_options_delete_1  ;; lgpData + 276
   \   00000034   001090E5           LDR      R1,[R0, #+0]
   \   00000038   0100A0E3           MOV      R0,#+1
   \   0000003C   4E0000EF           SWI      +78
    378            }
    379            if(bl->type == IS_FILE)
   \                     ??bookmarks_options_delete_0:
   \   00000040   0400D4E5           LDRB     R0,[R4, #+4]
   \   00000044   020050E3           CMP      R0,#+2
   \   00000048   0200001A           BNE      ??bookmarks_options_delete_2
    380              unlink(bl->fullname, &io_error);
   \   0000004C   080094E5           LDR      R0,[R4, #+8]
   \   00000050   0D10A0E1           MOV      R1,SP
   \   00000054   6B0100EF           SWI      +363
    381            GeneralFuncF1(2);
   \                     ??bookmarks_options_delete_2:
   \   00000058   0200A0E3           MOV      R0,#+2
   \   0000005C   3B0100EF           SWI      +315
    382          }
   \   00000060   1180BDE8           POP      {R0,R4,PC}       ;; return
   \                     ??bookmarks_options_delete_1:
   \   00000064   ........           DC32     lgpData + 276
    383          
    384          #define OPTIONS_ITEMS_N 4
    385          HEADER_DESC bookmarks_options_header={0,0,0,0,NULL,(int)"Options:",LGP_NULL};
    386          
    387          MENUITEM_DESC bookmarks_options_items[OPTIONS_ITEMS_N]=
    388          {
    389            {NULL,(int)"Edit",          LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //0
    390            {NULL,(int)"Add bookmark",  LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //1
    391            {NULL,(int)"Add folder",    LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //2
    392            {NULL,(int)"Delete",        LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //3
    393          };
    394          

   \                                 In segment DATA_C, align 4, align-sorted
    395          const MENUPROCS_DESC bookmarks_options_procs[OPTIONS_ITEMS_N]=
   \                     bookmarks_options_procs:
   \   00000000   ............       DC32 bookmarks_options_edit, bookmarks_options_add_bookmark
   \              ....        
   \   00000008   ............       DC32 bookmarks_options_add_folder, bookmarks_options_delete
   \              ....        
    396          {
    397            bookmarks_options_edit,
    398            bookmarks_options_add_bookmark,
    399            bookmarks_options_add_folder,
    400            bookmarks_options_delete,
    401          };
    402          
    403          int bookmarks_options_softkeys[]={0,1,2};
    404          
    405          SOFTKEY_DESC bookmarks_options_sk[]=
    406          {
    407            {0x0018,0x0000,(int)"Select"},
    408            {0x0001,0x0000,(int)"Back"},
    409            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    410          };
    411          
    412          SOFTKEYSTAB bookmarks_options_skt=
    413          {
    414            bookmarks_options_sk,0
    415          };
    416          
    417          MENU_DESC bookmarks_options_struct=
    418          {
    419            8, NULL, NULL, NULL,
    420            bookmarks_options_softkeys,
    421            &bookmarks_options_skt,
    422            0x10,
    423            NULL,
    424            bookmarks_options_items,   //Items
    425            bookmarks_options_procs,   //Procs
    426            OPTIONS_ITEMS_N //n
    427          };
    428          

   \                                 In segment CODE, align 4, keep-with-next
    429          void show_bookmarks_options(BList * bl)
    430          {
   \                     show_bookmarks_options:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   14D04DE2           SUB      SP,SP,#+20
   \   00000008   0040B0E1           MOVS     R4,R0
    431            int to_remove[OPTIONS_ITEMS_N + 1];
    432            int n = 0;
    433            if (bl)
    434            {
    435              switch(bl->type)
   \   0000000C   0410D415           LDRBNE   R1,[R4, #+4]
   \   00000010   0000A0E3           MOV      R0,#+0
   \   00000014   00005113           CMPNE    R1,#+0
   \   00000018   0400001A           BNE      ??show_bookmarks_options_0
    436              {
    437              case IS_BACK:
    438                to_remove[++ n] = 0;
   \   0000001C   0010A0E3           MOV      R1,#+0
   \   00000020   04108DE5           STR      R1,[SP, #+4]
    439                to_remove[++ n] = 3;
   \   00000024   0200A0E3           MOV      R0,#+2
   \   00000028   0320A0E3           MOV      R2,#+3
   \   0000002C   08208DE5           STR      R2,[SP, #+8]
    440                break;
    441              }
    442            }
    443            else
    444            {
    445              to_remove[++n] = 0;
    446              to_remove[++n] = 3;
    447            }
    448            
    449            if(! bl)
   \                     ??show_bookmarks_options_0:
   \   00000030   000054E3           CMP      R4,#+0
   \   00000034   0600001A           BNE      ??show_bookmarks_options_1
    450            {
    451              to_remove[++ n] = 1;
   \   00000038   010080E2           ADD      R0,R0,#+1
   \   0000003C   0D10A0E1           MOV      R1,SP
   \   00000040   0120A0E3           MOV      R2,#+1
   \   00000044   002181E7           STR      R2,[R1, +R0, LSL #+2]
    452              to_remove[++ n] = 2;
   \   00000048   010080E2           ADD      R0,R0,#+1
   \   0000004C   0220A0E3           MOV      R2,#+2
   \   00000050   002181E7           STR      R2,[R1, +R0, LSL #+2]
    453            }
    454            to_remove[0] = n;
    455            patch_header_small((HEADER_DESC*)(&bookmarks_options_header));
   \                     ??show_bookmarks_options_1:
   \   00000054   7C509FE5           LDR      R5,??show_bookmarks_options_2  ;; bookmarks_options_items
   \   00000058   00008DE5           STR      R0,[SP, #+0]
   \   0000005C   700085E2           ADD      R0,R5,#+112
   \   00000060   ........           _BLF     patch_header_small,??patch_header_small??rA
    456            
    457            bookmarks_options_header.lgp_id=(int)lgpData[LGP_Options];
   \   00000064   ........           LDR      R0,??DataTable7  ;; lgpData
    458            
    459            bookmarks_options_items[0].lgp_id_small=(int)lgpData[LGP_Edit];
    460            bookmarks_options_items[1].lgp_id_small=(int)lgpData[LGP_NewBookmark];
    461            bookmarks_options_items[2].lgp_id_small=(int)lgpData[LGP_NewFolder];
    462            bookmarks_options_items[3].lgp_id_small=(int)lgpData[LGP_Delete];
    463            
    464            bookmarks_options_sk[0].lgp_id=(int)lgpData[LGP_Select];
    465            bookmarks_options_sk[1].lgp_id=(int)lgpData[LGP_Back];
    466            
    467            CreateMenu(1, 0, &bookmarks_options_struct, &bookmarks_options_header, 0, OPTIONS_ITEMS_N, bl, to_remove);
   \   00000068   703085E2           ADD      R3,R5,#+112
   \   0000006C   B81090E5           LDR      R1,[R0, #+184]
   \   00000070   9C2085E2           ADD      R2,R5,#+156
   \   00000074   7C1085E5           STR      R1,[R5, #+124]
   \   00000078   AC1090E5           LDR      R1,[R0, #+172]
   \   0000007C   041085E5           STR      R1,[R5, #+4]
   \   00000080   9C1090E5           LDR      R1,[R0, #+156]
   \   00000084   201085E5           STR      R1,[R5, #+32]
   \   00000088   A01090E5           LDR      R1,[R0, #+160]
   \   0000008C   3C1085E5           STR      R1,[R5, #+60]
   \   00000090   B01090E5           LDR      R1,[R0, #+176]
   \   00000094   581085E5           STR      R1,[R5, #+88]
   \   00000098   5C1090E5           LDR      R1,[R0, #+92]
   \   0000009C   B40090E5           LDR      R0,[R0, #+180]
   \   000000A0   881085E5           STR      R1,[R5, #+136]
   \   000000A4   900085E5           STR      R0,[R5, #+144]
   \   000000A8   0D00A0E1           MOV      R0,SP
   \   000000AC   01002DE9           PUSH     {R0}
   \   000000B0   10002DE9           PUSH     {R4}
   \   000000B4   0010A0E3           MOV      R1,#+0
   \   000000B8   0400A0E3           MOV      R0,#+4
   \   000000BC   01002DE9           PUSH     {R0}
   \   000000C0   0000A0E3           MOV      R0,#+0
   \   000000C4   01002DE9           PUSH     {R0}
   \   000000C8   0100A0E3           MOV      R0,#+1
   \   000000CC   520100EF           SWI      +338
    468          }
   \   000000D0   24D08DE2           ADD      SP,SP,#+36
   \   000000D4   3080BDE8           POP      {R4,R5,PC}       ;; return
   \                     ??show_bookmarks_options_2:
   \   000000D8   ........           DC32     bookmarks_options_items
    469          
    470          //------------------------------- Bookmarks menu -------------------------------
    471          
    472          volatile BList * bl_top;
    473          

   \                                 In segment CODE, align 4, keep-with-next
    474          void Free_BList(void)
    475          {
   \                     Free_BList:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    476            LockSched();
    477            BList * bl = (BList *)bl_top;
   \   00000004   ........           LDR      R4,??DataTable15  ;; bookmarks_menu_sk
   \   00000008   460100EF           SWI      +326
   \   0000000C   385094E5           LDR      R5,[R4, #+56]
    478            bl_top = NULL;
   \   00000010   0060A0E3           MOV      R6,#+0
   \   00000014   386084E5           STR      R6,[R4, #+56]
    479            UnlockSched();
   \   00000018   470100EF           SWI      +327
   \   0000001C   000055E3           CMP      R5,#+0
   \   00000020   0400000A           BEQ      ??Free_BList_0
    480            while(bl)
    481            {
    482              BList * bl_prev = bl;
   \                     ??Free_BList_1:
   \   00000024   0500A0E1           MOV      R0,R5
    483              bl = bl->next;
   \   00000028   005095E5           LDR      R5,[R5, #+0]
    484              mfree(bl_prev);
   \   0000002C   150000EF           SWI      +21
    485            }
   \   00000030   000055E3           CMP      R5,#+0
   \   00000034   FAFFFF1A           BNE      ??Free_BList_1
    486            if(bookmarks_current_folder)
   \                     ??Free_BList_0:
   \   00000038   340094E5           LDR      R0,[R4, #+52]
   \   0000003C   000050E3           CMP      R0,#+0
   \   00000040   0000000A           BEQ      ??Free_BList_2
    487              mfree(bookmarks_current_folder);
   \   00000044   150000EF           SWI      +21
    488            bookmarks_current_folder = NULL;
   \                     ??Free_BList_2:
   \   00000048   346084E5           STR      R6,[R4, #+52]
    489          }
   \   0000004C   7080BDE8           POP      {R4-R6,PC}       ;; return
    490          

   \                                 In segment CODE, align 4, keep-with-next
    491          BList * AddToFList(const char* full_name, const char *name, BListType type)
    492          {
   \                     AddToFList:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   0050A0E1           MOV      R5,R0
   \   00000008   0160A0E1           MOV      R6,R1
   \   0000000C   0270A0E1           MOV      R7,R2
    493            int l_fname;
    494            BList * bn = malloc(sizeof(BList)+(l_fname=strlen(full_name))+strlen(name)+2);
   \   00000010   1B0000EF           SWI      +27
   \   00000014   0080A0E1           MOV      R8,R0
   \   00000018   0600A0E1           MOV      R0,R6
   \   0000001C   1B0000EF           SWI      +27
   \   00000020   080080E0           ADD      R0,R0,R8
   \   00000024   120080E2           ADD      R0,R0,#+18
   \   00000028   140000EF           SWI      +20
   \   0000002C   0040A0E1           MOV      R4,R0
    495            bn->fullname=(char *)bn + sizeof(BList);
   \   00000030   100084E2           ADD      R0,R4,#+16
   \   00000034   080084E5           STR      R0,[R4, #+8]
    496            bn->name=(char *)bn+sizeof(BList)+l_fname+1;
   \   00000038   040088E0           ADD      R0,R8,R4
   \   0000003C   110080E2           ADD      R0,R0,#+17
   \   00000040   0C0084E5           STR      R0,[R4, #+12]
    497            strcpy(bn->fullname,full_name);
   \   00000044   080094E5           LDR      R0,[R4, #+8]
   \   00000048   0510A0E1           MOV      R1,R5
   \   0000004C   1A0000EF           SWI      +26
    498            strcpy(bn->name,name);
   \   00000050   0C0094E5           LDR      R0,[R4, #+12]
   \   00000054   0610A0E1           MOV      R1,R6
   \   00000058   1A0000EF           SWI      +26
    499            bn->type = type;
   \   0000005C   0470C4E5           STRB     R7,[R4, #+4]
    500            bn->next = NULL;
   \   00000060   0000A0E3           MOV      R0,#+0
   \   00000064   000084E5           STR      R0,[R4, #+0]
    501            BList * bl=(BList *)bl_top;
   \   00000068   ........           LDR      R0,??DataTable15  ;; bookmarks_menu_sk
   \   0000006C   385090E5           LDR      R5,[R0, #+56]
    502            if (bl)
   \   00000070   000055E3           CMP      R5,#+0
   \   00000074   0D00000A           BEQ      ??AddToFList_0
    503            {
    504              BList * pr =(BList *)&bl_top;
   \   00000078   386080E2           ADD      R6,R0,#+56
    505              while(strcmp_nocase(bl->name, bn->name) < 0)
   \                     ??AddToFList_1:
   \   0000007C   0C0095E5           LDR      R0,[R5, #+12]
   \   00000080   0C1094E5           LDR      R1,[R4, #+12]
   \   00000084   ........           _BLF     strcmp_nocase,??strcmp_nocase??rA
   \   00000088   000050E3           CMP      R0,#+0
   \   0000008C   0300005A           BPL      ??AddToFList_2
    506              {
    507                pr = bl;
   \   00000090   0560A0E1           MOV      R6,R5
    508                bl = bl->next;
   \   00000094   005095E5           LDR      R5,[R5, #+0]
    509                if (!bl) break;
   \   00000098   000055E3           CMP      R5,#+0
   \   0000009C   F6FFFF1A           BNE      ??AddToFList_1
    510              }
    511              bn->next = bl;
   \                     ??AddToFList_2:
   \   000000A0   005084E5           STR      R5,[R4, #+0]
    512              pr->next = bn;
   \   000000A4   004086E5           STR      R4,[R6, #+0]
   \   000000A8   0400A0E1           MOV      R0,R4
   \   000000AC   F081BDE8           POP      {R4-R8,PC}
    513            }
    514            else
    515            {
    516              bl_top = bn;
   \                     ??AddToFList_0:
   \   000000B0   384080E5           STR      R4,[R0, #+56]
    517            }
    518            return (bn);
   \   000000B4   0400A0E1           MOV      R0,R4
   \   000000B8   F081BDE8           POP      {R4-R8,PC}       ;; return
    519          }
    520          

   \                                 In segment CODE, align 4, keep-with-next
    521          int FindFiles(char * str)
    522          {
   \                     FindFiles:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
    523            DIR_ENTRY de;
    524            unsigned int err;
    525            char *rev,*s,*d;
    526            int i, c, n=0;
    527            char path[256];
    528            char name[128];
    529            
    530            strcpy(path,str);
    531            
    532            Free_BList();
    533            
    534            bookmarks_current_folder = (char *)malloc(strlen(path) + 1);
   \   00000004   ........           LDR      R5,??DataTable15  ;; bookmarks_menu_sk
    535            strcpy(bookmarks_current_folder, path);
    536          
    537            s=path;
    538            d=name;
    539            rev=0;
    540            
    541            char * bookmarks_path = getSymbolicPath("$bookmarks\\");
   \   00000008   ........           LDR      R11,??DataTable17  ;; `?<Constant "...">`
   \   0000000C   CCD04DE2           SUB      SP,SP,#+204
   \   00000010   40DE4DE2           SUB      SP,SP,#+1024
   \   00000014   0010A0E1           MOV      R1,R0
   \   00000018   D30F8DE2           ADD      R0,SP,#+844
   \   0000001C   1A0000EF           SWI      +26
   \   00000020   ........           BL       Free_BList
   \   00000024   D30F8DE2           ADD      R0,SP,#+844
   \   00000028   1B0000EF           SWI      +27
   \   0000002C   010080E2           ADD      R0,R0,#+1
   \   00000030   140000EF           SWI      +20
   \   00000034   340085E5           STR      R0,[R5, #+52]
   \   00000038   D31F8DE2           ADD      R1,SP,#+844
   \   0000003C   1A0000EF           SWI      +26
   \   00000040   D38F8DE2           ADD      R8,SP,#+844
   \   00000044   4C908DE2           ADD      R9,SP,#+76
   \   00000048   34008BE2           ADD      R0,R11,#+52
   \   0000004C   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
    542            const char back[]="...";
   \   00000050   00109BE5           LDR      R1,[R11, #0]
   \   00000054   0070A0E1           MOV      R7,R0
   \   00000058   04008DE2           ADD      R0,SP,#+4
   \   0000005C   001080E5           STR      R1,[R0, #+0]
    543            if(strcmp_nocase(bookmarks_current_folder, bookmarks_path) != 0)
   \   00000060   340095E5           LDR      R0,[R5, #+52]
   \   00000064   0040A0E3           MOV      R4,#+0
   \   00000068   409E89E2           ADD      R9,R9,#+1024
   \   0000006C   0060A0E3           MOV      R6,#+0
   \   00000070   04A0A0E1           MOV      R10,R4
   \   00000074   0710A0E1           MOV      R1,R7
   \   00000078   ........           _BLF     strcmp_nocase,??strcmp_nocase??rA
   \   0000007C   000050E3           CMP      R0,#+0
   \   00000080   0600001A           BNE      ??FindFiles_0
   \   00000084   0F0000EA           B        ??FindFiles_1
    544            {
    545              while((c=*s++))
    546              {
    547                *d++ = c;
   \                     ??FindFiles_2:
   \   00000088   ........           STRB     R0,[R9], #+1
    548                if (c == '\\' && *s != '\0')
   \   0000008C   5C0050E3           CMP      R0,#+92
   \   00000090   0200001A           BNE      ??FindFiles_0
   \   00000094   0000D8E5           LDRB     R0,[R8, #+0]
   \   00000098   000050E3           CMP      R0,#+0
    549                  rev=d;
   \   0000009C   09A0A011           MOVNE    R10,R9
    550              }
   \                     ??FindFiles_0:
   \   000000A0   ........           LDRB     R0,[R8], #+1
   \   000000A4   000050E3           CMP      R0,#+0
   \   000000A8   F6FFFF1A           BNE      ??FindFiles_2
    551              *rev = 0;
   \   000000AC   0060CAE5           STRB     R6,[R10, #+0]
    552              AddToFList(name, back, IS_BACK);
   \   000000B0   0020A0E3           MOV      R2,#+0
   \   000000B4   04108DE2           ADD      R1,SP,#+4
   \   000000B8   4C008DE2           ADD      R0,SP,#+76
   \   000000BC   400E80E2           ADD      R0,R0,#+1024
   \   000000C0   ........           BL       AddToFList
    553              n++;
   \   000000C4   0140A0E3           MOV      R4,#+1
    554            }
    555            mfree(bookmarks_path);
   \                     ??FindFiles_1:
   \   000000C8   0700A0E1           MOV      R0,R7
   \   000000CC   150000EF           SWI      +21
    556            
    557            i=strlen(path);
   \   000000D0   D30F8DE2           ADD      R0,SP,#+844
   \   000000D4   1B0000EF           SWI      +27
   \   000000D8   0070A0E1           MOV      R7,R0
    558            path[i++]='*';
   \   000000DC   D30F8DE2           ADD      R0,SP,#+844
   \   000000E0   000087E0           ADD      R0,R7,R0
   \   000000E4   2A10A0E3           MOV      R1,#+42
   \   000000E8   0010C0E5           STRB     R1,[R0, #+0]
    559            path[i]=0;
   \   000000EC   0160C0E5           STRB     R6,[R0, #+1]
    560            if (FindFirstFile(&de,path,&err))
   \   000000F0   0D20A0E1           MOV      R2,SP
   \   000000F4   D31F8DE2           ADD      R1,SP,#+844
   \   000000F8   08008DE2           ADD      R0,SP,#+8
   \   000000FC   6B0000EF           SWI      +107
   \   00000100   000050E3           CMP      R0,#+0
   \   00000104   3200000A           BEQ      ??FindFiles_3
    561            {
    562              do
    563              {
    564                i=strlen(de.folder_name);
   \                     ??FindFiles_4:
   \   00000108   3C008DE2           ADD      R0,SP,#+60
   \   0000010C   1B0000EF           SWI      +27
   \   00000110   0050A0E1           MOV      R5,R0
    565                strcpy(path,de.folder_name);
   \   00000114   3C108DE2           ADD      R1,SP,#+60
   \   00000118   D30F8DE2           ADD      R0,SP,#+844
   \   0000011C   1A0000EF           SWI      +26
    566                path[i++]='\\';
   \   00000120   D30F8DE2           ADD      R0,SP,#+844
   \   00000124   000085E0           ADD      R0,R5,R0
   \   00000128   5C50A0E3           MOV      R5,#+92
   \   0000012C   ........           STRB     R5,[R0], #+1
    567                strcpy(path+i,de.file_name);
   \   00000130   BD108DE2           ADD      R1,SP,#+189
   \   00000134   1A0000EF           SWI      +26
    568                if (de.file_attr&FA_DIRECTORY)
   \   00000138   F403DDE1           LDRSH    R0,[SP, #+52]
   \   0000013C   014084E2           ADD      R4,R4,#+1
   \   00000140   100010E3           TST      R0,#0x10
   \   00000144   0C00000A           BEQ      ??FindFiles_5
    569                {
    570                  i=strlen(path);
   \   00000148   D30F8DE2           ADD      R0,SP,#+844
   \   0000014C   1B0000EF           SWI      +27
   \   00000150   0070A0E1           MOV      R7,R0
    571                  path[i++]='\\';
   \   00000154   D30F8DE2           ADD      R0,SP,#+844
   \   00000158   000087E0           ADD      R0,R7,R0
   \   0000015C   0050C0E5           STRB     R5,[R0, #+0]
    572                  path[i]=0;
   \   00000160   0160C0E5           STRB     R6,[R0, #+1]
    573                  strcpy(name, de.file_name);
   \   00000164   BD108DE2           ADD      R1,SP,#+189
   \   00000168   4C008DE2           ADD      R0,SP,#+76
   \   0000016C   400E80E2           ADD      R0,R0,#+1024
   \   00000170   1A0000EF           SWI      +26
    574                  AddToFList(path,name,IS_FOLDER);
   \   00000174   0120A0E3           MOV      R2,#+1
   \   00000178   0C0000EA           B        ??FindFiles_6
    575                  n ++;
    576                }
    577                else
    578                {
    579                  i = strlen(de.file_name);
   \                     ??FindFiles_5:
   \   0000017C   BD008DE2           ADD      R0,SP,#+189
   \   00000180   1B0000EF           SWI      +27
   \   00000184   0070A0E1           MOV      R7,R0
    580                  strncpy(name, de.file_name, i - 4);
   \   00000188   042047E2           SUB      R2,R7,#+4
   \   0000018C   BD108DE2           ADD      R1,SP,#+189
   \   00000190   4C008DE2           ADD      R0,SP,#+76
   \   00000194   400E80E2           ADD      R0,R0,#+1024
   \   00000198   160100EF           SWI      +278
    581                  name[i - 4] = NULL;
   \   0000019C   4C008DE2           ADD      R0,SP,#+76
   \   000001A0   400E80E2           ADD      R0,R0,#+1024
   \   000001A4   000087E0           ADD      R0,R7,R0
   \   000001A8   046040E5           STRB     R6,[R0, #-4]
    582                  AddToFList(path, name, IS_FILE);
   \   000001AC   0220A0E3           MOV      R2,#+2
   \                     ??FindFiles_6:
   \   000001B0   4C108DE2           ADD      R1,SP,#+76
   \   000001B4   401E81E2           ADD      R1,R1,#+1024
   \   000001B8   D30F8DE2           ADD      R0,SP,#+844
   \   000001BC   ........           BL       AddToFList
    583                  n ++;
    584                }
    585              }
    586              while(FindNextFile(&de,&err));
   \   000001C0   0D10A0E1           MOV      R1,SP
   \   000001C4   08008DE2           ADD      R0,SP,#+8
   \   000001C8   6C0000EF           SWI      +108
   \   000001CC   000050E3           CMP      R0,#+0
   \   000001D0   CCFFFF1A           BNE      ??FindFiles_4
    587            }
    588            FindClose(&de,&err);
   \                     ??FindFiles_3:
   \   000001D4   0D10A0E1           MOV      R1,SP
   \   000001D8   08008DE2           ADD      R0,SP,#+8
   \   000001DC   6D0000EF           SWI      +109
    589            return n;
   \   000001E0   0400A0E1           MOV      R0,R4
   \   000001E4   CCD08DE2           ADD      SP,SP,#+204
   \   000001E8   40DE8DE2           ADD      SP,SP,#+1024
   \   000001EC   F08FBDE8           POP      {R4-R11,PC}      ;; return
    590          }
    591          

   \                                 In segment CODE, align 4, keep-with-next
    592          BList * FindBListByNS(int * i, BListType type)
    593          {
    594            BList * bl = (BList *)bl_top;
   \                     FindBListByNS:
   \   00000000   3C209FE5           LDR      R2,??FindBListByNS_0  ;; bookmarks_menu_sk + 56
   \   00000004   010000EA           B        ??FindBListByNS_1
    595            while(bl)
    596            {
    597              if (bl->type == type)
    598              {
    599                if (!(*i)) return (bl);
    600                (*i)--;
   \                     ??FindBListByNS_2:
   \   00000008   013043E2           SUB      R3,R3,#+1
   \   0000000C   003080E5           STR      R3,[R0, #+0]
    601              }    
    602              bl = bl->next;
   \                     ??FindBListByNS_1:
   \   00000010   002092E5           LDR      R2,[R2, #+0]
   \   00000014   000052E3           CMP      R2,#+0
   \   00000018   0700000A           BEQ      ??FindBListByNS_3
   \   0000001C   0430D2E5           LDRB     R3,[R2, #+4]
   \   00000020   010053E1           CMP      R3,R1
   \   00000024   F9FFFF1A           BNE      ??FindBListByNS_1
   \   00000028   003090E5           LDR      R3,[R0, #+0]
   \   0000002C   000053E3           CMP      R3,#+0
   \   00000030   F4FFFF1A           BNE      ??FindBListByNS_2
   \   00000034   0200A0E1           MOV      R0,R2
   \   00000038   1EFF2FE1           BX       LR
    603            }
    604            return bl;
   \                     ??FindBListByNS_3:
   \   0000003C   0000A0E3           MOV      R0,#+0
   \   00000040   1EFF2FE1           BX       LR               ;; return
   \                     ??FindBListByNS_0:
   \   00000044   ........           DC32     bookmarks_menu_sk + 56
    605          }
    606            

   \                                 In segment CODE, align 4, keep-with-next
    607          BList * FindBListByN(int n)
    608          {
   \                     FindBListByN:
   \   00000000   01402DE9           PUSH     {R0,LR}
    609            BList * bl;
    610            bl = FindBListByNS(&n, IS_BACK);   if ((!n)&&(bl)) return(bl);
   \   00000004   0010A0E3           MOV      R1,#+0
   \   00000008   0D00A0E1           MOV      R0,SP
   \   0000000C   ........           BL       FindBListByNS
   \   00000010   00109DE5           LDR      R1,[SP, #+0]
   \   00000014   000051E3           CMP      R1,#+0
   \   00000018   0100001A           BNE      ??FindBListByN_0
   \   0000001C   000050E3           CMP      R0,#+0
   \   00000020   0280BD18           POPNE    {R1,PC}
    611            bl = FindBListByNS(&n, IS_FOLDER); if ((!n)&&(bl)) return(bl);
   \                     ??FindBListByN_0:
   \   00000024   0110A0E3           MOV      R1,#+1
   \   00000028   0D00A0E1           MOV      R0,SP
   \   0000002C   ........           BL       FindBListByNS
   \   00000030   00109DE5           LDR      R1,[SP, #+0]
   \   00000034   000051E3           CMP      R1,#+0
   \   00000038   0100001A           BNE      ??FindBListByN_1
   \   0000003C   000050E3           CMP      R0,#+0
   \   00000040   0280BD18           POPNE    {R1,PC}
    612            bl = FindBListByNS(&n, IS_FILE);   if ((!n)&&(bl)) return(bl);
   \                     ??FindBListByN_1:
   \   00000044   0210A0E3           MOV      R1,#+2
   \   00000048   0D00A0E1           MOV      R0,SP
   \   0000004C   ........           BL       FindBListByNS
   \   00000050   0280BDE8           POP      {R1,PC}
    613            return bl;
    614          }
    615          

   \                                 In segment CODE, align 4, keep-with-next
    616          int bookmarks_menu_onkey(void *data, GUI_MSG *msg)
    617          {
   \                     bookmarks_menu_onkey:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    618            BList * bl = FindBListByN(GetCurMenuItem(data));
   \   0000000C   8F0100EF           SWI      +399
   \   00000010   ........           BL       FindBListByN
   \   00000014   0010A0E1           MOV      R1,R0
    619            
    620            if (msg->keys==0x3D)
   \   00000018   F200D5E1           LDRSH    R0,[R5, #+2]
   \   0000001C   3D0050E3           CMP      R0,#+61
   \   00000020   2400001A           BNE      ??bookmarks_menu_onkey_0
    621            {
    622              if (bl) 
   \   00000024   000051E3           CMP      R1,#+0
   \   00000028   2600000A           BEQ      ??bookmarks_menu_onkey_1
    623              {
    624                if (bl->type == IS_FOLDER || bl->type == IS_BACK)
   \   0000002C   080091E5           LDR      R0,[R1, #+8]
   \   00000030   0410D1E5           LDRB     R1,[R1, #+4]
   \   00000034   010051E3           CMP      R1,#+1
   \   00000038   00005113           CMPNE    R1,#+0
   \   0000003C   0900001A           BNE      ??bookmarks_menu_onkey_2
    625                {
    626                  Menu_SetItemCountDyn(data, FindFiles(bl->fullname));
   \   00000040   ........           BL       FindFiles
   \   00000044   0010A0E1           MOV      R1,R0
   \   00000048   0400A0E1           MOV      R0,R4
   \   0000004C   E60100EF           SWI      +486
    627                  SetCursorToMenuItem(data, 0);
   \   00000050   0010A0E3           MOV      R1,#+0
   \   00000054   0400A0E1           MOV      R0,R4
   \   00000058   C40100EF           SWI      +452
    628                  RefreshGUI();
   \   0000005C   960100EF           SWI      +406
    629                }
    630                else
    631                {
    632                  if (ReadUrlFile(bl->fullname))
    633                  {
    634                    int len = strlen(view_url);
    635                    _safe_free(goto_url);
    636                    goto_url = URL_reencode_escapes(view_url);
    637                    return (0xFF);
    638                  }      
    639                  return (1);
    640                }
    641              }
    642              return(-1);
   \   00000060   0000E0E3           MVN      R0,#+0
   \   00000064   3080BDE8           POP      {R4,R5,PC}
   \                     ??bookmarks_menu_onkey_2:
   \   00000068   ........           _BLF     ReadUrlFile,??ReadUrlFile??rA
   \   0000006C   000050E3           CMP      R0,#+0
   \   00000070   0E00000A           BEQ      ??bookmarks_menu_onkey_3
   \   00000074   ........           LDR      R4,??DataTable12  ;; view_url
   \   00000078   ........           LDR      R5,??DataTable24  ;; goto_url
   \   0000007C   000094E5           LDR      R0,[R4, #+0]
   \   00000080   1B0000EF           SWI      +27
   \   00000084   000095E5           LDR      R0,[R5, #+0]
   \   00000088   000050E3           CMP      R0,#+0
   \   0000008C   0100000A           BEQ      ??bookmarks_menu_onkey_4
   \   00000090   150000EF           SWI      +21
   \   00000094   0000A0E3           MOV      R0,#+0
   \                     ??bookmarks_menu_onkey_4:
   \   00000098   000085E5           STR      R0,[R5, #+0]
   \   0000009C   000094E5           LDR      R0,[R4, #+0]
   \   000000A0   ........           _BLF     URL_reencode_escapes,??URL_reencode_escapes??rA
   \   000000A4   000085E5           STR      R0,[R5, #+0]
   \   000000A8   FF00A0E3           MOV      R0,#+255
   \   000000AC   3080BDE8           POP      {R4,R5,PC}
   \                     ??bookmarks_menu_onkey_3:
   \   000000B0   0100A0E3           MOV      R0,#+1
   \   000000B4   3080BDE8           POP      {R4,R5,PC}
    643            }
    644            if (msg->keys==0x18)
   \                     ??bookmarks_menu_onkey_0:
   \   000000B8   180050E3           CMP      R0,#+24
   \   000000BC   0300001A           BNE      ??bookmarks_menu_onkey_5
    645            {
    646              show_bookmarks_options(bl);
   \   000000C0   0100A0E1           MOV      R0,R1
   \   000000C4   ........           BL       show_bookmarks_options
    647              return (-1);
   \                     ??bookmarks_menu_onkey_1:
   \   000000C8   0000E0E3           MVN      R0,#+0
   \   000000CC   3080BDE8           POP      {R4,R5,PC}
    648            }
    649            return (0);
   \                     ??bookmarks_menu_onkey_5:
   \   000000D0   0000A0E3           MOV      R0,#+0
   \   000000D4   3080BDE8           POP      {R4,R5,PC}       ;; return
    650          }
    651          
    652          int bookmarks_menu_icons[2];
    653          

   \                                 In segment CODE, align 4, keep-with-next
    654          void bookmarks_menu_ghook(void *data, int cmd)
    655          {
   \                     bookmarks_menu_ghook:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
    656            if (cmd == TI_CMD_DESTROY)
   \   00000004   ........           LDR      R5,??DataTable15  ;; bookmarks_menu_sk
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   030051E3           CMP      R1,#+3
   \   00000010   0A00001A           BNE      ??bookmarks_menu_ghook_0
    657            {
    658              for(int i = 0; i < 2; i++)
   \   00000014   0040A0E3           MOV      R4,#+0
   \                     ??bookmarks_menu_ghook_1:
   \   00000018   040185E0           ADD      R0,R5,R4, LSL #+2
   \   0000001C   2C0090E5           LDR      R0,[R0, #+44]
   \   00000020   000050E3           CMP      R0,#+0
   \   00000024   0000000A           BEQ      ??bookmarks_menu_ghook_2
    659                if (bookmarks_menu_icons[i])
    660                  mfree((void *)bookmarks_menu_icons[i]);
   \   00000028   150000EF           SWI      +21
   \                     ??bookmarks_menu_ghook_2:
   \   0000002C   014084E2           ADD      R4,R4,#+1
   \   00000030   020054E3           CMP      R4,#+2
   \   00000034   F7FFFFBA           BLT      ??bookmarks_menu_ghook_1
    661              Free_BList();   
   \   00000038   ........           BL       Free_BList
   \   0000003C   3080BDE8           POP      {R4,R5,PC}
    662            }
    663            if (cmd == TI_CMD_FOCUS)
   \                     ??bookmarks_menu_ghook_0:
   \   00000040   0A0051E3           CMP      R1,#+10
   \   00000044   3080BD18           POPNE    {R4,R5,PC}
    664            {
    665              DisableIDLETMR();
   \   00000048   7F0100EF           SWI      +383
    666              if(bookmarks_current_folder)
   \   0000004C   340095E5           LDR      R0,[R5, #+52]
   \   00000050   000050E3           CMP      R0,#+0
   \   00000054   3080BD08           POPEQ    {R4,R5,PC}
    667              {
    668                Menu_SetItemCountDyn(data, FindFiles(bookmarks_current_folder));
   \   00000058   ........           BL       FindFiles
   \   0000005C   0010A0E1           MOV      R1,R0
   \   00000060   0400A0E1           MOV      R0,R4
   \   00000064   E60100EF           SWI      +486
    669                SetCursorToMenuItem(data, 0);
   \   00000068   0010A0E3           MOV      R1,#+0
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   C40100EF           SWI      +452
    670              }
    671            }
    672          }
   \   00000074   3080BDE8           POP      {R4,R5,PC}       ;; return
    673          

   \                                 In segment CODE, align 4, keep-with-next
    674          void bookmarks_menu_iconhndl(void * data, int curitem, void * user_pointer)
    675          {
   \                     bookmarks_menu_iconhndl:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    676            WSHDR * ws;
    677            void * item = AllocMenuItem(data);
   \   0000000C   970100EF           SWI      +407
   \   00000010   0060A0E1           MOV      R6,R0
    678            BList * bl = FindBListByN(curitem);
   \   00000014   0500A0E1           MOV      R0,R5
   \   00000018   ........           BL       FindBListByN
   \   0000001C   0080B0E1           MOVS     R8,R0
    679            if (bl)
   \   00000020   1300000A           BEQ      ??bookmarks_menu_iconhndl_0
    680            {
    681              int len = strlen(bl->name);
   \   00000024   0C0098E5           LDR      R0,[R8, #+12]
   \   00000028   1B0000EF           SWI      +27
   \   0000002C   0090A0E1           MOV      R9,R0
    682              ws = AllocMenuWS(data, len + 4);
   \   00000030   041089E2           ADD      R1,R9,#+4
   \   00000034   0400A0E1           MOV      R0,R4
   \   00000038   980100EF           SWI      +408
    683              str_2ws(ws, bl->name, len);
   \   0000003C   0C1098E5           LDR      R1,[R8, #+12]
   \   00000040   0070A0E1           MOV      R7,R0
   \   00000044   0920A0E1           MOV      R2,R9
   \   00000048   6C0100EF           SWI      +364
    684              if (bl->type == IS_BACK || bl->type == IS_FOLDER)
   \   0000004C   0400D8E5           LDRB     R0,[R8, #+4]
   \   00000050   ........           LDR      R1,??DataTable15  ;; bookmarks_menu_sk
   \   00000054   000050E3           CMP      R0,#+0
   \   00000058   01005013           CMPNE    R0,#+1
   \   0000005C   2C208112           ADDNE    R2,R1,#+44
    685                SetMenuItemIconArray(data, item, &bookmarks_menu_icons[1]);
   \   00000060   30208102           ADDEQ    R2,R1,#+48
   \   00000064   0610A0E1           MOV      R1,R6
   \   00000068   0400A0E1           MOV      R0,R4
   \   0000006C   990100EF           SWI      +409
   \   00000070   070000EA           B        ??bookmarks_menu_iconhndl_1
    686              else
    687                SetMenuItemIconArray(data, item, &bookmarks_menu_icons[0]);
    688            }
    689            else
    690            {
    691              ws = AllocMenuWS(data, 10);
   \                     ??bookmarks_menu_iconhndl_0:
   \   00000074   0A10A0E3           MOV      R1,#+10
   \   00000078   0400A0E1           MOV      R0,R4
   \   0000007C   980100EF           SWI      +408
   \   00000080   0070A0E1           MOV      R7,R0
    692              ascii2ws(ws, lgpData[LGP_Error]);
   \   00000084   ........           LDR      R0,??DataTable25  ;; lgpData + 24
   \   00000088   001090E5           LDR      R1,[R0, #+0]
   \   0000008C   0700A0E1           MOV      R0,R7
   \   00000090   ........           _BLF     ascii2ws,??ascii2ws??rA
    693            }
    694            SetMenuItemText(data, item, ws, curitem);
   \                     ??bookmarks_menu_iconhndl_1:
   \   00000094   0530A0E1           MOV      R3,R5
   \   00000098   0720A0E1           MOV      R2,R7
   \   0000009C   0610A0E1           MOV      R1,R6
   \   000000A0   0400A0E1           MOV      R0,R4
   \   000000A4   9A0100EF           SWI      +410
    695          }
   \   000000A8   F083BDE8           POP      {R4-R9,PC}       ;; return
    696          
    697          int bookmarks_menu_softkeys[]={0,1,2};
    698          SOFTKEY_DESC bookmarks_menu_sk[]=
    699          {
    700            {0x0018,0x0000,(int)"Options"},
    701            {0x0001,0x0000,(int)"Back"},
    702            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    703          };
    704          
    705          SOFTKEYSTAB bookmarks_menu_skt=
    706          {
    707            bookmarks_menu_sk,0
    708          };
    709          
    710          HEADER_DESC bookmarks_menu_header={0,0,0,0,NULL,NULL,LGP_NULL};
    711          
    712          MENU_DESC bookmarks_menu_struct=
    713          {
    714            8, bookmarks_menu_onkey, bookmarks_menu_ghook, NULL,
    715            bookmarks_menu_softkeys,
    716            &bookmarks_menu_skt,
    717            0x11,
    718            bookmarks_menu_iconhndl,
    719            NULL,   //Items
    720            NULL,   //Procs
    721            0   //n
    722          };
    723          

   \                                 In segment CODE, align 4, keep-with-next
    724          int CreateBookmarksMenu()
    725          {
   \                     CreateBookmarksMenu:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    726            bookmarks_current_folder = NULL;
   \   00000004   98409FE5           LDR      R4,??CreateBookmarksMenu_0  ;; bookmarks_menu_sk
    727            char * bm_pic = getSymbolicPath("$resources\\bookmark.png");
   \   00000008   ........           LDR      R5,??DataTable17  ;; `?<Constant "...">`
   \   0000000C   0000A0E3           MOV      R0,#+0
   \   00000010   340084E5           STR      R0,[R4, #+52]
   \   00000014   1C0085E2           ADD      R0,R5,#+28
   \   00000018   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
   \   0000001C   0060A0E1           MOV      R6,R0
    728            char * dir_pic = getSymbolicPath("$resources\\folder.png");
   \   00000020   040085E2           ADD      R0,R5,#+4
   \   00000024   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
    729            bookmarks_menu_icons[0] = (int)bm_pic;
   \   00000028   2C6084E5           STR      R6,[R4, #+44]
    730            bookmarks_menu_icons[1] = (int)dir_pic;
   \   0000002C   300084E5           STR      R0,[R4, #+48]
    731            
    732            char * bookmarks_path = getSymbolicPath("$bookmarks\\");
   \   00000030   340085E2           ADD      R0,R5,#+52
   \   00000034   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
   \   00000038   0050A0E1           MOV      R5,R0
    733            patch_header(&bookmarks_menu_header);
   \   0000003C   180084E2           ADD      R0,R4,#+24
   \   00000040   ........           _BLF     patch_header,??patch_header??rA
    734            bookmarks_menu_sk[0].lgp_id=(int)lgpData[LGP_Options];
   \   00000044   ........           LDR      R0,??DataTable32  ;; lgpData
   \   00000048   B81090E5           LDR      R1,[R0, #+184]
   \   0000004C   041084E5           STR      R1,[R4, #+4]
    735            bookmarks_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   \   00000050   681090E5           LDR      R1,[R0, #+104]
    736            bookmarks_menu_header.lgp_id=(int)lgpData[LGP_SelectBookmarkHeader];
   \   00000054   BC0090E5           LDR      R0,[R0, #+188]
   \   00000058   0C1084E5           STR      R1,[R4, #+12]
   \   0000005C   240084E5           STR      R0,[R4, #+36]
    737            int gui_id = CreateMenu(0, 0, &bookmarks_menu_struct, &bookmarks_menu_header, 0, FindFiles(bookmarks_path), 0, 0);
   \   00000060   0500A0E1           MOV      R0,R5
   \   00000064   ........           BL       FindFiles
   \   00000068   0010A0E3           MOV      R1,#+0
   \   0000006C   02002DE9           PUSH     {R1}
   \   00000070   02002DE9           PUSH     {R1}
   \   00000074   01002DE9           PUSH     {R0}
   \   00000078   183084E2           ADD      R3,R4,#+24
   \   0000007C   3C2084E2           ADD      R2,R4,#+60
   \   00000080   0000A0E3           MOV      R0,#+0
   \   00000084   01002DE9           PUSH     {R0}
   \   00000088   520100EF           SWI      +338
   \   0000008C   0040A0E1           MOV      R4,R0
    738            mfree(bookmarks_path);
   \   00000090   0500A0E1           MOV      R0,R5
   \   00000094   150000EF           SWI      +21
    739            return gui_id;
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   10D08DE2           ADD      SP,SP,#+16
   \   000000A0   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??CreateBookmarksMenu_0:
   \   000000A4   ........           DC32     bookmarks_menu_sk
    740          }
    741          
    742          //--------------------------------- Search menu --------------------------------
    743          
    744          #define   MAX_SEARCH_ENGINES 32
    745          
    746          SOFTKEY_DESC search_menu_sk[]=
    747          {
    748            {0x0018,0x0000,(int)"Search"},
    749            {0x0001,0x0000,(int)"Cancel"},
    750            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    751          };
    752          

   \                                 In segment DATA_C, align 4, align-sorted
    753          static const SOFTKEYSTAB search_menu_skt=
   \                     search_menu_skt:
   \   00000000   ........0000       DC32 search_menu_sk, 0
   \              0000        
    754          {
    755            search_menu_sk,0
    756          };
    757          
    758          static int search_engine_count=0;
    759          static int selected_search_engine=0;
    760          static char * search_engines[MAX_SEARCH_ENGINES];
    761          

   \                                 In segment CODE, align 4, keep-with-next
    762          static void free_search_engines()
    763          {
   \                     free_search_engines:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    764            LockSched();
    765            char ** p=search_engines;
   \   00000004   ........           LDR      R4,??DataTable30  ;; search_menu_sk
   \   00000008   460100EF           SWI      +326
    766            for(int i=search_engine_count-1;i>=0;i--) mfree(*p++);
   \   0000000C   5C0094E5           LDR      R0,[R4, #+92]
   \   00000010   645084E2           ADD      R5,R4,#+100
   \   00000014   016050E2           SUBS     R6,R0,#+1
   \   00000018   0300004A           BMI      ??free_search_engines_0
   \                     ??free_search_engines_1:
   \   0000001C   ........           LDR      R0,[R5], #+4
   \   00000020   150000EF           SWI      +21
   \   00000024   016056E2           SUBS     R6,R6,#+1
   \   00000028   FBFFFF5A           BPL      ??free_search_engines_1
    767            search_engine_count=0;
   \                     ??free_search_engines_0:
   \   0000002C   0000A0E3           MOV      R0,#+0
   \   00000030   5C0084E5           STR      R0,[R4, #+92]
    768            UnlockSched();
   \   00000034   470100EF           SWI      +327
    769          };
   \   00000038   7080BDE8           POP      {R4-R6,PC}       ;; return
    770          

   \                                 In segment CODE, align 4, keep-with-next
    771          static void get_search_engines()
    772          {
   \                     get_search_engines:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
    773            free_search_engines();  
    774                
    775            char **sep=search_engines;
   \   00000004   ........           LDR      R4,??DataTable30  ;; search_menu_sk
    776            unsigned int err;
    777            DIR_ENTRY de;
    778            char str[128];  
    779            
    780            char * search_path = getSymbolicPath("$search\\");
   \   00000008   ........           LDR      R7,??DataTable23  ;; `?<Constant "%s%s.url">`
   \   0000000C   F2DF4DE2           SUB      SP,SP,#+968
   \   00000010   ........           BL       free_search_engines
   \   00000014   645084E2           ADD      R5,R4,#+100
   \   00000018   140087E2           ADD      R0,R7,#+20
   \   0000001C   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
   \   00000020   0060A0E1           MOV      R6,R0
    781            char * s=search_path;
    782            strcpy(str,s);
   \   00000024   0610A0E1           MOV      R1,R6
   \   00000028   D20F8DE2           ADD      R0,SP,#+840
   \   0000002C   1A0000EF           SWI      +26
    783            strcat(str,"*.url");
   \   00000030   0C1087E2           ADD      R1,R7,#+12
   \   00000034   D20F8DE2           ADD      R0,SP,#+840
   \   00000038   170000EF           SWI      +23
    784            if (FindFirstFile(&de,str,&err))
   \   0000003C   0D20A0E1           MOV      R2,SP
   \   00000040   D21F8DE2           ADD      R1,SP,#+840
   \   00000044   04008DE2           ADD      R0,SP,#+4
   \   00000048   6B0000EF           SWI      +107
   \   0000004C   000050E3           CMP      R0,#+0
   \   00000050   1B00000A           BEQ      ??get_search_engines_0
    785            {
    786              do
    787              {
    788                if (!(de.file_attr&FA_DIRECTORY))
   \                     ??get_search_engines_1:
   \   00000054   F003DDE1           LDRSH    R0,[SP, #+48]
   \   00000058   100010E3           TST      R0,#0x10
   \   0000005C   1300001A           BNE      ??get_search_engines_2
    789                {
    790                  if(search_engine_count>=MAX_SEARCH_ENGINES) break;        
   \   00000060   5C0094E5           LDR      R0,[R4, #+92]
   \   00000064   200050E3           CMP      R0,#+32
   \   00000068   150000AA           BGE      ??get_search_engines_0
    791                  int l=strlen(de.file_name); 
   \   0000006C   B9008DE2           ADD      R0,SP,#+185
   \   00000070   1B0000EF           SWI      +27
   \   00000074   0080A0E1           MOV      R8,R0
    792                  char * s=malloc(strlen(de.file_name)+1);
   \   00000078   B9008DE2           ADD      R0,SP,#+185
   \   0000007C   1B0000EF           SWI      +27
   \   00000080   010080E2           ADD      R0,R0,#+1
   \   00000084   140000EF           SWI      +20
   \   00000088   0070A0E1           MOV      R7,R0
    793                  strcpy(s,de.file_name);
   \   0000008C   B9108DE2           ADD      R1,SP,#+185
   \   00000090   1A0000EF           SWI      +26
    794                  s[l-4]=0;
   \   00000094   070088E0           ADD      R0,R8,R7
   \   00000098   0010A0E3           MOV      R1,#+0
   \   0000009C   041040E5           STRB     R1,[R0, #-4]
    795                  search_engine_count++;
   \   000000A0   5C0094E5           LDR      R0,[R4, #+92]
   \   000000A4   010080E2           ADD      R0,R0,#+1
   \   000000A8   5C0084E5           STR      R0,[R4, #+92]
    796                  *sep++=s;
   \   000000AC   ........           STR      R7,[R5], #+4
    797                }
    798              }
    799              while(FindNextFile(&de,&err));
   \                     ??get_search_engines_2:
   \   000000B0   0D10A0E1           MOV      R1,SP
   \   000000B4   04008DE2           ADD      R0,SP,#+4
   \   000000B8   6C0000EF           SWI      +108
   \   000000BC   000050E3           CMP      R0,#+0
   \   000000C0   E3FFFF1A           BNE      ??get_search_engines_1
    800            }
    801            FindClose(&de, &err);
   \                     ??get_search_engines_0:
   \   000000C4   0D10A0E1           MOV      R1,SP
   \   000000C8   04008DE2           ADD      R0,SP,#+4
   \   000000CC   6D0000EF           SWI      +109
    802            mfree(search_path);
   \   000000D0   0600A0E1           MOV      R0,R6
   \   000000D4   150000EF           SWI      +21
    803            if(selected_search_engine>=search_engine_count) selected_search_engine=search_engine_count-1;
   \   000000D8   5C0094E5           LDR      R0,[R4, #+92]
   \   000000DC   601094E5           LDR      R1,[R4, #+96]
   \   000000E0   000051E1           CMP      R1,R0
   \   000000E4   010040A2           SUBGE    R0,R0,#+1
   \   000000E8   600084A5           STRGE    R0,[R4, #+96]
    804          };
   \   000000EC   F2DF8DE2           ADD      SP,SP,#+968
   \   000000F0   F081BDE8           POP      {R4-R8,PC}       ;; return
    805          

   \                                 In segment CODE, align 4, keep-with-next
    806          void search_menu_locret(void){}
   \                     search_menu_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
    807          

   \                                 In segment CODE, align 4, keep-with-next
    808          int search_menu_onkey(GUI *data, GUI_MSG *msg)
    809          {
   \                     search_menu_onkey:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   58DF4DE2           SUB      SP,SP,#+352
    810            EDITCONTROL ec;
    811            if (msg->keys==0xFFF)
   \   00000008   F210D1E1           LDRSH    R1,[R1, #+2]
   \   0000000C   FF20A0E3           MOV      R2,#+255
   \   00000010   F02E82E3           ORR      R2,R2,#0xF00
   \   00000014   020051E1           CMP      R1,R2
   \   00000018   C500001A           BNE      ??search_menu_onkey_0
    812            {
    813              if(selected_search_engine<0)return 0;
   \   0000001C   ........           LDR      R4,??DataTable30  ;; search_menu_sk
   \   00000020   601094E5           LDR      R1,[R4, #+96]
   \   00000024   000051E3           CMP      R1,#+0
   \   00000028   C100004A           BMI      ??search_menu_onkey_0
    814          
    815              //query
    816              ExtractEditControl(data,2,&ec);
   \   0000002C   432F8DE2           ADD      R2,SP,#+268
    817              WSHDR *ws = ec.pWS;
    818              int ql=ws->wsbody[0];
    819              
    820              //read url file    
    821              int f,fsize;
    822              unsigned int err;
    823              
    824              char *s, *url;
    825              FSTATS stat;
    826              char url_file[256];
    827              
    828              char * search_path = getSymbolicPath("$search\\");
   \   00000030   ........           LDR      R5,??DataTable23  ;; `?<Constant "%s%s.url">`
   \   00000034   0210A0E3           MOV      R1,#+2
   \   00000038   690100EF           SWI      +361
   \   0000003C   34119DE5           LDR      R1,[SP, #+308]
   \   00000040   04108DE5           STR      R1,[SP, #+4]
   \   00000044   000091E5           LDR      R0,[R1, #+0]
   \   00000048   B070D0E1           LDRH     R7,[R0, #+0]
   \   0000004C   140085E2           ADD      R0,R5,#+20
   \   00000050   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
   \   00000054   0060A0E1           MOV      R6,R0
    829              const char* _ss = "%s%s.url";
    830              sprintf(url_file,_ss, search_path, search_engines[selected_search_engine]);
   \   00000058   600094E5           LDR      R0,[R4, #+96]
   \   0000005C   0620A0E1           MOV      R2,R6
   \   00000060   000184E0           ADD      R0,R4,R0, LSL #+2
   \   00000064   643090E5           LDR      R3,[R0, #+100]
   \   00000068   0510A0E1           MOV      R1,R5
   \   0000006C   0C008DE2           ADD      R0,SP,#+12
   \   00000070   160000EF           SWI      +22
    831              mfree(search_path);
   \   00000074   0600A0E1           MOV      R0,R6
   \   00000078   150000EF           SWI      +21
    832              if (GetFileStats(url_file,&stat,&err)==-1) goto fail;
   \   0000007C   0050E0E3           MVN      R5,#+0
   \   00000080   0D20A0E1           MOV      R2,SP
   \   00000084   4E1F8DE2           ADD      R1,SP,#+312
   \   00000088   0C008DE2           ADD      R0,SP,#+12
   \   0000008C   840000EF           SWI      +132
   \   00000090   050050E1           CMP      R0,R5
   \   00000094   A200000A           BEQ      ??search_menu_onkey_1
    833              if ((fsize=stat.size)<=0)  goto fail;
   \   00000098   3C419DE5           LDR      R4,[SP, #+316]
   \   0000009C   010054E3           CMP      R4,#+1
   \   000000A0   9F0000BA           BLT      ??search_menu_onkey_1
    834              if ((f=fopen(url_file,A_ReadOnly+A_BIN,P_READ,&err))==-1) goto fail;    
   \   000000A4   0D30A0E1           MOV      R3,SP
   \   000000A8   8020A0E3           MOV      R2,#+128
   \   000000AC   801CA0E3           MOV      R1,#+32768
   \   000000B0   0C008DE2           ADD      R0,SP,#+12
   \   000000B4   0A0000EF           SWI      +10
   \   000000B8   0060A0E1           MOV      R6,R0
   \   000000BC   050056E1           CMP      R6,R5
   \   000000C0   9700000A           BEQ      ??search_menu_onkey_1
    835              
    836              url=(char*)malloc(fsize+1);
   \   000000C4   010084E2           ADD      R0,R4,#+1
   \   000000C8   140000EF           SWI      +20
   \   000000CC   0050A0E1           MOV      R5,R0
    837              url[fread(f,url,fsize,&err)]=0;    
   \   000000D0   0080A0E3           MOV      R8,#+0
   \   000000D4   0D30A0E1           MOV      R3,SP
   \   000000D8   0420A0E1           MOV      R2,R4
   \   000000DC   0510A0E1           MOV      R1,R5
   \   000000E0   0600A0E1           MOV      R0,R6
   \   000000E4   0B0000EF           SWI      +11
   \   000000E8   0580C0E7           STRB     R8,[R0, +R5]
    838              fclose(f,&err);  
   \   000000EC   0D10A0E1           MOV      R1,SP
   \   000000F0   0600A0E1           MOV      R0,R6
   \   000000F4   0D0000EF           SWI      +13
    839              s=url;
   \   000000F8   0500A0E1           MOV      R0,R5
   \   000000FC   0010D0E5           LDRB     R1,[R0, #+0]
   \   00000100   210051E3           CMP      R1,#+33
   \   00000104   0200003A           BCC      ??search_menu_onkey_2
    840              while(*s>32) s++;
   \                     ??search_menu_onkey_3:
   \   00000108   0110F0E5           LDRB     R1,[R0, #+1]!
   \   0000010C   210051E3           CMP      R1,#+33
   \   00000110   FCFFFF2A           BCS      ??search_menu_onkey_3
    841              *s=0;
    842              fsize=strlen(url);
    843              
    844              //build search url
    845              _safe_free(goto_url);
   \                     ??search_menu_onkey_2:
   \   00000114   ........           LDR      R6,??DataTable24  ;; goto_url
   \   00000118   0080C0E5           STRB     R8,[R0, #+0]
   \   0000011C   0500A0E1           MOV      R0,R5
   \   00000120   1B0000EF           SWI      +27
   \   00000124   0040A0E1           MOV      R4,R0
   \   00000128   000096E5           LDR      R0,[R6, #+0]
   \   0000012C   000050E3           CMP      R0,#+0
   \   00000130   0000000A           BEQ      ??search_menu_onkey_4
   \   00000134   150000EF           SWI      +21
    846              goto_url=malloc(2+fsize+6*ql+2);    
   \                     ??search_menu_onkey_4:
   \   00000138   0600A0E3           MOV      R0,#+6
   \   0000013C   904721E0           MLA      R1,R0,R7,R4
   \   00000140   008086E5           STR      R8,[R6, #+0]
   \   00000144   040081E2           ADD      R0,R1,#+4
   \   00000148   140000EF           SWI      +20
   \   0000014C   000086E5           STR      R0,[R6, #+0]
    847              goto_url[0]='0';
   \   00000150   3010A0E3           MOV      R1,#+48
   \   00000154   0010C0E5           STRB     R1,[R0, #+0]
    848              goto_url[1]='/';          
   \   00000158   000096E5           LDR      R0,[R6, #+0]
   \   0000015C   2F10A0E3           MOV      R1,#+47
   \   00000160   0110C0E5           STRB     R1,[R0, #+1]
    849              
    850              s=strstr(url, "%s");
   \   00000164   751F8FE2           ADR      R1,??search_menu_onkey_5  ;; "%s"
   \   00000168   0500A0E1           MOV      R0,R5
   \   0000016C   180100EF           SWI      +280
   \   00000170   000050E3           CMP      R0,#+0
   \   00000174   3400000A           BEQ      ??search_menu_onkey_6
    851              char* ts;
    852              if(s)
    853              {
    854                int ofs=s-url;
   \   00000178   059040E0           SUB      R9,R0,R5
    855                memcpy(goto_url+2,url,ofs);
   \   0000017C   000096E5           LDR      R0,[R6, #+0]
   \   00000180   0920A0E1           MOV      R2,R9
   \   00000184   0510A0E1           MOV      R1,R5
   \   00000188   020080E2           ADD      R0,R0,#+2
   \   0000018C   1E0100EF           SWI      +286
    856                s=goto_url+2+ofs;
   \   00000190   000096E5           LDR      R0,[R6, #+0]
    857                for (int i=0; i<ql; i++) *s++=char16to8(ws->wsbody[i+1]);
   \   00000194   00B0A0E3           MOV      R11,#+0
   \   00000198   000089E0           ADD      R0,R9,R0
   \   0000019C   02A080E2           ADD      R10,R0,#+2
   \   000001A0   010057E3           CMP      R7,#+1
   \   000001A4   070000AA           BGE      ??search_menu_onkey_7
   \   000001A8   080000EA           B        ??search_menu_onkey_8
   \                     ??search_menu_onkey_9:
   \   000001AC   04009DE5           LDR      R0,[SP, #+4]
   \   000001B0   000090E5           LDR      R0,[R0, #+0]
   \   000001B4   8B0080E0           ADD      R0,R0,R11, LSL #+1
   \   000001B8   B200D0E1           LDRH     R0,[R0, #+2]
   \   000001BC   01B08BE2           ADD      R11,R11,#+1
   \   000001C0   ........           _BLF     char16to8,??char16to8??rA
   \   000001C4   ........           STRB     R0,[R10], #+1
   \                     ??search_menu_onkey_7:
   \   000001C8   07005BE1           CMP      R11,R7
   \   000001CC   F6FFFFBA           BLT      ??search_menu_onkey_9
    858                *s = 0;
   \                     ??search_menu_onkey_8:
   \   000001D0   0080CAE5           STRB     R8,[R10, #+0]
    859                ts = malloc(ql+1);
   \   000001D4   010087E2           ADD      R0,R7,#+1
   \   000001D8   140000EF           SWI      +20
   \   000001DC   0070A0E1           MOV      R7,R0
    860                strcpy(ts,goto_url+2+ofs);
   \   000001E0   000096E5           LDR      R0,[R6, #+0]
   \   000001E4   000089E0           ADD      R0,R9,R0
   \   000001E8   021080E2           ADD      R1,R0,#+2
   \   000001EC   0700A0E1           MOV      R0,R7
   \   000001F0   1A0000EF           SWI      +26
    861                ts = ToWeb(ts,1,0);
   \   000001F4   0020A0E3           MOV      R2,#+0
   \   000001F8   0110A0E3           MOV      R1,#+1
   \   000001FC   0700A0E1           MOV      R0,R7
   \   00000200   ........           _BLF     ToWeb,??ToWeb??rA
   \   00000204   0070A0E1           MOV      R7,R0
    862                memcpy(goto_url+2+ofs,ts,strlen(ts));
   \   00000208   1B0000EF           SWI      +27
   \   0000020C   0020A0E1           MOV      R2,R0
   \   00000210   000096E5           LDR      R0,[R6, #+0]
   \   00000214   0710A0E1           MOV      R1,R7
   \   00000218   000089E0           ADD      R0,R9,R0
   \   0000021C   020080E2           ADD      R0,R0,#+2
   \   00000220   1E0100EF           SWI      +286
    863                memcpy(goto_url+2+ofs+strlen(ts),url+ofs+2,fsize-ofs-1);
   \   00000224   0700A0E1           MOV      R0,R7
   \   00000228   1B0000EF           SWI      +27
   \   0000022C   003096E5           LDR      R3,[R6, #+0]
   \   00000230   091044E0           SUB      R1,R4,R9
   \   00000234   012041E2           SUB      R2,R1,#+1
   \   00000238   051089E0           ADD      R1,R9,R5
   \   0000023C   021081E2           ADD      R1,R1,#+2
   \   00000240   033089E0           ADD      R3,R9,R3
   \   00000244   030080E0           ADD      R0,R0,R3
   \   00000248   270000EA           B        ??search_menu_onkey_10
    864              }
    865              else
    866              {
    867                memcpy(goto_url+2,url,fsize);  
   \                     ??search_menu_onkey_6:
   \   0000024C   000096E5           LDR      R0,[R6, #+0]
   \   00000250   0420A0E1           MOV      R2,R4
   \   00000254   0510A0E1           MOV      R1,R5
   \   00000258   020080E2           ADD      R0,R0,#+2
   \   0000025C   1E0100EF           SWI      +286
    868                s=goto_url+2+fsize;
   \   00000260   000096E5           LDR      R0,[R6, #+0]
    869                for (int i=0; i<ql; i++) *s++=char16to8(ws->wsbody[i+1]);
   \   00000264   0090A0E3           MOV      R9,#+0
   \   00000268   000084E0           ADD      R0,R4,R0
   \   0000026C   02A080E2           ADD      R10,R0,#+2
   \   00000270   010057E3           CMP      R7,#+1
   \   00000274   070000AA           BGE      ??search_menu_onkey_11
   \   00000278   080000EA           B        ??search_menu_onkey_12
   \                     ??search_menu_onkey_13:
   \   0000027C   04009DE5           LDR      R0,[SP, #+4]
   \   00000280   000090E5           LDR      R0,[R0, #+0]
   \   00000284   890080E0           ADD      R0,R0,R9, LSL #+1
   \   00000288   B200D0E1           LDRH     R0,[R0, #+2]
   \   0000028C   019089E2           ADD      R9,R9,#+1
   \   00000290   ........           _BLF     char16to8,??char16to8??rA
   \   00000294   ........           STRB     R0,[R10], #+1
   \                     ??search_menu_onkey_11:
   \   00000298   070059E1           CMP      R9,R7
   \   0000029C   F6FFFFBA           BLT      ??search_menu_onkey_13
    870                *s = 0;
   \                     ??search_menu_onkey_12:
   \   000002A0   0080CAE5           STRB     R8,[R10, #+0]
    871                ts = malloc(ql+1);
   \   000002A4   010087E2           ADD      R0,R7,#+1
   \   000002A8   140000EF           SWI      +20
   \   000002AC   0070A0E1           MOV      R7,R0
    872                strcpy(ts,goto_url+2+fsize);
   \   000002B0   000096E5           LDR      R0,[R6, #+0]
   \   000002B4   000084E0           ADD      R0,R4,R0
   \   000002B8   021080E2           ADD      R1,R0,#+2
   \   000002BC   0700A0E1           MOV      R0,R7
   \   000002C0   1A0000EF           SWI      +26
    873                ts = ToWeb(ts,1,0);
   \   000002C4   0020A0E3           MOV      R2,#+0
   \   000002C8   0110A0E3           MOV      R1,#+1
   \   000002CC   0700A0E1           MOV      R0,R7
   \   000002D0   ........           _BLF     ToWeb,??ToWeb??rA
   \   000002D4   0070A0E1           MOV      R7,R0
    874                memcpy(goto_url+2+fsize,ts,strlen(ts)+1);
   \   000002D8   1B0000EF           SWI      +27
   \   000002DC   012080E2           ADD      R2,R0,#+1
   \   000002E0   000096E5           LDR      R0,[R6, #+0]
   \   000002E4   0710A0E1           MOV      R1,R7
   \   000002E8   000084E0           ADD      R0,R4,R0
   \                     ??search_menu_onkey_10:
   \   000002EC   020080E2           ADD      R0,R0,#+2
   \   000002F0   1E0100EF           SWI      +286
    875              };  
    876              mfree(ts);
   \   000002F4   0700A0E1           MOV      R0,R7
   \   000002F8   150000EF           SWI      +21
    877              mfree(url);
   \   000002FC   0500A0E1           MOV      R0,R5
   \   00000300   150000EF           SWI      +21
    878              goto_url = ToWeb(goto_url,0,0);
   \   00000304   000096E5           LDR      R0,[R6, #+0]
   \   00000308   0020A0E3           MOV      R2,#+0
   \   0000030C   0210A0E1           MOV      R1,R2
   \   00000310   ........           _BLF     ToWeb,??ToWeb??rA
   \   00000314   000086E5           STR      R0,[R6, #+0]
    879              
    880              return (0xFF);     
   \   00000318   FF00A0E3           MOV      R0,#+255
   \   0000031C   58DF8DE2           ADD      SP,SP,#+352
   \   00000320   F08FBDE8           POP      {R4-R11,PC}
    881              
    882            fail:
    883              ShowMSG(2,(int)lgpData[LGP_Error]);
   \                     ??search_menu_onkey_1:
   \   00000324   ........           LDR      R0,??DataTable25  ;; lgpData + 24
   \   00000328   001090E5           LDR      R1,[R0, #+0]
   \   0000032C   0200A0E3           MOV      R0,#+2
   \   00000330   480100EF           SWI      +328
    884              return (0);
   \                     ??search_menu_onkey_0:
   \   00000334   0000A0E3           MOV      R0,#+0
   \   00000338   58DF8DE2           ADD      SP,SP,#+352
   \   0000033C   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??search_menu_onkey_5:
   \   00000340   25730000           DC8      "%s",+0
    885            }
    886            return (0);
    887          }
    888          

   \                                 In segment CODE, align 4, keep-with-next
    889          void search_menu_ghook(GUI *data, int cmd)
    890          {
    891            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Search]};
   \                     search_menu_ghook:
   \   00000000   D4209FE5           LDR      R2,??search_menu_ghook_0  ;; `?<Constant {4095, 0, 0}>_4`
   \   00000004   70402DE9           PUSH     {R4-R6,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   0C0092E8           LDM      R2,{R2,R3}
   \   00000010   0040A0E1           MOV      R4,R0
   \   00000014   0D00A0E1           MOV      R0,SP
   \   00000018   0C0080E8           STM      R0,{R2,R3}
   \   0000001C   BC209FE5           LDR      R2,??search_menu_ghook_0+0x4  ;; lgpData + 244
    892            
    893            if(cmd == TI_CMD_DESTROY)
   \   00000020   030051E3           CMP      R1,#+3
   \   00000024   002092E5           LDR      R2,[R2, #+0]
   \   00000028   04208DE5           STR      R2,[SP, #+4]
   \   0000002C   0100001A           BNE      ??search_menu_ghook_1
    894            {
    895              free_search_engines();
   \   00000030   ........           BL       free_search_engines
   \   00000034   7380BDE8           POP      {R0,R1,R4-R6,PC}
    896            }
    897            if (cmd == TI_CMD_REDRAW)
   \                     ??search_menu_ghook_1:
   \   00000038   070051E3           CMP      R1,#+7
   \   0000003C   0400001A           BNE      ??search_menu_ghook_2
    898            {
    899              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   00000040   0020A0E3           MOV      R2,#+0
   \   00000044   0D10A0E1           MOV      R1,SP
   \   00000048   0400A0E1           MOV      R0,R4
   \   0000004C   680100EF           SWI      +360
   \   00000050   7380BDE8           POP      {R0,R1,R4-R6,PC}
    900            }
    901            if (cmd == TI_CMD_FOCUS)
   \                     ??search_menu_ghook_2:
   \   00000054   0A0051E3           CMP      R1,#+10
   \   00000058   0100001A           BNE      ??search_menu_ghook_3
    902            {
    903              DisableIDLETMR();
   \   0000005C   7F0100EF           SWI      +383
   \   00000060   7380BDE8           POP      {R0,R1,R4-R6,PC}
    904            }
    905            if (cmd == TI_CMD_COMBOBOX_FOCUS)
   \                     ??search_menu_ghook_3:
   \   00000064   0D0051E3           CMP      R1,#+13
   \   00000068   7380BD18           POPNE    {R0,R1,R4-R6,PC}
    906            {
    907              int cbi=EDIT_GetFocus(data);
    908              if(cbi==4)
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   820100EF           SWI      +386
   \   00000074   040050E3           CMP      R0,#+4
   \   00000078   7380BD18           POPNE    {R0,R1,R4-R6,PC}
    909              {
    910                WSHDR * ews=AllocWS(128);    
    911                selected_search_engine=EDIT_GetItemNumInFocusedComboBox(data)-1;
   \   0000007C   ........           LDR      R6,??DataTable30  ;; search_menu_sk
   \   00000080   8000A0E3           MOV      R0,#+128
   \   00000084   250100EF           SWI      +293
   \   00000088   0050A0E1           MOV      R5,R0
   \   0000008C   0400A0E1           MOV      R0,R4
   \   00000090   800100EF           SWI      +384
   \   00000094   010040E2           SUB      R0,R0,#+1
   \   00000098   600086E5           STR      R0,[R6, #+96]
    912                if(selected_search_engine>=0&&selected_search_engine<search_engine_count)
   \   0000009C   000050E3           CMP      R0,#+0
   \   000000A0   0A00004A           BMI      ??search_menu_ghook_4
   \   000000A4   5C1096E5           LDR      R1,[R6, #+92]
   \   000000A8   010050E1           CMP      R0,R1
   \   000000AC   070000AA           BGE      ??search_menu_ghook_4
    913                {
    914                  str_2ws(ews,search_engines[selected_search_engine],128);
   \   000000B0   8020A0E3           MOV      R2,#+128
   \   000000B4   000186E0           ADD      R0,R6,R0, LSL #+2
   \   000000B8   641090E5           LDR      R1,[R0, #+100]
   \   000000BC   0500A0E1           MOV      R0,R5
   \   000000C0   6C0100EF           SWI      +364
    915                  EDIT_SetTextToFocused(data,ews);
   \   000000C4   0510A0E1           MOV      R1,R5
   \   000000C8   0400A0E1           MOV      R0,R4
   \   000000CC   810100EF           SWI      +385
    916                };
    917                FreeWS(ews);
   \                     ??search_menu_ghook_4:
   \   000000D0   0500A0E1           MOV      R0,R5
   \   000000D4   290100EF           SWI      +297
    918              };
    919            }
    920          }
   \   000000D8   7380BDE8           POP      {R0,R1,R4-R6,PC}  ;; return
   \                     ??search_menu_ghook_0:
   \   000000DC   ........           DC32     `?<Constant {4095, 0, 0}>_4`
   \   000000E0   ........           DC32     lgpData + 244
    921          
    922          HEADER_DESC search_menu_header={0,0,0,0,NULL,(int)"Search:",0x7FFFFFFF};
    923          
    924          INPUTDIA_DESC search_menu_struct=
    925          {
    926            1,
    927            search_menu_onkey,
    928            search_menu_ghook,
    929            (void *)search_menu_locret,
    930            0,
    931            &search_menu_skt,
    932            {0,0,0,0},
    933            FONT_SMALL,
    934            100,
    935            101,
    936            0,
    937            0,
    938            0x40000000
    939          };
    940          
    941          

   \                                 In segment CODE, align 4, keep-with-next
    942          static int CreateSearchDialog()
    943          {
   \                     CreateSearchDialog:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
    944            get_search_engines();
    945          
    946            void *ma=malloc_adr();
    947            void *eq;
    948            EDITCONTROL ec;
    949          
    950            WSHDR * ews=AllocWS(1024);
    951          
    952            PrepareEditControl(&ec);
    953            eq=AllocEQueue(ma,mfree_adr());
    954          
    955            ascii2ws(ews,lgpData[LGP_TextHeader]);
   \   00000004   ........           LDR      R7,??DataTable32  ;; lgpData
    956            ConstructEditControl(&ec,ECT_HEADER,ECF_APPEND_EOL,ews,1024);
    957            AddEditControlToEditQend(eq,&ec,ma);
    958          
    959            wsprintf(ews,sEmpty);
   \   00000008   84819FE5           LDR      R8,??CreateSearchDialog_0  ;; search_menu_sk
   \   0000000C   2CD04DE2           SUB      SP,SP,#+44
   \   00000010   ........           BL       get_search_engines
   \   00000014   148000EF           SWI      +32788
   \   00000018   0040A0E1           MOV      R4,R0
   \   0000001C   400EA0E3           MOV      R0,#+1024
   \   00000020   250100EF           SWI      +293
   \   00000024   0050A0E1           MOV      R5,R0
   \   00000028   0D00A0E1           MOV      R0,SP
   \   0000002C   640100EF           SWI      +356
   \   00000030   158000EF           SWI      +32789
   \   00000034   0010A0E1           MOV      R1,R0
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   630100EF           SWI      +355
   \   00000040   781097E5           LDR      R1,[R7, #+120]
   \   00000044   0060A0E1           MOV      R6,R0
   \   00000048   0500A0E1           MOV      R0,R5
   \   0000004C   ........           _BLF     ascii2ws,??ascii2ws??rA
   \   00000050   400EA0E3           MOV      R0,#+1024
   \   00000054   01002DE9           PUSH     {R0}
   \   00000058   0530A0E1           MOV      R3,R5
   \   0000005C   4020A0E3           MOV      R2,#+64
   \   00000060   0110A0E3           MOV      R1,#+1
   \   00000064   04008DE2           ADD      R0,SP,#+4
   \   00000068   650100EF           SWI      +357
   \   0000006C   0420A0E1           MOV      R2,R4
   \   00000070   04108DE2           ADD      R1,SP,#+4
   \   00000074   0600A0E1           MOV      R0,R6
   \   00000078   660100EF           SWI      +358
   \   0000007C   581098E5           LDR      R1,[R8, #+88]
   \   00000080   0500A0E1           MOV      R0,R5
   \   00000084   240100EF           SWI      +292
    960            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL,ews,1024);
   \   00000088   400EA0E3           MOV      R0,#+1024
   \   0000008C   01002DE9           PUSH     {R0}
   \   00000090   0530A0E1           MOV      R3,R5
   \   00000094   4020A0E3           MOV      R2,#+64
   \   00000098   0310A0E3           MOV      R1,#+3
   \   0000009C   08008DE2           ADD      R0,SP,#+8
   \   000000A0   650100EF           SWI      +357
    961            AddEditControlToEditQend(eq,&ec,ma);
   \   000000A4   0420A0E1           MOV      R2,R4
   \   000000A8   08108DE2           ADD      R1,SP,#+8
   \   000000AC   0600A0E1           MOV      R0,R6
   \   000000B0   660100EF           SWI      +358
    962            
    963            ascii2ws(ews,lgpData[LGP_SearchEngine]);
   \   000000B4   7C1097E5           LDR      R1,[R7, #+124]
   \   000000B8   0500A0E1           MOV      R0,R5
   \   000000BC   ........           _BLF     ascii2ws,??ascii2ws??rA
    964            ConstructEditControl(&ec,ECT_HEADER,ECF_APPEND_EOL,ews,1024);
   \   000000C0   400EA0E3           MOV      R0,#+1024
   \   000000C4   01002DE9           PUSH     {R0}
   \   000000C8   0530A0E1           MOV      R3,R5
   \   000000CC   4020A0E3           MOV      R2,#+64
   \   000000D0   0110A0E3           MOV      R1,#+1
   \   000000D4   0C008DE2           ADD      R0,SP,#+12
   \   000000D8   650100EF           SWI      +357
    965            AddEditControlToEditQend(eq,&ec,ma);
   \   000000DC   0420A0E1           MOV      R2,R4
   \   000000E0   0C108DE2           ADD      R1,SP,#+12
   \   000000E4   0600A0E1           MOV      R0,R6
   \   000000E8   660100EF           SWI      +358
    966            
    967            wsprintf(ews,sEmpty);
   \   000000EC   581098E5           LDR      R1,[R8, #+88]
   \   000000F0   0500A0E1           MOV      R0,R5
   \   000000F4   240100EF           SWI      +292
    968            ConstructComboBox(&ec,7,ECF_APPEND_EOL,ews,32,0,search_engine_count,selected_search_engine+1);
   \   000000F8   600098E5           LDR      R0,[R8, #+96]
   \   000000FC   0530A0E1           MOV      R3,R5
   \   00000100   010080E2           ADD      R0,R0,#+1
   \   00000104   01002DE9           PUSH     {R0}
   \   00000108   5C0098E5           LDR      R0,[R8, #+92]
   \   0000010C   4020A0E3           MOV      R2,#+64
   \   00000110   01002DE9           PUSH     {R0}
   \   00000114   0710A0E3           MOV      R1,#+7
   \   00000118   0000A0E3           MOV      R0,#+0
   \   0000011C   01002DE9           PUSH     {R0}
   \   00000120   2000A0E3           MOV      R0,#+32
   \   00000124   01002DE9           PUSH     {R0}
   \   00000128   1C008DE2           ADD      R0,SP,#+28
   \   0000012C   840100EF           SWI      +388
    969            AddEditControlToEditQend(eq,&ec,ma);
   \   00000130   0420A0E1           MOV      R2,R4
   \   00000134   1C108DE2           ADD      R1,SP,#+28
   \   00000138   0600A0E1           MOV      R0,R6
   \   0000013C   660100EF           SWI      +358
    970            
    971            FreeWS(ews);
   \   00000140   0500A0E1           MOV      R0,R5
   \   00000144   290100EF           SWI      +297
    972            patch_header(&search_menu_header);
   \   00000148   180088E2           ADD      R0,R8,#+24
   \   0000014C   ........           _BLF     patch_header,??patch_header??rA
    973            patch_input(&search_menu_struct);
   \   00000150   E40088E2           ADD      R0,R8,#+228
   \   00000154   ........           _BLF     patch_input,??patch_input??rA
    974            search_menu_sk[0].lgp_id=(int)lgpData[LGP_Search];
   \   00000158   F40097E5           LDR      R0,[R7, #+244]
    975            search_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
    976            search_menu_header.lgp_id=(int)lgpData[LGP_SearchHeader];
    977            return CreateInputTextDialog(&search_menu_struct, &search_menu_header, eq, 1, 0);  
   \   0000015C   0130A0E3           MOV      R3,#+1
   \   00000160   040088E5           STR      R0,[R8, #+4]
   \   00000164   680097E5           LDR      R0,[R7, #+104]
   \   00000168   0620A0E1           MOV      R2,R6
   \   0000016C   0C0088E5           STR      R0,[R8, #+12]
   \   00000170   C00097E5           LDR      R0,[R7, #+192]
   \   00000174   181088E2           ADD      R1,R8,#+24
   \   00000178   240088E5           STR      R0,[R8, #+36]
   \   0000017C   0000A0E3           MOV      R0,#+0
   \   00000180   01002DE9           PUSH     {R0}
   \   00000184   E40088E2           ADD      R0,R8,#+228
   \   00000188   670100EF           SWI      +359
   \   0000018C   4CD08DE2           ADD      SP,SP,#+76
   \   00000190   F081BDE8           POP      {R4-R8,PC}       ;; return
   \                     ??CreateSearchDialog_0:
   \   00000194   ........           DC32     search_menu_sk
    978          };
    979          
    980          //--------------------------------Find string menu------------------------------
    981          SOFTKEY_DESC find_box_menu_sk[]=
    982          {
    983            {0x0018,0x0000,(int)"Ok"},
    984            {0x0001,0x0000,(int)"Cancel"},
    985            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    986          };
    987          

   \                                 In segment DATA_C, align 4, align-sorted
    988          static const SOFTKEYSTAB find_box_menu_skt=
   \                     find_box_menu_skt:
   \   00000000   ........0000       DC32 find_box_menu_sk, 0
   \              0000        

   \                                 In segment DATA_I, align 4, align-sorted
   \                     search_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for search_menu_sk>`
   \                     search_menu_header:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for search_menu_header>`
   \                     find_box_menu_sk:
   \   0000002C                      DS8 24
   \   00000044                      REQUIRE `?<Initializer for find_box_menu_sk>`
    989          {
    990            find_box_menu_sk,0
    991          };
    992          
    993          HEADER_DESC find_box_hdr={0,0,0,0,NULL,(int)"Find:",LGP_NULL};
   \                     find_box_hdr:
   \   00000044                      DS8 20
   \   00000058                      REQUIRE `?<Initializer for find_box_hdr>`
   \                     sEmpty:
   \   00000058                      DS8 4
   \   0000005C                      REQUIRE `?<Initializer for sEmpty>`
   \   0000005C                      DS8 4
   \   00000060                      REQUIRE `?<Initializer for search_engine_count>`
   \   00000060                      DS8 4
   \   00000064                      REQUIRE `?<Initializer for selected_search_engine>`
   \   00000064                      DS8 128
   \   000000E4                      REQUIRE `?<Initializer for search_engines>`
   \                     search_menu_struct:
   \   000000E4                      DS8 56
   \   0000011C                      REQUIRE `?<Initializer for search_menu_struct>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     bookmarks_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for bookmarks_menu_sk>`
   \                     bookmarks_menu_header:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for bookmarks_menu_header>`
   \                     bookmarks_menu_icons:
   \   0000002C                      DS8 8
   \   00000034                      REQUIRE `?<Initializer for bookmarks_menu_icons>`
   \                     bookmarks_current_folder:
   \   00000034                      DS8 4
   \   00000038                      REQUIRE `?<Initializer for bookmarks_current_folder>`
   \                     bl_top:
   \   00000038                      DS8 4
   \   0000003C                      REQUIRE `?<Initializer for bl_top>`
   \                     bookmarks_menu_struct:
   \   0000003C                      DS8 44
   \   00000068                      REQUIRE `?<Initializer for bookmarks_menu_struct>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     edit_bookmark_hdr:
   \   00000000                      DS8 20
   \   00000014                      REQUIRE `?<Initializer for edit_bookmark_hdr>`
   \                     edit_mode:
   \   00000014                      DS8 1
   \   00000015                      REQUIRE `?<Initializer for edit_mode>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     edit_bookmark_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for edit_bookmark_sk>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     bookmarks_options_items:
   \   00000000                      DS8 112
   \   00000070                      REQUIRE `?<Initializer for bookmarks_options_items>`
   \                     bookmarks_options_header:
   \   00000070                      DS8 20
   \   00000084                      REQUIRE `?<Initializer for bookmarks_options_header>`
   \                     bookmarks_options_sk:
   \   00000084                      DS8 24
   \   0000009C                      REQUIRE `?<Initializer for bookmarks_options_sk>`
   \                     bookmarks_options_struct:
   \   0000009C                      DS8 44
   \   000000C8                      REQUIRE `?<Initializer for bookmarks_options_struct>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     bookmarks_options_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for bookmarks_options_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     bookmarks_options_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for bookmarks_options_skt>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     bookmarks_menu_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for bookmarks_menu_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     bookmarks_menu_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for bookmarks_menu_skt>`
    994          

   \                                 In segment CODE, align 4, keep-with-next
    995          static void find_box_ghook(GUI *data, int cmd)
    996          {
    997            const char* _t = "%t";
    998            int i;
    999            WSHDR* ews;
   1000            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     find_box_ghook:
   \   00000000   D4209FE5           LDR      R2,??find_box_ghook_0+0x4  ;; `?<Constant {4095, 0, 0}>_1`
   \   00000004   F0432DE9           PUSH     {R4-R9,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   0C0092E8           LDM      R2,{R2,R3}
   \   00000010   ........           LDR      R6,??DataTable32  ;; lgpData
   \   00000014   0040A0E1           MOV      R4,R0
   \   00000018   0D00A0E1           MOV      R0,SP
   \   0000001C   0C0080E8           STM      R0,{R2,R3}
   \   00000020   642096E5           LDR      R2,[R6, #+100]
   \   00000024   2B5F8FE2           ADR      R5,??find_box_ghook_0  ;; "%t"
   \   00000028   04208DE5           STR      R2,[SP, #+4]
   1001            if (cmd==0x0A)
   \   0000002C   0A0051E3           CMP      R1,#+10
   \   00000030   0100001A           BNE      ??find_box_ghook_1
   1002            {
   1003              DisableIDLETMR();
   \   00000034   7F0100EF           SWI      +383
   \   00000038   F383BDE8           POP      {R0,R1,R4-R9,PC}
   1004            }
   1005            if (cmd==7)
   \                     ??find_box_ghook_1:
   \   0000003C   070051E3           CMP      R1,#+7
   \   00000040   0400001A           BNE      ??find_box_ghook_2
   1006            {
   1007              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   00000044   0020A0E3           MOV      R2,#+0
   \   00000048   0D10A0E1           MOV      R1,SP
   \   0000004C   0400A0E1           MOV      R0,R4
   \   00000050   680100EF           SWI      +360
   \   00000054   F383BDE8           POP      {R0,R1,R4-R9,PC}
   1008            }
   1009            if (cmd==0x0D)
   \                     ??find_box_ghook_2:
   \   00000058   0D0051E3           CMP      R1,#+13
   \   0000005C   F383BD18           POPNE    {R0,R1,R4-R9,PC}
   1010            {
   1011              ews = AllocWS(256);
   \   00000060   400FA0E3           MOV      R0,#+256
   \   00000064   250100EF           SWI      +293
   \   00000068   0070A0E1           MOV      R7,R0
   1012              if ((i=EDIT_GetItemNumInFocusedComboBox(data)))
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   800100EF           SWI      +384
   \   00000074   0080B0E1           MOVS     R8,R0
   \   00000078   1000000A           BEQ      ??find_box_ghook_3
   1013              {
   1014                VIEWDATA* vd = EDIT_GetUserPointer(data);
   \   0000007C   0400A0E1           MOV      R0,R4
   \   00000080   DF0100EF           SWI      +479
   \   00000084   0090A0E1           MOV      R9,R0
   1015                if (i == 2)
   \   00000088   020058E3           CMP      R8,#+2
   \   0000008C   0500001A           BNE      ??find_box_ghook_4
   1016                {
   1017                 wsprintf(ews,_t,lgpData[LGP_Yes]);
   \   00000090   182196E5           LDR      R2,[R6, #+280]
   \   00000094   0510A0E1           MOV      R1,R5
   \   00000098   0700A0E1           MOV      R0,R7
   \   0000009C   240100EF           SWI      +292
   1018                 vd->search_isCaseSens = 1;
   \   000000A0   0100A0E3           MOV      R0,#+1
   \   000000A4   040000EA           B        ??find_box_ghook_5
   1019                }
   1020                else
   1021                {
   1022                 wsprintf(ews,_t,lgpData[LGP_No]); 
   \                     ??find_box_ghook_4:
   \   000000A8   1C2196E5           LDR      R2,[R6, #+284]
   \   000000AC   0510A0E1           MOV      R1,R5
   \   000000B0   0700A0E1           MOV      R0,R7
   \   000000B4   240100EF           SWI      +292
   1023                 vd->search_isCaseSens = 0;
   \   000000B8   0000A0E3           MOV      R0,#+0
   \                     ??find_box_ghook_5:
   \   000000BC   040189E5           STR      R0,[R9, #+260]
   1024                }
   1025              }
   1026              EDIT_SetTextToFocused(data,ews);
   \                     ??find_box_ghook_3:
   \   000000C0   0710A0E1           MOV      R1,R7
   \   000000C4   0400A0E1           MOV      R0,R4
   \   000000C8   810100EF           SWI      +385
   1027              FreeWS(ews);
   \   000000CC   0700A0E1           MOV      R0,R7
   \   000000D0   290100EF           SWI      +297
   1028            }
   1029          }
   \   000000D4   F383BDE8           POP      {R0,R1,R4-R9,PC}  ;; return
   \                     ??find_box_ghook_0:
   \   000000D8   25740000           DC8      "%t",+0
   \   000000DC   ........           DC32     `?<Constant {4095, 0, 0}>_1`
   1030          

   \                                 In segment CODE, align 4, keep-with-next
   1031          static void find_box_locret(void){}
   \                     find_box_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1032          
   1033          

   \                                 In segment CODE, align 4, keep-with-next
   1034          static int find_box_onkey(GUI *data, GUI_MSG *msg)
   1035          {
   \                     find_box_onkey:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0040A0E1           MOV      R4,R0
   1036            EDITCONTROL ec;
   1037            VIEWDATA* vd;
   1038            if (msg->keys==0xFFF)
   \   0000000C   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000010   FF10A0E3           MOV      R1,#+255
   \   00000014   F01E81E3           ORR      R1,R1,#0xF00
   \   00000018   010050E1           CMP      R0,R1
   \   0000001C   0E00001A           BNE      ??find_box_onkey_0
   1039            {
   1040              ExtractEditControl(data,2,&ec);
   \   00000020   0D20A0E1           MOV      R2,SP
   \   00000024   0210A0E3           MOV      R1,#+2
   \   00000028   0400A0E1           MOV      R0,R4
   \   0000002C   690100EF           SWI      +361
   1041              vd = EDIT_GetUserPointer(data);
   \   00000030   0400A0E1           MOV      R0,R4
   \   00000034   DF0100EF           SWI      +479
   1042              wstrcpy(vd->search_string, ec.pWS);
   \   00000038   28109DE5           LDR      R1,[SP, #+40]
   \   0000003C   0040A0E1           MOV      R4,R0
   \   00000040   000194E5           LDR      R0,[R4, #+256]
   \   00000044   1F0100EF           SWI      +287
   1043              FindStringOnPage(vd);
   \   00000048   0400A0E1           MOV      R0,R4
   \   0000004C   ........           _BLF     FindStringOnPage,??FindStringOnPage??rA
   1044              return (0xFF);
   \   00000050   FF00A0E3           MOV      R0,#+255
   \   00000054   2CD08DE2           ADD      SP,SP,#+44
   \   00000058   1080BDE8           POP      {R4,PC}
   1045            }
   1046            return (0);
   \                     ??find_box_onkey_0:
   \   0000005C   0000A0E3           MOV      R0,#+0
   \   00000060   2CD08DE2           ADD      SP,SP,#+44
   \   00000064   1080BDE8           POP      {R4,PC}          ;; return
   1047          }
   1048          

   \                                 In segment DATA_C, align 4, align-sorted
   1049          static const INPUTDIA_DESC find_box_desc =
   \                     find_box_desc:
   \   00000000   01000000....       DC32 1, find_box_onkey, find_box_ghook, find_box_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 find_box_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1050          {
   1051            1,
   1052            find_box_onkey,
   1053            find_box_ghook,
   1054            (void *)find_box_locret,
   1055            0,
   1056            &find_box_menu_skt,
   1057            {0,0,0,0},
   1058            FONT_SMALL,
   1059            100,
   1060            101,
   1061            0,
   1062            //  0x00000001 - Выровнять по правому краю
   1063            //  0x00000002 - Выровнять по центру
   1064            //  0x00000004 - Инверсия знакомест
   1065            //  0x00000008 - UnderLine
   1066            //  0x00000020 - Не переносить слова
   1067            //  0x00000200 - bold
   1068            0,
   1069            //  0x00000002 - ReadOnly
   1070            //  0x00000004 - Не двигается курсор
   1071            //  0x40000000 - Поменять местами софт-кнопки
   1072            0x40000000
   1073          };
   1074          

   \                                 In segment CODE, align 4, keep-with-next
   1075          int CreateFindDialog(VIEWDATA *vd)
   1076          {
   \                     CreateFindDialog:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   1077            
   1078            void *ma=malloc_adr();
   1079            void *eq;
   1080            EDITCONTROL ec;
   1081            WSHDR * ews=AllocWS(256);
   1082            
   1083            eq=AllocEQueue(ma,mfree_adr());
   1084            
   1085            ascii2ws(ews,lgpData[LGP_FindString]);
   \   00000004   ........           LDR      R6,??DataTable32  ;; lgpData
   \   00000008   2CD04DE2           SUB      SP,SP,#+44
   1086            ConstructEditControl(&ec,ECT_HEADER,ECF_APPEND_EOL,ews,128);
   1087            AddEditControlToEditQend(eq,&ec,ma);
   1088            
   1089            PrepareEditControl(&ec);
   1090            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL,vd->search_string,256);
   1091            AddEditControlToEditQend(eq,&ec,ma);
   1092            
   1093            ascii2ws(ews,lgpData[LGP_MatchCase]);
   1094            ConstructEditControl(&ec,ECT_HEADER,ECF_APPEND_EOL,ews,128);
   1095            AddEditControlToEditQend(eq,&ec,ma);
   1096           
   1097            wsprintf(ews,sEmpty);
   \   0000000C   ........           LDR      R9,??DataTable30  ;; search_menu_sk
   \   00000010   0040A0E1           MOV      R4,R0
   \   00000014   148000EF           SWI      +32788
   \   00000018   0070A0E1           MOV      R7,R0
   \   0000001C   400FA0E3           MOV      R0,#+256
   \   00000020   250100EF           SWI      +293
   \   00000024   0080A0E1           MOV      R8,R0
   \   00000028   158000EF           SWI      +32789
   \   0000002C   0010A0E1           MOV      R1,R0
   \   00000030   0700A0E1           MOV      R0,R7
   \   00000034   630100EF           SWI      +355
   \   00000038   801096E5           LDR      R1,[R6, #+128]
   \   0000003C   0050A0E1           MOV      R5,R0
   \   00000040   0800A0E1           MOV      R0,R8
   \   00000044   ........           _BLF     ascii2ws,??ascii2ws??rA
   \   00000048   8000A0E3           MOV      R0,#+128
   \   0000004C   01002DE9           PUSH     {R0}
   \   00000050   0830A0E1           MOV      R3,R8
   \   00000054   4020A0E3           MOV      R2,#+64
   \   00000058   0110A0E3           MOV      R1,#+1
   \   0000005C   04008DE2           ADD      R0,SP,#+4
   \   00000060   650100EF           SWI      +357
   \   00000064   0720A0E1           MOV      R2,R7
   \   00000068   04108DE2           ADD      R1,SP,#+4
   \   0000006C   0500A0E1           MOV      R0,R5
   \   00000070   660100EF           SWI      +358
   \   00000074   04008DE2           ADD      R0,SP,#+4
   \   00000078   640100EF           SWI      +356
   \   0000007C   400FA0E3           MOV      R0,#+256
   \   00000080   01002DE9           PUSH     {R0}
   \   00000084   003194E5           LDR      R3,[R4, #+256]
   \   00000088   4020A0E3           MOV      R2,#+64
   \   0000008C   0310A0E3           MOV      R1,#+3
   \   00000090   08008DE2           ADD      R0,SP,#+8
   \   00000094   650100EF           SWI      +357
   \   00000098   0720A0E1           MOV      R2,R7
   \   0000009C   08108DE2           ADD      R1,SP,#+8
   \   000000A0   0500A0E1           MOV      R0,R5
   \   000000A4   660100EF           SWI      +358
   \   000000A8   CC1096E5           LDR      R1,[R6, #+204]
   \   000000AC   0800A0E1           MOV      R0,R8
   \   000000B0   ........           _BLF     ascii2ws,??ascii2ws??rA
   \   000000B4   8000A0E3           MOV      R0,#+128
   \   000000B8   01002DE9           PUSH     {R0}
   \   000000BC   0830A0E1           MOV      R3,R8
   \   000000C0   4020A0E3           MOV      R2,#+64
   \   000000C4   0110A0E3           MOV      R1,#+1
   \   000000C8   0C008DE2           ADD      R0,SP,#+12
   \   000000CC   650100EF           SWI      +357
   \   000000D0   0720A0E1           MOV      R2,R7
   \   000000D4   0C108DE2           ADD      R1,SP,#+12
   \   000000D8   0500A0E1           MOV      R0,R5
   \   000000DC   660100EF           SWI      +358
   \   000000E0   581099E5           LDR      R1,[R9, #+88]
   \   000000E4   0800A0E1           MOV      R0,R8
   \   000000E8   240100EF           SWI      +292
   1098            ConstructComboBox(&ec,7,ECF_APPEND_EOL,ews,32,0,2,1);
   \   000000EC   0100A0E3           MOV      R0,#+1
   \   000000F0   01002DE9           PUSH     {R0}
   \   000000F4   0830A0E1           MOV      R3,R8
   \   000000F8   4020A0E3           MOV      R2,#+64
   \   000000FC   0710A0E3           MOV      R1,#+7
   \   00000100   0200A0E3           MOV      R0,#+2
   \   00000104   01002DE9           PUSH     {R0}
   \   00000108   0000A0E3           MOV      R0,#+0
   \   0000010C   01002DE9           PUSH     {R0}
   \   00000110   2000A0E3           MOV      R0,#+32
   \   00000114   01002DE9           PUSH     {R0}
   \   00000118   1C008DE2           ADD      R0,SP,#+28
   \   0000011C   840100EF           SWI      +388
   1099            AddEditControlToEditQend(eq,&ec,ma);
   \   00000120   0720A0E1           MOV      R2,R7
   1100            FreeWS(ews);
   1101          
   1102            patch_header(&find_box_hdr);
   1103            patch_input(&find_box_desc);
   \   00000124   58709FE5           LDR      R7,??CreateFindDialog_0  ;; find_box_desc
   \   00000128   1C108DE2           ADD      R1,SP,#+28
   \   0000012C   0500A0E1           MOV      R0,R5
   \   00000130   660100EF           SWI      +358
   \   00000134   0800A0E1           MOV      R0,R8
   \   00000138   290100EF           SWI      +297
   \   0000013C   440089E2           ADD      R0,R9,#+68
   \   00000140   ........           _BLF     patch_header,??patch_header??rA
   \   00000144   0700A0E1           MOV      R0,R7
   \   00000148   ........           _BLF     patch_input,??patch_input??rA
   1104            find_box_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   \   0000014C   640096E5           LDR      R0,[R6, #+100]
   1105            find_box_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1106            find_box_hdr.lgp_id=(int)lgpData[LGP_FindHeader];
   1107            return CreateInputTextDialog(&find_box_desc,&find_box_hdr,eq,1,vd);
   \   00000150   0130A0E3           MOV      R3,#+1
   \   00000154   300089E5           STR      R0,[R9, #+48]
   \   00000158   680096E5           LDR      R0,[R6, #+104]
   \   0000015C   0520A0E1           MOV      R2,R5
   \   00000160   380089E5           STR      R0,[R9, #+56]
   \   00000164   C40096E5           LDR      R0,[R6, #+196]
   \   00000168   441089E2           ADD      R1,R9,#+68
   \   0000016C   500089E5           STR      R0,[R9, #+80]
   \   00000170   10002DE9           PUSH     {R4}
   \   00000174   0700A0E1           MOV      R0,R7
   \   00000178   670100EF           SWI      +359
   \   0000017C   4CD08DE2           ADD      SP,SP,#+76
   \   00000180   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??CreateFindDialog_0:
   \   00000184   ........           DC32     find_box_desc
   1108          }
   1109          
   1110          //-------------------------------Save Page--------------------------------------
   1111          SOFTKEY_DESC savepage_box_menu_sk[]=
   1112          {
   1113            {0x0018,0x0000,(int)"Ok"},
   1114            {0x0001,0x0000,(int)"Cancel"},
   1115            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1116          };
   1117          

   \                                 In segment DATA_C, align 4, align-sorted
   1118          static const SOFTKEYSTAB savepage_box_menu_skt=
   \                     savepage_box_menu_skt:
   \   00000000   ........0000       DC32 savepage_box_menu_sk, 0
   \              0000        

   \                                 In segment DATA_I, align 4, align-sorted
   \                     savepage_box_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for savepage_box_menu_sk>`
   1119          {
   1120            savepage_box_menu_sk,0
   1121          };
   1122          
   1123          HEADER_DESC savepage_box_hdr={0,0,0,0,NULL,(int)"Save page:",LGP_NULL};
   \                     savepage_box_hdr:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for savepage_box_hdr>`
   1124          

   \                                 In segment CODE, align 4, keep-with-next
   1125          static void savepage_box_ghook(GUI *data, int cmd)
   1126          {
   1127            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     savepage_box_ghook:
   \   00000000   44309FE5           LDR      R3,??savepage_box_ghook_0  ;; `?<Constant {4095, 0, 0}>_2`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   300093E8           LDM      R3,{R4,R5}
   \   00000010   38309FE5           LDR      R3,??savepage_box_ghook_0+0x4  ;; lgpData + 100
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   300082E8           STM      R2,{R4,R5}
   \   0000001C   003093E5           LDR      R3,[R3, #+0]
   1128            if (cmd==0x0A)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   04308DE5           STR      R3,[SP, #+4]
   \   00000028   0100001A           BNE      ??savepage_box_ghook_1
   1129            {
   1130              DisableIDLETMR();
   \   0000002C   7F0100EF           SWI      +383
   \   00000030   3380BDE8           POP      {R0,R1,R4,R5,PC}
   1131            }
   1132            if (cmd==7)
   \                     ??savepage_box_ghook_1:
   \   00000034   070051E3           CMP      R1,#+7
   \   00000038   3380BD18           POPNE    {R0,R1,R4,R5,PC}
   1133            {
   1134              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000003C   0020A0E3           MOV      R2,#+0
   \   00000040   0D10A0E1           MOV      R1,SP
   \   00000044   680100EF           SWI      +360
   1135            }
   1136          }
   \   00000048   3380BDE8           POP      {R0,R1,R4,R5,PC}  ;; return
   \                     ??savepage_box_ghook_0:
   \   0000004C   ........           DC32     `?<Constant {4095, 0, 0}>_2`
   \   00000050   ........           DC32     lgpData + 100
   1137          

   \                                 In segment CODE, align 4, keep-with-next
   1138          static void savepage_box_locret(void){}
   \                     savepage_box_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1139          
   1140          #define BUF_SIZE 0x4000

   \                                 In segment CODE, align 4, keep-with-next
   1141          int fcopy(char* src, char* dst) //From MC source code
   1142          {
   \                     fcopy:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   1143          	int fi=-1, fo=-1;
   1144          	char* buff=0;
   1145          	int cb, left;
   1146          	int res = 0;
   1147                  unsigned int err;
   1148                  FSTATS fs;
   1149          	if (GetFileStats(dst,&fs,&err)!=-1)
   \   00000008   ........           LDR      R8,??DataTable32  ;; lgpData
   \   0000000C   0060A0E1           MOV      R6,R0
   \   00000010   0170A0E1           MOV      R7,R1
   \   00000014   0050A0E3           MOV      R5,#+0
   \   00000018   0040A0E3           MOV      R4,#+0
   \   0000001C   0490E0E1           MVN      R9,R4
   \   00000020   0D20A0E1           MOV      R2,SP
   \   00000024   04108DE2           ADD      R1,SP,#+4
   \   00000028   0700A0E1           MOV      R0,R7
   \   0000002C   840000EF           SWI      +132
   \   00000030   090050E1           CMP      R0,R9
   \   00000034   0500000A           BEQ      ??fcopy_0
   1150                    ShowMSG(1, (int)lgpData[LGP_FileExists]); 
   \   00000038   0C1198E5           LDR      R1,[R8, #+268]
   \   0000003C   0100A0E3           MOV      R0,#+1
   \   00000040   480100EF           SWI      +328
   \   00000044   0400A0E1           MOV      R0,R4
   \   00000048   2CD08DE2           ADD      SP,SP,#+44
   \   0000004C   F083BDE8           POP      {R4-R9,PC}
   1151                  else
   1152                  {
   1153          	  fi = fopen(src, A_ReadOnly + A_BIN, P_READ, &err);
   \                     ??fcopy_0:
   \   00000050   0D30A0E1           MOV      R3,SP
   \   00000054   8020A0E3           MOV      R2,#+128
   \   00000058   801CA0E3           MOV      R1,#+32768
   \   0000005C   0600A0E1           MOV      R0,R6
   \   00000060   0A0000EF           SWI      +10
   \   00000064   0060A0E1           MOV      R6,R0
   1154                    if (fi != -1) 
   \   00000068   090056E1           CMP      R6,R9
   \   0000006C   2800000A           BEQ      ??fcopy_1
   1155                    {
   1156                            fo = fopen(dst, A_ReadWrite+A_BIN+A_Create+A_Truncate, P_READ+P_WRITE, &err);
   \   00000070   0D30A0E1           MOV      R3,SP
   \   00000074   602FA0E3           MOV      R2,#+384
   \   00000078   0210A0E3           MOV      R1,#+2
   \   0000007C   831C81E3           ORR      R1,R1,#0x8300
   \   00000080   0700A0E1           MOV      R0,R7
   \   00000084   0A0000EF           SWI      +10
   \   00000088   0070A0E1           MOV      R7,R0
   1157                            if (fo != -1) 
   \   0000008C   090057E1           CMP      R7,R9
   \   00000090   3800000A           BEQ      ??fcopy_2
   1158                            {
   1159            
   1160                                    left = lseek(fi, 0, S_END, &err, &err);
   \   00000094   0D00A0E1           MOV      R0,SP
   \   00000098   01002DE9           PUSH     {R0}
   \   0000009C   04308DE2           ADD      R3,SP,#+4
   \   000000A0   0220A0E3           MOV      R2,#+2
   \   000000A4   0010A0E3           MOV      R1,#+0
   \   000000A8   0600A0E1           MOV      R0,R6
   \   000000AC   0F0000EF           SWI      +15
   \   000000B0   0080A0E1           MOV      R8,R0
   1161                                    lseek(fi, 0, S_SET, &err, &err);
   \   000000B4   04008DE2           ADD      R0,SP,#+4
   \   000000B8   01002DE9           PUSH     {R0}
   \   000000BC   08308DE2           ADD      R3,SP,#+8
   \   000000C0   0420A0E1           MOV      R2,R4
   \   000000C4   0210A0E1           MOV      R1,R2
   \   000000C8   0600A0E1           MOV      R0,R6
   \   000000CC   0F0000EF           SWI      +15
   1162                                    if (left)
   \   000000D0   000058E3           CMP      R8,#+0
   \   000000D4   08D08DE2           ADD      SP,SP,#+8
   \   000000D8   2200000A           BEQ      ??fcopy_3
   1163                                    {
   1164                                            buff = malloc(BUF_SIZE);
   \   000000DC   400CA0E3           MOV      R0,#+16384
   \   000000E0   140000EF           SWI      +20
   \   000000E4   0050B0E1           MOVS     R5,R0
   1165                                            if (!buff) goto L_EXIT;
   \   000000E8   0C00001A           BNE      ??fcopy_4
   1166                                    }
   1167                                    while (left) 
   1168                                    {
   1169                                            cb = left < BUF_SIZE ? left : BUF_SIZE;
   1170                                            left -= cb;
   1171            
   1172                                            if (fread(fi, buff, cb, &err) != cb) goto L_EXIT;
   1173                                            if (fwrite(fo, buff, cb, &err) != cb) goto L_EXIT;
   1174                                    }
   1175                                    res = 1;
   1176                            }
   1177                            else
   1178                              ShowMSG(1, (int)lgpData[LGP_FileInvalid]);
   1179                              
   1180                    }
   1181                  }
   1182          L_EXIT:
   1183          	if (buff) mfree(buff);
   \                     ??fcopy_5:
   \   000000EC   000055E3           CMP      R5,#+0
   \   000000F0   0100000A           BEQ      ??fcopy_6
   \   000000F4   0500A0E1           MOV      R0,R5
   \   000000F8   150000EF           SWI      +21
   1184          	if (fo != -1) fclose(fo, &err);
   \                     ??fcopy_6:
   \   000000FC   0D10A0E1           MOV      R1,SP
   \   00000100   0700A0E1           MOV      R0,R7
   \   00000104   0D0000EF           SWI      +13
   1185          	if (fi !=- 1) fclose(fi, &err);
   \                     ??fcopy_7:
   \   00000108   0D10A0E1           MOV      R1,SP
   \   0000010C   0600A0E1           MOV      R0,R6
   \   00000110   0D0000EF           SWI      +13
   1186          	return res;
   \                     ??fcopy_1:
   \   00000114   0400A0E1           MOV      R0,R4
   \   00000118   2CD08DE2           ADD      SP,SP,#+44
   \   0000011C   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??fcopy_4:
   \   00000120   400C58E3           CMP      R8,#+16384
   \   00000124   0890A0B1           MOVLT    R9,R8
   \   00000128   409CA0A3           MOVGE    R9,#+16384
   \   0000012C   098048E0           SUB      R8,R8,R9
   \   00000130   0D30A0E1           MOV      R3,SP
   \   00000134   0920A0E1           MOV      R2,R9
   \   00000138   0510A0E1           MOV      R1,R5
   \   0000013C   0600A0E1           MOV      R0,R6
   \   00000140   0B0000EF           SWI      +11
   \   00000144   090050E1           CMP      R0,R9
   \   00000148   E7FFFF1A           BNE      ??fcopy_5
   \   0000014C   0D30A0E1           MOV      R3,SP
   \   00000150   0920A0E1           MOV      R2,R9
   \   00000154   0510A0E1           MOV      R1,R5
   \   00000158   0700A0E1           MOV      R0,R7
   \   0000015C   0C0000EF           SWI      +12
   \   00000160   090050E1           CMP      R0,R9
   \   00000164   E0FFFF1A           BNE      ??fcopy_5
   \                     ??fcopy_3:
   \   00000168   000058E3           CMP      R8,#+0
   \   0000016C   EBFFFF1A           BNE      ??fcopy_4
   \   00000170   0140A0E3           MOV      R4,#+1
   \   00000174   DCFFFFEA           B        ??fcopy_5
   \                     ??fcopy_2:
   \   00000178   101198E5           LDR      R1,[R8, #+272]
   \   0000017C   0100A0E3           MOV      R0,#+1
   \   00000180   480100EF           SWI      +328
   \   00000184   DFFFFFEA           B        ??fcopy_7
   1187          }
   1188          

   \                                 In segment CODE, align 4, keep-with-next
   1189          static int savepage_box_onkey(GUI *data, GUI_MSG *msg)
   1190          {
   \                     savepage_box_onkey:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   6BDF4DE2           SUB      SP,SP,#+428
   1191            EDITCONTROL ec;
   1192            if (msg->keys==0xFFF)
   \   00000008   F210D1E1           LDRSH    R1,[R1, #+2]
   \   0000000C   FF20A0E3           MOV      R2,#+255
   \   00000010   F02E82E3           ORR      R2,R2,#0xF00
   \   00000014   020051E1           CMP      R1,R2
   \   00000018   2000001A           BNE      ??savepage_box_onkey_0
   1193            {
   1194              char fname[256];
   1195              char tfname[128];
   1196              ExtractEditControl(data,2,&ec);
   1197              char* src_fname = getCurrPageName();
   1198              strcpy(fname, "$pages\\");
   \   0000001C   88509FE5           LDR      R5,??savepage_box_onkey_1  ;; `?<Constant "$pages\\\\">`
   \   00000020   602F8DE2           ADD      R2,SP,#+384
   \   00000024   0210A0E3           MOV      R1,#+2
   \   00000028   690100EF           SWI      +361
   \   0000002C   ........           _BLF     getCurrPageName,??getCurrPageName??rA
   \   00000030   0040A0E1           MOV      R4,R0
   \   00000034   0510A0E1           MOV      R1,R5
   \   00000038   0D00A0E1           MOV      R0,SP
   \   0000003C   1A0000EF           SWI      +26
   1199              ws_2str(ec.pWS, tfname, 127);
   \   00000040   A8019DE5           LDR      R0,[SP, #+424]
   \   00000044   7F20A0E3           MOV      R2,#+127
   \   00000048   401F8DE2           ADD      R1,SP,#+256
   \   0000004C   A30000EF           SWI      +163
   1200              strcat(fname, tfname);
   \   00000050   401F8DE2           ADD      R1,SP,#+256
   \   00000054   0D00A0E1           MOV      R0,SP
   \   00000058   170000EF           SWI      +23
   1201              strcat(fname,".oms");
   \   0000005C   081085E2           ADD      R1,R5,#+8
   \   00000060   0D00A0E1           MOV      R0,SP
   \   00000064   170000EF           SWI      +23
   1202              char* dest_fname = getSymbolicPath(fname);
   \   00000068   0D00A0E1           MOV      R0,SP
   \   0000006C   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
   \   00000070   0050A0E1           MOV      R5,R0
   1203              int res = fcopy(src_fname, dest_fname);
   \   00000074   0510A0E1           MOV      R1,R5
   \   00000078   0400A0E1           MOV      R0,R4
   \   0000007C   ........           BL       fcopy
   \   00000080   0060A0E1           MOV      R6,R0
   1204              mfree(src_fname);
   \   00000084   0400A0E1           MOV      R0,R4
   \   00000088   150000EF           SWI      +21
   1205              mfree(dest_fname);
   \   0000008C   0500A0E1           MOV      R0,R5
   \   00000090   150000EF           SWI      +21
   1206              if (res)
   \   00000094   000056E3           CMP      R6,#+0
   1207                return (0xFF);
   \   00000098   FF00A013           MOVNE    R0,#+255
   \   0000009C   0000001A           BNE      ??savepage_box_onkey_2
   1208            }
   1209            return (0);
   \                     ??savepage_box_onkey_0:
   \   000000A0   0000A0E3           MOV      R0,#+0
   \                     ??savepage_box_onkey_2:
   \   000000A4   6BDF8DE2           ADD      SP,SP,#+428      ;; stack cleaning
   \   000000A8   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??savepage_box_onkey_1:
   \   000000AC   ........           DC32     `?<Constant "$pages\\\\">`
   1210          }
   1211          

   \                                 In segment DATA_C, align 4, align-sorted
   1212          static const INPUTDIA_DESC savepage_box_desc =
   \                     savepage_box_desc:
   \   00000000   01000000....       DC32 1, savepage_box_onkey, savepage_box_ghook, savepage_box_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 savepage_box_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1213          {
   1214            1,
   1215            savepage_box_onkey,
   1216            savepage_box_ghook,
   1217            (void *)savepage_box_locret,
   1218            0,
   1219            &savepage_box_menu_skt,
   1220            {0,0,0,0},
   1221            FONT_SMALL,
   1222            100,
   1223            101,
   1224            0,
   1225            //  0x00000001 - Выровнять по правому краю
   1226            //  0x00000002 - Выровнять по центру
   1227            //  0x00000004 - Инверсия знакомест
   1228            //  0x00000008 - UnderLine
   1229            //  0x00000020 - Не переносить слова
   1230            //  0x00000200 - bold
   1231            0,
   1232            //  0x00000002 - ReadOnly
   1233            //  0x00000004 - Не двигается курсор
   1234            //  0x40000000 - Поменять местами софт-кнопки
   1235            0x40000000
   1236          };
   1237          

   \                                 In segment CODE, align 4, keep-with-next
   1238          int CreateSavePageDialog(VIEWDATA *vd)
   1239          {
   \                     CreateSavePageDialog:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   1240            
   1241            void *ma=malloc_adr();
   1242            void *eq;
   1243            EDITCONTROL ec;
   1244            WSHDR * ews=AllocWS(256);
   1245            
   1246            eq=AllocEQueue(ma,mfree_adr());
   1247            
   1248            ascii2ws(ews,lgpData[LGP_SavePageString]);
   \   00000004   ........           LDR      R6,??DataTable32  ;; lgpData
   \   00000008   2CD04DE2           SUB      SP,SP,#+44
   \   0000000C   0040A0E1           MOV      R4,R0
   \   00000010   148000EF           SWI      +32788
   \   00000014   0070A0E1           MOV      R7,R0
   \   00000018   400FA0E3           MOV      R0,#+256
   \   0000001C   250100EF           SWI      +293
   \   00000020   0080A0E1           MOV      R8,R0
   \   00000024   158000EF           SWI      +32789
   \   00000028   0010A0E1           MOV      R1,R0
   \   0000002C   0700A0E1           MOV      R0,R7
   \   00000030   630100EF           SWI      +355
   \   00000034   841096E5           LDR      R1,[R6, #+132]
   \   00000038   0050A0E1           MOV      R5,R0
   \   0000003C   0800A0E1           MOV      R0,R8
   \   00000040   ........           _BLF     ascii2ws,??ascii2ws??rA
   1249            ConstructEditControl(&ec,ECT_HEADER,ECF_APPEND_EOL,ews,128);
   \   00000044   8000A0E3           MOV      R0,#+128
   \   00000048   01002DE9           PUSH     {R0}
   \   0000004C   0830A0E1           MOV      R3,R8
   \   00000050   4020A0E3           MOV      R2,#+64
   \   00000054   0110A0E3           MOV      R1,#+1
   \   00000058   04008DE2           ADD      R0,SP,#+4
   \   0000005C   650100EF           SWI      +357
   1250            AddEditControlToEditQend(eq,&ec,ma);
   \   00000060   0720A0E1           MOV      R2,R7
   \   00000064   04108DE2           ADD      R1,SP,#+4
   \   00000068   0500A0E1           MOV      R0,R5
   \   0000006C   660100EF           SWI      +358
   1251            
   1252            PrepareEditControl(&ec);
   \   00000070   04008DE2           ADD      R0,SP,#+4
   \   00000074   640100EF           SWI      +356
   1253            ascii2ws(ews, vd->title);
   \   00000078   E41094E5           LDR      R1,[R4, #+228]
   \   0000007C   0800A0E1           MOV      R0,R8
   \   00000080   ........           _BLF     ascii2ws,??ascii2ws??rA
   1254            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL,ews,256);
   \   00000084   400FA0E3           MOV      R0,#+256
   \   00000088   01002DE9           PUSH     {R0}
   \   0000008C   0830A0E1           MOV      R3,R8
   \   00000090   4020A0E3           MOV      R2,#+64
   \   00000094   0310A0E3           MOV      R1,#+3
   \   00000098   08008DE2           ADD      R0,SP,#+8
   \   0000009C   650100EF           SWI      +357
   1255            AddEditControlToEditQend(eq,&ec,ma);
   \   000000A0   0720A0E1           MOV      R2,R7
   1256          
   1257            FreeWS(ews);
   1258            patch_header(&savepage_box_hdr);
   \   000000A4   5C709FE5           LDR      R7,??CreateSavePageDialog_0  ;; savepage_box_menu_sk
   \   000000A8   08108DE2           ADD      R1,SP,#+8
   \   000000AC   0500A0E1           MOV      R0,R5
   \   000000B0   660100EF           SWI      +358
   \   000000B4   0800A0E1           MOV      R0,R8
   1259            patch_input(&savepage_box_desc);
   \   000000B8   4C809FE5           LDR      R8,??CreateSavePageDialog_0+0x4  ;; savepage_box_desc
   \   000000BC   290100EF           SWI      +297
   \   000000C0   180087E2           ADD      R0,R7,#+24
   \   000000C4   ........           _BLF     patch_header,??patch_header??rA
   \   000000C8   0800A0E1           MOV      R0,R8
   \   000000CC   ........           _BLF     patch_input,??patch_input??rA
   1260            savepage_box_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   \   000000D0   640096E5           LDR      R0,[R6, #+100]
   1261            savepage_box_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1262            savepage_box_hdr.lgp_id=(int)lgpData[LGP_SavePageHeader];
   1263            return CreateInputTextDialog(&savepage_box_desc,&savepage_box_hdr,eq,1,vd);
   \   000000D4   0130A0E3           MOV      R3,#+1
   \   000000D8   040087E5           STR      R0,[R7, #+4]
   \   000000DC   680096E5           LDR      R0,[R6, #+104]
   \   000000E0   0520A0E1           MOV      R2,R5
   \   000000E4   0C0087E5           STR      R0,[R7, #+12]
   \   000000E8   C80096E5           LDR      R0,[R6, #+200]
   \   000000EC   181087E2           ADD      R1,R7,#+24
   \   000000F0   240087E5           STR      R0,[R7, #+36]
   \   000000F4   10002DE9           PUSH     {R4}
   \   000000F8   0800A0E1           MOV      R0,R8
   \   000000FC   670100EF           SWI      +359
   \   00000100   38D08DE2           ADD      SP,SP,#+56
   \   00000104   F081BDE8           POP      {R4-R8,PC}       ;; return
   \                     ??CreateSavePageDialog_0:
   \   00000108   ........           DC32     savepage_box_menu_sk
   \   0000010C   ........           DC32     savepage_box_desc
   1264          }
   1265          
   1266          //------------------------------- History menu ---------------------------------
   1267          

   \                                 In segment CODE, align 4, keep-with-next
   1268          int history_menu_onkey(void *gui, GUI_MSG *msg) //history
   1269          {
   \                     history_menu_onkey:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   40DF4DE2           SUB      SP,SP,#+256
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0160A0E1           MOV      R6,R1
   1270            char **history = MenuGetUserPointer(gui);
   \   00000010   E00100EF           SWI      +480
   \   00000014   0050A0E1           MOV      R5,R0
   1271          
   1272            int i = GetCurMenuItem(gui);
   \   00000018   0400A0E1           MOV      R0,R4
   \   0000001C   8F0100EF           SWI      +399
   1273            if (msg->keys==0x3D || msg->keys==0x18)
   \   00000020   F210D6E1           LDRSH    R1,[R6, #+2]
   \   00000024   0040A0E3           MOV      R4,#+0
   \   00000028   3D0051E3           CMP      R1,#+61
   \   0000002C   18005113           CMPNE    R1,#+24
   \   00000030   2100001A           BNE      ??history_menu_onkey_0
   1274            {
   1275              if (history[i])
   \   00000034   005185E0           ADD      R5,R5,R0, LSL #+2
   \   00000038   000095E5           LDR      R0,[R5, #+0]
   \   0000003C   000050E3           CMP      R0,#+0
   \   00000040   1A00000A           BEQ      ??history_menu_onkey_1
   1276              {
   1277                char *histdelim = strchr(history[i], '|');
   \   00000044   7C10A0E3           MOV      R1,#+124
   \   00000048   180000EF           SWI      +24
   1278                if (histdelim)
   \   0000004C   000050E3           CMP      R0,#+0
   \   00000050   1600000A           BEQ      ??history_menu_onkey_1
   1279                {
   1280                  *histdelim = 0;   
   1281                  _safe_free(goto_url);
   \   00000054   ........           LDR      R6,??DataTable47  ;; goto_url
   \   00000058   0040C0E5           STRB     R4,[R0, #+0]
   \   0000005C   000096E5           LDR      R0,[R6, #+0]
   \   00000060   000050E3           CMP      R0,#+0
   \   00000064   0000000A           BEQ      ??history_menu_onkey_2
   \   00000068   150000EF           SWI      +21
   \                     ??history_menu_onkey_2:
   \   0000006C   004086E5           STR      R4,[R6, #+0]
   1282                  goto_url=malloc(strlen(history[i])+3);
   \   00000070   000095E5           LDR      R0,[R5, #+0]
   \   00000074   1B0000EF           SWI      +27
   \   00000078   030080E2           ADD      R0,R0,#+3
   \   0000007C   140000EF           SWI      +20
   \   00000080   000086E5           STR      R0,[R6, #+0]
   1283                  goto_url[0] = '0'; goto_url[1] = '/';      
   \   00000084   3010A0E3           MOV      R1,#+48
   \   00000088   0010C0E5           STRB     R1,[R0, #+0]
   \   0000008C   000096E5           LDR      R0,[R6, #+0]
   \   00000090   2F10A0E3           MOV      R1,#+47
   \   00000094   0110C0E5           STRB     R1,[R0, #+1]
   1284                  strcpy(goto_url+2,history[i]);
   \   00000098   000096E5           LDR      R0,[R6, #+0]
   \   0000009C   001095E5           LDR      R1,[R5, #+0]
   \   000000A0   020080E2           ADD      R0,R0,#+2
   \   000000A4   1A0000EF           SWI      +26
   1285                  return (0xFF);
   \   000000A8   FF00A0E3           MOV      R0,#+255
   \   000000AC   000000EA           B        ??history_menu_onkey_3
   1286                }
   1287              }
   1288              return(1);
   \                     ??history_menu_onkey_1:
   \   000000B0   0100A0E3           MOV      R0,#+1
   \                     ??history_menu_onkey_3:
   \   000000B4   40DF8DE2           ADD      SP,SP,#+256
   \   000000B8   F080BDE8           POP      {R4-R7,PC}
   1289            }
   1290            if (msg->gbsmsg->submess == '#')
   \                     ??history_menu_onkey_0:
   \   000000BC   005185E0           ADD      R5,R5,R0, LSL #+2
   \   000000C0   040096E5           LDR      R0,[R6, #+4]
   \   000000C4   080090E5           LDR      R0,[R0, #+8]
   \   000000C8   230050E3           CMP      R0,#+35
   \   000000CC   1100001A           BNE      ??history_menu_onkey_4
   1291            {
   1292              if (history[i])
   \   000000D0   000095E5           LDR      R0,[R5, #+0]
   \   000000D4   000050E3           CMP      R0,#+0
   \   000000D8   0E00000A           BEQ      ??history_menu_onkey_4
   1293              {
   1294                char *histdelim = strchr(history[i], '|');
   \   000000DC   7C10A0E3           MOV      R1,#+124
   \   000000E0   180000EF           SWI      +24
   \   000000E4   0070B0E1           MOVS     R7,R0
   1295                if (histdelim)
   \   000000E8   0A00000A           BEQ      ??history_menu_onkey_4
   1296                {
   1297                  char histurl[256];
   1298                  memcpy(histurl, history[i], histdelim-history[i]);
   \   000000EC   000095E5           LDR      R0,[R5, #+0]
   \   000000F0   002047E0           SUB      R2,R7,R0
   \   000000F4   0010A0E1           MOV      R1,R0
   \   000000F8   0D00A0E1           MOV      R0,SP
   \   000000FC   1E0100EF           SWI      +286
   1299                  histurl[histdelim-history[i]] = 0;
   \   00000100   000095E5           LDR      R0,[R5, #+0]
   \   00000104   0D10A0E1           MOV      R1,SP
   \   00000108   000047E0           SUB      R0,R7,R0
   \   0000010C   0140C0E7           STRB     R4,[R0, +R1]
   1300                  ShowLink(histurl);
   \   00000110   0D00A0E1           MOV      R0,SP
   \   00000114   ........           _BLF     ShowLink,??ShowLink??rA
   1301                }
   1302              }
   1303            }
   1304            if (msg->gbsmsg->submess == '*')
   \                     ??history_menu_onkey_4:
   \   00000118   040096E5           LDR      R0,[R6, #+4]
   \   0000011C   080090E5           LDR      R0,[R0, #+8]
   \   00000120   2A0050E3           CMP      R0,#+42
   \   00000124   0800001A           BNE      ??history_menu_onkey_5
   1305            {
   1306              if (history[i])
   \   00000128   000095E5           LDR      R0,[R5, #+0]
   \   0000012C   000050E3           CMP      R0,#+0
   \   00000130   0600000A           BEQ      ??history_menu_onkey_6
   1307              {
   1308                char* histtitle = strchr(history[i], '|');
   \   00000134   7C10A0E3           MOV      R1,#+124
   \   00000138   180000EF           SWI      +24
   1309                if (histtitle)
   \   0000013C   000050E3           CMP      R0,#+0
   \   00000140   0200000A           BEQ      ??history_menu_onkey_6
   1310                {
   1311                  ShowLink(histtitle+1);
   \   00000144   010080E2           ADD      R0,R0,#+1
   \   00000148   ........           _BLF     ShowLink,??ShowLink??rA
   1312                }
   1313              }
   1314            }
   1315            return (0);
   \                     ??history_menu_onkey_5:
   \   0000014C   0000A0E3           MOV      R0,#+0
   \                     ??history_menu_onkey_6:
   \   00000150   40DF8DE2           ADD      SP,SP,#+256      ;; stack cleaning
   \   00000154   F080BDE8           POP      {R4-R7,PC}       ;; return
   1316          }
   1317          

   \                                 In segment CODE, align 4, keep-with-next
   1318          void history_menu_ghook(void *gui, int cmd)
   1319          {
   \                     history_menu_ghook:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0140A0E1           MOV      R4,R1
   1320            extern const int HISTORY_DEPTH;
   1321            int i;
   1322            char **history = MenuGetUserPointer(gui);
   \   00000008   E00100EF           SWI      +480
   \   0000000C   0050A0E1           MOV      R5,R0
   1323            if (cmd == TI_CMD_DESTROY)
   \   00000010   030054E3           CMP      R4,#+3
   \   00000014   1100001A           BNE      ??history_menu_ghook_0
   1324            {
   1325              for(i = 0; i < HISTORY_DEPTH; i++)
   \   00000018   50009FE5           LDR      R0,??history_menu_ghook_1  ;; HISTORY_DEPTH
   \   0000001C   0040A0E3           MOV      R4,#+0
   \   00000020   006090E5           LDR      R6,[R0, #+0]
   \   00000024   010056E3           CMP      R6,#+1
   \   00000028   070000AA           BGE      ??history_menu_ghook_2
   \   0000002C   0500A0E1           MOV      R0,R5
   \   00000030   150000EF           SWI      +21
   \   00000034   7080BDE8           POP      {R4-R6,PC}
   1326                if(history[i])
   \                     ??history_menu_ghook_3:
   \   00000038   040195E7           LDR      R0,[R5, +R4, LSL #+2]
   \   0000003C   000050E3           CMP      R0,#+0
   \   00000040   0000000A           BEQ      ??history_menu_ghook_4
   1327                  mfree(history[i]);
   \   00000044   150000EF           SWI      +21
   \                     ??history_menu_ghook_4:
   \   00000048   014084E2           ADD      R4,R4,#+1
   \                     ??history_menu_ghook_2:
   \   0000004C   060054E1           CMP      R4,R6
   \   00000050   F8FFFFBA           BLT      ??history_menu_ghook_3
   1328              mfree(history);
   \   00000054   0500A0E1           MOV      R0,R5
   \   00000058   150000EF           SWI      +21
   \   0000005C   7080BDE8           POP      {R4-R6,PC}
   1329            }
   1330            if (cmd == TI_CMD_FOCUS)
   \                     ??history_menu_ghook_0:
   \   00000060   0A0054E3           CMP      R4,#+10
   \   00000064   7080BD18           POPNE    {R4-R6,PC}
   1331            {
   1332              DisableIDLETMR();
   \   00000068   7F0100EF           SWI      +383
   1333            }
   1334          }
   \   0000006C   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??history_menu_ghook_1:
   \   00000070   ........           DC32     HISTORY_DEPTH
   1335          

   \                                 In segment CODE, align 4, keep-with-next
   1336          void history_menu_iconhndl(void *gui, int cur_item, void *user_pointer)
   1337          {
   \                     history_menu_iconhndl:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
   1338            char **history=user_pointer;
   1339            int len;
   1340            WSHDR *ws;
   1341            void *item=AllocMenuItem(gui);
   \   00000010   970100EF           SWI      +407
   \   00000014   0070A0E1           MOV      R7,R0
   1342          
   1343            if (history[cur_item])
   \   00000018   050196E7           LDR      R0,[R6, +R5, LSL #+2]
   \   0000001C   000050E3           CMP      R0,#+0
   \   00000020   0C00000A           BEQ      ??history_menu_iconhndl_0
   1344            {
   1345              char* histtitle = strchr(history[cur_item], '|');
   \   00000024   7C10A0E3           MOV      R1,#+124
   \   00000028   180000EF           SWI      +24
   \   0000002C   0060B0E1           MOVS     R6,R0
   1346              if (histtitle)
   \   00000030   0800000A           BEQ      ??history_menu_iconhndl_0
   1347              {
   1348                histtitle++;
   1349                len=strlen(histtitle);
   \   00000034   016080E2           ADD      R6,R0,#+1
   \   00000038   0600A0E1           MOV      R0,R6
   \   0000003C   1B0000EF           SWI      +27
   1350                ws=AllocMenuWS(gui,len+4);
   \   00000040   041080E2           ADD      R1,R0,#+4
   \   00000044   0400A0E1           MOV      R0,R4
   \   00000048   980100EF           SWI      +408
   \   0000004C   0080A0E1           MOV      R8,R0
   1351                ascii2ws(ws,histtitle);
   \   00000050   0610A0E1           MOV      R1,R6
   \   00000054   060000EA           B        ??history_menu_iconhndl_1
   1352              }
   1353              else
   1354              {
   1355                ws=AllocMenuWS(gui,10);
   \                     ??history_menu_iconhndl_0:
   \   00000058   0A10A0E3           MOV      R1,#+10
   \   0000005C   0400A0E1           MOV      R0,R4
   \   00000060   980100EF           SWI      +408
   \   00000064   0080A0E1           MOV      R8,R0
   1356                ascii2ws(ws,lgpData[LGP_Error]);
   \   00000068   ........           LDR      R0,??DataTable34  ;; lgpData + 24
   \   0000006C   001090E5           LDR      R1,[R0, #+0]
   \   00000070   0800A0E1           MOV      R0,R8
   \                     ??history_menu_iconhndl_1:
   \   00000074   ........           _BLF     ascii2ws,??ascii2ws??rA
   1357              }
   1358            }
   1359            else
   1360            {
   1361              ws=AllocMenuWS(gui,10);
   1362              ascii2ws(ws,lgpData[LGP_Error]);
   1363            }
   1364            SetMenuItemText(gui, item, ws, cur_item);
   \   00000078   0530A0E1           MOV      R3,R5
   \   0000007C   0820A0E1           MOV      R2,R8
   \   00000080   0710A0E1           MOV      R1,R7
   \   00000084   0400A0E1           MOV      R0,R4
   \   00000088   9A0100EF           SWI      +410
   1365          }
   \   0000008C   F081BDE8           POP      {R4-R8,PC}       ;; return
   1366          

   \                                 In segment DATA_I, align 4, align-sorted
   1367          int history_menu_softkeys[]={0,1,2};
   \                     history_menu_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for history_menu_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
   1368          SOFTKEY_DESC history_menu_sk[]=
   \                     history_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for history_menu_sk>`
   1369          {
   1370            {0x0018,0x0000,(int)"Go"},
   1371            {0x0001,0x0000,(int)"Cancel"},
   1372            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1373          };
   1374          
   1375          SOFTKEYSTAB history_menu_skt=
   1376          {
   1377            history_menu_sk,0
   1378          };
   1379          
   1380          HEADER_DESC history_menu_header={0,0,0,0,NULL,(int)"History:",LGP_NULL};
   \                     history_menu_header:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for history_menu_header>`
   1381          
   1382          MENU_DESC history_menu_struct=
   \                     history_menu_struct:
   \   0000002C                      DS8 44
   \   00000058                      REQUIRE `?<Initializer for history_menu_struct>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     history_menu_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for history_menu_skt>`
   1383          {
   1384            8, history_menu_onkey, history_menu_ghook, NULL,
   1385            history_menu_softkeys,
   1386            &history_menu_skt,
   1387            0x10,
   1388            history_menu_iconhndl,
   1389            NULL,   //Items
   1390            NULL,   //Procs
   1391            0   //n
   1392          };
   1393          

   \                                 In segment CODE, align 4, keep-with-next
   1394          int CreateHistoryMenu()
   1395          {
   \                     CreateHistoryMenu:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   1396            int depth;
   1397            char **history;
   1398            history = GetHistory(&depth);
   \   00000008   0D00A0E1           MOV      R0,SP
   \   0000000C   ........           _BLF     GetHistory,??GetHistory??rA
   \   00000010   0040A0E1           MOV      R4,R0
   1399            if (!depth) return 0;
   \   00000014   00009DE5           LDR      R0,[SP, #+0]
   \   00000018   000050E3           CMP      R0,#+0
   \   0000001C   3280BD08           POPEQ    {R1,R4,R5,PC}
   1400            patch_header(&history_menu_header);
   \   00000020   54509FE5           LDR      R5,??CreateHistoryMenu_0  ;; history_menu_sk
   \   00000024   180085E2           ADD      R0,R5,#+24
   \   00000028   ........           _BLF     patch_header,??patch_header??rA
   1401            history_menu_sk[0].lgp_id=(int)lgpData[LGP_Go];
   \   0000002C   ........           LDR      R0,??DataTable50  ;; lgpData
   1402            history_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1403            history_menu_header.lgp_id=(int)lgpData[LGP_HistoryHeader];
   1404            return CreateMenu(0, 0, &history_menu_struct, &history_menu_header, 0, depth, history, 0);
   \   00000030   183085E2           ADD      R3,R5,#+24
   \   00000034   D01090E5           LDR      R1,[R0, #+208]
   \   00000038   2C2085E2           ADD      R2,R5,#+44
   \   0000003C   041085E5           STR      R1,[R5, #+4]
   \   00000040   681090E5           LDR      R1,[R0, #+104]
   \   00000044   D40090E5           LDR      R0,[R0, #+212]
   \   00000048   0C1085E5           STR      R1,[R5, #+12]
   \   0000004C   240085E5           STR      R0,[R5, #+36]
   \   00000050   0000A0E3           MOV      R0,#+0
   \   00000054   01002DE9           PUSH     {R0}
   \   00000058   10002DE9           PUSH     {R4}
   \   0000005C   08009DE5           LDR      R0,[SP, #+8]
   \   00000060   0010A0E3           MOV      R1,#+0
   \   00000064   01002DE9           PUSH     {R0}
   \   00000068   0000A0E3           MOV      R0,#+0
   \   0000006C   01002DE9           PUSH     {R0}
   \   00000070   520100EF           SWI      +338
   \   00000074   10D08DE2           ADD      SP,SP,#+16
   \   00000078   3280BDE8           POP      {R1,R4,R5,PC}    ;; return
   \                     ??CreateHistoryMenu_0:
   \   0000007C   ........           DC32     history_menu_sk
   1405          }
   1406          
   1407          //--------------------------------- Url input ----------------------------------
   1408          
   1409          SOFTKEY_DESC input_url_sk[]=
   1410          {
   1411            {0x0018,0x0000, NULL},
   1412            {0x0001,0x0000, NULL},
   1413            {0x003D,0x0000, (int)LGP_DOIT_PIC}
   1414          };
   1415          

   \                                 In segment DATA_C, align 4, align-sorted
   1416          static const SOFTKEYSTAB input_url_skt=
   \                     input_url_skt:
   \   00000000   ........0000       DC32 input_url_sk, 0
   \              0000        

   \                                 In segment DATA_I, align 4, align-sorted
   \                     input_url_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for input_url_sk>`
   1417          {
   1418            input_url_sk,0
   1419          };
   1420          
   1421          
   1422          HEADER_DESC input_url_header={0,0,0,0,NULL,NULL,LGP_NULL};
   \                     input_url_header:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for input_url_header>`
   1423          

   \                                 In segment CODE, align 4, keep-with-next
   1424          static void input_url_ghook(GUI *data, int cmd)
   1425          {
   1426            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Go]};
   \                     input_url_ghook:
   \   00000000   44309FE5           LDR      R3,??input_url_ghook_0  ;; `?<Constant {4095, 0, 0}>_3`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   300093E8           LDM      R3,{R4,R5}
   \   00000010   38309FE5           LDR      R3,??input_url_ghook_0+0x4  ;; lgpData + 208
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   300082E8           STM      R2,{R4,R5}
   \   0000001C   003093E5           LDR      R3,[R3, #+0]
   1427            if (cmd==TI_CMD_FOCUS)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   04308DE5           STR      R3,[SP, #+4]
   \   00000028   0100001A           BNE      ??input_url_ghook_1
   1428            {
   1429              DisableIDLETMR();
   \   0000002C   7F0100EF           SWI      +383
   \   00000030   3380BDE8           POP      {R0,R1,R4,R5,PC}
   1430            }
   1431            if (cmd==TI_CMD_REDRAW)
   \                     ??input_url_ghook_1:
   \   00000034   070051E3           CMP      R1,#+7
   \   00000038   3380BD18           POPNE    {R0,R1,R4,R5,PC}
   1432            {
   1433              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000003C   0020A0E3           MOV      R2,#+0
   \   00000040   0D10A0E1           MOV      R1,SP
   \   00000044   680100EF           SWI      +360
   1434            }
   1435          }
   \   00000048   3380BDE8           POP      {R0,R1,R4,R5,PC}  ;; return
   \                     ??input_url_ghook_0:
   \   0000004C   ........           DC32     `?<Constant {4095, 0, 0}>_3`
   \   00000050   ........           DC32     lgpData + 208
   1436          

   \                                 In segment CODE, align 4, keep-with-next
   1437          static void input_url_locret(void){}
   \                     input_url_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1438          

   \                                 In segment CODE, align 4, keep-with-next
   1439          static int input_url_onkey(GUI *data, GUI_MSG *msg)
   1440          {
   \                     input_url_onkey:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   1441            if (msg->keys==0xFFF || msg->keys == 0x18)
   \   00000008   F210D1E1           LDRSH    R1,[R1, #+2]
   \   0000000C   FF20A0E3           MOV      R2,#+255
   \   00000010   F02E82E3           ORR      R2,R2,#0xF00
   \   00000014   020051E1           CMP      R1,R2
   \   00000018   18005113           CMPNE    R1,#+24
   \   0000001C   2E00001A           BNE      ??input_url_onkey_0
   1442            {
   1443              EDITCONTROL ec;
   1444              ExtractEditControl(data,1,&ec);
   1445              _safe_free(goto_url);
   \   00000020   ........           LDR      R4,??DataTable47  ;; goto_url
   \   00000024   0D20A0E1           MOV      R2,SP
   \   00000028   0110A0E3           MOV      R1,#+1
   \   0000002C   690100EF           SWI      +361
   \   00000030   000094E5           LDR      R0,[R4, #+0]
   \   00000034   000050E3           CMP      R0,#+0
   \   00000038   0000000A           BEQ      ??input_url_onkey_1
   \   0000003C   150000EF           SWI      +21
   \                     ??input_url_onkey_1:
   \   00000040   0050A0E3           MOV      R5,#+0
   \   00000044   005084E5           STR      R5,[R4, #+0]
   1446              char * s = goto_url = (char *)malloc(ec.pWS->wsbody[0]+3);
   \   00000048   28009DE5           LDR      R0,[SP, #+40]
   1447              *s++='0';
   1448              *s++='/';
   1449              for (int i=0; i<ec.pWS->wsbody[0]; i++) *s++=char16to8(ec.pWS->wsbody[i+1]);
   \   0000004C   0070A0E3           MOV      R7,#+0
   \   00000050   000090E5           LDR      R0,[R0, #+0]
   \   00000054   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000058   030080E2           ADD      R0,R0,#+3
   \   0000005C   140000EF           SWI      +20
   \   00000060   000084E5           STR      R0,[R4, #+0]
   \   00000064   0060A0E1           MOV      R6,R0
   \   00000068   3000A0E3           MOV      R0,#+48
   \   0000006C   ........           STRB     R0,[R6], #+1
   \   00000070   2F00A0E3           MOV      R0,#+47
   \   00000074   ........           STRB     R0,[R6], #+1
   \   00000078   28009DE5           LDR      R0,[SP, #+40]
   \   0000007C   000090E5           LDR      R0,[R0, #+0]
   \   00000080   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000084   000050E3           CMP      R0,#+0
   \   00000088   0500001A           BNE      ??input_url_onkey_2
   \   0000008C   090000EA           B        ??input_url_onkey_3
   \                     ??input_url_onkey_4:
   \   00000090   870080E0           ADD      R0,R0,R7, LSL #+1
   \   00000094   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000098   017087E2           ADD      R7,R7,#+1
   \   0000009C   ........           _BLF     char16to8,??char16to8??rA
   \   000000A0   ........           STRB     R0,[R6], #+1
   \                     ??input_url_onkey_2:
   \   000000A4   28009DE5           LDR      R0,[SP, #+40]
   \   000000A8   000090E5           LDR      R0,[R0, #+0]
   \   000000AC   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000B0   010057E1           CMP      R7,R1
   \   000000B4   F5FFFFBA           BLT      ??input_url_onkey_4
   1450              *s = 0;
   \                     ??input_url_onkey_3:
   \   000000B8   0050C6E5           STRB     R5,[R6, #+0]
   1451              goto_url = ToWeb(goto_url,0,0);
   \   000000BC   000094E5           LDR      R0,[R4, #+0]
   \   000000C0   0020A0E3           MOV      R2,#+0
   \   000000C4   0210A0E1           MOV      R1,R2
   \   000000C8   ........           _BLF     ToWeb,??ToWeb??rA
   \   000000CC   000084E5           STR      R0,[R4, #+0]
   1452              return 0xFF;
   \   000000D0   FF00A0E3           MOV      R0,#+255
   \   000000D4   2CD08DE2           ADD      SP,SP,#+44
   \   000000D8   F080BDE8           POP      {R4-R7,PC}
   1453            }
   1454            return (0);
   \                     ??input_url_onkey_0:
   \   000000DC   0000A0E3           MOV      R0,#+0
   \   000000E0   2CD08DE2           ADD      SP,SP,#+44
   \   000000E4   F080BDE8           POP      {R4-R7,PC}       ;; return
   1455          }
   1456          

   \                                 In segment DATA_C, align 4, align-sorted
   1457          static const INPUTDIA_DESC input_url_desc =
   \                     input_url_desc:
   \   00000000   01000000....       DC32 1, input_url_onkey, input_url_ghook, input_url_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 input_url_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1458          {
   1459            1,
   1460            input_url_onkey,
   1461            input_url_ghook,
   1462            (void *)input_url_locret,
   1463            0,
   1464            &input_url_skt,
   1465            {0,0,0,0},
   1466            FONT_SMALL,
   1467            100,
   1468            101,
   1469            0,
   1470            //  0x00000001 - Выровнять по правому краю
   1471            //  0x00000002 - Выровнять по центру
   1472            //  0x00000004 - Инверсия знакомест
   1473            //  0x00000008 - UnderLine
   1474            //  0x00000020 - Не переносить слова
   1475            //  0x00000200 - bold
   1476            0,
   1477            //  0x00000002 - ReadOnly
   1478            //  0x00000004 - Не двигается курсор
   1479            //  0x40000000 - Поменять местами софт-кнопки
   1480            0x40000000
   1481          };
   1482          
   1483          

   \                                 In segment CODE, align 4, keep-with-next
   1484          int CreateInputUrl()
   1485          {
   \                     CreateInputUrl:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   1486            void *ma=malloc_adr();
   \   00000008   148000EF           SWI      +32788
   \   0000000C   0040A0E1           MOV      R4,R0
   1487            void *eq;
   1488            char *url_start = "";
   1489            EDITCONTROL ec;
   1490            
   1491            eq=AllocEQueue(ma,mfree_adr());    // Extension
   \   00000010   158000EF           SWI      +32789
   \   00000014   0010A0E1           MOV      R1,R0
   \   00000018   0400A0E1           MOV      R0,R4
   \   0000001C   630100EF           SWI      +355
   \   00000020   0050A0E1           MOV      R5,R0
   1492            WSHDR *ews=AllocWS(1024);
   \   00000024   400EA0E3           MOV      R0,#+1024
   \   00000028   250100EF           SWI      +293
   \   0000002C   0060A0E1           MOV      R6,R0
   1493          
   1494            MAIN_CSM *main_csm;
   1495            if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \   00000030   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   00000034   5B7F8FE2           ADR      R7,??CreateInputUrl_0  ;; ""
   \   00000038   000090E5           LDR      R0,[R0, #+0]
   \   0000003C   080100EF           SWI      +264
   \   00000040   000050E3           CMP      R0,#+0
   \   00000044   2E00000A           BEQ      ??CreateInputUrl_1
   1496            {
   1497              VIEW_GUI *p=FindGUIbyId(main_csm->view_id,NULL);
   \   00000048   280090E5           LDR      R0,[R0, #+40]
   \   0000004C   0010A0E3           MOV      R1,#+0
   \   00000050   090200EF           SWI      +521
   1498              if (p->vd->pageurl)
   \   00000054   340090E5           LDR      R0,[R0, #+52]
   \   00000058   E01090E5           LDR      R1,[R0, #+224]
   \   0000005C   000051E3           CMP      R1,#+0
   \   00000060   0D00000A           BEQ      ??CreateInputUrl_2
   1499              {
   1500                for(url_start = p->vd->pageurl; *url_start && *url_start != '/'; url_start++);
   \   00000064   0170A0E1           MOV      R7,R1
   \   00000068   000000EA           B        ??CreateInputUrl_3
   \                     ??CreateInputUrl_4:
   \   0000006C   017087E2           ADD      R7,R7,#+1
   \                     ??CreateInputUrl_3:
   \   00000070   0000D7E5           LDRB     R0,[R7, #+0]
   \   00000074   000050E3           CMP      R0,#+0
   \   00000078   2F005013           CMPNE    R0,#+47
   \   0000007C   FAFFFF1A           BNE      ??CreateInputUrl_4
   1501                for(; *url_start && *url_start == '/'; url_start++);
   \                     ??CreateInputUrl_5:
   \   00000080   0000D7E5           LDRB     R0,[R7, #+0]
   \   00000084   000050E3           CMP      R0,#+0
   \   00000088   1D00000A           BEQ      ??CreateInputUrl_1
   \   0000008C   2F0050E3           CMP      R0,#+47
   \   00000090   1B00001A           BNE      ??CreateInputUrl_1
   \   00000094   017087E2           ADD      R7,R7,#+1
   \   00000098   F8FFFFEA           B        ??CreateInputUrl_5
   1502              }
   1503              else
   1504              {
   1505                switch(view_url_mode)
   \                     ??CreateInputUrl_2:
   \   0000009C   ........           LDR      R1,??DataTable38  ;; view_url_mode
   \   000000A0   ........           LDR      R0,??DataTable39  ;; view_url
   \   000000A4   001091E5           LDR      R1,[R1, #+0]
   \   000000A8   000090E5           LDR      R0,[R0, #+0]
   \   000000AC   000051E3           CMP      R1,#+0
   \   000000B0   0200000A           BEQ      ??CreateInputUrl_6
   \   000000B4   011051E2           SUBS     R1,R1,#+1
   \   000000B8   0200000A           BEQ      ??CreateInputUrl_7
   \   000000BC   100000EA           B        ??CreateInputUrl_1
   1506                {
   1507                case MODE_FILE:
   1508                  url_start=view_url;
   \                     ??CreateInputUrl_6:
   \   000000C0   0070A0E1           MOV      R7,R0
   1509                  URL_unescape(url_start);
   \   000000C4   0D0000EA           B        ??CreateInputUrl_8
   1510                  break;
   1511                case MODE_URL:
   1512                  for(url_start = view_url; *url_start && *url_start != '/'; url_start++);
   \                     ??CreateInputUrl_7:
   \   000000C8   0070A0E1           MOV      R7,R0
   \   000000CC   000000EA           B        ??CreateInputUrl_9
   \                     ??CreateInputUrl_10:
   \   000000D0   017087E2           ADD      R7,R7,#+1
   \                     ??CreateInputUrl_9:
   \   000000D4   0000D7E5           LDRB     R0,[R7, #+0]
   \   000000D8   000050E3           CMP      R0,#+0
   \   000000DC   2F005013           CMPNE    R0,#+47
   \   000000E0   FAFFFF1A           BNE      ??CreateInputUrl_10
   1513                  for(; *url_start && *url_start == '/'; url_start++);
   \                     ??CreateInputUrl_11:
   \   000000E4   0000D7E5           LDRB     R0,[R7, #+0]
   \   000000E8   000050E3           CMP      R0,#+0
   \   000000EC   0200000A           BEQ      ??CreateInputUrl_12
   \   000000F0   2F0050E3           CMP      R0,#+47
   \   000000F4   01708702           ADDEQ    R7,R7,#+1
   \   000000F8   F9FFFF0A           BEQ      ??CreateInputUrl_11
   1514                  URL_unescape(url_start);
   \                     ??CreateInputUrl_12:
   \   000000FC   0700A0E1           MOV      R0,R7
   \                     ??CreateInputUrl_8:
   \   00000100   ........           _BLF     URL_unescape,??URL_unescape??rA
   1515                  break;
   1516                default:
   1517                  break;
   1518                }
   1519              }
   1520            }
   1521            utf8_2ws(ews, url_start, 1024);
   \                     ??CreateInputUrl_1:
   \   00000104   402EA0E3           MOV      R2,#+1024
   \   00000108   0710A0E1           MOV      R1,R7
   \   0000010C   0600A0E1           MOV      R0,R6
   \   00000110   E30100EF           SWI      +483
   1522            
   1523            PrepareEditControl(&ec);
   \   00000114   0D00A0E1           MOV      R0,SP
   \   00000118   640100EF           SWI      +356
   1524            ConstructEditControl(&ec,ECT_NORMAL_TEXT, ECF_APPEND_EOL, ews, 1024);
   \   0000011C   400EA0E3           MOV      R0,#+1024
   \   00000120   01002DE9           PUSH     {R0}
   \   00000124   0630A0E1           MOV      R3,R6
   \   00000128   4020A0E3           MOV      R2,#+64
   \   0000012C   0310A0E3           MOV      R1,#+3
   \   00000130   04008DE2           ADD      R0,SP,#+4
   \   00000134   650100EF           SWI      +357
   1525            AddEditControlToEditQend(eq,&ec,ma); //2
   \   00000138   0420A0E1           MOV      R2,R4
   1526          
   1527            FreeWS(ews);
   1528            patch_header(&input_url_header);
   \   0000013C   68409FE5           LDR      R4,??CreateInputUrl_0+0x4  ;; input_url_sk
   \   00000140   04108DE2           ADD      R1,SP,#+4
   \   00000144   0500A0E1           MOV      R0,R5
   \   00000148   660100EF           SWI      +358
   \   0000014C   0600A0E1           MOV      R0,R6
   1529            patch_input(&input_url_desc);
   \   00000150   58609FE5           LDR      R6,??CreateInputUrl_0+0x8  ;; input_url_desc
   \   00000154   290100EF           SWI      +297
   \   00000158   180084E2           ADD      R0,R4,#+24
   \   0000015C   ........           _BLF     patch_header,??patch_header??rA
   \   00000160   0600A0E1           MOV      R0,R6
   \   00000164   ........           _BLF     patch_input,??patch_input??rA
   1530            input_url_sk[0].lgp_id=(int)lgpData[LGP_Go];
   \   00000168   ........           LDR      R0,??DataTable50  ;; lgpData
   1531            input_url_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1532            input_url_header.lgp_id=(int)lgpData[LGP_AddressHeader];
   1533            return CreateInputTextDialog(&input_url_desc, &input_url_header, eq,1,0);
   \   0000016C   0130A0E3           MOV      R3,#+1
   \   00000170   D01090E5           LDR      R1,[R0, #+208]
   \   00000174   0520A0E1           MOV      R2,R5
   \   00000178   041084E5           STR      R1,[R4, #+4]
   \   0000017C   681090E5           LDR      R1,[R0, #+104]
   \   00000180   D80090E5           LDR      R0,[R0, #+216]
   \   00000184   0C1084E5           STR      R1,[R4, #+12]
   \   00000188   240084E5           STR      R0,[R4, #+36]
   \   0000018C   0000A0E3           MOV      R0,#+0
   \   00000190   01002DE9           PUSH     {R0}
   \   00000194   181084E2           ADD      R1,R4,#+24
   \   00000198   0600A0E1           MOV      R0,R6
   \   0000019C   670100EF           SWI      +359
   \   000001A0   34D08DE2           ADD      SP,SP,#+52
   \   000001A4   F080BDE8           POP      {R4-R7,PC}       ;; return
   \                     ??CreateInputUrl_0:
   \   000001A8   00000000           DC8      "",+0,+0,+0
   \   000001AC   ........           DC32     input_url_sk
   \   000001B0   ........           DC32     input_url_desc
   1534          }
   1535          
   1536          //--------------------------------- Main menu ----------------------------------
   1537          

   \                                 In segment CODE, align 4, keep-with-next
   1538          static void main_menu_goto_url(GUI *gui)
   1539          {
   1540            MAIN_CSM *main_csm;
   1541            int goto_url_id;
   1542            if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     main_menu_goto_url:
   \   00000000   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   00000004   10402DE9           PUSH     {R4,LR}
   \   00000008   000090E5           LDR      R0,[R0, #+0]
   \   0000000C   080100EF           SWI      +264
   \   00000010   0040B0E1           MOVS     R4,R0
   \   00000014   0100000A           BEQ      ??main_menu_goto_url_0
   1543            {
   1544              goto_url_id=CreateInputUrl();
   1545              main_csm->goto_url=goto_url_id;
   \   00000018   ........           BL       CreateInputUrl
   \   0000001C   2C0084E5           STR      R0,[R4, #+44]
   1546            } 
   1547            GeneralFuncF1(1);  
   \                     ??main_menu_goto_url_0:
   \   00000020   0100A0E3           MOV      R0,#+1
   \   00000024   3B0100EF           SWI      +315
   1548          }
   \   00000028   1080BDE8           POP      {R4,PC}          ;; return
   1549          

   \                                 In segment CODE, align 4, keep-with-next
   1550          static void main_menu_goto_bookmarks(GUI *gui)
   1551          {
   1552            MAIN_CSM *main_csm;
   1553            int bookmark_menu_id;
   1554            if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     main_menu_goto_bookmarks:
   \   00000000   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   00000004   10402DE9           PUSH     {R4,LR}
   \   00000008   000090E5           LDR      R0,[R0, #+0]
   \   0000000C   080100EF           SWI      +264
   \   00000010   0040B0E1           MOVS     R4,R0
   \   00000014   0100000A           BEQ      ??main_menu_goto_bookmarks_0
   1555            {
   1556              bookmark_menu_id=CreateBookmarksMenu();
   1557              main_csm->sel_bmk=bookmark_menu_id;
   \   00000018   ........           BL       CreateBookmarksMenu
   \   0000001C   300084E5           STR      R0,[R4, #+48]
   1558            } 
   1559            GeneralFuncF1(1);
   \                     ??main_menu_goto_bookmarks_0:
   \   00000020   0100A0E3           MOV      R0,#+1
   \   00000024   3B0100EF           SWI      +315
   1560          }
   \   00000028   1080BDE8           POP      {R4,PC}          ;; return
   1561          
   1562          

   \                                 In segment CODE, align 4, keep-with-next
   1563          static void main_menu_search(GUI *gui)
   1564          {
   1565            MAIN_CSM *main_csm;
   1566            int search_id;
   1567            if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     main_menu_search:
   \   00000000   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   00000004   10402DE9           PUSH     {R4,LR}
   \   00000008   000090E5           LDR      R0,[R0, #+0]
   \   0000000C   080100EF           SWI      +264
   \   00000010   0040B0E1           MOVS     R4,R0
   \   00000014   0100000A           BEQ      ??main_menu_search_0
   1568            {
   1569              search_id=CreateSearchDialog();
   1570              main_csm->goto_url=search_id;
   \   00000018   ........           BL       CreateSearchDialog
   \   0000001C   2C0084E5           STR      R0,[R4, #+44]
   1571            } 
   1572            GeneralFuncF1(1);
   \                     ??main_menu_search_0:
   \   00000020   0100A0E3           MOV      R0,#+1
   \   00000024   3B0100EF           SWI      +315
   1573          }
   \   00000028   1080BDE8           POP      {R4,PC}          ;; return
   1574          

   \                                 In segment CODE, align 4, keep-with-next
   1575          static void main_menu_find(GUI *gui)
   1576          {
   \                     main_menu_find:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   1577            if (FindCSMbyID(maincsm_id))
   \   00000008   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   0000000C   000090E5           LDR      R0,[R0, #+0]
   \   00000010   080100EF           SWI      +264
   \   00000014   000050E3           CMP      R0,#+0
   \   00000018   0200000A           BEQ      ??main_menu_find_0
   1578            {
   1579              CreateFindDialog(MenuGetUserPointer(gui));
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   E00100EF           SWI      +480
   \   00000024   ........           BL       CreateFindDialog
   1580            } 
   1581            GeneralFuncF1(1);
   \                     ??main_menu_find_0:
   \   00000028   0100A0E3           MOV      R0,#+1
   \   0000002C   3B0100EF           SWI      +315
   1582          }
   \   00000030   1080BDE8           POP      {R4,PC}          ;; return
   1583          
   1584          

   \                                 In segment CODE, align 4, keep-with-next
   1585          static void main_menu_goto_history(GUI *gui)
   1586          {
   1587            MAIN_CSM *main_csm;
   1588            int history_menu_id;
   1589            if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     main_menu_goto_history:
   \   00000000   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   00000004   10402DE9           PUSH     {R4,LR}
   \   00000008   000090E5           LDR      R0,[R0, #+0]
   \   0000000C   080100EF           SWI      +264
   \   00000010   0040B0E1           MOVS     R4,R0
   \   00000014   0100000A           BEQ      ??main_menu_goto_history_0
   1590            {
   1591              history_menu_id=CreateHistoryMenu();
   1592              main_csm->sel_bmk=history_menu_id;
   \   00000018   ........           BL       CreateHistoryMenu
   \   0000001C   300084E5           STR      R0,[R4, #+48]
   1593            } 
   1594            GeneralFuncF1(1);
   \                     ??main_menu_goto_history_0:
   \   00000020   0100A0E3           MOV      R0,#+1
   \   00000024   3B0100EF           SWI      +315
   1595          }
   \   00000028   1080BDE8           POP      {R4,PC}          ;; return
   1596          

   \                                 In segment CODE, align 4, keep-with-next
   1597          static void main_menu_options(GUI *gui)
   1598          {
   \                     main_menu_options:
   \   00000000   10402DE9           PUSH     {R4,LR}
   1599            WSHDR *ws;
   1600            ws=AllocWS(150);
   \   00000004   9600A0E3           MOV      R0,#+150
   \   00000008   250100EF           SWI      +293
   \   0000000C   0040A0E1           MOV      R4,R0
   1601            str_2ws(ws,successed_config_filename,128);
   \   00000010   30009FE5           LDR      R0,??main_menu_options_0  ;; successed_config_filename
   \   00000014   8020A0E3           MOV      R2,#+128
   \   00000018   001090E5           LDR      R1,[R0, #+0]
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   6C0100EF           SWI      +364
   1602            ExecuteFile(ws,0,0);
   \   00000024   0020A0E3           MOV      R2,#+0
   \   00000028   0010A0E3           MOV      R1,#+0
   \   0000002C   0400A0E1           MOV      R0,R4
   \   00000030   940000EF           SWI      +148
   1603            FreeWS(ws);
   \   00000034   0400A0E1           MOV      R0,R4
   \   00000038   290100EF           SWI      +297
   1604            GeneralFuncF1(1);
   \   0000003C   0100A0E3           MOV      R0,#+1
   \   00000040   3B0100EF           SWI      +315
   1605          }
   \   00000044   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??main_menu_options_0:
   \   00000048   ........           DC32     successed_config_filename
   1606          

   \                                 In segment CODE, align 4, keep-with-next
   1607          static void main_menu_quit(GUI *gui)
   1608          {
   1609            MAIN_CSM *main_csm;
   1610            if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     main_menu_quit:
   \   00000000   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   000090E5           LDR      R0,[R0, #+0]
   \   0000000C   080100EF           SWI      +264
   \   00000010   0040B0E1           MOVS     R4,R0
   \   00000014   0A00000A           BEQ      ??main_menu_quit_0
   1611            {
   1612              FreePageStack();
   1613              _safe_free(goto_url);
   \   00000018   ........           LDR      R5,??DataTable47  ;; goto_url
   \   0000001C   ........           _BLF     FreePageStack,??FreePageStack??rA
   \   00000020   000095E5           LDR      R0,[R5, #+0]
   \   00000024   000050E3           CMP      R0,#+0
   \   00000028   0100000A           BEQ      ??main_menu_quit_1
   \   0000002C   150000EF           SWI      +21
   \   00000030   0000A0E3           MOV      R0,#+0
   \                     ??main_menu_quit_1:
   \   00000034   000085E5           STR      R0,[R5, #+0]
   1614              GeneralFunc_flag1(main_csm->view_id,0xFF);
   \   00000038   280094E5           LDR      R0,[R4, #+40]
   \   0000003C   FF10A0E3           MOV      R1,#+255
   \   00000040   3D0100EF           SWI      +317
   1615              GeneralFuncF1(1);
   1616            }
   1617            else
   1618            {
   1619              GeneralFuncF1(1);
   \                     ??main_menu_quit_0:
   \   00000044   0100A0E3           MOV      R0,#+1
   \   00000048   3B0100EF           SWI      +315
   1620            }
   1621          }
   \   0000004C   3080BDE8           POP      {R4,R5,PC}       ;; return
   1622          

   \                                 In segment CODE, align 4, keep-with-next
   1623          static void main_menu_savepage(GUI *gui)
   1624          {
   \                     main_menu_savepage:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   1625            if (FindCSMbyID(maincsm_id))
   \   00000008   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   0000000C   000090E5           LDR      R0,[R0, #+0]
   \   00000010   080100EF           SWI      +264
   \   00000014   000050E3           CMP      R0,#+0
   \   00000018   0200000A           BEQ      ??main_menu_savepage_0
   1626            {
   1627              CreateSavePageDialog(MenuGetUserPointer(gui));
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   E00100EF           SWI      +480
   \   00000024   ........           BL       CreateSavePageDialog
   1628            } 
   1629            GeneralFuncF1(1);
   \                     ??main_menu_savepage_0:
   \   00000028   0100A0E3           MOV      R0,#+1
   \   0000002C   3B0100EF           SWI      +315
   1630          }
   \   00000030   1080BDE8           POP      {R4,PC}          ;; return
   1631          

   \                                 In segment DATA_C, align 4, align-sorted
   1632          static const int main_menu_softkeys[]={0,1,2};
   \                     main_menu_softkeys:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000
   1633          
   1634          SOFTKEY_DESC main_menu_sk[]=
   1635          {
   1636            {0x0018,0x0000,(int)"Select"},
   1637            {0x0001,0x0000,(int)"Back"},
   1638            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1639          };
   1640          

   \                                 In segment DATA_C, align 4, align-sorted
   1641          static const SOFTKEYSTAB main_menu_skt=
   \                     main_menu_skt:
   \   00000000   ........0000       DC32 main_menu_sk, 0
   \              0000        

   \                                 In segment DATA_I, align 4, align-sorted
   1642          {
   1643            main_menu_sk,0
   1644          };
   1645          
   1646          #define MAIN_MENU_ITEMS_N 8
   1647          HEADER_DESC main_menu_header={0,0,0,0,NULL,(int)"Menu:",LGP_NULL};
   1648          
   1649          MENUITEM_DESC main_menu_items[MAIN_MENU_ITEMS_N]=
   \                     main_menu_items:
   \   00000000                      DS8 224
   \   000000E0                      REQUIRE `?<Initializer for main_menu_items>`
   \                     main_menu_sk:
   \   000000E0                      DS8 24
   \   000000F8                      REQUIRE `?<Initializer for main_menu_sk>`
   \                     main_menu_header:
   \   000000F8                      DS8 20
   \   0000010C                      REQUIRE `?<Initializer for main_menu_header>`
   1650          {
   1651            {NULL, NULL, LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //0
   1652            {NULL, NULL, LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //1
   1653            {NULL, NULL, LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //2
   1654            {NULL, NULL, LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //3
   1655            {NULL, NULL, LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //3
   1656            {NULL, NULL, LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //3
   1657            {NULL, NULL, LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}, //3
   1658            {NULL, NULL, LGP_NULL, 0, NULL, MENU_FLAG3, MENU_FLAG2}  //4
   1659          };
   1660          

   \                                 In segment DATA_C, align 4, align-sorted
   1661          static const MENUPROCS_DESC main_menu_procs[MAIN_MENU_ITEMS_N]=
   \                     main_menu_procs:
   \   00000000   ............       DC32 main_menu_goto_url, main_menu_goto_bookmarks
   \              ....        
   \   00000008   ............       DC32 main_menu_goto_history, main_menu_options, main_menu_search
   \              ............
   \   00000014   ............       DC32 main_menu_find, main_menu_savepage, main_menu_quit
   \              ............
   1662          {
   1663            main_menu_goto_url,
   1664            main_menu_goto_bookmarks,
   1665            main_menu_goto_history,
   1666            main_menu_options,
   1667            main_menu_search,
   1668            main_menu_find,
   1669            main_menu_savepage,
   1670            main_menu_quit
   1671          };
   1672          

   \                                 In segment CODE, align 4, keep-with-next
   1673          static void main_menu_ghook(void *data, int cmd)
   1674          {
   \                     main_menu_ghook:
   \   00000000   00402DE9           PUSH     {LR}
   1675            if (cmd == TI_CMD_FOCUS)
   \   00000004   0A0051E3           CMP      R1,#+10
   \   00000008   0080BD18           POPNE    {PC}
   1676            {
   1677              DisableIDLETMR();
   \   0000000C   7F0100EF           SWI      +383
   1678            }
   1679          }
   \   00000010   0080BDE8           POP      {PC}             ;; return
   1680          

   \                                 In segment DATA_C, align 4, align-sorted
   1681          static const MENU_DESC main_menu_struct=
   \                     main_menu_struct:
   \   00000000   080000000000       DC32 8, 0H, main_menu_ghook, 0H, main_menu_softkeys, main_menu_skt, 16
   \              0000........
   \              00000000....
   \              ............
   \              10000000    
   \   0000001C   00000000....       DC32 0H, main_menu_items, main_menu_procs, 8
   \              ............
   \              08000000    
   1682          {
   1683            8, NULL, main_menu_ghook, NULL,
   1684            main_menu_softkeys,
   1685            &main_menu_skt,
   1686            0x10,//MENU_FLAG,
   1687            NULL,
   1688            main_menu_items,//menuitems,
   1689            main_menu_procs,//menuprocs,
   1690            MAIN_MENU_ITEMS_N
   1691          };
   1692          

   \                                 In segment CODE, align 4, keep-with-next
   1693          int CreateMainMenu(VIEWDATA *vd)
   1694          {
   \                     CreateMainMenu:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   1695            MAIN_CSM * main_csm;
   1696            int main_menu_id;
   1697            if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \   00000008   ........           LDR      R0,??DataTable49  ;; maincsm_id
   \   0000000C   000090E5           LDR      R0,[R0, #+0]
   \   00000010   080100EF           SWI      +264
   \   00000014   0050B0E1           MOVS     R5,R0
   \   00000018   2700000A           BEQ      ??CreateMainMenu_0
   1698            {
   1699              patch_header(&main_menu_header);
   \   0000001C   A0609FE5           LDR      R6,??CreateMainMenu_1  ;; main_menu_items
   \   00000020   F80086E2           ADD      R0,R6,#+248
   \   00000024   ........           _BLF     patch_header,??patch_header??rA
   1700              main_menu_sk[0].lgp_id=(int)lgpData[LGP_Select];
   \   00000028   ........           LDR      R0,??DataTable50  ;; lgpData
   1701              main_menu_sk[1].lgp_id=(int)lgpData[LGP_Back];
   1702              main_menu_header.lgp_id=(int)lgpData[LGP_Menu];
   1703              main_menu_items[0].lgp_id_small=(int)lgpData[LGP_GoTo];
   1704              main_menu_items[1].lgp_id_small=(int)lgpData[LGP_Bookmarks];
   1705              main_menu_items[2].lgp_id_small=(int)lgpData[LGP_History];
   1706              main_menu_items[3].lgp_id_small=(int)lgpData[LGP_Settings];
   1707              main_menu_items[4].lgp_id_small=(int)lgpData[LGP_Search];
   1708              main_menu_items[5].lgp_id_small=(int)lgpData[LGP_Find];
   1709              main_menu_items[6].lgp_id_small=(int)lgpData[LGP_SavePage];
   1710              main_menu_items[7].lgp_id_small=(int)lgpData[LGP_Exit];
   1711            
   1712              main_menu_id=CreateMenu(0, 0, &main_menu_struct, &main_menu_header, 0, MAIN_MENU_ITEMS_N, vd, 0);
   \   0000002C   94209FE5           LDR      R2,??CreateMainMenu_1+0x4  ;; main_menu_struct
   \   00000030   5C1090E5           LDR      R1,[R0, #+92]
   \   00000034   F83086E2           ADD      R3,R6,#+248
   \   00000038   E41086E5           STR      R1,[R6, #+228]
   \   0000003C   B41090E5           LDR      R1,[R0, #+180]
   \   00000040   EC1086E5           STR      R1,[R6, #+236]
   \   00000044   DC1090E5           LDR      R1,[R0, #+220]
   \   00000048   041186E5           STR      R1,[R6, #+260]
   \   0000004C   E01090E5           LDR      R1,[R0, #+224]
   \   00000050   041086E5           STR      R1,[R6, #+4]
   \   00000054   E41090E5           LDR      R1,[R0, #+228]
   \   00000058   201086E5           STR      R1,[R6, #+32]
   \   0000005C   E81090E5           LDR      R1,[R0, #+232]
   \   00000060   3C1086E5           STR      R1,[R6, #+60]
   \   00000064   EC1090E5           LDR      R1,[R0, #+236]
   \   00000068   581086E5           STR      R1,[R6, #+88]
   \   0000006C   F41090E5           LDR      R1,[R0, #+244]
   \   00000070   741086E5           STR      R1,[R6, #+116]
   \   00000074   F81090E5           LDR      R1,[R0, #+248]
   \   00000078   901086E5           STR      R1,[R6, #+144]
   \   0000007C   FC1090E5           LDR      R1,[R0, #+252]
   \   00000080   F00090E5           LDR      R0,[R0, #+240]
   \   00000084   AC1086E5           STR      R1,[R6, #+172]
   \   00000088   C80086E5           STR      R0,[R6, #+200]
   \   0000008C   0000A0E3           MOV      R0,#+0
   \   00000090   01002DE9           PUSH     {R0}
   \   00000094   10002DE9           PUSH     {R4}
   \   00000098   0010A0E3           MOV      R1,#+0
   \   0000009C   0800A0E3           MOV      R0,#+8
   \   000000A0   01002DE9           PUSH     {R0}
   \   000000A4   0000A0E3           MOV      R0,#+0
   \   000000A8   01002DE9           PUSH     {R0}
   \   000000AC   520100EF           SWI      +338
   \   000000B0   0060A0E1           MOV      R6,R0
   1713              main_csm->main_menu_id=main_menu_id;
   \   000000B4   346085E5           STR      R6,[R5, #+52]
   \   000000B8   10D08DE2           ADD      SP,SP,#+16
   1714            }
   1715            return main_menu_id;
   \                     ??CreateMainMenu_0:
   \   000000BC   0600A0E1           MOV      R0,R6
   \   000000C0   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??CreateMainMenu_1:
   \   000000C4   ........           DC32     main_menu_items
   \   000000C8   ........           DC32     main_menu_struct
   1716          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   ........           DC32     maincsm_id

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable6:
   \   00000000   ........           DC32     view_url_mode

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable7:
   \   00000000   ........           DC32     lgpData

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable12:
   \   00000000   ........           DC32     view_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable15:
   \   00000000   ........           DC32     bookmarks_menu_sk

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable17:
   \   00000000   ........           DC32     `?<Constant "...">`

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable23:
   \   00000000   ........           DC32     `?<Constant "%s%s.url">`

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable24:
   \   00000000   ........           DC32     goto_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable25:
   \   00000000   ........           DC32     lgpData + 24

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable30:
   \   00000000   ........           DC32     search_menu_sk

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable32:
   \   00000000   ........           DC32     lgpData

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable34:
   \   00000000   ........           DC32     lgpData + 24

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable38:
   \   00000000   ........           DC32     view_url_mode

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable39:
   \   00000000   ........           DC32     view_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable47:
   \   00000000   ........           DC32     goto_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable49:
   \   00000000   ........           DC32     maincsm_id

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable50:
   \   00000000   ........           DC32     lgpData

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for search_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Search">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Cancel">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for search_menu_header>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "Search:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for find_box_menu_sk>`:
   \   0000002C   18000000           DC16 24, 0
   \   00000030   ........           DC32 `?<Constant "Ok">`
   \   00000034   01000000           DC16 1, 0
   \   00000038   ........           DC32 `?<Constant "Cancel">`
   \   0000003C   3D000000           DC16 61, 0
   \   00000040   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for find_box_hdr>`:
   \   00000044   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   0000004C   00000000....       DC32 0H, `?<Constant "Find:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for sEmpty>`:
   \   00000058   ........           DC32 `?<Constant "">`
   \                     `?<Initializer for search_engine_count>`:
   \   0000005C   00000000           DC32 0
   \                     `?<Initializer for selected_search_engine>`:
   \   00000060   00000000           DC32 0
   \                     `?<Initializer for search_engines>`:
   \   00000064   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000074   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000084   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   00000094   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   000000A4   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   000000B4   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   000000C4   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \   000000D4   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              000000000000
   \              00000000    
   \                     `?<Initializer for search_menu_struct>`:
   \   000000E4   01000000....       DC32 1, search_menu_onkey, search_menu_ghook, search_menu_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   000000F8   ........           DC32 search_menu_skt
   \   000000FC   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000104   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for bookmarks_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Options">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Back">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for bookmarks_menu_header>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   000000000000       DC32 0H, 0, 2147483647
   \              0000FFFFFF7F
   \                     `?<Initializer for bookmarks_menu_icons>`:
   \   0000002C   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0
   \              0000        
   \                     `?<Initializer for bookmarks_current_folder>`:
   \   00000034   00000000           DC8 0, 0, 0, 0
   \                     `?<Initializer for bl_top>`:
   \   00000038   00000000           DC8 0, 0, 0, 0
   \                     `?<Initializer for bookmarks_menu_struct>`:
   \   0000003C   08000000....       DC32 8, bookmarks_menu_onkey, bookmarks_menu_ghook, 0H
   \              ............
   \              00000000    
   \   0000004C   ............       DC32 bookmarks_menu_softkeys, bookmarks_menu_skt, 17
   \              ....11000000
   \   00000058   ........0000       DC32 bookmarks_menu_iconhndl, 0H, 0H, 0
   \              000000000000
   \              00000000    

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for edit_bookmark_hdr>`:
   \   00000000   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000008   00000000....       DC32 0H, `?<Constant "Bookmark...">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for edit_mode>`:
   \   00000014   00                 DC8 0

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for edit_bookmark_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Add">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Cancel">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for bookmarks_options_items>`:
   \   00000000   00000000....       DC32 0H, `?<Constant "Edit">`, 2147483647, 0, 0H, 3, 1442, 0H
   \              ....FFFFFF7F
   \              000000000000
   \              000003000000
   \              A20500000000
   \              0000        
   \   00000020   ........FFFF       DC32 `?<Constant "Add bookmark">`, 2147483647, 0, 0H, 3, 1442, 0H
   \              FF7F00000000
   \              000000000300
   \              0000A2050000
   \              00000000    
   \   0000003C   ........FFFF       DC32 `?<Constant "Add folder">`, 2147483647, 0, 0H, 3, 1442, 0H
   \              FF7F00000000
   \              000000000300
   \              0000A2050000
   \              00000000    
   \   00000058   ........FFFF       DC32 `?<Constant "Delete">`, 2147483647, 0, 0H, 3, 1442
   \              FF7F00000000
   \              000000000300
   \              0000A2050000
   \                     `?<Initializer for bookmarks_options_header>`:
   \   00000070   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000078   00000000....       DC32 0H, `?<Constant "Options:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for bookmarks_options_sk>`:
   \   00000084   18000000           DC16 24, 0
   \   00000088   ........           DC32 `?<Constant "Select">`
   \   0000008C   01000000           DC16 1, 0
   \   00000090   ........           DC32 `?<Constant "Back">`
   \   00000094   3D000000           DC16 61, 0
   \   00000098   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for bookmarks_options_struct>`:
   \   0000009C   080000000000       DC32 8, 0H, 0H, 0H, bookmarks_options_softkeys, bookmarks_options_skt
   \              000000000000
   \              00000000....
   \              ............
   \   000000B4   100000000000       DC32 16, 0H, bookmarks_options_items, bookmarks_options_procs, 4
   \              0000........
   \              ........0400
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for bookmarks_options_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for bookmarks_options_skt>`:
   \   00000000   ........0000       DC32 bookmarks_options_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for bookmarks_menu_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for bookmarks_menu_skt>`:
   \   00000000   ........0000       DC32 bookmarks_menu_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for savepage_box_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Ok">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Cancel">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for savepage_box_hdr>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "Save page:">`, 2147483647
   \              ....FFFFFF7F

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for history_menu_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for history_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Go">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Cancel">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for history_menu_header>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "History:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for history_menu_struct>`:
   \   0000002C   08000000....       DC32 8, history_menu_onkey, history_menu_ghook, 0H
   \              ............
   \              00000000    
   \   0000003C   ............       DC32 history_menu_softkeys, history_menu_skt, 16, history_menu_iconhndl
   \              ....10000000
   \              ........    
   \   0000004C   000000000000       DC32 0H, 0H, 0
   \              000000000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for history_menu_skt>`:
   \   00000000   ........0000       DC32 history_menu_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for input_url_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   00000000           DC32 0
   \   00000008   01000000           DC16 1, 0
   \   0000000C   00000000           DC32 0
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for input_url_header>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   000000000000       DC32 0H, 0, 2147483647
   \              0000FFFFFF7F

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for main_menu_items>`:
   \   00000000   000000000000       DC32 0H, 0, 2147483647, 0, 0H, 3, 1442, 0H, 0, 2147483647, 0, 0H, 3
   \              0000FFFFFF7F
   \              000000000000
   \              000003000000
   \              A20500000000
   \              000000000000
   \              FFFFFF7F0000
   \              000000000000
   \              03000000    
   \   00000034   A20500000000       DC32 1442, 0H, 0, 2147483647, 0, 0H, 3, 1442, 0H, 0, 2147483647, 0, 0H
   \              000000000000
   \              FFFFFF7F0000
   \              000000000000
   \              03000000A205
   \              000000000000
   \              00000000FFFF
   \              FF7F00000000
   \              00000000    
   \   00000068   03000000A205       DC32 3, 1442, 0H, 0, 2147483647, 0, 0H, 3, 1442, 0H, 0, 2147483647, 0
   \              000000000000
   \              00000000FFFF
   \              FF7F00000000
   \              000000000300
   \              0000A2050000
   \              000000000000
   \              0000FFFFFF7F
   \              00000000    
   \   0000009C   000000000300       DC32 0H, 3, 1442, 0H, 0, 2147483647, 0, 0H, 3, 1442, 0H, 0, 2147483647
   \              0000A2050000
   \              000000000000
   \              0000FFFFFF7F
   \              000000000000
   \              000003000000
   \              A20500000000
   \              000000000000
   \              FFFFFF7F    
   \   000000D0   000000000000       DC32 0, 0H, 3, 1442
   \              000003000000
   \              A2050000    
   \                     `?<Initializer for main_menu_sk>`:
   \   000000E0   18000000           DC16 24, 0
   \   000000E4   ........           DC32 `?<Constant "Select">`
   \   000000E8   01000000           DC16 1, 0
   \   000000EC   ........           DC32 `?<Constant "Back">`
   \   000000F0   3D000000           DC16 61, 0
   \   000000F4   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for main_menu_header>`:
   \   000000F8   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000100   00000000....       DC32 0H, `?<Constant "Menu:">`, 2147483647
   \              ....FFFFFF7F

   \                                 In segment DATA_C, align 1, align-sorted
   \   00000000   257400             DC8 "%t"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Add bookmark">`:
   \   00000000   41646420626F       DC8 "Add bookmark"
   \              6F6B6D61726B
   \              00          
   \   0000000D   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Options:">`:
   \   00000000   4F7074696F6E       DC8 "Options:"
   \              733A00      
   \   00000009   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Bookmark...">`:
   \   00000000   426F6F6B6D61       DC8 "Bookmark..."
   \              726B2E2E2E00

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Cancel">`:
   \   00000000   43616E63656C       DC8 "Cancel"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     `?<Constant "">`:
   \   00000000   00                 DC8 ""

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0
   \   00000008   F00F0000           DC16 4080, 0
   \   0000000C   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_1`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_2`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "$pages\\\\">`:
   \   00000000   247061676573       DC8 "$pages\\"
   \              5C00        
   \   00000008   2E6F6D7300         DC8 ".oms"
   \   0000000D   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "...">`:
   \   00000000   2E2E2E00           DC8 "..."
   \   00000004   247265736F75       DC8 "$resources\\folder.png"
   \              726365735C66
   \              6F6C6465722E
   \              706E6700    
   \   0000001A   0000               DC8 0, 0
   \   0000001C   247265736F75       DC8 "$resources\\bookmark.png"
   \              726365735C62
   \              6F6F6B6D6172
   \              6B2E706E6700
   \   00000034   24626F6F6B6D       DC8 "$bookmarks\\"
   \              61726B735C00

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_3`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_4`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 1, align-sorted
   \   00000000   257300             DC8 "%s"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "%s%s.url">`:
   \   00000000   257325732E75       DC8 "%s%s.url"
   \              726C00      
   \   00000009   000000             DC8 0, 0, 0
   \   0000000C   2A2E75726C00       DC8 "*.url"
   \   00000012   0000               DC8 0, 0
   \   00000014   247365617263       DC8 "$search\\"
   \              685C00      
   \   0000001D   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant ".url">`:
   \   00000000   2E75726C00         DC8 ".url"
   \   00000005   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \   00000000   5C00               DC8 "\\"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Add">`:
   \   00000000   41646400           DC8 "Add"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Menu:">`:
   \   00000000   4D656E753A00       DC8 "Menu:"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "History:">`:
   \   00000000   486973746F72       DC8 "History:"
   \              793A00      
   \   00000009   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     `?<Constant "Go">`:
   \   00000000   476F00             DC8 "Go"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Save page:">`:
   \   00000000   536176652070       DC8 "Save page:"
   \              6167653A00  
   \   0000000B   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Find:">`:
   \   00000000   46696E643A00       DC8 "Find:"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     `?<Constant "Ok">`:
   \   00000000   4F6B00             DC8 "Ok"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Search:">`:
   \   00000000   536561726368       DC8 "Search:"
   \              3A00        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Search">`:
   \   00000000   536561726368       DC8 "Search"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Options">`:
   \   00000000   4F7074696F6E       DC8 "Options"
   \              7300        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Edit">`:
   \   00000000   4564697400         DC8 "Edit"
   \   00000005   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Back">`:
   \   00000000   4261636B00         DC8 "Back"
   \   00000005   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Select">`:
   \   00000000   53656C656374       DC8 "Select"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Delete">`:
   \   00000000   44656C657465       DC8 "Delete"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Add folder">`:
   \   00000000   41646420666F       DC8 "Add folder"
   \              6C64657200  
   \   0000000B   00                 DC8 0

   Maximum stack usage in bytes:

     Function                       CSTACK
     --------                       ------
     AddToFList                        24
     CreateBookmarksMenu               32
     CreateFindDialog                 104
     CreateHistoryMenu                 32
     CreateInputUrl                    72
     CreateMainMenu                    32
     CreateSavePageDialog              80
     CreateSearchDialog               100
     FindBListByN                       8
     FindBListByNS                      0
     FindFiles                       1264
     Free_BList                        16
     bookmarks_menu_ghook              12
     bookmarks_menu_iconhndl           28
     bookmarks_menu_onkey              12
     bookmarks_options_add_bookmark     4
     bookmarks_options_add_folder       4
     bookmarks_options_delete          12
     bookmarks_options_edit             8
     edit_bookmark_extract_link        60
     edit_bookmark_extract_name        60
     edit_bookmark_ghook               76
     edit_bookmark_locret               0
     edit_bookmark_onkey               28
     fcopy                             80
     find_box_ghook                    36
     find_box_locret                    0
     find_box_onkey                    52
     free_search_engines               16
     get_search_engines               992
     history_menu_ghook                16
     history_menu_iconhndl             24
     history_menu_onkey               276
     input_url_ghook                   20
     input_url_locret                   0
     input_url_onkey                   64
     main_menu_find                     8
     main_menu_ghook                    4
     main_menu_goto_bookmarks           8
     main_menu_goto_history             8
     main_menu_goto_url                 8
     main_menu_options                  8
     main_menu_quit                    12
     main_menu_savepage                 8
     main_menu_search                   8
     patch_header                       8
     patch_header_small                 8
     patch_input                       12
     savepage_box_ghook                20
     savepage_box_locret                0
     savepage_box_onkey               444
     search_menu_ghook                 24
     search_menu_locret                 0
     search_menu_onkey                388
     show_bookmarks_options            48
     show_edit_bookmark_menu          136


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     patch_header                     52
     patch_input                      68
     patch_header_small               48
     edit_bookmark_skt                 8
     edit_bookmark_ghook             196
     edit_bookmark_locret              4
     edit_bookmark_extract_name      188
     edit_bookmark_extract_link      120
     edit_bookmark_onkey             500
     ?<Constant "">_1                 60
     show_edit_bookmark_menu        1036
     bookmarks_options_edit           72
     bookmarks_options_add_bookmark   28
     bookmarks_options_add_folder     28
     bookmarks_options_delete        104
     bookmarks_options_procs          16
     show_bookmarks_options          220
     Free_BList                       80
     AddToFList                      188
     FindFiles                       496
     FindBListByNS                    72
     FindBListByN                     84
     bookmarks_menu_onkey            216
     bookmarks_menu_ghook            120
     bookmarks_menu_iconhndl         172
     CreateBookmarksMenu             168
     search_menu_skt                   8
     free_search_engines              60
     get_search_engines              244
     search_menu_locret                4
     search_menu_onkey               836
     search_menu_ghook               228
     CreateSearchDialog              408
     find_box_menu_skt                 8
     search_menu_sk                  284
     bookmarks_menu_sk               104
     edit_bookmark_hdr                21
     edit_bookmark_sk                 24
     bookmarks_options_items         200
     bookmarks_options_softkeys       12
     bookmarks_options_skt             8
     bookmarks_menu_softkeys          12
     bookmarks_menu_skt                8
     find_box_ghook                  224
     find_box_locret                   4
     find_box_onkey                  104
     find_box_desc                    56
     CreateFindDialog                392
     savepage_box_menu_skt             8
     savepage_box_menu_sk             44
     savepage_box_ghook               84
     savepage_box_locret               4
     fcopy                           392
     savepage_box_onkey              176
     savepage_box_desc                56
     CreateSavePageDialog            272
     history_menu_onkey              344
     history_menu_ghook              116
     history_menu_iconhndl           144
     history_menu_softkeys            12
     history_menu_sk                  88
     history_menu_skt                  8
     CreateHistoryMenu               128
     input_url_skt                     8
     input_url_sk                     44
     input_url_ghook                  84
     input_url_locret                  4
     input_url_onkey                 232
     input_url_desc                   56
     CreateInputUrl                  436
     main_menu_goto_url               44
     main_menu_goto_bookmarks         44
     main_menu_search                 44
     main_menu_find                   52
     main_menu_goto_history           44
     main_menu_options                76
     main_menu_quit                   80
     main_menu_savepage               52
     main_menu_softkeys               12
     main_menu_skt                     8
     main_menu_items                 268
     main_menu_procs                  32
     main_menu_ghook                  20
     main_menu_struct                 44
     CreateMainMenu                  204
     ??DataTable4                      4
     ??DataTable6                      4
     ??DataTable7                      4
     ??DataTable12                     4
     ??DataTable15                     4
     ??DataTable17                     4
     ??DataTable23                     4
     ??DataTable24                     4
     ??DataTable25                     4
     ??DataTable30                     4
     ??DataTable32                     4
     ??DataTable34                     4
     ??DataTable38                     4
     ??DataTable39                     4
     ??DataTable47                     4
     ??DataTable49                     4
     ??DataTable50                     4
     ?<Initializer for search_menu_sk>
                                     284
     ?<Initializer for bookmarks_menu_sk>
                                     104
     ?<Initializer for edit_bookmark_hdr>
                                      21
     ?<Initializer for edit_bookmark_sk>
                                      24
     ?<Initializer for bookmarks_options_items>
                                     200
     ?<Initializer for bookmarks_options_softkeys>
                                      12
     ?<Initializer for bookmarks_options_skt>
                                       8
     ?<Initializer for bookmarks_menu_softkeys>
                                      12
     ?<Initializer for bookmarks_menu_skt>
                                       8
     ?<Initializer for savepage_box_menu_sk>
                                      44
     ?<Initializer for history_menu_softkeys>
                                      12
     ?<Initializer for history_menu_sk>
                                      88
     ?<Initializer for history_menu_skt>
                                       8
     ?<Initializer for input_url_sk>
                                      44
     ?<Initializer for main_menu_items>
                                     268
     ?<Constant "%t">                  3
     ?<Constant "Add bookmark">       16
     ?<Constant "Options:">           12
     ?<Constant "Bookmark...">        12
     ?<Constant "Cancel">              8
     ?<Constant "">                    1
     ?<Constant {4095, 0, 0}>         16
     ?<Constant {4095, 0, 0}>_1        8
     ?<Constant {4095, 0, 0}>_2        8
     ?<Constant "$pages\\">           16
     ?<Constant "...">                64
     ?<Constant {4095, 0, 0}>_3        8
     ?<Constant {4095, 0, 0}>_4        8
     ?<Constant "%s">                  3
     ?<Constant "%s%s.url">           32
     ?<Constant ".url">                8
     ?<Constant "\\">                  2
     ?<Constant "Add">                 4
     ?<Constant "Menu:">               8
     ?<Constant "History:">           12
     ?<Constant "Go">                  3
     ?<Constant "Save page:">         12
     ?<Constant "Find:">               8
     ?<Constant "Ok">                  3
     ?<Constant "Search:">             8
     ?<Constant "Search">              8
     ?<Constant "Options">             8
     ?<Constant "Edit">                8
     ?<Constant "Back">                8
     ?<Constant "Select">              8
     ?<Constant "Delete">              8
     ?<Constant "Add folder">         12
      Others                         428

 
 10 324 bytes in segment CODE
    723 bytes in segment DATA_C
  1 137 bytes in segment DATA_I
  1 137 bytes in segment DATA_ID
     12 bytes in segment INITTAB
 
 9 740 bytes of CODE  memory (+ 596 bytes shared)
 1 860 bytes of CONST memory
 1 137 bytes of DATA  memory

Errors: none
Warnings: none
