##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    06/Oct/2008  21:46:15 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  D:\Pasha\elf\BelleteMini13.05.08\display_utils.c     #
#    Command line    =  D:\Pasha\elf\BelleteMini13.05.08\display_utils.c -D  #
#                       NEWSGOLD -D ELKA -lC D:\Pasha\elf\BelleteMini13.05.0 #
#                       8\Release_ELKA\List\ -o D:\Pasha\elf\BelleteMini13.0 #
#                       5.08\Release_ELKA\Obj\ -s9 --no_unroll --no_inline   #
#                       --cpu_mode arm --endian little --cpu ARM926EJ-S      #
#                       --stack_align 4 --interwork -e --fpu None            #
#                       --dlib_config "D:\Pasha\Embedded Workbench 4.0       #
#                       Evaluation2\ARM\LIB\dl5tpainl8n.h" -I                #
#                       "D:\Pasha\Embedded Workbench 4.0                     #
#                       Evaluation2\ARM\INC\"                                #
#    List file       =  D:\Pasha\elf\BelleteMini13.05.08\Release_ELKA\List\d #
#                       isplay_utils.lst                                     #
#    Object file     =  D:\Pasha\elf\BelleteMini13.05.08\Release_ELKA\Obj\di #
#                       splay_utils.r79                                      #
#                                                                            #
#                                                                            #
##############################################################################

D:\Pasha\elf\BelleteMini13.05.08\display_utils.c
      1          #include "../inc/swilib.h"
      2          #include "view.h"
      3          #include "display_utils.h"
      4          #include "siemens_unicode.h"
      5          #include "string_works.h"
      6          #include "rect_patcher.h"

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_header(HEADER_DESC const *)
   \                     patch_header:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B000C4E1           STRH     R0,[R4, #+0]
   \   00000010   1800A0E3           MOV      R0,#+24
   \   00000014   B200C4E1           STRH     R0,[R4, #+2]
   \   00000018   888100EF           SWI      +33160
   \   0000001C   010040E2           SUB      R0,R0,#+1
   \   00000020   B400C4E1           STRH     R0,[R4, #+4]
   \   00000024   8A8100EF           SWI      +33162
   \   00000028   170080E2           ADD      R0,R0,#+23
   \   0000002C   B600C4E1           STRH     R0,[R4, #+6]
   \   00000030   1080BDE8           POP      {R4,PC}          ;; return

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_input(INPUTDIA_DESC const *)
   \                     patch_input:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B801C4E1           STRH     R0,[R4, #+24]
   \   00000010   8A8100EF           SWI      +33162
   \   00000014   190080E2           ADD      R0,R0,#+25
   \   00000018   BA01C4E1           STRH     R0,[R4, #+26]
   \   0000001C   888100EF           SWI      +33160
   \   00000020   010040E2           SUB      R0,R0,#+1
   \   00000024   BC01C4E1           STRH     R0,[R4, #+28]
   \   00000028   898100EF           SWI      +33161
   \   0000002C   0050A0E1           MOV      R5,R0
   \   00000030   8B8100EF           SWI      +33163
   \   00000034   000045E0           SUB      R0,R5,R0
   \   00000038   010040E2           SUB      R0,R0,#+1
   \   0000003C   BE01C4E1           STRH     R0,[R4, #+30]
   \   00000040   3080BDE8           POP      {R4,R5,PC}       ;; return
      7          #include "main.h"
      8          #include "file_works.h"
      9          #include "lang.h"
     10          
     11          extern int maincsm_id;
     12          

   \                                 In segment CODE, align 4, keep-with-next
     13          int GetFontHeight(int font, int atribute)
     14          {
   \                     GetFontHeight:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0140A0E1           MOV      R4,R1
     15            int height=GetFontYSIZE(font);
   \   00000008   C50100EF           SWI      +453
     16            if (atribute&TEXT_INVERT)   height+=1;
   \   0000000C   100014E3           TST      R4,#0x10
   \   00000010   01008012           ADDNE    R0,R0,#+1
     17            if (atribute&TEXT_UNDERLINE)   height+=1;
   \   00000014   080014E3           TST      R4,#0x8
   \   00000018   01008012           ADDNE    R0,R0,#+1
     18            if (atribute&TEXT_OUTLINE)  height+=2;
   \   0000001C   200014E3           TST      R4,#0x20
   \   00000020   02008012           ADDNE    R0,R0,#+2
     19            return height;
   \   00000024   1080BDE8           POP      {R4,PC}          ;; return
     20          }
     21          

   \                                 In segment CODE, align 4, keep-with-next
     22          unsigned int SearchNextDisplayLine(VIEWDATA *vd, LINECACHE *p/*, unsigned int *max_h*/)
     23          {
   \                     SearchNextDisplayLine:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   0050A0E1           MOV      R5,R0
   \   00000008   0140A0E1           MOV      R4,R1
     24            int left=ScreenW();
     25            int c,h,cw,f=0;
   \   0000000C   0070A0E3           MOV      R7,#+0
   \   00000010   888100EF           SWI      +33160
   \   00000014   0060A0E1           MOV      R6,R0
     26            p->centerAtAll=0;
   \   00000018   BC00D4E1           LDRH     R0,[R4, #+12]
   \   0000001C   DF10A0E3           MOV      R1,#+223
   \   00000020   FF1C81E3           ORR      R1,R1,#0xFF00
   \   00000024   000001E0           AND      R0,R1,R0
   \   00000028   BC00C4E1           STRH     R0,[R4, #+12]
     27            p->pixheight=0;
   \   0000002C   0000A0E3           MOV      R0,#+0
   \   00000030   BE00C4E1           STRH     R0,[R4, #+14]
     28            p->pos=vd->lines_cache_pos;
   \   00000034   180095E5           LDR      R0,[R5, #+24]
   \                     ??SearchNextDisplayLine_0:
   \   00000038   000084E5           STR      R0,[R4, #+0]
   \   0000003C   010000EA           B        ??SearchNextDisplayLine_1
     29            while(p->pos<vd->rawtext_size)
     30            {
     31              c=vd->rawtext[p->pos++];
     32              if ((c&0xFF00)==0xE100)
     33              {
     34                h=GetImgHeight(GetPicNByUnicodeSymbol(c));
     35              }
     36              else
     37              {
     38                h=GetFontHeight(p->bold?FONT_SMALL_BOLD:FONT_SMALL,p->underline?TEXT_UNDERLINE:0+p->ref?TEXT_INVERT:0);
     39              }
     40              switch(c)
     41              {
     42              case UTF16_NEWLINE:
     43                f=1;
     44                h=0;
     45                break;
     46              case UTF16_ENA_CENTER:
     47                p->center=1;
   \                     ??SearchNextDisplayLine_2:
   \   00000040   080082E3           ORR      R0,R2,#0x8
   \                     ??SearchNextDisplayLine_3:
   \   00000044   BC00C4E1           STRH     R0,[R4, #+12]
     48                continue;
   \                     ??SearchNextDisplayLine_1:
   \   00000048   000094E5           LDR      R0,[R4, #+0]
   \   0000004C   0C1095E5           LDR      R1,[R5, #+12]
   \   00000050   010050E1           CMP      R0,R1
   \   00000054   6700002A           BCS      ??SearchNextDisplayLine_4
   \   00000058   011080E2           ADD      R1,R0,#+1
   \   0000005C   001084E5           STR      R1,[R4, #+0]
   \   00000060   081095E5           LDR      R1,[R5, #+8]
   \   00000064   800081E0           ADD      R0,R1,R0, LSL #+1
   \   00000068   B080D0E1           LDRH     R8,[R0, #+0]
   \   0000006C   FF0C08E2           AND      R0,R8,#0xFF00
   \   00000070   E10C50E3           CMP      R0,#+57600
   \   00000074   0300001A           BNE      ??SearchNextDisplayLine_5
   \   00000078   0800A0E1           MOV      R0,R8
   \   0000007C   E40100EF           SWI      +484
   \   00000080   210000EF           SWI      +33
   \   00000084   0A0000EA           B        ??SearchNextDisplayLine_6
   \                     ??SearchNextDisplayLine_5:
   \   00000088   BC00D4E1           LDRH     R0,[R4, #+12]
   \   0000008C   020010E3           TST      R0,#0x2
   \   00000090   0810A013           MOVNE    R1,#+8
   \   00000094   0200001A           BNE      ??SearchNextDisplayLine_7
   \   00000098   040010E3           TST      R0,#0x4
   \   0000009C   1010A013           MOVNE    R1,#+16
   \   000000A0   0010A003           MOVEQ    R1,#+0
   \                     ??SearchNextDisplayLine_7:
   \   000000A4   010010E3           TST      R0,#0x1
   \   000000A8   0900A013           MOVNE    R0,#+9
   \   000000AC   0800A003           MOVEQ    R0,#+8
   \   000000B0   ........           BL       GetFontHeight
   \                     ??SearchNextDisplayLine_6:
   \   000000B4   0C3095E5           LDR      R3,[R5, #+12]
   \   000000B8   001094E5           LDR      R1,[R4, #+0]
   \   000000BC   BC20D4E1           LDRH     R2,[R4, #+12]
   \   000000C0   0090A0E1           MOV      R9,R0
   \   000000C4   02A043E2           SUB      R10,R3,#+2
   \   000000C8   010081E2           ADD      R0,R1,#+1
   \   000000CC   0A0058E3           CMP      R8,#+10
   \   000000D0   2A00000A           BEQ      ??SearchNextDisplayLine_8
   \   000000D4   01C0A0E3           MOV      R12,#+1
   \   000000D8   E0CC8CE3           ORR      R12,R12,#0xE000
   \   000000DC   0C0058E1           CMP      R8,R12
   \   000000E0   3C00000A           BEQ      ??SearchNextDisplayLine_9
   \   000000E4   01C08CE2           ADD      R12,R12,#+1
   \   000000E8   0C0058E1           CMP      R8,R12
   \   000000EC   3700000A           BEQ      ??SearchNextDisplayLine_10
   \   000000F0   02C08CE2           ADD      R12,R12,#+2
   \   000000F4   0C0058E1           CMP      R8,R12
   \   000000F8   2E00000A           BEQ      ??SearchNextDisplayLine_11
   \   000000FC   01C08CE3           ORR      R12,R12,#0x1
   \   00000100   0C0058E1           CMP      R8,R12
   \   00000104   2F00000A           BEQ      ??SearchNextDisplayLine_12
   \   00000108   01C08CE2           ADD      R12,R12,#+1
   \   0000010C   0C0058E1           CMP      R8,R12
   \   00000110   3600000A           BEQ      ??SearchNextDisplayLine_13
   \   00000114   01C08CE3           ORR      R12,R12,#0x1
   \   00000118   0C0058E1           CMP      R8,R12
   \   0000011C   4200000A           BEQ      ??SearchNextDisplayLine_14
   \   00000120   01C08CE2           ADD      R12,R12,#+1
   \   00000124   0C0058E1           CMP      R8,R12
   \   00000128   01C08C13           ORRNE    R12,R12,#0x1
   \   0000012C   0C005811           CMPNE    R8,R12
   \   00000130   4A00000A           BEQ      ??SearchNextDisplayLine_15
   \   00000134   09C08CE2           ADD      R12,R12,#+9
   \   00000138   0C0058E1           CMP      R8,R12
   \   0000013C   2700000A           BEQ      ??SearchNextDisplayLine_16
   \   00000140   01C08CE3           ORR      R12,R12,#0x1
   \   00000144   0C0058E1           CMP      R8,R12
   \   00000148   2600000A           BEQ      ??SearchNextDisplayLine_17
   \   0000014C   09C08CE2           ADD      R12,R12,#+9
   \   00000150   0C0058E1           CMP      R8,R12
   \   00000154   1500000A           BEQ      ??SearchNextDisplayLine_18
   \   00000158   01C08CE3           ORR      R12,R12,#0x1
   \   0000015C   0C0058E1           CMP      R8,R12
   \   00000160   1000000A           BEQ      ??SearchNextDisplayLine_19
   \   00000164   01C08CE2           ADD      R12,R12,#+1
   \   00000168   0C0058E1           CMP      R8,R12
   \   0000016C   B3FFFF0A           BEQ      ??SearchNextDisplayLine_2
   \   00000170   01C08CE3           ORR      R12,R12,#0x1
   \   00000174   0C0058E1           CMP      R8,R12
   \   00000178   0600000A           BEQ      ??SearchNextDisplayLine_20
   \   0000017C   010000EA           B        ??SearchNextDisplayLine_21
   \                     ??SearchNextDisplayLine_8:
   \   00000180   0170A0E3           MOV      R7,#+1
   \   00000184   0090A0E3           MOV      R9,#+0
     49              case UTF16_DIS_CENTER:
     50                p->center=0;
     51                continue;
     52              case UTF16_ALIGN_RIGHT:
     53                p->right=1;
     54                continue;
     55              case UTF16_ALIGN_LEFT:
     56                p->right=0;
     57                continue;
     58              case UTF16_DIS_INVERT:
     59                p->ref=0;
     60                continue;
     61              case UTF16_ENA_INVERT:
     62                p->ref=1;
     63                continue;
     64              case UTF16_DIS_UNDERLINE:
     65                p->underline=0;
     66                continue;
     67              case UTF16_ENA_UNDERLINE:
     68                p->underline=1;
     69                continue;
     70              case UTF16_FONT_SMALL:
     71                p->bold=0;
     72                continue;
     73              case UTF16_FONT_SMALL_BOLD:
     74                p->bold=1;
     75                continue;
     76              case UTF16_INK_RGBA:
     77                if (p->pos>(vd->rawtext_size-2)) return 0;
     78                p->ink1=vd->rawtext[p->pos++];
     79                p->ink2=vd->rawtext[p->pos++];
     80                continue;
     81              case UTF16_PAPER_RGBA:
     82                if (p->pos>(vd->rawtext_size-2)) return 0;
     83                p->paper1=vd->rawtext[p->pos++];
     84                p->paper2=vd->rawtext[p->pos++];
     85                continue;
     86              case UTF16_INK_INDEX:
     87              case UTF16_PAPER_INDEX:
     88                if (p->pos>=(vd->rawtext_size-1)) return 0;
     89                p->pos++;
     90                continue;
     91              }
     92              // компоновка элементов здесь
     93              cw=GetSymbolWidth(c,p->bold?FONT_SMALL_BOLD:FONT_SMALL);
   \                     ??SearchNextDisplayLine_21:
   \   00000188   010012E3           TST      R2,#0x1
   \   0000018C   0810A003           MOVEQ    R1,#+8
   \   00000190   0910A013           MOVNE    R1,#+9
   \   00000194   350000EA           B        ??SearchNextDisplayLine_22
   \                     ??SearchNextDisplayLine_20:
   \   00000198   F710A0E3           MOV      R1,#+247
   \                     ??SearchNextDisplayLine_23:
   \   0000019C   FF1C81E3           ORR      R1,R1,#0xFF00
   \   000001A0   020001E0           AND      R0,R1,R2
   \   000001A4   A6FFFFEA           B        ??SearchNextDisplayLine_3
   \                     ??SearchNextDisplayLine_19:
   \   000001A8   100082E3           ORR      R0,R2,#0x10
   \   000001AC   A4FFFFEA           B        ??SearchNextDisplayLine_3
   \                     ??SearchNextDisplayLine_18:
   \   000001B0   EF10A0E3           MOV      R1,#+239
   \   000001B4   F8FFFFEA           B        ??SearchNextDisplayLine_23
   \                     ??SearchNextDisplayLine_11:
   \   000001B8   FB10A0E3           MOV      R1,#+251
   \   000001BC   FF1C81E3           ORR      R1,R1,#0xFF00
   \   000001C0   020001E0           AND      R0,R1,R2
   \   000001C4   9EFFFFEA           B        ??SearchNextDisplayLine_3
   \                     ??SearchNextDisplayLine_12:
   \   000001C8   040082E3           ORR      R0,R2,#0x4
   \   000001CC   9CFFFFEA           B        ??SearchNextDisplayLine_3
   \                     ??SearchNextDisplayLine_10:
   \   000001D0   FD10A0E3           MOV      R1,#+253
   \   000001D4   F0FFFFEA           B        ??SearchNextDisplayLine_23
   \                     ??SearchNextDisplayLine_9:
   \   000001D8   020082E3           ORR      R0,R2,#0x2
   \   000001DC   98FFFFEA           B        ??SearchNextDisplayLine_3
   \                     ??SearchNextDisplayLine_16:
   \   000001E0   FE10A0E3           MOV      R1,#+254
   \   000001E4   ECFFFFEA           B        ??SearchNextDisplayLine_23
   \                     ??SearchNextDisplayLine_17:
   \   000001E8   010082E3           ORR      R0,R2,#0x1
   \   000001EC   94FFFFEA           B        ??SearchNextDisplayLine_3
   \                     ??SearchNextDisplayLine_13:
   \   000001F0   01005AE1           CMP      R10,R1
   \   000001F4   0100002A           BCS      ??SearchNextDisplayLine_24
   \                     ??SearchNextDisplayLine_4:
   \   000001F8   0000A0E3           MOV      R0,#+0
   \   000001FC   F08FBDE8           POP      {R4-R11,PC}
   \                     ??SearchNextDisplayLine_24:
   \   00000200   000084E5           STR      R0,[R4, #+0]
   \   00000204   082095E5           LDR      R2,[R5, #+8]
   \   00000208   811082E0           ADD      R1,R2,R1, LSL #+1
   \   0000020C   B010D1E1           LDRH     R1,[R1, #+0]
   \   00000210   B410C4E1           STRH     R1,[R4, #+4]
   \   00000214   011080E2           ADD      R1,R0,#+1
   \   00000218   001084E5           STR      R1,[R4, #+0]
   \   0000021C   800082E0           ADD      R0,R2,R0, LSL #+1
   \   00000220   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000224   B600C4E1           STRH     R0,[R4, #+6]
   \   00000228   86FFFFEA           B        ??SearchNextDisplayLine_1
   \                     ??SearchNextDisplayLine_14:
   \   0000022C   01005AE1           CMP      R10,R1
   \   00000230   F0FFFF3A           BCC      ??SearchNextDisplayLine_4
   \   00000234   000084E5           STR      R0,[R4, #+0]
   \   00000238   082095E5           LDR      R2,[R5, #+8]
   \   0000023C   811082E0           ADD      R1,R2,R1, LSL #+1
   \   00000240   B010D1E1           LDRH     R1,[R1, #+0]
   \   00000244   B810C4E1           STRH     R1,[R4, #+8]
   \   00000248   011080E2           ADD      R1,R0,#+1
   \   0000024C   001084E5           STR      R1,[R4, #+0]
   \   00000250   800082E0           ADD      R0,R2,R0, LSL #+1
   \   00000254   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000258   BA00C4E1           STRH     R0,[R4, #+10]
   \   0000025C   79FFFFEA           B        ??SearchNextDisplayLine_1
   \                     ??SearchNextDisplayLine_15:
   \   00000260   012043E2           SUB      R2,R3,#+1
   \   00000264   020051E1           CMP      R1,R2
   \   00000268   E2FFFF2A           BCS      ??SearchNextDisplayLine_4
   \   0000026C   71FFFFEA           B        ??SearchNextDisplayLine_0
   \                     ??SearchNextDisplayLine_22:
   \   00000270   0800A0E1           MOV      R0,R8
   \   00000274   E10100EF           SWI      +481
   \   00000278   00A0A0E1           MOV      R10,R0
     94              left-=cw;
   \   0000027C   0A6056E0           SUBS     R6,R6,R10
     95              if (left<0)
   \   00000280   0580A0E3           MOV      R8,#+5
   \   00000284   E08C88E3           ORR      R8,R8,#0xE000
   \   00000288   2400005A           BPL      ??SearchNextDisplayLine_25
     96              {
     97                int b=1;
     98                int cw=0;
     99                if (p->ref)
   \   0000028C   BC00D4E1           LDRH     R0,[R4, #+12]
   \   00000290   0170A0E3           MOV      R7,#+1
   \   00000294   0060A0E3           MOV      R6,#+0
   \   00000298   040010E3           TST      R0,#0x4
   \   0000029C   0A00001A           BNE      ??SearchNextDisplayLine_26
    100                {
    101                  while (1)
    102                  {
    103                    if (vd->rawtext[p->pos-b]==UTF16_ENA_INVERT) break;
    104                    if (vd->rawtext[p->pos-b]==UTF16_NEWLINE)
    105                    {
    106                      b++;
    107                      break;
    108                    }
    109                    if (cw>=ScreenW()/2)
    110                    {
    111                      b=1;
    112                      break;
    113                    }
    114                    cw+=GetSymbolWidth(vd->rawtext[p->pos-b],p->bold?FONT_SMALL_BOLD:FONT_SMALL);
    115                    b++;
    116                  }
    117                }
    118                else
    119                {
    120                  ;
    121                }
    122                p->pos-=b;
   \                     ??SearchNextDisplayLine_27:
   \   000002A0   000094E5           LDR      R0,[R4, #+0]
   \   000002A4   070040E0           SUB      R0,R0,R7
   \   000002A8   330000EA           B        ??SearchNextDisplayLine_28
   \                     ??SearchNextDisplayLine_29:
   \   000002AC   000094E5           LDR      R0,[R4, #+0]
   \   000002B0   082095E5           LDR      R2,[R5, #+8]
   \   000002B4   070040E0           SUB      R0,R0,R7
   \   000002B8   800082E0           ADD      R0,R2,R0, LSL #+1
   \   000002BC   B000D0E1           LDRH     R0,[R0, #+0]
   \   000002C0   0970A0E1           MOV      R7,R9
   \   000002C4   E10100EF           SWI      +481
   \   000002C8   066080E0           ADD      R6,R0,R6
   \                     ??SearchNextDisplayLine_26:
   \   000002CC   000094E5           LDR      R0,[R4, #+0]
   \   000002D0   081095E5           LDR      R1,[R5, #+8]
   \   000002D4   070040E0           SUB      R0,R0,R7
   \   000002D8   800081E0           ADD      R0,R1,R0, LSL #+1
   \   000002DC   B010D0E1           LDRH     R1,[R0, #+0]
   \   000002E0   080051E1           CMP      R1,R8
   \   000002E4   EDFFFF0A           BEQ      ??SearchNextDisplayLine_27
   \   000002E8   019087E2           ADD      R9,R7,#+1
   \   000002EC   0A0051E3           CMP      R1,#+10
   \   000002F0   0970A001           MOVEQ    R7,R9
   \   000002F4   E9FFFF0A           BEQ      ??SearchNextDisplayLine_27
   \   000002F8   888100EF           SWI      +33160
   \   000002FC   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   00000300   C00056E1           CMP      R6,R0, ASR #+1
   \   00000304   0170A0A3           MOVGE    R7,#+1
   \   00000308   E4FFFFAA           BGE      ??SearchNextDisplayLine_27
   \   0000030C   BC00D4E1           LDRH     R0,[R4, #+12]
   \   00000310   010010E3           TST      R0,#0x1
   \   00000314   0810A003           MOVEQ    R1,#+8
   \   00000318   0910A013           MOVNE    R1,#+9
   \   0000031C   E2FFFFEA           B        ??SearchNextDisplayLine_29
    123                return 1; // here can be a bug with line height
    124              }
    125              
    126              if (cw>=ScreenW()/2||h>GetFontHeight(FONT_SMALL,0)*2) // Картинки отдельно
   \                     ??SearchNextDisplayLine_25:
   \   00000320   888100EF           SWI      +33160
   \   00000324   06B08AE0           ADD      R11,R10,R6
   \   00000328   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   0000032C   C0005AE1           CMP      R10,R0, ASR #+1
   \   00000330   040000AA           BGE      ??SearchNextDisplayLine_30
   \   00000334   0010A0E3           MOV      R1,#+0
   \   00000338   0800A0E3           MOV      R0,#+8
   \   0000033C   ........           BL       GetFontHeight
   \   00000340   800059E1           CMP      R9,R0, LSL #+1
   \   00000344   0F0000DA           BLE      ??SearchNextDisplayLine_31
    127              {
    128                if (left+cw<ScreenW()) // image is last character
   \                     ??SearchNextDisplayLine_30:
   \   00000348   888100EF           SWI      +33160
   \   0000034C   00005BE1           CMP      R11,R0
   \   00000350   0C0000AA           BGE      ??SearchNextDisplayLine_31
    129                {
    130                  p->centerAtAll=1;
   \   00000354   BC00D4E1           LDRH     R0,[R4, #+12]
   \   00000358   200080E3           ORR      R0,R0,#0x20
   \   0000035C   BC00C4E1           STRH     R0,[R4, #+12]
    131                  if (vd->rawtext[p->pos-1]==UTF16_ENA_INVERT)
   \   00000360   000094E5           LDR      R0,[R4, #+0]
   \   00000364   081095E5           LDR      R1,[R5, #+8]
   \   00000368   801081E0           ADD      R1,R1,R0, LSL #+1
   \   0000036C   B21051E1           LDRH     R1,[R1, #-2]
   \   00000370   080051E1           CMP      R1,R8
   \   00000374   01004012           SUBNE    R0,R0,#+1
    132                  {
    133                    p->pos-=2;
   \   00000378   02004002           SUBEQ    R0,R0,#+2
   \                     ??SearchNextDisplayLine_28:
   \   0000037C   000084E5           STR      R0,[R4, #+0]
    134                    return 1;
   \                     ??SearchNextDisplayLine_32:
   \   00000380   0100A0E3           MOV      R0,#+1
   \   00000384   F08FBDE8           POP      {R4-R11,PC}
    135                  }
    136                  else
    137                  {
    138                    p->pos-=1;
    139                    return 1;
    140                  }
    141                }
    142              }
    143              if (h>p->pixheight) p->pixheight=h;
   \                     ??SearchNextDisplayLine_31:
   \   00000388   BE00D4E1           LDRH     R0,[R4, #+14]
   \   0000038C   090050E1           CMP      R0,R9
   \   00000390   BE90C4B1           STRHLT   R9,[R4, #+14]
    144                
    145              if (cw>=ScreenW()/2||h>GetFontHeight(FONT_SMALL,0)*2) // Картинки отдельно
   \   00000394   888100EF           SWI      +33160
   \   00000398   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   0000039C   C0005AE1           CMP      R10,R0, ASR #+1
   \   000003A0   040000AA           BGE      ??SearchNextDisplayLine_33
   \   000003A4   0010A0E3           MOV      R1,#+0
   \   000003A8   0800A0E3           MOV      R0,#+8
   \   000003AC   ........           BL       GetFontHeight
   \   000003B0   800059E1           CMP      R9,R0, LSL #+1
   \   000003B4   170000DA           BLE      ??SearchNextDisplayLine_34
    146              {
    147                if (left+cw==ScreenW()) // image is first character
   \                     ??SearchNextDisplayLine_33:
   \   000003B8   888100EF           SWI      +33160
   \   000003BC   00005BE1           CMP      R11,R0
   \   000003C0   1400001A           BNE      ??SearchNextDisplayLine_34
    148                {
    149                  if (p->pos>(vd->rawtext_size-1)) return 0;
   \   000003C4   000094E5           LDR      R0,[R4, #+0]
   \   000003C8   0C1095E5           LDR      R1,[R5, #+12]
   \   000003CC   011041E2           SUB      R1,R1,#+1
   \   000003D0   000051E1           CMP      R1,R0
   \   000003D4   87FFFF3A           BCC      ??SearchNextDisplayLine_4
    150                  p->centerAtAll=1;
   \   000003D8   BC10D4E1           LDRH     R1,[R4, #+12]
    151                  if (vd->rawtext[p->pos+1]==UTF16_DIS_INVERT)
   \   000003DC   0120C8E3           BIC      R2,R8,#0x1
   \   000003E0   201081E3           ORR      R1,R1,#0x20
   \   000003E4   BC10C4E1           STRH     R1,[R4, #+12]
   \   000003E8   081095E5           LDR      R1,[R5, #+8]
   \   000003EC   801081E0           ADD      R1,R1,R0, LSL #+1
   \   000003F0   B210D1E1           LDRH     R1,[R1, #+2]
   \   000003F4   020051E1           CMP      R1,R2
   \   000003F8   E0FFFF1A           BNE      ??SearchNextDisplayLine_32
    152                  {
    153                    p->ref=0;
   \   000003FC   BC10D4E1           LDRH     R1,[R4, #+12]
   \   00000400   FB20A0E3           MOV      R2,#+251
   \   00000404   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000408   011002E0           AND      R1,R2,R1
   \   0000040C   BC10C4E1           STRH     R1,[R4, #+12]
    154                    p->pos+=1;
   \   00000410   010080E2           ADD      R0,R0,#+1
   \   00000414   D8FFFFEA           B        ??SearchNextDisplayLine_28
    155                    return 1;
    156                  }
    157                  else
    158                  {
    159                    return 1;
    160                  }
    161                }
    162              }
    163              if (f) return 1;
   \                     ??SearchNextDisplayLine_34:
   \   00000418   000057E3           CMP      R7,#+0
   \   0000041C   09FFFF0A           BEQ      ??SearchNextDisplayLine_1
   \   00000420   0100A0E3           MOV      R0,#+1
   \   00000424   F08FBDE8           POP      {R4-R11,PC}
    164            }
    165            return 0;
    166          }
    167          
    168          #define LINESCACHECHUNK 256
    169          

   \                                 In segment CODE, align 4, keep-with-next
    170          static void newCacheLine(VIEWDATA *vd, LINECACHE *p)
    171          {
   \                     newCacheLine:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    172            if ((vd->lines_cache_size%LINESCACHECHUNK)==0)
   \   00000008   140094E5           LDR      R0,[R4, #+20]
   \   0000000C   0150A0E1           MOV      R5,R1
   \   00000010   001CB0E1           LSLS     R1,R0,#+24
   \   00000014   0400001A           BNE      ??newCacheLine_0
    173            {
    174              //Дошли до конца куска, реаллоцируем еще кусок
    175              vd->lines_cache=realloc(vd->lines_cache,(vd->lines_cache_size+LINESCACHECHUNK)*sizeof(LINECACHE));
   \   00000018   400F80E2           ADD      R0,R0,#+256
   \   0000001C   0012A0E1           LSL      R1,R0,#+4
   \   00000020   100094E5           LDR      R0,[R4, #+16]
   \   00000024   BA0000EF           SWI      +186
   \   00000028   100084E5           STR      R0,[R4, #+16]
    176            }
    177            memcpy(vd->lines_cache+(vd->lines_cache_size++),p,sizeof(LINECACHE));
   \                     ??newCacheLine_0:
   \   0000002C   140094E5           LDR      R0,[R4, #+20]
   \   00000030   1020A0E3           MOV      R2,#+16
   \   00000034   011080E2           ADD      R1,R0,#+1
   \   00000038   141084E5           STR      R1,[R4, #+20]
   \   0000003C   103094E5           LDR      R3,[R4, #+16]
   \   00000040   0510A0E1           MOV      R1,R5
   \   00000044   000283E0           ADD      R0,R3,R0, LSL #+4
   \   00000048   1E0100EF           SWI      +286
    178            vd->lines_cache_pos=p->pos;
   \   0000004C   000095E5           LDR      R0,[R5, #+0]
   \   00000050   180084E5           STR      R0,[R4, #+24]
    179          }
   \   00000054   3080BDE8           POP      {R4,R5,PC}       ;; return
    180          

   \                                 In segment CODE, align 4, keep-with-next
    181          int LineDown(VIEWDATA *vd)
    182          {
   \                     LineDown:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   10D04DE2           SUB      SP,SP,#+16
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   1C0094E5           LDR      R0,[R4, #+28]
   \   00000010   141094E5           LDR      R1,[R4, #+20]
   \   00000014   010080E2           ADD      R0,R0,#+1
   \   00000018   010050E1           CMP      R0,R1
   \   0000001C   2600003A           BCC      ??LineDown_0
    183            if (vd->view_line+1<vd->lines_cache_size)
    184            {
    185              vd->view_line++;
    186            }
    187            else
    188            {
    189              LINECACHE *lc;
    190              if (!vd->lines_cache_size)
   \   00000020   000051E3           CMP      R1,#+0
   \   00000024   1600001A           BNE      ??LineDown_1
    191              {
    192                LINECACHE lc;
    193                lc.ink1=0x0000;
    194                lc.ink2=0x0064;
   \   00000028   6420A0E3           MOV      R2,#+100
   \   0000002C   B620CDE1           STRH     R2,[SP, #+6]
    195                lc.paper1=0xFFFF;
   \   00000030   FF20A0E3           MOV      R2,#+255
   \   00000034   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000038   B820CDE1           STRH     R2,[SP, #+8]
    196                lc.paper2=0xFF64;
   \   0000003C   9B20C2E3           BIC      R2,R2,#0x9B
   \   00000040   BA20CDE1           STRH     R2,[SP, #+10]
    197                lc.pixheight=0;
    198                lc.bold=0;
    199                lc.underline=0;
    200                lc.ref=0;
   \   00000044   BC20DDE1           LDRH     R2,[SP, #+12]
   \   00000048   0000A0E3           MOV      R0,#+0
   \   0000004C   B400CDE1           STRH     R0,[SP, #+4]
   \   00000050   BE00CDE1           STRH     R0,[SP, #+14]
   \   00000054   F830A0E3           MOV      R3,#+248
   \   00000058   FF3C83E3           ORR      R3,R3,#0xFF00
   \   0000005C   022003E0           AND      R2,R3,R2
   \   00000060   BC20CDE1           STRH     R2,[SP, #+12]
    201                lc.pos=0;
   \   00000064   00008DE5           STR      R0,[SP, #+0]
    202                lc.center=0;
    203                lc.right=0;
   \   00000068   0210A0E1           MOV      R1,R2
   \   0000006C   112043E2           SUB      R2,R3,#+17
   \   00000070   011002E0           AND      R1,R2,R1
   \   00000074   BC10CDE1           STRH     R1,[SP, #+12]
    204                newCacheLine(vd,&lc);
   \   00000078   0D10A0E1           MOV      R1,SP
   \   0000007C   0400A0E1           MOV      R0,R4
   \   00000080   ........           BL       newCacheLine
    205              }
    206              lc=vd->lines_cache+vd->lines_cache_size-1;
   \                     ??LineDown_1:
   \   00000084   140094E5           LDR      R0,[R4, #+20]
   \   00000088   101094E5           LDR      R1,[R4, #+16]
   \   0000008C   000281E0           ADD      R0,R1,R0, LSL #+4
   \   00000090   105040E2           SUB      R5,R0,#+16
    207              if (!SearchNextDisplayLine(vd,lc)) return 0; // can't caching futher
   \   00000094   0510A0E1           MOV      R1,R5
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   ........           BL       SearchNextDisplayLine
   \   000000A0   000050E3           CMP      R0,#+0
   \   000000A4   0600000A           BEQ      ??LineDown_2
    208              newCacheLine(vd,lc);
   \   000000A8   0510A0E1           MOV      R1,R5
   \   000000AC   0400A0E1           MOV      R0,R4
   \   000000B0   ........           BL       newCacheLine
    209              vd->view_line++;
   \   000000B4   1C0094E5           LDR      R0,[R4, #+28]
   \   000000B8   010080E2           ADD      R0,R0,#+1
   \                     ??LineDown_0:
   \   000000BC   1C0084E5           STR      R0,[R4, #+28]
    210            }
    211            return 1;
   \   000000C0   0100A0E3           MOV      R0,#+1
   \                     ??LineDown_2:
   \   000000C4   10D08DE2           ADD      SP,SP,#+16       ;; stack cleaning
   \   000000C8   3080BDE8           POP      {R4,R5,PC}       ;; return
    212          }
    213          
    214          // 0 page start

   \                                 In segment CODE, align 4, keep-with-next
    215          int LineUp(VIEWDATA *vd)
    216          {
    217            int vl=vd->view_line;
   \                     LineUp:
   \   00000000   1C1090E5           LDR      R1,[R0, #+28]
    218            if (vl)
   \   00000004   000051E3           CMP      R1,#+0
   \   00000008   0300000A           BEQ      ??LineUp_0
    219            {
    220              vl--;
    221              vd->view_line=vl;
   \   0000000C   011041E2           SUB      R1,R1,#+1
   \   00000010   1C1080E5           STR      R1,[R0, #+28]
    222              return 1;
   \   00000014   0100A0E3           MOV      R0,#+1
   \   00000018   1EFF2FE1           BX       LR
    223            }
    224            else
    225              return 0;
   \                     ??LineUp_0:
   \   0000001C   0000A0E3           MOV      R0,#+0
   \   00000020   1EFF2FE1           BX       LR               ;; return
    226          }
    227          

   \                                 In segment CODE, align 4, keep-with-next
    228          void scrollDown(VIEWDATA *vd, int amount)
    229          {
   \                     scrollDown:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    230            if (!RenderPage(vd,0)||vd->lines_cache_size==0) return;
   \   0000000C   0010A0E3           MOV      R1,#+0
   \   00000010   ........           BL       RenderPage
   \   00000014   000050E3           CMP      R0,#+0
   \   00000018   14009415           LDRNE    R0,[R4, #+20]
   \   0000001C   00005013           CMPNE    R0,#+0
   \   00000020   3080BD08           POPEQ    {R4,R5,PC}
    231            
    232            vd->pixdisp+=amount;
   \   00000024   200094E5           LDR      R0,[R4, #+32]
   \   00000028   000085E0           ADD      R0,R5,R0
   \   0000002C   200084E5           STR      R0,[R4, #+32]
   \   00000030   000000EA           B        ??scrollDown_0
    233            unsigned int cl_h;
    234          L1:
    235            cl_h=vd->lines_cache[vd->view_line].pixheight;
    236            if (vd->pixdisp>cl_h)
    237            {
    238              vd->pixdisp-=cl_h;
    239              unsigned int pd=vd->pixdisp;
    240              LineDown(vd);
    241              vd->pixdisp=0;
    242              if (!RenderPage(vd,0))
    243              {
    244                while(LineDown(vd)) ;
    245                vd->pixdisp=(vd->lines_cache+vd->lines_cache_size-1)->pixheight;
    246                scrollUp(vd,ScreenH()-1);
    247                return;
    248              }
    249              vd->pixdisp=pd;
   \                     ??scrollDown_1:
   \   00000034   205084E5           STR      R5,[R4, #+32]
    250              goto L1;
   \                     ??scrollDown_0:
   \   00000038   1C0094E5           LDR      R0,[R4, #+28]
   \   0000003C   101094E5           LDR      R1,[R4, #+16]
   \   00000040   000281E0           ADD      R0,R1,R0, LSL #+4
   \   00000044   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000048   201094E5           LDR      R1,[R4, #+32]
   \   0000004C   010050E1           CMP      R0,R1
   \   00000050   0F00002A           BCS      ??scrollDown_2
   \   00000054   005041E0           SUB      R5,R1,R0
   \   00000058   205084E5           STR      R5,[R4, #+32]
   \   0000005C   0400A0E1           MOV      R0,R4
   \   00000060   ........           BL       LineDown
   \   00000064   0000A0E3           MOV      R0,#+0
   \   00000068   200084E5           STR      R0,[R4, #+32]
   \   0000006C   0010A0E3           MOV      R1,#+0
   \   00000070   0400A0E1           MOV      R0,R4
   \   00000074   ........           BL       RenderPage
   \   00000078   000050E3           CMP      R0,#+0
   \   0000007C   ECFFFF1A           BNE      ??scrollDown_1
   \                     ??scrollDown_3:
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   ........           BL       LineDown
   \   00000088   000050E3           CMP      R0,#+0
   \   0000008C   FBFFFF1A           BNE      ??scrollDown_3
   \   00000090   080000EA           B        ??scrollDown_4
    251            }
    252            else
    253            {
    254              if (!RenderPage(vd,0))
   \                     ??scrollDown_2:
   \   00000094   0010A0E3           MOV      R1,#+0
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   ........           BL       RenderPage
   \   000000A0   000050E3           CMP      R0,#+0
   \   000000A4   3080BD18           POPNE    {R4,R5,PC}
    255              {
    256                while(LineDown(vd)) ;
   \                     ??scrollDown_5:
   \   000000A8   0400A0E1           MOV      R0,R4
   \   000000AC   ........           BL       LineDown
   \   000000B0   000050E3           CMP      R0,#+0
   \   000000B4   FBFFFF1A           BNE      ??scrollDown_5
    257                vd->pixdisp=(vd->lines_cache+vd->lines_cache_size-1)->pixheight;
   \                     ??scrollDown_4:
   \   000000B8   140094E5           LDR      R0,[R4, #+20]
   \   000000BC   101094E5           LDR      R1,[R4, #+16]
   \   000000C0   000281E0           ADD      R0,R1,R0, LSL #+4
   \   000000C4   B20050E1           LDRH     R0,[R0, #-2]
   \   000000C8   200084E5           STR      R0,[R4, #+32]
    258                scrollUp(vd,ScreenH()-1);
   \   000000CC   898100EF           SWI      +33161
   \   000000D0   011040E2           SUB      R1,R0,#+1
   \   000000D4   0400A0E1           MOV      R0,R4
   \   000000D8   ........           BL       scrollUp
   \   000000DC   3080BDE8           POP      {R4,R5,PC}       ;; return
    259              }
    260            }
    261          }
    262          

   \                                 In segment CODE, align 4, keep-with-next
    263          void scrollUp(VIEWDATA *vd, int amount)
    264          {
   \                     scrollUp:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   040000EA           B        ??scrollUp_0
    265            while (vd->pixdisp-amount<0)
    266            {
    267              if (!LineUp(vd))
    268              {
    269                vd->pixdisp=0;
    270                return;
    271              }
    272              amount-=vd->lines_cache[vd->view_line].pixheight;
   \                     ??scrollUp_1:
   \   00000010   1C0094E5           LDR      R0,[R4, #+28]
   \   00000014   101094E5           LDR      R1,[R4, #+16]
   \   00000018   000281E0           ADD      R0,R1,R0, LSL #+4
   \   0000001C   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000020   005045E0           SUB      R5,R5,R0
   \                     ??scrollUp_0:
   \   00000024   200094E5           LDR      R0,[R4, #+32]
   \   00000028   050050E0           SUBS     R0,R0,R5
   \   0000002C   0300005A           BPL      ??scrollUp_2
   \   00000030   0400A0E1           MOV      R0,R4
   \   00000034   ........           BL       LineUp
   \   00000038   000050E3           CMP      R0,#+0
   \   0000003C   F3FFFF1A           BNE      ??scrollUp_1
    273            }
    274            vd->pixdisp-=amount;
   \                     ??scrollUp_2:
   \   00000040   200084E5           STR      R0,[R4, #+32]
    275          }
   \   00000044   3080BDE8           POP      {R4,R5,PC}       ;; return
    276          
    277          #define MAX_COLORS_IN_LINE 32
    278          typedef struct {
    279            char color[4];
    280            int start_x;
    281            int end_x;
    282          } COLOR_RC;
    283          

   \                                 In segment CODE, align 4, keep-with-next
    284          void renderForm(VIEWDATA *vd, REFCACHE *rf, int x, int y)
    285          {
   \                     renderForm:
   \   00000000   F44F2DE9           PUSH     {R2,R4-R11,LR}
   \   00000004   0050A0E1           MOV      R5,R0
   \   00000008   0160A0E1           MOV      R6,R1
    286            if (rf->tag=='x'||rf->tag=='p')
   \   0000000C   080096E5           LDR      R0,[R6, #+8]
   \   00000010   0340A0E1           MOV      R4,R3
   \   00000014   780050E3           CMP      R0,#+120
   \   00000018   70005013           CMPNE    R0,#+112
   \   0000001C   4F00001A           BNE      ??renderForm_0
    287            {
    288              // calc pos
    289              int d=(GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_TEXT_FORM))-GetFontHeight(FONT_SMALL,0))/2;
   \   00000020   F00095E5           LDR      R0,[R5, #+240]
   \   00000024   E40100EF           SWI      +484
   \   00000028   210000EF           SWI      +33
   \   0000002C   0070A0E1           MOV      R7,R0
   \   00000030   0010A0E3           MOV      R1,#+0
   \   00000034   0800A0E3           MOV      R0,#+8
   \   00000038   ........           BL       GetFontHeight
   \   0000003C   000047E0           SUB      R0,R7,R0
   \   00000040   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   00000044   C070A0E1           ASR      R7,R0,#+1
    290              // count lenght
    291              int w=GetImgWidth(GetPicNByUnicodeSymbol(vd->WCHAR_TEXT_FORM))-(d*2);
   \   00000048   F00095E5           LDR      R0,[R5, #+240]
   \   0000004C   E40100EF           SWI      +484
   \   00000050   220000EF           SWI      +34
   \   00000054   879040E0           SUB      R9,R0,R7, LSL #+1
    292              WSHDR *ws2=AllocWS(((WSHDR *)rf->data)->wsbody[0]);
   \   00000058   180096E5           LDR      R0,[R6, #+24]
   \   0000005C   000090E5           LDR      R0,[R0, #+0]
   \   00000060   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000064   250100EF           SWI      +293
   \   00000068   0080A0E1           MOV      R8,R0
   \   0000006C   020000EA           B        ??renderForm_1
    293              for (;ws2->wsbody[0]<((WSHDR *)rf->data)->wsbody[0];)
    294              {
    295                w-=GetSymbolWidth(((WSHDR *)rf->data)->wsbody[ws2->wsbody[0]+1],FONT_SMALL);
    296                if (w<=0)
    297                  break;
    298                ws2->wsbody[0]++;
    299                if (rf->tag=='p')
    300                  ws2->wsbody[ws2->wsbody[0]]='*';
   \                     ??renderForm_2:
   \   00000070   810080E0           ADD      R0,R0,R1, LSL #+1
   \   00000074   2A10A0E3           MOV      R1,#+42
   \   00000078   B010C0E1           STRH     R1,[R0, #+0]
   \                     ??renderForm_1:
   \   0000007C   180096E5           LDR      R0,[R6, #+24]
   \   00000080   002098E5           LDR      R2,[R8, #+0]
   \   00000084   003090E5           LDR      R3,[R0, #+0]
   \   00000088   B010D2E1           LDRH     R1,[R2, #+0]
   \   0000008C   B030D3E1           LDRH     R3,[R3, #+0]
   \   00000090   030051E1           CMP      R1,R3
   \   00000094   1800002A           BCS      ??renderForm_3
   \   00000098   B020D2E1           LDRH     R2,[R2, #+0]
   \   0000009C   000090E5           LDR      R0,[R0, #+0]
   \   000000A0   0810A0E3           MOV      R1,#+8
   \   000000A4   820080E0           ADD      R0,R0,R2, LSL #+1
   \   000000A8   B200D0E1           LDRH     R0,[R0, #+2]
   \   000000AC   E10100EF           SWI      +481
   \   000000B0   009049E0           SUB      R9,R9,R0
   \   000000B4   010059E3           CMP      R9,#+1
   \   000000B8   0F0000BA           BLT      ??renderForm_3
   \   000000BC   000098E5           LDR      R0,[R8, #+0]
   \   000000C0   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000C4   011081E2           ADD      R1,R1,#+1
   \   000000C8   B010C0E1           STRH     R1,[R0, #+0]
   \   000000CC   081096E5           LDR      R1,[R6, #+8]
   \   000000D0   700051E3           CMP      R1,#+112
   \   000000D4   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000D8   E4FFFF0A           BEQ      ??renderForm_2
    301                else
    302                  ws2->wsbody[ws2->wsbody[0]]=((WSHDR *)rf->data)->wsbody[ws2->wsbody[0]];
   \   000000DC   182096E5           LDR      R2,[R6, #+24]
   \   000000E0   811080E0           ADD      R1,R0,R1, LSL #+1
   \   000000E4   B000D0E1           LDRH     R0,[R0, #+0]
   \   000000E8   002092E5           LDR      R2,[R2, #+0]
   \   000000EC   800082E0           ADD      R0,R2,R0, LSL #+1
   \   000000F0   B000D0E1           LDRH     R0,[R0, #+0]
   \   000000F4   B000C1E1           STRH     R0,[R1, #+0]
   \   000000F8   DFFFFFEA           B        ??renderForm_1
    303              }
    304              DrawString(ws2,x+d,y+d,ScreenW(),ScreenH(),
    305                FONT_SMALL,TEXT_NOFORMAT,
    306                GetPaletteAdrByColorIndex(1),
    307                GetPaletteAdrByColorIndex(23));
   \                     ??renderForm_3:
   \   000000FC   1700A0E3           MOV      R0,#+23
   \   00000100   2E0100EF           SWI      +302
   \   00000104   00A0A0E1           MOV      R10,R0
   \   00000108   0100A0E3           MOV      R0,#+1
   \   0000010C   2E0100EF           SWI      +302
   \   00000110   00B0A0E1           MOV      R11,R0
   \   00000114   898100EF           SWI      +33161
   \   00000118   0090A0E1           MOV      R9,R0
   \   0000011C   888100EF           SWI      +33160
   \   00000120   0030A0E1           MOV      R3,R0
   \   00000124   00042DE9           PUSH     {R10}
   \   00000128   00082DE9           PUSH     {R11}
   \   0000012C   8000A0E3           MOV      R0,#+128
   \   00000130   01002DE9           PUSH     {R0}
   \   00000134   042087E0           ADD      R2,R7,R4
   \   00000138   0800A0E3           MOV      R0,#+8
   \   0000013C   01002DE9           PUSH     {R0}
   \   00000140   00022DE9           PUSH     {R9}
   \   00000144   14009DE5           LDR      R0,[SP, #+20]
   \   00000148   001087E0           ADD      R1,R7,R0
   \   0000014C   0800A0E1           MOV      R0,R8
   \   00000150   4C0100EF           SWI      +332
    308              FreeWS(ws2);
   \   00000154   0800A0E1           MOV      R0,R8
   \   00000158   290100EF           SWI      +297
   \   0000015C   14D08DE2           ADD      SP,SP,#+20
    309            }
    310            if (rf->tag=='s'&&rf->value!=_NOREF)
   \                     ??renderForm_0:
   \   00000160   080096E5           LDR      R0,[R6, #+8]
   \   00000164   730050E3           CMP      R0,#+115
   \   00000168   F18FBD18           POPNE    {R0,R4-R11,PC}
   \   0000016C   100096E5           LDR      R0,[R6, #+16]
   \   00000170   010070E3           CMN      R0,#+1
   \   00000174   F18FBD08           POPEQ    {R0,R4-R11,PC}
    311            {
    312              // calc pos
    313              int d=(GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM))-GetFontHeight(FONT_SMALL,0))/2;
   \   00000178   F40095E5           LDR      R0,[R5, #+244]
   \   0000017C   E40100EF           SWI      +484
   \   00000180   210000EF           SWI      +33
   \   00000184   0070A0E1           MOV      R7,R0
   \   00000188   0010A0E3           MOV      R1,#+0
   \   0000018C   0800A0E3           MOV      R0,#+8
   \   00000190   ........           BL       GetFontHeight
   \   00000194   000047E0           SUB      R0,R7,R0
   \   00000198   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   0000019C   C070A0E1           ASR      R7,R0,#+1
    314              // count lenght
    315              int w=GetImgWidth(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM))-(d*2)-GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM));
   \   000001A0   F40095E5           LDR      R0,[R5, #+244]
   \   000001A4   E40100EF           SWI      +484
   \   000001A8   220000EF           SWI      +34
   \   000001AC   0080A0E1           MOV      R8,R0
   \   000001B0   F40095E5           LDR      R0,[R5, #+244]
   \   000001B4   878048E0           SUB      R8,R8,R7, LSL #+1
   \   000001B8   E40100EF           SWI      +484
   \   000001BC   210000EF           SWI      +33
    316              int count=_rshort2(vd->oms+rf->value);
   \   000001C0   3C1095E5           LDR      R1,[R5, #+60]
   \   000001C4   008048E0           SUB      R8,R8,R0
   \   000001C8   100096E5           LDR      R0,[R6, #+16]
   \   000001CC   010080E0           ADD      R0,R0,R1
   \   000001D0   ........           _BLF     _rshort2,??_rshort2??rA
    317              char *c=extract_omstr(vd,rf->value);
   \   000001D4   101096E5           LDR      R1,[R6, #+16]
   \   000001D8   0090A0E1           MOV      R9,R0
   \   000001DC   0500A0E1           MOV      R0,R5
   \   000001E0   ........           _BLF     extract_omstr,??extract_omstr??rA
   \   000001E4   0050A0E1           MOV      R5,R0
    318              WSHDR *ws2=AllocWS(count);
   \   000001E8   0900A0E1           MOV      R0,R9
   \   000001EC   250100EF           SWI      +293
   \   000001F0   0060A0E1           MOV      R6,R0
    319              oms2ws(ws2,c,count);
   \   000001F4   0920A0E1           MOV      R2,R9
   \   000001F8   0510A0E1           MOV      R1,R5
   \   000001FC   ........           _BLF     oms2ws,??oms2ws??rA
    320              count=ws2->wsbody[0];
   \   00000200   000096E5           LDR      R0,[R6, #+0]
    321              ws2->wsbody[0]=0;
   \   00000204   0010A0E3           MOV      R1,#+0
   \   00000208   B090D0E1           LDRH     R9,[R0, #+0]
   \   0000020C   020000EA           B        ??renderForm_4
    322              for (;ws2->wsbody[0]<count;)
    323              {
    324                w-=GetSymbolWidth(ws2->wsbody[ws2->wsbody[0]+1],FONT_SMALL);
    325                if (w<=0)
    326                  break;
    327                ws2->wsbody[0]++;
   \                     ??renderForm_5:
   \   00000210   000096E5           LDR      R0,[R6, #+0]
   \   00000214   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000218   011081E2           ADD      R1,R1,#+1
   \                     ??renderForm_4:
   \   0000021C   B010C0E1           STRH     R1,[R0, #+0]
   \   00000220   000096E5           LDR      R0,[R6, #+0]
   \   00000224   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000228   090051E1           CMP      R1,R9
   \   0000022C   070000AA           BGE      ??renderForm_6
   \   00000230   B020D0E1           LDRH     R2,[R0, #+0]
   \   00000234   0810A0E3           MOV      R1,#+8
   \   00000238   820080E0           ADD      R0,R0,R2, LSL #+1
   \   0000023C   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000240   E10100EF           SWI      +481
   \   00000244   008048E0           SUB      R8,R8,R0
   \   00000248   010058E3           CMP      R8,#+1
   \   0000024C   EFFFFFAA           BGE      ??renderForm_5
    328              }
    329              DrawString(ws2,x+d,y+d,ScreenW(),ScreenH(),
    330                FONT_SMALL,TEXT_NOFORMAT,
    331                GetPaletteAdrByColorIndex(1),
    332                GetPaletteAdrByColorIndex(23));
   \                     ??renderForm_6:
   \   00000250   1700A0E3           MOV      R0,#+23
   \   00000254   2E0100EF           SWI      +302
   \   00000258   0090A0E1           MOV      R9,R0
   \   0000025C   0100A0E3           MOV      R0,#+1
   \   00000260   2E0100EF           SWI      +302
   \   00000264   00A0A0E1           MOV      R10,R0
   \   00000268   898100EF           SWI      +33161
   \   0000026C   0080A0E1           MOV      R8,R0
   \   00000270   888100EF           SWI      +33160
   \   00000274   00022DE9           PUSH     {R9}
   \   00000278   00042DE9           PUSH     {R10}
   \   0000027C   8010A0E3           MOV      R1,#+128
   \   00000280   02002DE9           PUSH     {R1}
   \   00000284   0030A0E1           MOV      R3,R0
   \   00000288   042087E0           ADD      R2,R7,R4
   \   0000028C   0810A0E3           MOV      R1,#+8
   \   00000290   02002DE9           PUSH     {R1}
   \   00000294   00012DE9           PUSH     {R8}
   \   00000298   14009DE5           LDR      R0,[SP, #+20]
   \   0000029C   001087E0           ADD      R1,R7,R0
   \   000002A0   0600A0E1           MOV      R0,R6
   \   000002A4   4C0100EF           SWI      +332
    333              FreeWS(ws2);
   \   000002A8   0600A0E1           MOV      R0,R6
   \   000002AC   290100EF           SWI      +297
    334              mfree(c);
   \   000002B0   0500A0E1           MOV      R0,R5
   \   000002B4   150000EF           SWI      +21
   \   000002B8   14D08DE2           ADD      SP,SP,#+20
    335            }
    336          }
   \   000002BC   F18FBDE8           POP      {R0,R4-R11,PC}   ;; return
    337          
    338          // возвращает 1, если видна последняя строка
    339          // возвращает 2, если виден конец страницы

   \                                 In segment CODE, align 4, keep-with-next
    340          int RenderPage(VIEWDATA *vd, int do_draw)
    341          {
   \                     RenderPage:
   \   00000000   F24F2DE9           PUSH     {R1,R4-R11,LR}
   \   00000004   B4DF4DE2           SUB      SP,SP,#+720
   \   00000008   0040A0E1           MOV      R4,R0
    342            int scr_w=ScreenW()-1;
    343            int scr_h=ScreenH()-1;
    344            int sc=0;
   \   0000000C   0060A0E3           MOV      R6,#+0
   \   00000010   888100EF           SWI      +33160
   \   00000014   010040E2           SUB      R0,R0,#+1
   \   00000018   10008DE5           STR      R0,[SP, #+16]
   \   0000001C   898100EF           SWI      +33161
   \   00000020   010040E2           SUB      R0,R0,#+1
   \   00000024   20008DE5           STR      R0,[SP, #+32]
    345            int dc;
    346            WSHDR *ws=vd->ws;
   \   00000028   241094E5           LDR      R1,[R4, #+36]
    347            LINECACHE *lc;
    348            int ypos=-vd->pixdisp;
    349            unsigned int vl;
    350            unsigned int store_line=vl=vd->view_line;
    351            unsigned int len;
    352            unsigned int y2;
    353            
    354            char def_ink[4];
    355            COLOR_RC rc[MAX_COLORS_IN_LINE];
    356            int cur_rc;
    357            int ws_width;
    358            
    359            int c;
    360            int ena_ref=0;
   \   0000002C   0050A0E3           MOV      R5,#+0
   \   00000030   34108DE5           STR      R1,[SP, #+52]
   \   00000034   200094E5           LDR      R0,[R4, #+32]
   \   00000038   1C1094E5           LDR      R1,[R4, #+28]
   \   0000003C   007060E2           RSB      R7,R0,#+0
   \   00000040   24108DE5           STR      R1,[SP, #+36]
   \   00000044   44108DE5           STR      R1,[SP, #+68]
   \   00000048   0510A0E1           MOV      R1,R5
   \   0000004C   30108DE5           STR      R1,[SP, #+48]
   \   00000050   0100E0E1           MVN      R0,R1
   \   00000054   2C0084E5           STR      R0,[R4, #+44]
    361            
    362            unsigned int flag=0;
    363            
    364            vd->pos_first_ref=0xFFFFFFFF;
    365            vd->pos_last_ref=0xFFFFFFFF;
   \   00000058   300084E5           STR      R0,[R4, #+48]
    366            vd->pos_prev_ref=0xFFFFFFFF;
   \   0000005C   340084E5           STR      R0,[R4, #+52]
    367            vd->pos_next_ref=0xFFFFFFFF;
   \   00000060   380084E5           STR      R0,[R4, #+56]
    368            
    369            int dfh=GetFontHeight(FONT_SMALL,0)*2; //double font height
   \   00000064   0800A0E3           MOV      R0,#+8
   \   00000068   ........           BL       GetFontHeight
   \   0000006C   8000A0E1           LSL      R0,R0,#+1
   \   00000070   38008DE5           STR      R0,[SP, #+56]
    370            
    371            int rnd_x;
    372            REFCACHE *rnd_rf;
    373            
    374            RECT rcs[32]; // cursor
    375            RECT rcs_work;
    376            int  rcs_num=0;
   \   00000074   0510A0E1           MOV      R1,R5
   \   00000078   18108DE5           STR      R1,[SP, #+24]
    377            
    378            int lcheck=0; // last line checker
   \   0000007C   14108DE5           STR      R1,[SP, #+20]
    379            int lprev=0; // prev line
   \   00000080   40108DE5           STR      R1,[SP, #+64]
   \   00000084   2E0000EA           B        ??RenderPage_0
    380            
    381            int x;
    382            
    383            while(ypos<=scr_h)
    384            {
    385              if (!lcheck) lcheck=!LineDown(vd);
    386              else lcheck++;
    387              if (lcheck<=1&&vd->lines_cache_size>0)
    388              {
    389                lc=vd->lines_cache+vl;
    390                if (vl) lprev=-1;
    391                dc=0;
    392                ws_width=0;
    393                cur_rc=1;
    394                rnd_rf=NULL;
    395                zeromem(&rcs_work,sizeof(RECT));
    396                
    397                rc[0].start_x=0;
    398                rc[0].end_x=scr_w;
    399                rc[0].color[0]=lc[lprev].paper1>>8;
    400                rc[0].color[1]=lc[lprev].paper1;
    401                rc[0].color[2]=lc[lprev].paper2>>8;
    402                rc[0].color[3]=lc[lprev].paper2;
    403                
    404                if (vl) sc=lc[lprev].pos;
    405                len=lc->pos-sc;
    406                
    407                while(len>0&&dc<250)
    408                {
    409                  c=vd->rawtext[sc];
    410                  
    411                  if (c==UTF16_ENA_INVERT)
    412                  {
    413                    if ((lc->pixheight<dfh)?(ypos<0):(ypos+lc->pixheight-dfh<0))
    414                      goto L1;
    415                    if ((lc->pixheight<dfh)?(ypos+lc->pixheight>scr_h):(ypos+dfh>scr_h))
    416                      goto L1;
    417                    if (vd->pos_cur_ref==sc)
    418                    {
    419                      flag=1;
    420                      ena_ref=1;
    421                      rcs_work.x=ws_width;
    422                    }
    423                    else
    424                    {
    425                      if (vd->pos_first_ref==0xFFFFFFFF) vd->pos_first_ref=sc;
    426                      if (flag==0) vd->pos_prev_ref=sc;
    427                      if (flag==1)
    428                      {
    429                        vd->pos_next_ref=sc;
    430                        flag=2;
    431                      }
    432                      vd->pos_last_ref=sc;
    433                      if (ena_ref) ena_ref++;
    434                      goto L1;
    435                    }
    436                    goto L1;
    437                  }
    438                  if (c==UTF16_DIS_INVERT)
    439                  {
    440                    if (ena_ref!=1)
    441                    {
    442                      if (ena_ref) ena_ref--;
    443                      goto L1;
    444                    }
    445                    rcs_work.x2=ws_width;
    446                    ena_ref=0;
    447                    goto L1;
    448                  }
    449                  if (c==UTF16_PAPER_RGBA)
    450                  {
    451                    if (cur_rc<MAX_COLORS_IN_LINE)
    452                    {
    453                      COLOR_RC *prev=rc+cur_rc-1;
    454                      rc[cur_rc].color[0]=vd->rawtext[sc+1]>>8;
    455                      rc[cur_rc].color[1]=vd->rawtext[sc+1];
    456                      rc[cur_rc].color[2]=vd->rawtext[sc+2]>>8;
    457                      rc[cur_rc].color[3]=vd->rawtext[sc+2];
    458                      if (memcmp((void *)rc[cur_rc].color,(void *)prev->color,4))  // Только если цвет не равен предыдущему (очередь объектов не резиновая ;))
    459                      {
    460                        prev->end_x=ws_width-1;
    461                        rc[cur_rc].start_x=ws_width;
    462                        rc[cur_rc].end_x=scr_w;
    463                        cur_rc++;
    464                      }
    465                    }
    466                  }
    467                  if (c==UTF16_ALIGN_LEFT||c==UTF16_ALIGN_RIGHT||c==UTF16_ENA_CENTER|| \
    468                      c==UTF16_DIS_CENTER||c==UTF16_NEWLINE)
    469                  {
    470                    goto L1;
    471                  }
    472                  if ((c&0xFF00)==0xE100)
    473                  {
    474                    if (c==vd->WCHAR_TEXT_FORM||c==vd->WCHAR_LIST_FORM)
    475                    {
    476                      rnd_rf=FindReferenceByBegin(vd,sc-1);
    477                      rnd_x=ws_width;
    478                    }
    479                  }
    480                  ws->wsbody[++dc]=c;
    481                  ws_width+=GetSymbolWidth(c,lc[lprev].bold?FONT_SMALL_BOLD:FONT_SMALL);
    482                  
    483                  if ((c==UTF16_PAPER_RGBA)||(c==UTF16_INK_RGBA))
    484                  {
    485                    len--;
    486                    ws->wsbody[++dc]=vd->rawtext[++sc];
    487                    len--;
    488                    ws->wsbody[++dc]=vd->rawtext[++sc];
    489                  }
    490                  L1:
    491                  sc++;
    492                  len--;
    493                }
    494                ws->wsbody[0]=dc;
    495                y2=lc->pixheight+ypos;
    496          
    497                if (do_draw&&y2!=ypos)
    498                {
    499                  x=0;
    500                  if (lc[lprev].right) x=scr_w-ws_width;
    501                  if (lc[lprev].center||lc->centerAtAll) x=(scr_w-ws_width)/2;
    502                  
    503                  def_ink[0]=lc[lprev].ink1>>8;
    504                  def_ink[1]=lc[lprev].ink1;
    505                  def_ink[2]=lc[lprev].ink2>>8;
    506                  def_ink[3]=lc[lprev].ink2;
    507                  
    508                  for (int i=0; i!=cur_rc; i++)
    509                  {
    510                    DrawRectangle(rc[i].start_x,ypos,rc[i].end_x,y2,
    511          		                    RECT_FILL_WITH_PEN,rc[i].color,rc[i].color);
    512                  }
    513                  
    514                  if (ena_ref) rcs_work.x2=ws_width;
    515                  if ((rcs_work.x!=0||rcs_work.x2!=0)&&rcs_work.x!=rcs_work.x2)
    516                  {
    517                    rcs_work.y=ypos;
    518                    rcs_work.y2=y2;
    519                    rcs_work.x+=x;
    520                    rcs_work.x2+=x;
    521                    
    522                    rcs_work.x-=2;
    523                    rcs_work.x2++;
    524                    rcs_work.y--;
    525                    
    526                    if (rcs_work.x<0) rcs_work.x=0;
    527                    if (rcs_work.x2>scr_w) rcs_work.x2=scr_w;
    528                    
    529                    memcpy(&rcs[rcs_num],&rcs_work,sizeof(RECT));
    530                    rcs_num++;
    531                  }
    532          	      DrawString(ws,x,ypos,scr_w,y2,
    533          		               lc[lprev].bold?FONT_SMALL_BOLD:FONT_SMALL,
    534                             TEXT_NOFORMAT+(lc[lprev].underline?TEXT_UNDERLINE:0),
    535          		               def_ink,GetPaletteAdrByColorIndex(23));
    536                  
    537                  if (rnd_rf) renderForm(vd,rnd_rf,rnd_x+x,ypos);
    538                  
    539                  if (y2>=scr_h||lcheck)
    540                  {
    541                    if (rcs_num)
    542                    {
    543                      char cl[4];
    544                      setColor(0,0,170,100,cl);
    545                      REFCACHE *rf=FindReferenceByBegin(vd,vd->pos_cur_ref);
    546                      if (rf->tag=='Z') setColor(190,0,0,100,cl);
    547                      for (int i=0;i<rcs_num;i++)
    548                      {
    549                         DrawLine(rcs[i].x2  ,rcs[i].y  ,rcs[i].x2  ,rcs[i].y2  ,0,cl);
    550                         DrawLine(rcs[i].x2-1,rcs[i].y  ,rcs[i].x2-1,rcs[i].y2  ,0,cl);
    551                         if (i+1<rcs_num&&rcs[i].x<rcs[i+1].x2)
    552                         {
    553                           DrawLine(rcs[i].x2,rcs[i].y2,rcs[i+1].x2,rcs[i].y2,0,cl);
    554                           if (rcs[i].x2>rcs[i+1].x2)
    555                             DrawLine(rcs[i].x2-1,rcs[i].y2+1,rcs[i+1].x2+1,rcs[i].y2+1,0,cl);
    556                           else
    557                             DrawLine(rcs[i].x2+1,rcs[i].y2+1,rcs[i+1].x2-1,rcs[i].y2+1,0,cl);
    558                         }
    559                         else
    560                         {
    561                           DrawLine(rcs[i].x2  ,rcs[i].y2  ,rcs[i].x  ,rcs[i].y2  ,0,cl);
    562                           DrawLine(rcs[i].x2-1,rcs[i].y2+1,rcs[i].x+1,rcs[i].y2+1,0,cl);
    563                         }
    564                         DrawLine(rcs[i].x  ,rcs[i].y2  ,rcs[i].x  ,rcs[i].y  ,0,cl);
    565                         DrawLine(rcs[i].x+1,rcs[i].y2  ,rcs[i].x+1,rcs[i].y  ,0,cl);
    566                         if (i>0&&rcs[i].x2>rcs[i-1].x)
    567                         {
    568                           DrawLine(rcs[i].x,rcs[i].y,rcs[i-1].x,rcs[i].y,0,cl);
    569                           if (rcs[i].x<rcs[i-1].x)
    570                             DrawLine(rcs[i].x+1,rcs[i].y-1,rcs[i-1].x-1,rcs[i].y-1,0,cl);
    571                           else
    572                             DrawLine(rcs[i].x-1,rcs[i].y-1,rcs[i-1].x+1,rcs[i].y-1,0,cl);
    573                         }
    574                         else
    575                         {
    576                           DrawLine(rcs[i].x  ,rcs[i].y  ,rcs[i].x2 , rcs[i].y  ,0,cl);
    577                           DrawLine(rcs[i].x+1,rcs[i].y-1,rcs[i].x2-1,rcs[i].y-1,0,cl);
    578                         }
    579                      }
    580                    }
    581                    int b=((store_line?vd->lines_cache[store_line+lprev].pos:0)*1000)/vd->rawtext_size*scr_h/1000-2; // no float
   \                     ??RenderPage_1:
   \   00000088   0C2094E5           LDR      R2,[R4, #+12]
   \   0000008C   FA1FA0E3           MOV      R1,#+1000
   \   00000090   910000E0           MUL      R0,R1,R0
   \   00000094   0210A0E1           MOV      R1,R2
   \   00000098   ........           _BLF     ??divu32_a,??rA??divu32_a
   \   0000009C   20009DE5           LDR      R0,[SP, #+32]
   \   000000A0   900101E0           MUL      R1,R0,R1
   \   000000A4   400A9FE5           LDR      R0,??RenderPage_2  ;; 0x10624dd3
   \   000000A8   903187E0           UMULL    R3,R7,R0,R1
    582                    int e=(lc->pos*1000)/vd->rawtext_size*scr_h/1000+2;
   \   000000AC   0C009DE5           LDR      R0,[SP, #+12]
   \   000000B0   FA1FA0E3           MOV      R1,#+1000
   \   000000B4   000090E5           LDR      R0,[R0, #+0]
   \   000000B8   2773A0E1           LSR      R7,R7,#+6
   \   000000BC   910000E0           MUL      R0,R1,R0
   \   000000C0   0210A0E1           MOV      R1,R2
   \   000000C4   ........           _BLF     ??divu32_a,??rA??divu32_a
   \   000000C8   20009DE5           LDR      R0,[SP, #+32]
   \   000000CC   027047E2           SUB      R7,R7,#+2
   \   000000D0   900101E0           MUL      R1,R0,R1
   \   000000D4   100A9FE5           LDR      R0,??RenderPage_2  ;; 0x10624dd3
   \   000000D8   902183E0           UMULL    R2,R3,R0,R1
    583                    if (!lcheck||b>0)
   \   000000DC   14009DE5           LDR      R0,[SP, #+20]
   \   000000E0   2333A0E1           LSR      R3,R3,#+6
   \   000000E4   028083E2           ADD      R8,R3,#+2
   \   000000E8   000050E3           CMP      R0,#+0
   \   000000EC   0100000A           BEQ      ??RenderPage_3
   \   000000F0   010057E3           CMP      R7,#+1
   \   000000F4   0E0000BA           BLT      ??RenderPage_4
    584                    {
    585          #ifdef ELKA
    586                      DrawRectangle(scr_w-2,b,scr_w,e,0,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(2));
   \                     ??RenderPage_3:
   \   000000F8   0200A0E3           MOV      R0,#+2
   \   000000FC   2E0100EF           SWI      +302
   \   00000100   00A0A0E1           MOV      R10,R0
   \   00000104   0200A0E3           MOV      R0,#+2
   \   00000108   2E0100EF           SWI      +302
   \   0000010C   00042DE9           PUSH     {R10}
   \   00000110   01002DE9           PUSH     {R0}
   \   00000114   0830A0E1           MOV      R3,R8
   \   00000118   0710A0E1           MOV      R1,R7
   \   0000011C   0000A0E3           MOV      R0,#+0
   \   00000120   01002DE9           PUSH     {R0}
   \   00000124   1C209DE5           LDR      R2,[SP, #+28]
   \   00000128   020042E2           SUB      R0,R2,#+2
   \   0000012C   B40100EF           SWI      +436
   \   00000130   0CD08DE2           ADD      SP,SP,#+12
    587          #else
    588                      DrawRectangle(scr_w-1,b,scr_w,e,0,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(2));
    589          #endif
    590                    }
    591                    
    592          //        if (ballet_fexists("$ballet\\debug.txt"))
    593          //        {
    594          //          WSHDR *ws;
    595          //          ws=AllocWS(128);
    596          ////          for (int i=store_line;i<=vl;i++)
    597          ////          {
    598          ////            wsprintf(ws,"%u: %u %c%c h:%u",i,vd->lines_cache[i].pos,vd->lines_cache[i].center?'+':'-',vd->lines_cache[i].right?'>':'<',vd->lines_cache[i].pixheight);
    599          ////            DrawString(ws,3,(1+i-store_line)*14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(23));
    600          ////          }
    601          //          {
    602          //            wsprintf(ws,"%i",ws_width);
    603          //            DrawString(ws,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    604          //            wsprintf(ws,"%u %u",vd->pos_first_ref,vd->pos_last_ref);
    605          //            DrawString(ws,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    606          //            wsprintf(ws,"%u %u",vd->pos_prev_ref,vd->pos_next_ref);
    607          //            DrawString(ws,3,26,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    608          //            wsprintf(ws,"%u %c",vd->pos_cur_ref,FindReference(vd,vd->pos_cur_ref)?FindReference(vd,vd->pos_cur_ref)->tag:'0');
    609          //            DrawString(ws,3,38,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    610          //            wsprintf(ws,"%i",vd->pixdisp);
    611          //            DrawString(ws,3,50,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    612          ////            ws->wsbody[0]=10;
    613          ////            memcpy(&(ws->wsbody[1]),(vd->rawtext+store_pos),10);
    614          ////            DrawString(ws,3,50,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    615          //          }
    616          //          FreeWS(ws);
    617          //        }
    618                  }
    619                }
    620                ypos=y2;
    621                vl++;
   \                     ??RenderPage_4:
   \   00000134   24109DE5           LDR      R1,[SP, #+36]
   \   00000138   0970A0E1           MOV      R7,R9
   \   0000013C   011081E2           ADD      R1,R1,#+1
   \   00000140   24108DE5           STR      R1,[SP, #+36]
   \                     ??RenderPage_0:
   \   00000144   20009DE5           LDR      R0,[SP, #+32]
   \   00000148   070050E1           CMP      R0,R7
   \   0000014C   5A0200BA           BLT      ??RenderPage_5
   \   00000150   14009DE5           LDR      R0,[SP, #+20]
   \   00000154   000050E3           CMP      R0,#+0
   \   00000158   0600001A           BNE      ??RenderPage_6
   \   0000015C   0400A0E1           MOV      R0,R4
   \   00000160   ........           BL       LineDown
   \   00000164   000050E3           CMP      R0,#+0
   \   00000168   0600001A           BNE      ??RenderPage_7
   \   0000016C   0110A0E3           MOV      R1,#+1
   \   00000170   14108DE5           STR      R1,[SP, #+20]
   \   00000174   030000EA           B        ??RenderPage_7
   \                     ??RenderPage_6:
   \   00000178   011080E2           ADD      R1,R0,#+1
   \   0000017C   14108DE5           STR      R1,[SP, #+20]
   \   00000180   020051E3           CMP      R1,#+2
   \   00000184   4C0200AA           BGE      ??RenderPage_5
   \                     ??RenderPage_7:
   \   00000188   140094E5           LDR      R0,[R4, #+20]
   \   0000018C   000050E3           CMP      R0,#+0
   \   00000190   4902000A           BEQ      ??RenderPage_5
   \   00000194   24109DE5           LDR      R1,[SP, #+36]
   \   00000198   102094E5           LDR      R2,[R4, #+16]
   \   0000019C   0080A0E3           MOV      R8,#+0
   \   000001A0   011282E0           ADD      R1,R2,R1, LSL #+4
   \   000001A4   0C108DE5           STR      R1,[SP, #+12]
   \   000001A8   24009DE5           LDR      R0,[SP, #+36]
   \   000001AC   0090A0E3           MOV      R9,#+0
   \   000001B0   000050E3           CMP      R0,#+0
   \   000001B4   0010E013           MVNNE    R1,#+0
   \   000001B8   40108D15           STRNE    R1,[SP, #+64]
   \   000001BC   0110A0E3           MOV      R1,#+1
   \   000001C0   1C108DE5           STR      R1,[SP, #+28]
   \   000001C4   0810A0E1           MOV      R1,R8
   \   000001C8   3C108DE5           STR      R1,[SP, #+60]
   \   000001CC   0810A0E3           MOV      R1,#+8
   \   000001D0   04008DE2           ADD      R0,SP,#+4
   \   000001D4   1D0100EF           SWI      +285
   \   000001D8   0810A0E1           MOV      R1,R8
   \   000001DC   54108DE5           STR      R1,[SP, #+84]
   \   000001E0   10109DE5           LDR      R1,[SP, #+16]
   \   000001E4   58108DE5           STR      R1,[SP, #+88]
   \   000001E8   40109DE5           LDR      R1,[SP, #+64]
   \   000001EC   0C209DE5           LDR      R2,[SP, #+12]
   \   000001F0   011282E0           ADD      R1,R2,R1, LSL #+4
   \   000001F4   00108DE5           STR      R1,[SP, #+0]
   \   000001F8   B810D1E1           LDRH     R1,[R1, #+8]
   \   000001FC   2114A0E1           LSR      R1,R1,#+8
   \   00000200   5010CDE5           STRB     R1,[SP, #+80]
   \   00000204   00109DE5           LDR      R1,[SP, #+0]
   \   00000208   B810D1E1           LDRH     R1,[R1, #+8]
   \   0000020C   5110CDE5           STRB     R1,[SP, #+81]
   \   00000210   00109DE5           LDR      R1,[SP, #+0]
   \   00000214   BA10D1E1           LDRH     R1,[R1, #+10]
   \   00000218   2114A0E1           LSR      R1,R1,#+8
   \   0000021C   5210CDE5           STRB     R1,[SP, #+82]
   \   00000220   00109DE5           LDR      R1,[SP, #+0]
   \   00000224   BA10D1E1           LDRH     R1,[R1, #+10]
   \   00000228   5310CDE5           STRB     R1,[SP, #+83]
   \   0000022C   24009DE5           LDR      R0,[SP, #+36]
   \   00000230   001092E5           LDR      R1,[R2, #+0]
   \   00000234   000050E3           CMP      R0,#+0
   \   00000238   00009D15           LDRNE    R0,[SP, #+0]
   \   0000023C   00609015           LDRNE    R6,[R0, #+0]
   \   00000240   061041E0           SUB      R1,R1,R6
   \   00000244   1D0000EA           B        ??RenderPage_8
   \                     ??RenderPage_9:
   \   00000248   0A00A0E1           MOV      R0,R10
   \   0000024C   E10100EF           SWI      +481
   \   00000250   088080E0           ADD      R8,R0,R8
   \   00000254   0700A0E3           MOV      R0,#+7
   \   00000258   E00C80E3           ORR      R0,R0,#0xE000
   \   0000025C   00005AE1           CMP      R10,R0
   \   00000260   0100C013           BICNE    R0,R0,#0x1
   \   00000264   00005A11           CMPNE    R10,R0
   \   00000268   1100001A           BNE      ??RenderPage_10
   \   0000026C   080094E5           LDR      R0,[R4, #+8]
   \   00000270   34309DE5           LDR      R3,[SP, #+52]
   \   00000274   011089E2           ADD      R1,R9,#+1
   \   00000278   003093E5           LDR      R3,[R3, #+0]
   \   0000027C   012086E2           ADD      R2,R6,#+1
   \   00000280   829080E0           ADD      R9,R0,R2, LSL #+1
   \   00000284   B090D9E1           LDRH     R9,[R9, #+0]
   \   00000288   816083E0           ADD      R6,R3,R1, LSL #+1
   \   0000028C   B090C6E1           STRH     R9,[R6, #+0]
   \   00000290   28909DE5           LDR      R9,[SP, #+40]
   \   00000294   016082E2           ADD      R6,R2,#+1
   \   00000298   029049E2           SUB      R9,R9,#+2
   \   0000029C   28908DE5           STR      R9,[SP, #+40]
   \   000002A0   860080E0           ADD      R0,R0,R6, LSL #+1
   \   000002A4   B000D0E1           LDRH     R0,[R0, #+0]
   \   000002A8   019081E2           ADD      R9,R1,#+1
   \   000002AC   891083E0           ADD      R1,R3,R9, LSL #+1
   \   000002B0   B000C1E1           STRH     R0,[R1, #+0]
   \                     ??RenderPage_10:
   \   000002B4   28109DE5           LDR      R1,[SP, #+40]
   \   000002B8   016086E2           ADD      R6,R6,#+1
   \   000002BC   011041E2           SUB      R1,R1,#+1
   \                     ??RenderPage_8:
   \   000002C0   28108DE5           STR      R1,[SP, #+40]
   \   000002C4   28009DE5           LDR      R0,[SP, #+40]
   \   000002C8   000050E3           CMP      R0,#+0
   \   000002CC   9400000A           BEQ      ??RenderPage_11
   \   000002D0   FA0059E3           CMP      R9,#+250
   \   000002D4   920000AA           BGE      ??RenderPage_11
   \   000002D8   080094E5           LDR      R0,[R4, #+8]
   \   000002DC   0510A0E3           MOV      R1,#+5
   \   000002E0   860080E0           ADD      R0,R0,R6, LSL #+1
   \   000002E4   B0A0D0E1           LDRH     R10,[R0, #+0]
   \   000002E8   E01C81E3           ORR      R1,R1,#0xE000
   \   000002EC   01005AE1           CMP      R10,R1
   \   000002F0   3200001A           BNE      ??RenderPage_12
   \   000002F4   0C009DE5           LDR      R0,[SP, #+12]
   \   000002F8   38109DE5           LDR      R1,[SP, #+56]
   \   000002FC   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000300   010050E1           CMP      R0,R1
   \   00000304   020000AA           BGE      ??RenderPage_13
   \   00000308   000057E3           CMP      R7,#+0
   \   0000030C   0500005A           BPL      ??RenderPage_14
   \   00000310   E7FFFFEA           B        ??RenderPage_10
   \                     ??RenderPage_13:
   \   00000314   0C009DE5           LDR      R0,[SP, #+12]
   \   00000318   BE00D0E1           LDRH     R0,[R0, #+14]
   \   0000031C   070080E0           ADD      R0,R0,R7
   \   00000320   010050E0           SUBS     R0,R0,R1
   \   00000324   E2FFFF4A           BMI      ??RenderPage_10
   \                     ??RenderPage_14:
   \   00000328   0C009DE5           LDR      R0,[SP, #+12]
   \   0000032C   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000330   010050E1           CMP      R0,R1
   \   00000334   20009DE5           LDR      R0,[SP, #+32]
   \   00000338   050000AA           BGE      ??RenderPage_15
   \   0000033C   0C109DE5           LDR      R1,[SP, #+12]
   \   00000340   BE10D1E1           LDRH     R1,[R1, #+14]
   \   00000344   071081E0           ADD      R1,R1,R7
   \   00000348   010050E1           CMP      R0,R1
   \   0000034C   030000AA           BGE      ??RenderPage_16
   \   00000350   D7FFFFEA           B        ??RenderPage_10
   \                     ??RenderPage_15:
   \   00000354   071081E0           ADD      R1,R1,R7
   \   00000358   010050E1           CMP      R0,R1
   \   0000035C   D4FFFFBA           BLT      ??RenderPage_10
   \                     ??RenderPage_16:
   \   00000360   280094E5           LDR      R0,[R4, #+40]
   \   00000364   060050E1           CMP      R0,R6
   \   00000368   0400001A           BNE      ??RenderPage_17
   \   0000036C   0110A0E3           MOV      R1,#+1
   \   00000370   30108DE5           STR      R1,[SP, #+48]
   \   00000374   0150A0E3           MOV      R5,#+1
   \   00000378   B480CDE1           STRH     R8,[SP, #+4]
   \   0000037C   CCFFFFEA           B        ??RenderPage_10
   \                     ??RenderPage_17:
   \   00000380   2C0094E5           LDR      R0,[R4, #+44]
   \   00000384   010070E3           CMN      R0,#+1
   \   00000388   2C608405           STREQ    R6,[R4, #+44]
   \   0000038C   30009DE5           LDR      R0,[SP, #+48]
   \   00000390   000050E3           CMP      R0,#+0
   \   00000394   34608405           STREQ    R6,[R4, #+52]
   \   00000398   0300000A           BEQ      ??RenderPage_18
   \   0000039C   010050E3           CMP      R0,#+1
   \   000003A0   38608405           STREQ    R6,[R4, #+56]
   \   000003A4   0210A003           MOVEQ    R1,#+2
   \   000003A8   30108D05           STREQ    R1,[SP, #+48]
   \                     ??RenderPage_18:
   \   000003AC   306084E5           STR      R6,[R4, #+48]
   \   000003B0   000055E3           CMP      R5,#+0
   \   000003B4   BEFFFF0A           BEQ      ??RenderPage_10
   \   000003B8   015085E2           ADD      R5,R5,#+1
   \   000003BC   BCFFFFEA           B        ??RenderPage_10
   \                     ??RenderPage_12:
   \   000003C0   0110C1E3           BIC      R1,R1,#0x1
   \   000003C4   01005AE1           CMP      R10,R1
   \   000003C8   0800001A           BNE      ??RenderPage_19
   \   000003CC   010055E3           CMP      R5,#+1
   \   000003D0   0300000A           BEQ      ??RenderPage_20
   \   000003D4   000055E3           CMP      R5,#+0
   \   000003D8   B5FFFF0A           BEQ      ??RenderPage_10
   \   000003DC   015045E2           SUB      R5,R5,#+1
   \   000003E0   B3FFFFEA           B        ??RenderPage_10
   \                     ??RenderPage_20:
   \   000003E4   B880CDE1           STRH     R8,[SP, #+8]
   \   000003E8   0050A0E3           MOV      R5,#+0
   \   000003EC   B0FFFFEA           B        ??RenderPage_10
   \                     ??RenderPage_19:
   \   000003F0   031081E3           ORR      R1,R1,#0x3
   \   000003F4   01005AE1           CMP      R10,R1
   \   000003F8   2700001A           BNE      ??RenderPage_21
   \   000003FC   1C109DE5           LDR      R1,[SP, #+28]
   \   00000400   200051E3           CMP      R1,#+32
   \   00000404   2E0000AA           BGE      ??RenderPage_22
   \   00000408   0C20A0E3           MOV      R2,#+12
   \   0000040C   50308DE2           ADD      R3,SP,#+80
   \   00000410   92312BE0           MLA      R11,R2,R1,R3
   \   00000414   0C204BE2           SUB      R2,R11,#+12
   \   00000418   48208DE5           STR      R2,[SP, #+72]
   \   0000041C   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000420   0420A0E3           MOV      R2,#+4
   \   00000424   2004A0E1           LSR      R0,R0,#+8
   \   00000428   0000CBE5           STRB     R0,[R11, #+0]
   \   0000042C   080094E5           LDR      R0,[R4, #+8]
   \   00000430   860080E0           ADD      R0,R0,R6, LSL #+1
   \   00000434   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000438   0100CBE5           STRB     R0,[R11, #+1]
   \   0000043C   080094E5           LDR      R0,[R4, #+8]
   \   00000440   860080E0           ADD      R0,R0,R6, LSL #+1
   \   00000444   B400D0E1           LDRH     R0,[R0, #+4]
   \   00000448   2004A0E1           LSR      R0,R0,#+8
   \   0000044C   0200CBE5           STRB     R0,[R11, #+2]
   \   00000450   080094E5           LDR      R0,[R4, #+8]
   \   00000454   860080E0           ADD      R0,R0,R6, LSL #+1
   \   00000458   B400D0E1           LDRH     R0,[R0, #+4]
   \   0000045C   0300CBE5           STRB     R0,[R11, #+3]
   \   00000460   48109DE5           LDR      R1,[SP, #+72]
   \   00000464   0B00A0E1           MOV      R0,R11
   \   00000468   1C0100EF           SWI      +284
   \   0000046C   000050E3           CMP      R0,#+0
   \   00000470   1300000A           BEQ      ??RenderPage_22
   \   00000474   48009DE5           LDR      R0,[SP, #+72]
   \   00000478   011048E2           SUB      R1,R8,#+1
   \   0000047C   081080E5           STR      R1,[R0, #+8]
   \   00000480   04808BE5           STR      R8,[R11, #+4]
   \   00000484   10009DE5           LDR      R0,[SP, #+16]
   \   00000488   08008BE5           STR      R0,[R11, #+8]
   \   0000048C   1C109DE5           LDR      R1,[SP, #+28]
   \   00000490   011081E2           ADD      R1,R1,#+1
   \   00000494   1C108DE5           STR      R1,[SP, #+28]
   \   00000498   090000EA           B        ??RenderPage_22
   \                     ??RenderPage_21:
   \   0000049C   150081E2           ADD      R0,R1,#+21
   \   000004A0   00005AE1           CMP      R10,R0
   \   000004A4   01008013           ORRNE    R0,R0,#0x1
   \   000004A8   00005A11           CMPNE    R10,R0
   \   000004AC   01008012           ADDNE    R0,R0,#+1
   \   000004B0   00005A11           CMPNE    R10,R0
   \   000004B4   01008013           ORRNE    R0,R0,#0x1
   \   000004B8   00005A11           CMPNE    R10,R0
   \   000004BC   0A005A13           CMPNE    R10,#+10
   \   000004C0   7BFFFF0A           BEQ      ??RenderPage_10
   \                     ??RenderPage_22:
   \   000004C4   FF0C0AE2           AND      R0,R10,#0xFF00
   \   000004C8   E10C50E3           CMP      R0,#+57600
   \   000004CC   0900001A           BNE      ??RenderPage_23
   \   000004D0   F00094E5           LDR      R0,[R4, #+240]
   \   000004D4   00005AE1           CMP      R10,R0
   \   000004D8   F4009415           LDRNE    R0,[R4, #+244]
   \   000004DC   00005A11           CMPNE    R10,R0
   \   000004E0   0400001A           BNE      ??RenderPage_23
   \   000004E4   011046E2           SUB      R1,R6,#+1
   \   000004E8   0400A0E1           MOV      R0,R4
   \   000004EC   ........           BL       FindReferenceByBegin
   \   000004F0   3C008DE5           STR      R0,[SP, #+60]
   \   000004F4   4C808DE5           STR      R8,[SP, #+76]
   \                     ??RenderPage_23:
   \   000004F8   34009DE5           LDR      R0,[SP, #+52]
   \   000004FC   019089E2           ADD      R9,R9,#+1
   \   00000500   000090E5           LDR      R0,[R0, #+0]
   \   00000504   890080E0           ADD      R0,R0,R9, LSL #+1
   \   00000508   B0A0C0E1           STRH     R10,[R0, #+0]
   \   0000050C   00009DE5           LDR      R0,[SP, #+0]
   \   00000510   BC00D0E1           LDRH     R0,[R0, #+12]
   \   00000514   010010E3           TST      R0,#0x1
   \   00000518   0810A003           MOVEQ    R1,#+8
   \   0000051C   0910A013           MOVNE    R1,#+9
   \   00000520   48FFFFEA           B        ??RenderPage_9
   \                     ??RenderPage_11:
   \   00000524   34009DE5           LDR      R0,[SP, #+52]
   \   00000528   000090E5           LDR      R0,[R0, #+0]
   \   0000052C   B090C0E1           STRH     R9,[R0, #+0]
   \   00000530   0C009DE5           LDR      R0,[SP, #+12]
   \   00000534   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000538   009087E0           ADD      R9,R7,R0
   \   0000053C   D0029DE5           LDR      R0,[SP, #+720]
   \   00000540   000050E3           CMP      R0,#+0
   \   00000544   07005911           CMPNE    R9,R7
   \   00000548   F9FEFF0A           BEQ      ??RenderPage_4
   \   0000054C   00109DE5           LDR      R1,[SP, #+0]
   \   00000550   10009DE5           LDR      R0,[SP, #+16]
   \   00000554   BC10D1E1           LDRH     R1,[R1, #+12]
   \   00000558   00A0A0E3           MOV      R10,#+0
   \   0000055C   080040E0           SUB      R0,R0,R8
   \   00000560   100011E3           TST      R1,#0x10
   \   00000564   00109DE5           LDR      R1,[SP, #+0]
   \   00000568   00A0A011           MOVNE    R10,R0
   \   0000056C   BC10D1E1           LDRH     R1,[R1, #+12]
   \   00000570   080011E3           TST      R1,#0x8
   \   00000574   0300001A           BNE      ??RenderPage_24
   \   00000578   0C109DE5           LDR      R1,[SP, #+12]
   \   0000057C   BC10D1E1           LDRH     R1,[R1, #+12]
   \   00000580   200011E3           TST      R1,#0x20
   \   00000584   0100000A           BEQ      ??RenderPage_25
   \                     ??RenderPage_24:
   \   00000588   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   0000058C   C0A0A0E1           ASR      R10,R0,#+1
   \                     ??RenderPage_25:
   \   00000590   00109DE5           LDR      R1,[SP, #+0]
   \   00000594   00B0A0E3           MOV      R11,#+0
   \   00000598   B410D1E1           LDRH     R1,[R1, #+4]
   \   0000059C   2114A0E1           LSR      R1,R1,#+8
   \   000005A0   2C10CDE5           STRB     R1,[SP, #+44]
   \   000005A4   00109DE5           LDR      R1,[SP, #+0]
   \   000005A8   B410D1E1           LDRH     R1,[R1, #+4]
   \   000005AC   2D10CDE5           STRB     R1,[SP, #+45]
   \   000005B0   00109DE5           LDR      R1,[SP, #+0]
   \   000005B4   B610D1E1           LDRH     R1,[R1, #+6]
   \   000005B8   2114A0E1           LSR      R1,R1,#+8
   \   000005BC   2E10CDE5           STRB     R1,[SP, #+46]
   \   000005C0   00109DE5           LDR      R1,[SP, #+0]
   \   000005C4   B610D1E1           LDRH     R1,[R1, #+6]
   \   000005C8   2F10CDE5           STRB     R1,[SP, #+47]
   \   000005CC   1C009DE5           LDR      R0,[SP, #+28]
   \   000005D0   000050E3           CMP      R0,#+0
   \   000005D4   1100000A           BEQ      ??RenderPage_26
   \                     ??RenderPage_27:
   \   000005D8   0C10A0E3           MOV      R1,#+12
   \   000005DC   50008DE2           ADD      R0,SP,#+80
   \   000005E0   910B20E0           MLA      R0,R1,R11,R0
   \   000005E4   0930A0E1           MOV      R3,R9
   \   000005E8   0010A0E1           MOV      R1,R0
   \   000005EC   02002DE9           PUSH     {R1}
   \   000005F0   02002DE9           PUSH     {R1}
   \   000005F4   01B08BE2           ADD      R11,R11,#+1
   \   000005F8   0210A0E3           MOV      R1,#+2
   \   000005FC   02002DE9           PUSH     {R1}
   \   00000600   082090E5           LDR      R2,[R0, #+8]
   \   00000604   040090E5           LDR      R0,[R0, #+4]
   \   00000608   0710A0E1           MOV      R1,R7
   \   0000060C   B40100EF           SWI      +436
   \   00000610   28009DE5           LDR      R0,[SP, #+40]
   \   00000614   0CD08DE2           ADD      SP,SP,#+12
   \   00000618   00005BE1           CMP      R11,R0
   \   0000061C   EDFFFF1A           BNE      ??RenderPage_27
   \                     ??RenderPage_26:
   \   00000620   000055E3           CMP      R5,#+0
   \   00000624   B880CD11           STRHNE   R8,[SP, #+8]
   \   00000628   F800DDE1           LDRSH    R0,[SP, #+8]
   \   0000062C   F410DDE1           LDRSH    R1,[SP, #+4]
   \   00000630   000051E3           CMP      R1,#+0
   \   00000634   00005003           CMPEQ    R0,#+0
   \   00000638   00005111           CMPNE    R1,R0
   \   0000063C   1E00000A           BEQ      ??RenderPage_28
   \   00000640   B670CDE1           STRH     R7,[SP, #+6]
   \   00000644   BA90CDE1           STRH     R9,[SP, #+10]
   \   00000648   01208AE0           ADD      R2,R10,R1
   \   0000064C   B420CDE1           STRH     R2,[SP, #+4]
   \   00000650   00008AE0           ADD      R0,R10,R0
   \   00000654   B800CDE1           STRH     R0,[SP, #+8]
   \   00000658   F420DDE1           LDRSH    R2,[SP, #+4]
   \   0000065C   010080E2           ADD      R0,R0,#+1
   \   00000660   743F8DE2           ADD      R3,SP,#+464
   \   00000664   022042E2           SUB      R2,R2,#+2
   \   00000668   B420CDE1           STRH     R2,[SP, #+4]
   \   0000066C   B800CDE1           STRH     R0,[SP, #+8]
   \   00000670   F620DDE1           LDRSH    R2,[SP, #+6]
   \   00000674   0008A0E1           MOV      R0,R0, LSL #+16
   \   00000678   012042E2           SUB      R2,R2,#+1
   \   0000067C   B620CDE1           STRH     R2,[SP, #+6]
   \   00000680   F410DDE1           LDRSH    R1,[SP, #+4]
   \   00000684   000051E3           CMP      R1,#+0
   \   00000688   0020A043           MOVMI    R2,#+0
   \   0000068C   B420CD41           STRHMI   R2,[SP, #+4]
   \   00000690   10109DE5           LDR      R1,[SP, #+16]
   \   00000694   0820A0E3           MOV      R2,#+8
   \   00000698   400851E1           CMP      R1,R0, ASR #+16
   \   0000069C   B810CDB1           STRHLT   R1,[SP, #+8]
   \   000006A0   18009DE5           LDR      R0,[SP, #+24]
   \   000006A4   04108DE2           ADD      R1,SP,#+4
   \   000006A8   800183E0           ADD      R0,R3,R0, LSL #+3
   \   000006AC   1E0100EF           SWI      +286
   \   000006B0   18109DE5           LDR      R1,[SP, #+24]
   \   000006B4   011081E2           ADD      R1,R1,#+1
   \   000006B8   18108DE5           STR      R1,[SP, #+24]
   \                     ??RenderPage_28:
   \   000006BC   1700A0E3           MOV      R0,#+23
   \   000006C0   2E0100EF           SWI      +302
   \   000006C4   00109DE5           LDR      R1,[SP, #+0]
   \   000006C8   00209DE5           LDR      R2,[SP, #+0]
   \   000006CC   BC10D1E1           LDRH     R1,[R1, #+12]
   \   000006D0   BC20D2E1           LDRH     R2,[R2, #+12]
   \   000006D4   01002DE9           PUSH     {R0}
   \   000006D8   020011E3           TST      R1,#0x2
   \   000006DC   0810A013           MOVNE    R1,#+8
   \   000006E0   0010A003           MOVEQ    R1,#+0
   \   000006E4   30008DE2           ADD      R0,SP,#+48
   \   000006E8   01002DE9           PUSH     {R0}
   \   000006EC   010012E3           TST      R2,#0x1
   \   000006F0   0920A013           MOVNE    R2,#+9
   \   000006F4   0820A003           MOVEQ    R2,#+8
   \   000006F8   800081E2           ADD      R0,R1,#+128
   \   000006FC   01002DE9           PUSH     {R0}
   \   00000700   04002DE9           PUSH     {R2}
   \   00000704   0A10A0E1           MOV      R1,R10
   \   00000708   0900A0E1           MOV      R0,R9
   \   0000070C   01002DE9           PUSH     {R0}
   \   00000710   24309DE5           LDR      R3,[SP, #+36]
   \   00000714   48009DE5           LDR      R0,[SP, #+72]
   \   00000718   0720A0E1           MOV      R2,R7
   \   0000071C   4C0100EF           SWI      +332
   \   00000720   50009DE5           LDR      R0,[SP, #+80]
   \   00000724   14D08DE2           ADD      SP,SP,#+20
   \   00000728   000050E3           CMP      R0,#+0
   \   0000072C   0500000A           BEQ      ??RenderPage_29
   \   00000730   4C009DE5           LDR      R0,[SP, #+76]
   \   00000734   3C109DE5           LDR      R1,[SP, #+60]
   \   00000738   0730A0E1           MOV      R3,R7
   \   0000073C   00208AE0           ADD      R2,R10,R0
   \   00000740   0400A0E1           MOV      R0,R4
   \   00000744   ........           BL       renderForm
   \                     ??RenderPage_29:
   \   00000748   20009DE5           LDR      R0,[SP, #+32]
   \   0000074C   000059E1           CMP      R9,R0
   \   00000750   0200002A           BCS      ??RenderPage_30
   \   00000754   14009DE5           LDR      R0,[SP, #+20]
   \   00000758   000050E3           CMP      R0,#+0
   \   0000075C   74FEFF0A           BEQ      ??RenderPage_4
   \                     ??RenderPage_30:
   \   00000760   18009DE5           LDR      R0,[SP, #+24]
   \   00000764   000050E3           CMP      R0,#+0
   \   00000768   1900000A           BEQ      ??RenderPage_31
   \   0000076C   0D00A0E1           MOV      R0,SP
   \   00000770   01002DE9           PUSH     {R0}
   \   00000774   6430A0E3           MOV      R3,#+100
   \   00000778   AA20A0E3           MOV      R2,#+170
   \   0000077C   0010A0E3           MOV      R1,#+0
   \   00000780   0000A0E3           MOV      R0,#+0
   \   00000784   310100EF           SWI      +305
   \   00000788   281094E5           LDR      R1,[R4, #+40]
   \   0000078C   0400A0E1           MOV      R0,R4
   \   00000790   ........           BL       FindReferenceByBegin
   \   00000794   080090E5           LDR      R0,[R0, #+8]
   \   00000798   04D08DE2           ADD      SP,SP,#+4
   \   0000079C   5A0050E3           CMP      R0,#+90
   \   000007A0   0700001A           BNE      ??RenderPage_32
   \   000007A4   0D00A0E1           MOV      R0,SP
   \   000007A8   01002DE9           PUSH     {R0}
   \   000007AC   6430A0E3           MOV      R3,#+100
   \   000007B0   0020A0E3           MOV      R2,#+0
   \   000007B4   0010A0E3           MOV      R1,#+0
   \   000007B8   BE00A0E3           MOV      R0,#+190
   \   000007BC   310100EF           SWI      +305
   \   000007C0   04D08DE2           ADD      SP,SP,#+4
   \                     ??RenderPage_32:
   \   000007C4   18009DE5           LDR      R0,[SP, #+24]
   \   000007C8   00B0A0E3           MOV      R11,#+0
   \   000007CC   010050E3           CMP      R0,#+1
   \   000007D0   1F0000AA           BGE      ??RenderPage_33
   \                     ??RenderPage_31:
   \   000007D4   44009DE5           LDR      R0,[SP, #+68]
   \   000007D8   000050E3           CMP      R0,#+0
   \   000007DC   29FEFF0A           BEQ      ??RenderPage_1
   \   000007E0   40109DE5           LDR      R1,[SP, #+64]
   \   000007E4   000081E0           ADD      R0,R1,R0
   \   000007E8   101094E5           LDR      R1,[R4, #+16]
   \   000007EC   000291E7           LDR      R0,[R1, +R0, LSL #+4]
   \   000007F0   24FEFFEA           B        ??RenderPage_1
   \                     ??RenderPage_34:
   \   000007F4   0D00A0E1           MOV      R0,SP
   \   000007F8   01002DE9           PUSH     {R0}
   \   000007FC   0000A0E3           MOV      R0,#+0
   \   00000800   01002DE9           PUSH     {R0}
   \   00000804   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000808   F220D8E1           LDRSH    R2,[R8, #+2]
   \   0000080C   F000D7E1           LDRSH    R0,[R7, #+0]
   \   00000810   0310A0E1           MOV      R1,R3
   \   00000814   B30100EF           SWI      +435
   \   00000818   08008DE2           ADD      R0,SP,#+8
   \   0000081C   01002DE9           PUSH     {R0}
   \   00000820   0000A0E3           MOV      R0,#+0
   \   00000824   01002DE9           PUSH     {R0}
   \   00000828   F000D8E1           LDRSH    R0,[R8, #+0]
   \   0000082C   013040E2           SUB      R3,R0,#+1
   \   00000830   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000834   012040E2           SUB      R2,R0,#+1
   \   00000838   F000D8E1           LDRSH    R0,[R8, #+0]
   \   0000083C   011040E2           SUB      R1,R0,#+1
   \   00000840   F000D7E1           LDRSH    R0,[R7, #+0]
   \   00000844   010080E2           ADD      R0,R0,#+1
   \   00000848   B30100EF           SWI      +435
   \   0000084C   10D08DE2           ADD      SP,SP,#+16
   \                     ??RenderPage_35:
   \   00000850   0AB0A0E1           MOV      R11,R10
   \                     ??RenderPage_33:
   \   00000854   18009DE5           LDR      R0,[SP, #+24]
   \   00000858   00005BE1           CMP      R11,R0
   \   0000085C   DCFFFFAA           BGE      ??RenderPage_31
   \   00000860   740F8DE2           ADD      R0,SP,#+464
   \   00000864   8B7180E0           ADD      R7,R0,R11, LSL #+3
   \   00000868   0D00A0E1           MOV      R0,SP
   \   0000086C   01002DE9           PUSH     {R0}
   \   00000870   028087E2           ADD      R8,R7,#+2
   \   00000874   01A08BE2           ADD      R10,R11,#+1
   \   00000878   0000A0E3           MOV      R0,#+0
   \   0000087C   01002DE9           PUSH     {R0}
   \   00000880   F220D8E1           LDRSH    R2,[R8, #+2]
   \   00000884   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000888   F010D8E1           LDRSH    R1,[R8, #+0]
   \   0000088C   0200A0E1           MOV      R0,R2
   \   00000890   B30100EF           SWI      +435
   \   00000894   08008DE2           ADD      R0,SP,#+8
   \   00000898   01002DE9           PUSH     {R0}
   \   0000089C   0000A0E3           MOV      R0,#+0
   \   000008A0   01002DE9           PUSH     {R0}
   \   000008A4   F430D8E1           LDRSH    R3,[R8, #+4]
   \   000008A8   F010D8E1           LDRSH    R1,[R8, #+0]
   \   000008AC   F200D8E1           LDRSH    R0,[R8, #+2]
   \   000008B0   012040E2           SUB      R2,R0,#+1
   \   000008B4   010040E2           SUB      R0,R0,#+1
   \   000008B8   B30100EF           SWI      +435
   \   000008BC   28009DE5           LDR      R0,[SP, #+40]
   \   000008C0   10D08DE2           ADD      SP,SP,#+16
   \   000008C4   00005AE1           CMP      R10,R0
   \   000008C8   260000AA           BGE      ??RenderPage_36
   \   000008CC   F000D7E1           LDRSH    R0,[R7, #+0]
   \   000008D0   FA10D8E1           LDRSH    R1,[R8, #+10]
   \   000008D4   010050E1           CMP      R0,R1
   \   000008D8   220000AA           BGE      ??RenderPage_36
   \   000008DC   0D00A0E1           MOV      R0,SP
   \   000008E0   01002DE9           PUSH     {R0}
   \   000008E4   0000A0E3           MOV      R0,#+0
   \   000008E8   01002DE9           PUSH     {R0}
   \   000008EC   F430D8E1           LDRSH    R3,[R8, #+4]
   \   000008F0   FA20D8E1           LDRSH    R2,[R8, #+10]
   \   000008F4   F200D8E1           LDRSH    R0,[R8, #+2]
   \   000008F8   0310A0E1           MOV      R1,R3
   \   000008FC   B30100EF           SWI      +435
   \   00000900   FA00D8E1           LDRSH    R0,[R8, #+10]
   \   00000904   F210D8E1           LDRSH    R1,[R8, #+2]
   \   00000908   08D08DE2           ADD      SP,SP,#+8
   \   0000090C   010050E1           CMP      R0,R1
   \   00000910   0D00A0E1           MOV      R0,SP
   \   00000914   01002DE9           PUSH     {R0}
   \   00000918   0000A0E3           MOV      R0,#+0
   \   0000091C   01002DE9           PUSH     {R0}
   \   00000920   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000924   013080E2           ADD      R3,R0,#+1
   \   00000928   FA00D8E1           LDRSH    R0,[R8, #+10]
   \   0000092C   070000AA           BGE      ??RenderPage_37
   \   00000930   012080E2           ADD      R2,R0,#+1
   \   00000934   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000938   011080E2           ADD      R1,R0,#+1
   \   0000093C   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000940   010040E2           SUB      R0,R0,#+1
   \                     ??RenderPage_38:
   \   00000944   B30100EF           SWI      +435
   \   00000948   08D08DE2           ADD      SP,SP,#+8
   \   0000094C   1C0000EA           B        ??RenderPage_39
   \                     ??RenderPage_37:
   \   00000950   012040E2           SUB      R2,R0,#+1
   \   00000954   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000958   011080E2           ADD      R1,R0,#+1
   \   0000095C   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000960   010080E2           ADD      R0,R0,#+1
   \   00000964   F6FFFFEA           B        ??RenderPage_38
   \                     ??RenderPage_36:
   \   00000968   0D00A0E1           MOV      R0,SP
   \   0000096C   01002DE9           PUSH     {R0}
   \   00000970   0000A0E3           MOV      R0,#+0
   \   00000974   01002DE9           PUSH     {R0}
   \   00000978   F430D8E1           LDRSH    R3,[R8, #+4]
   \   0000097C   F020D7E1           LDRSH    R2,[R7, #+0]
   \   00000980   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000984   0310A0E1           MOV      R1,R3
   \   00000988   B30100EF           SWI      +435
   \   0000098C   08008DE2           ADD      R0,SP,#+8
   \   00000990   01002DE9           PUSH     {R0}
   \   00000994   0000A0E3           MOV      R0,#+0
   \   00000998   01002DE9           PUSH     {R0}
   \   0000099C   F400D8E1           LDRSH    R0,[R8, #+4]
   \   000009A0   013080E2           ADD      R3,R0,#+1
   \   000009A4   F000D7E1           LDRSH    R0,[R7, #+0]
   \   000009A8   012080E2           ADD      R2,R0,#+1
   \   000009AC   F400D8E1           LDRSH    R0,[R8, #+4]
   \   000009B0   011080E2           ADD      R1,R0,#+1
   \   000009B4   F200D8E1           LDRSH    R0,[R8, #+2]
   \   000009B8   010040E2           SUB      R0,R0,#+1
   \   000009BC   B30100EF           SWI      +435
   \   000009C0   10D08DE2           ADD      SP,SP,#+16
   \                     ??RenderPage_39:
   \   000009C4   0D00A0E1           MOV      R0,SP
   \   000009C8   01002DE9           PUSH     {R0}
   \   000009CC   0000A0E3           MOV      R0,#+0
   \   000009D0   01002DE9           PUSH     {R0}
   \   000009D4   F020D7E1           LDRSH    R2,[R7, #+0]
   \   000009D8   F030D8E1           LDRSH    R3,[R8, #+0]
   \   000009DC   F410D8E1           LDRSH    R1,[R8, #+4]
   \   000009E0   0200A0E1           MOV      R0,R2
   \   000009E4   B30100EF           SWI      +435
   \   000009E8   08008DE2           ADD      R0,SP,#+8
   \   000009EC   01002DE9           PUSH     {R0}
   \   000009F0   0000A0E3           MOV      R0,#+0
   \   000009F4   01002DE9           PUSH     {R0}
   \   000009F8   F030D8E1           LDRSH    R3,[R8, #+0]
   \   000009FC   F410D8E1           LDRSH    R1,[R8, #+4]
   \   00000A00   F000D7E1           LDRSH    R0,[R7, #+0]
   \   00000A04   012080E2           ADD      R2,R0,#+1
   \   00000A08   010080E2           ADD      R0,R0,#+1
   \   00000A0C   B30100EF           SWI      +435
   \   00000A10   01005BE3           CMP      R11,#+1
   \   00000A14   10D08DE2           ADD      SP,SP,#+16
   \   00000A18   75FFFFBA           BLT      ??RenderPage_34
   \   00000A1C   F210D8E1           LDRSH    R1,[R8, #+2]
   \   00000A20   07B0E0E3           MVN      R11,#+7
   \   00000A24   F7009BE1           LDRSH    R0,[R11, +R7]
   \   00000A28   010050E1           CMP      R0,R1
   \   00000A2C   70FFFFAA           BGE      ??RenderPage_34
   \   00000A30   0D00A0E1           MOV      R0,SP
   \   00000A34   01002DE9           PUSH     {R0}
   \   00000A38   0000A0E3           MOV      R0,#+0
   \   00000A3C   01002DE9           PUSH     {R0}
   \   00000A40   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000A44   F7209BE1           LDRSH    R2,[R11, +R7]
   \   00000A48   F000D7E1           LDRSH    R0,[R7, #+0]
   \   00000A4C   0310A0E1           MOV      R1,R3
   \   00000A50   B30100EF           SWI      +435
   \   00000A54   F000D7E1           LDRSH    R0,[R7, #+0]
   \   00000A58   F7109BE1           LDRSH    R1,[R11, +R7]
   \   00000A5C   08D08DE2           ADD      SP,SP,#+8
   \   00000A60   010050E1           CMP      R0,R1
   \   00000A64   0D00A0E1           MOV      R0,SP
   \   00000A68   01002DE9           PUSH     {R0}
   \   00000A6C   0000A0E3           MOV      R0,#+0
   \   00000A70   01002DE9           PUSH     {R0}
   \   00000A74   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000A78   013040E2           SUB      R3,R0,#+1
   \   00000A7C   F7009BE1           LDRSH    R0,[R11, +R7]
   \   00000A80   070000AA           BGE      ??RenderPage_40
   \   00000A84   012040E2           SUB      R2,R0,#+1
   \   00000A88   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000A8C   011040E2           SUB      R1,R0,#+1
   \   00000A90   F000D7E1           LDRSH    R0,[R7, #+0]
   \   00000A94   010080E2           ADD      R0,R0,#+1
   \                     ??RenderPage_41:
   \   00000A98   B30100EF           SWI      +435
   \   00000A9C   08D08DE2           ADD      SP,SP,#+8
   \   00000AA0   6AFFFFEA           B        ??RenderPage_35
   \                     ??RenderPage_40:
   \   00000AA4   012080E2           ADD      R2,R0,#+1
   \   00000AA8   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000AAC   011040E2           SUB      R1,R0,#+1
   \   00000AB0   F000D7E1           LDRSH    R0,[R7, #+0]
   \   00000AB4   010040E2           SUB      R0,R0,#+1
   \   00000AB8   F6FFFFEA           B        ??RenderPage_41
    622              }
    623              else
    624                break;
    625            }
    626            if (flag==0) vd->pos_cur_ref=0xFFFFFFFF;
   \                     ??RenderPage_5:
   \   00000ABC   30009DE5           LDR      R0,[SP, #+48]
   \   00000AC0   000050E3           CMP      R0,#+0
   \   00000AC4   0000E003           MVNEQ    R0,#+0
   \   00000AC8   28008405           STREQ    R0,[R4, #+40]
    627            vd->view_line=store_line;
   \   00000ACC   44009DE5           LDR      R0,[SP, #+68]
   \   00000AD0   1C0084E5           STR      R0,[R4, #+28]
    628            
    629          //  WSHDR *ws2;
    630          //  ws2=AllocWS(128);
    631          //  wsprintf(ws2,"lcheck:%i",lcheck);
    632          //  DrawString(ws2,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    633          //  FreeWS(ws2);
    634            
    635            if (lcheck==2)
   \   00000AD4   14009DE5           LDR      R0,[SP, #+20]
    636              return 0;
    637            else
    638              return 1;
   \   00000AD8   B5DF8DE2           ADD      SP,SP,#+724
   \   00000ADC   020050E3           CMP      R0,#+2
   \   00000AE0   0000A003           MOVEQ    R0,#+0
   \   00000AE4   0100A013           MOVNE    R0,#+1
   \   00000AE8   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??RenderPage_2:
   \   00000AEC   D34D6210           DC32     0x10624dd3
    639          }
    640          

   \                                 In segment CODE, align 4, keep-with-next
    641          REFCACHE *FindReferenceByBegin(VIEWDATA *vd, unsigned int pos)
    642          {
    643            int i=vd->ref_cache_size;
   \                     FindReferenceByBegin:
   \   00000000   C82090E5           LDR      R2,[R0, #+200]
    644            REFCACHE *rf;
    645            if (!i) return NULL;
   \   00000004   000052E3           CMP      R2,#+0
   \   00000008   0100001A           BNE      ??FindReferenceByBegin_0
   \                     ??FindReferenceByBegin_1:
   \   0000000C   0000A0E3           MOV      R0,#+0
   \   00000010   1EFF2FE1           BX       LR
    646            rf=vd->ref_cache;
   \                     ??FindReferenceByBegin_0:
   \   00000014   C40090E5           LDR      R0,[R0, #+196]
   \   00000018   020000EA           B        ??FindReferenceByBegin_2
    647            do
    648            {
    649              if (rf->begin==pos) return rf;
    650              rf++;
   \                     ??FindReferenceByBegin_3:
   \   0000001C   240080E2           ADD      R0,R0,#+36
    651            }
    652            while(--i);
   \   00000020   012052E2           SUBS     R2,R2,#+1
   \   00000024   F8FFFF0A           BEQ      ??FindReferenceByBegin_1
   \                     ??FindReferenceByBegin_2:
   \   00000028   003090E5           LDR      R3,[R0, #+0]
   \   0000002C   010053E1           CMP      R3,R1
   \   00000030   F9FFFF1A           BNE      ??FindReferenceByBegin_3
   \   00000034   1EFF2FE1           BX       LR               ;; return
    653            return NULL;
    654          }
    655          

   \                                 In segment CODE, align 4, keep-with-next
    656          REFCACHE *FindReferenceFirst(VIEWDATA *vd, unsigned int pos)
    657          {
   \                     FindReferenceFirst:
   \   00000000   0530A0E3           MOV      R3,#+5
   \   00000004   E03C83E3           ORR      R3,R3,#0xE000
   \   00000008   000000EA           B        ??FindReferenceFirst_0
    658            while (pos<vd->rawtext_size&&vd->rawtext[pos]!=UTF16_ENA_INVERT)
    659              pos++;
   \                     ??FindReferenceFirst_1:
   \   0000000C   011081E2           ADD      R1,R1,#+1
   \                     ??FindReferenceFirst_0:
   \   00000010   0C2090E5           LDR      R2,[R0, #+12]
   \   00000014   020051E1           CMP      R1,R2
   \   00000018   0400002A           BCS      ??FindReferenceFirst_2
   \   0000001C   082090E5           LDR      R2,[R0, #+8]
   \   00000020   812082E0           ADD      R2,R2,R1, LSL #+1
   \   00000024   B020D2E1           LDRH     R2,[R2, #+0]
   \   00000028   030052E1           CMP      R2,R3
   \   0000002C   F6FFFF1A           BNE      ??FindReferenceFirst_1
    660            return FindReferenceByBegin(vd,pos);
   \                     ??FindReferenceFirst_2:
   \   00000030   ........           B        FindReferenceByBegin  ;; tailcall
    661          }
    662          

   \                                 In segment CODE, align 4, keep-with-next
    663          REFCACHE *FindReference(VIEWDATA *vd, unsigned int pos)
    664          {
   \                     FindReference:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    665            REFCACHE *rf=FindReferenceByBegin(vd,pos);
   \   0000000C   ........           BL       FindReferenceByBegin
    666            if (rf!=NULL) return rf;
   \   00000010   000050E3           CMP      R0,#+0
   \   00000014   3080BD18           POPNE    {R4,R5,PC}
    667            else
    668            {
    669              int i=vd->ref_cache_size;
   \   00000018   C81094E5           LDR      R1,[R4, #+200]
    670              if (!i) return NULL;
   \   0000001C   000051E3           CMP      R1,#+0
   \   00000020   0000A003           MOVEQ    R0,#+0
   \   00000024   3080BD08           POPEQ    {R4,R5,PC}
    671              rf=vd->ref_cache;
   \   00000028   C40094E5           LDR      R0,[R4, #+196]
    672              do
    673              {
    674                if ((rf->begin<=pos)&&(pos<rf->end)) return rf;
   \                     ??FindReference_0:
   \   0000002C   002090E5           LDR      R2,[R0, #+0]
   \   00000030   020055E1           CMP      R5,R2
   \   00000034   0200003A           BCC      ??FindReference_1
   \   00000038   042090E5           LDR      R2,[R0, #+4]
   \   0000003C   020055E1           CMP      R5,R2
   \   00000040   3080BD38           POPCC    {R4,R5,PC}
    675                rf++;
   \                     ??FindReference_1:
   \   00000044   240080E2           ADD      R0,R0,#+36
    676              }
    677              while(--i);
   \   00000048   011051E2           SUBS     R1,R1,#+1
   \   0000004C   F6FFFF1A           BNE      ??FindReference_0
   \   00000050   0000A0E3           MOV      R0,#+0
   \   00000054   3080BDE8           POP      {R4,R5,PC}
    678            }
    679            return NULL;
    680          }
    681          

   \                                 In segment CODE, align 4, keep-with-next
    682          int FindReferenceById(VIEWDATA *vd, unsigned int id, int i) // Находит index'ы всех ref'ов с заданным id
    683          {
   \                     FindReferenceById:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
    684            unsigned int sz=*(vd->oms+id);
    685            sz<<=8;
    686            sz|=*(vd->oms+id+1);
   \   00000010   000000EA           B        ??FindReferenceById_0
    687            while(i<vd->ref_cache_size)
    688            {
    689              if (!omstrcmp(vd,(vd->ref_cache+i)->id,id)) return i;
    690              i++;
   \                     ??FindReferenceById_1:
   \   00000014   016086E2           ADD      R6,R6,#+1
   \                     ??FindReferenceById_0:
   \   00000018   C80094E5           LDR      R0,[R4, #+200]
   \   0000001C   000056E1           CMP      R6,R0
   \   00000020   0A0000AA           BGE      ??FindReferenceById_2
   \   00000024   C41094E5           LDR      R1,[R4, #+196]
   \   00000028   2400A0E3           MOV      R0,#+36
   \   0000002C   901621E0           MLA      R1,R0,R6,R1
   \   00000030   0520A0E1           MOV      R2,R5
   \   00000034   0C1091E5           LDR      R1,[R1, #+12]
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   ........           _BLF     omstrcmp,??omstrcmp??rA
   \   00000040   000050E3           CMP      R0,#+0
   \   00000044   F2FFFF1A           BNE      ??FindReferenceById_1
   \   00000048   0600A0E1           MOV      R0,R6
   \   0000004C   7080BDE8           POP      {R4-R6,PC}
    691            }
    692            return -1;
   \                     ??FindReferenceById_2:
   \   00000050   0000E0E3           MVN      R0,#+0
   \   00000054   7080BDE8           POP      {R4-R6,PC}       ;; return
    693          }
    694          
    695          // TEMPLATES MENU
    696          GUI *paste_gui;
    697          

   \                                 In segment CODE, align 4, keep-with-next
    698          int templ_menu_onkey(void *gui, GUI_MSG *msg)
    699          {
   \                     templ_menu_onkey:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   4CDF4DE2           SUB      SP,SP,#+304
    700            if (msg->keys==0x3D || msg->keys==0x18)
   \   00000008   F210D1E1           LDRSH    R1,[R1, #+2]
   \   0000000C   3D0051E3           CMP      R1,#+61
   \   00000010   18005113           CMPNE    R1,#+24
   \   00000014   5500001A           BNE      ??templ_menu_onkey_0
    701            {
    702              // select
    703              int item=GetCurMenuItem(gui);
    704              EDITCONTROL ec;
    705              ExtractEditControl(paste_gui,1,&ec);
   \   00000018   ........           LDR      R5,??DataTable18  ;; sel_STRUCT
   \   0000001C   8F0100EF           SWI      +399
   \   00000020   0040A0E1           MOV      R4,R0
   \   00000024   B80095E5           LDR      R0,[R5, #+184]
   \   00000028   412F8DE2           ADD      R2,SP,#+260
   \   0000002C   0110A0E3           MOV      R1,#+1
   \   00000030   690100EF           SWI      +361
    706              char fname[256];
    707              int file;
    708              unsigned int ul;
    709              getSymbolicPath(fname,"$ballet\\templates.txt");
   \   00000034   ........           LDR      R1,??DataTable2  ;; `?<Constant "\\316\\370\\350\\341\\352\\340">` + 8
   \   00000038   04008DE2           ADD      R0,SP,#+4
   \   0000003C   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
    710              if ((file=fopen(fname,A_ReadWrite,P_READ+P_WRITE,&ul))!=-1)
   \   00000040   0D30A0E1           MOV      R3,SP
   \   00000044   602FA0E3           MOV      R2,#+384
   \   00000048   0210A0E3           MOV      R1,#+2
   \   0000004C   04008DE2           ADD      R0,SP,#+4
   \   00000050   0A0000EF           SWI      +10
   \   00000054   0090A0E1           MOV      R9,R0
   \   00000058   010079E3           CMN      R9,#+1
   \   0000005C   4000000A           BEQ      ??templ_menu_onkey_1
    711              {
    712                int num=0;
    713                unsigned int buf_size = lseek(file, 0, S_END, &ul, &ul);
   \   00000060   0D00A0E1           MOV      R0,SP
   \   00000064   01002DE9           PUSH     {R0}
   \   00000068   04308DE2           ADD      R3,SP,#+4
   \   0000006C   0220A0E3           MOV      R2,#+2
   \   00000070   0010A0E3           MOV      R1,#+0
   \   00000074   0900A0E1           MOV      R0,R9
   \   00000078   0F0000EF           SWI      +15
   \   0000007C   0070A0E1           MOV      R7,R0
    714                lseek(file, 0, S_SET, &ul, &ul);
   \   00000080   04008DE2           ADD      R0,SP,#+4
   \   00000084   01002DE9           PUSH     {R0}
   \   00000088   0060A0E3           MOV      R6,#+0
   \   0000008C   08308DE2           ADD      R3,SP,#+8
   \   00000090   0620A0E1           MOV      R2,R6
   \   00000094   0210A0E1           MOV      R1,R2
   \   00000098   0900A0E1           MOV      R0,R9
   \   0000009C   0F0000EF           SWI      +15
    715                char *buffer = malloc(buf_size);
   \   000000A0   0700A0E1           MOV      R0,R7
   \   000000A4   140000EF           SWI      +20
   \   000000A8   0080A0E1           MOV      R8,R0
    716                fread(file, buffer, buf_size, &ul);
   \   000000AC   08308DE2           ADD      R3,SP,#+8
   \   000000B0   0720A0E1           MOV      R2,R7
   \   000000B4   0810A0E1           MOV      R1,R8
   \   000000B8   0900A0E1           MOV      R0,R9
   \   000000BC   0B0000EF           SWI      +11
    717                fclose(file, &ul);
   \   000000C0   08108DE2           ADD      R1,SP,#+8
   \   000000C4   0900A0E1           MOV      R0,R9
   \   000000C8   0D0000EF           SWI      +13
    718                int start=0,len=0;
   \   000000CC   0690A0E1           MOV      R9,R6
   \   000000D0   06A0A0E1           MOV      R10,R6
    719                for (int i=0;i<=buf_size;i++)
   \   000000D4   0600A0E1           MOV      R0,R6
   \   000000D8   08D08DE2           ADD      SP,SP,#+8
   \   000000DC   0B0000EA           B        ??templ_menu_onkey_2
    720                  if (buffer[i]==0x0A||buffer[i]==0x0D||i==buf_size)
   \                     ??templ_menu_onkey_3:
   \   000000E0   0820D0E7           LDRB     R2,[R0, +R8]
   \   000000E4   011080E2           ADD      R1,R0,#+1
   \   000000E8   0A0052E3           CMP      R2,#+10
   \   000000EC   0D005213           CMPNE    R2,#+13
   \   000000F0   07005011           CMPNE    R0,R7
   \   000000F4   0400001A           BNE      ??templ_menu_onkey_4
    721                  {
    722                    if (num==item) len=i-start;
   \   000000F8   040056E1           CMP      R6,R4
   \   000000FC   09A04000           SUBEQ    R10,R0,R9
    723                    num++;
   \   00000100   016086E2           ADD      R6,R6,#+1
    724                    if (num==item) start=i+1;
   \   00000104   040056E1           CMP      R6,R4
   \   00000108   0190A001           MOVEQ    R9,R1
    725                  }
   \                     ??templ_menu_onkey_4:
   \   0000010C   0100A0E1           MOV      R0,R1
   \                     ??templ_menu_onkey_2:
   \   00000110   000057E1           CMP      R7,R0
   \   00000114   F1FFFF2A           BCS      ??templ_menu_onkey_3
    726                char *c=malloc(len+1);
   \   00000118   01008AE2           ADD      R0,R10,#+1
   \   0000011C   140000EF           SWI      +20
   \   00000120   0040A0E1           MOV      R4,R0
    727                memcpy(c,buffer+start,len);
   \   00000124   0A20A0E1           MOV      R2,R10
   \   00000128   081089E0           ADD      R1,R9,R8
   \   0000012C   1E0100EF           SWI      +286
    728                c[len]=NULL;
   \   00000130   0000A0E3           MOV      R0,#+0
   \   00000134   0400CAE7           STRB     R0,[R10, +R4]
    729                ascii2ws(ec.pWS,c);
   \   00000138   2C019DE5           LDR      R0,[SP, #+300]
   \   0000013C   0410A0E1           MOV      R1,R4
   \   00000140   ........           _BLF     ascii2ws,??ascii2ws??rA
    730                StoreEditControl(paste_gui,1,&ec);
   \   00000144   B80095E5           LDR      R0,[R5, #+184]
   \   00000148   412F8DE2           ADD      R2,SP,#+260
   \   0000014C   0110A0E3           MOV      R1,#+1
   \   00000150   6A0100EF           SWI      +362
    731                mfree(buffer);
   \   00000154   0800A0E1           MOV      R0,R8
   \   00000158   150000EF           SWI      +21
    732                mfree(c);
   \   0000015C   0400A0E1           MOV      R0,R4
   \   00000160   150000EF           SWI      +21
    733              }
    734              return 0xFF;
   \                     ??templ_menu_onkey_1:
   \   00000164   FF00A0E3           MOV      R0,#+255
   \   00000168   4CDF8DE2           ADD      SP,SP,#+304
   \   0000016C   F087BDE8           POP      {R4-R10,PC}
    735            }
    736            return (0);
   \                     ??templ_menu_onkey_0:
   \   00000170   0000A0E3           MOV      R0,#+0
   \   00000174   4CDF8DE2           ADD      SP,SP,#+304
   \   00000178   F087BDE8           POP      {R4-R10,PC}      ;; return
    737          }
    738          

   \                                 In segment CODE, align 4, keep-with-next
    739          void templ_menu_ghook(void *gui, int cmd)
    740          {
   \                     templ_menu_ghook:
   \   00000000   00402DE9           PUSH     {LR}
    741            if (cmd==3) // free
    742            {
    743              ;
    744            }
    745            if (cmd==0x0A)
   \   00000004   0A0051E3           CMP      R1,#+10
   \   00000008   0080BD18           POPNE    {PC}
    746            {
    747              DisableIDLETMR();
   \   0000000C   7F0100EF           SWI      +383
    748            }
    749          }
   \   00000010   0080BDE8           POP      {PC}             ;; return

   \                                 In segment CODE, align 4, keep-with-next
    750          void templ_menu_iconhndl(void *gui, int cur_item, void *user_pointer)
    751          {
   \                     templ_menu_iconhndl:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
    752            WSHDR *ws;
    753            void *item=AllocMenuItem(gui);
    754            char fname[256];
    755            int file;
    756            unsigned int ul;
    757            getSymbolicPath(fname,"$ballet\\templates.txt");
   \   00000004   50719FE5           LDR      R7,??templ_menu_iconhndl_0  ;; `?<Constant "\\316\\370\\350\\341\\352\\340">`
   \   00000008   41DF4DE2           SUB      SP,SP,#+260
   \   0000000C   0040A0E1           MOV      R4,R0
   \   00000010   0150A0E1           MOV      R5,R1
   \   00000014   970100EF           SWI      +407
   \   00000018   0060A0E1           MOV      R6,R0
   \   0000001C   081087E2           ADD      R1,R7,#+8
   \   00000020   04008DE2           ADD      R0,SP,#+4
   \   00000024   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
    758            if ((file=fopen(fname,A_ReadWrite,P_READ+P_WRITE,&ul))!=-1)
   \   00000028   0D30A0E1           MOV      R3,SP
   \   0000002C   602FA0E3           MOV      R2,#+384
   \   00000030   0210A0E3           MOV      R1,#+2
   \   00000034   04008DE2           ADD      R0,SP,#+4
   \   00000038   0A0000EF           SWI      +10
   \   0000003C   00A0A0E1           MOV      R10,R0
   \   00000040   01007AE3           CMN      R10,#+1
   \   00000044   3700000A           BEQ      ??templ_menu_iconhndl_1
    759            {
    760              int num=0;
    761              unsigned int buf_size = lseek(file, 0, S_END, &ul, &ul);
   \   00000048   0D00A0E1           MOV      R0,SP
   \   0000004C   01002DE9           PUSH     {R0}
   \   00000050   04308DE2           ADD      R3,SP,#+4
   \   00000054   0220A0E3           MOV      R2,#+2
   \   00000058   0010A0E3           MOV      R1,#+0
   \   0000005C   0A00A0E1           MOV      R0,R10
   \   00000060   0F0000EF           SWI      +15
   \   00000064   0080A0E1           MOV      R8,R0
    762              lseek(file, 0, S_SET, &ul, &ul);
   \   00000068   04008DE2           ADD      R0,SP,#+4
   \   0000006C   01002DE9           PUSH     {R0}
   \   00000070   0090A0E3           MOV      R9,#+0
   \   00000074   08308DE2           ADD      R3,SP,#+8
   \   00000078   0920A0E1           MOV      R2,R9
   \   0000007C   0210A0E1           MOV      R1,R2
   \   00000080   0A00A0E1           MOV      R0,R10
   \   00000084   0F0000EF           SWI      +15
    763              char *buffer = malloc(buf_size);
   \   00000088   0800A0E1           MOV      R0,R8
   \   0000008C   140000EF           SWI      +20
   \   00000090   0070A0E1           MOV      R7,R0
    764              fread(file, buffer, buf_size, &ul);
   \   00000094   08308DE2           ADD      R3,SP,#+8
   \   00000098   0820A0E1           MOV      R2,R8
   \   0000009C   0710A0E1           MOV      R1,R7
   \   000000A0   0A00A0E1           MOV      R0,R10
   \   000000A4   0B0000EF           SWI      +11
    765              fclose(file, &ul);
   \   000000A8   08108DE2           ADD      R1,SP,#+8
   \   000000AC   0A00A0E1           MOV      R0,R10
   \   000000B0   0D0000EF           SWI      +13
    766              int start=0,len=0;
   \   000000B4   09A0A0E1           MOV      R10,R9
   \   000000B8   09B0A0E1           MOV      R11,R9
    767              for (int i=0;i<=buf_size;i++)
   \   000000BC   0900A0E1           MOV      R0,R9
   \   000000C0   08D08DE2           ADD      SP,SP,#+8
   \   000000C4   0B0000EA           B        ??templ_menu_iconhndl_2
    768                if (buffer[i]==0x0A||buffer[i]==0x0D||i==buf_size)
   \                     ??templ_menu_iconhndl_3:
   \   000000C8   0720D0E7           LDRB     R2,[R0, +R7]
   \   000000CC   011080E2           ADD      R1,R0,#+1
   \   000000D0   0A0052E3           CMP      R2,#+10
   \   000000D4   0D005213           CMPNE    R2,#+13
   \   000000D8   08005011           CMPNE    R0,R8
   \   000000DC   0400001A           BNE      ??templ_menu_iconhndl_4
    769                {
    770                  if (num==cur_item) len=i-start;
   \   000000E0   050059E1           CMP      R9,R5
   \   000000E4   0AB04000           SUBEQ    R11,R0,R10
    771                  num++;
   \   000000E8   019089E2           ADD      R9,R9,#+1
    772                  if (num==cur_item) start=i+1;
   \   000000EC   050059E1           CMP      R9,R5
   \   000000F0   01A0A001           MOVEQ    R10,R1
    773                }
   \                     ??templ_menu_iconhndl_4:
   \   000000F4   0100A0E1           MOV      R0,R1
   \                     ??templ_menu_iconhndl_2:
   \   000000F8   000058E1           CMP      R8,R0
   \   000000FC   F1FFFF2A           BCS      ??templ_menu_iconhndl_3
    774              ws=AllocMenuWS(gui,len);
   \   00000100   0B10A0E1           MOV      R1,R11
   \   00000104   0400A0E1           MOV      R0,R4
   \   00000108   980100EF           SWI      +408
   \   0000010C   0080A0E1           MOV      R8,R0
    775              str_2ws(ws,buffer+start,len);
   \   00000110   0B20A0E1           MOV      R2,R11
   \   00000114   07108AE0           ADD      R1,R10,R7
   \   00000118   6C0100EF           SWI      +364
    776              mfree(buffer);
   \   0000011C   0700A0E1           MOV      R0,R7
   \   00000120   150000EF           SWI      +21
   \   00000124   050000EA           B        ??templ_menu_iconhndl_5
    777            }
    778            else
    779            {
    780              ws=AllocMenuWS(gui,10);
   \                     ??templ_menu_iconhndl_1:
   \   00000128   0A10A0E3           MOV      R1,#+10
   \   0000012C   0400A0E1           MOV      R0,R4
   \   00000130   980100EF           SWI      +408
   \   00000134   0080A0E1           MOV      R8,R0
    781              wsprintf(ws, "Ошибка");
   \   00000138   0710A0E1           MOV      R1,R7
   \   0000013C   240100EF           SWI      +292
    782            }
    783            SetMenuItemText(gui, item, ws, cur_item);
   \                     ??templ_menu_iconhndl_5:
   \   00000140   0530A0E1           MOV      R3,R5
   \   00000144   0820A0E1           MOV      R2,R8
   \   00000148   0610A0E1           MOV      R1,R6
   \   0000014C   0400A0E1           MOV      R0,R4
   \   00000150   9A0100EF           SWI      +410
    784          }
   \   00000154   41DF8DE2           ADD      SP,SP,#+260
   \   00000158   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??templ_menu_iconhndl_0:
   \   0000015C   ........           DC32     `?<Constant "\\316\\370\\350\\341\\352\\340">`
    785          
    786          int templ_softkeys[]={0,1,2};
    787          SOFTKEY_DESC templ_sk[]=
    788          {
    789            {0x0018,0x0000,(int)"Select"},
    790            {0x0001,0x0000,(int)"Close"},
    791            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    792          };
    793          
    794          SOFTKEYSTAB templ_skt=
    795          {
    796            templ_sk,0
    797          };
    798          
    799          HEADER_DESC templ_HDR={0,0,0,0,NULL,(int)"Выбор",LGP_NULL};
    800          
    801          MENU_DESC templ_STRUCT=
    802          {
    803            8,templ_menu_onkey,templ_menu_ghook,NULL,
    804            templ_softkeys,
    805            &templ_skt,
    806            0x10,
    807            templ_menu_iconhndl,
    808            NULL,   //Items
    809            NULL,   //Procs
    810            0   //n
    811          };
    812          

   \                                 In segment CODE, align 4, keep-with-next
    813          void createTemplatesMenu()
    814          {
    815            // get amount of lines
    816            char fname[256];
    817            int file;
    818            unsigned int ul;
    819            getSymbolicPath(fname,"$ballet\\templates.txt");
   \                     createTemplatesMenu:
   \   00000000   ........           LDR      R1,??DataTable2  ;; `?<Constant "\\316\\370\\350\\341\\352\\340">` + 8
   \   00000004   F0402DE9           PUSH     {R4-R7,LR}
   \   00000008   41DF4DE2           SUB      SP,SP,#+260
   \   0000000C   04008DE2           ADD      R0,SP,#+4
   \   00000010   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
    820            if ((file=fopen(fname,A_ReadWrite,P_READ+P_WRITE,&ul))!=-1)
   \   00000014   0D30A0E1           MOV      R3,SP
   \   00000018   602FA0E3           MOV      R2,#+384
   \   0000001C   0210A0E3           MOV      R1,#+2
   \   00000020   04008DE2           ADD      R0,SP,#+4
   \   00000024   0A0000EF           SWI      +10
   \   00000028   0070A0E1           MOV      R7,R0
   \   0000002C   010077E3           CMN      R7,#+1
   \   00000030   3C00000A           BEQ      ??createTemplatesMenu_0
    821            {
    822              int num=1;
    823              unsigned int buf_size=lseek(file, 0, S_END, &ul, &ul);
   \   00000034   0D00A0E1           MOV      R0,SP
   \   00000038   01002DE9           PUSH     {R0}
   \   0000003C   04308DE2           ADD      R3,SP,#+4
   \   00000040   0220A0E3           MOV      R2,#+2
   \   00000044   0010A0E3           MOV      R1,#+0
   \   00000048   0700A0E1           MOV      R0,R7
   \   0000004C   0F0000EF           SWI      +15
   \   00000050   0050A0E1           MOV      R5,R0
    824              lseek(file, 0, S_SET, &ul, &ul);
   \   00000054   04008DE2           ADD      R0,SP,#+4
   \   00000058   01002DE9           PUSH     {R0}
   \   0000005C   08308DE2           ADD      R3,SP,#+8
   \   00000060   0020A0E3           MOV      R2,#+0
   \   00000064   0010A0E3           MOV      R1,#+0
   \   00000068   0700A0E1           MOV      R0,R7
   \   0000006C   0F0000EF           SWI      +15
    825              char *buffer=malloc(buf_size);
   \   00000070   0500A0E1           MOV      R0,R5
   \   00000074   140000EF           SWI      +20
   \   00000078   0060A0E1           MOV      R6,R0
    826              fread(file, buffer, buf_size, &ul);
   \   0000007C   08308DE2           ADD      R3,SP,#+8
   \   00000080   0520A0E1           MOV      R2,R5
   \   00000084   0610A0E1           MOV      R1,R6
   \   00000088   0700A0E1           MOV      R0,R7
   \   0000008C   0B0000EF           SWI      +11
    827              fclose(file, &ul);
   \   00000090   08108DE2           ADD      R1,SP,#+8
   \   00000094   0700A0E1           MOV      R0,R7
   \   00000098   0D0000EF           SWI      +13
    828              if ((buffer[buf_size-1]==0x0A||buffer[buf_size-1]==0x0D)) buf_size--;
   \   0000009C   060085E0           ADD      R0,R5,R6
   \   000000A0   011050E5           LDRB     R1,[R0, #-1]
   \   000000A4   0140A0E3           MOV      R4,#+1
   \   000000A8   08D08DE2           ADD      SP,SP,#+8
   \   000000AC   0A0051E3           CMP      R1,#+10
   \   000000B0   0D005113           CMPNE    R1,#+13
   \   000000B4   01504502           SUBEQ    R5,R5,#+1
    829              for (int i=0;i<buf_size;i++)
   \   000000B8   0000A0E3           MOV      R0,#+0
   \   000000BC   000055E3           CMP      R5,#+0
   \   000000C0   0500001A           BNE      ??createTemplatesMenu_1
   \   000000C4   060000EA           B        ??createTemplatesMenu_2
    830              {
    831                if ((buffer[i]==0x0A||buffer[i]==0x0D))
   \                     ??createTemplatesMenu_3:
   \   000000C8   0610D0E7           LDRB     R1,[R0, +R6]
    832                {
    833                  num++;
    834                }
    835              }
   \   000000CC   010080E2           ADD      R0,R0,#+1
   \   000000D0   0A0051E3           CMP      R1,#+10
   \   000000D4   0D005113           CMPNE    R1,#+13
   \   000000D8   01408402           ADDEQ    R4,R4,#+1
   \                     ??createTemplatesMenu_1:
   \   000000DC   050050E1           CMP      R0,R5
   \   000000E0   F8FFFF3A           BCC      ??createTemplatesMenu_3
    836              patch_header(&templ_HDR);
   \                     ??createTemplatesMenu_2:
   \   000000E4   44509FE5           LDR      R5,??createTemplatesMenu_4  ;; templ_HDR
   \   000000E8   0500A0E1           MOV      R0,R5
   \   000000EC   ........           _BLF     patch_header,??patch_header??rA
    837              mfree(buffer);
   \   000000F0   0600A0E1           MOV      R0,R6
   \   000000F4   150000EF           SWI      +21
    838              if (num>0)
   \   000000F8   010054E3           CMP      R4,#+1
   \   000000FC   090000BA           BLT      ??createTemplatesMenu_0
    839              {
    840                CreateMenu(0,0,&templ_STRUCT,&templ_HDR,0,num,0,0);
   \   00000100   0000A0E3           MOV      R0,#+0
   \   00000104   01002DE9           PUSH     {R0}
   \   00000108   01002DE9           PUSH     {R0}
   \   0000010C   10002DE9           PUSH     {R4}
   \   00000110   01002DE9           PUSH     {R0}
   \   00000114   0530A0E1           MOV      R3,R5
   \   00000118   142085E2           ADD      R2,R5,#+20
   \   0000011C   0010A0E3           MOV      R1,#+0
   \   00000120   520100EF           SWI      +338
   \   00000124   10D08DE2           ADD      SP,SP,#+16
    841              }
    842            }
    843          }
   \                     ??createTemplatesMenu_0:
   \   00000128   41DF8DE2           ADD      SP,SP,#+260      ;; stack cleaning
   \   0000012C   F080BDE8           POP      {R4-R7,PC}       ;; return
   \                     ??createTemplatesMenu_4:
   \   00000130   ........           DC32     templ_HDR
    844          
    845          // EDIT BOX
    846          REFCACHE *cur_ref;
    847          VIEWDATA *cur_vd;
    848          
    849          extern char *goto_url;
    850          extern char *from_url;
    851          extern char *goto_params;
    852          
    853          char *collectItemsParams(VIEWDATA *vd, REFCACHE *rf);
    854          
    855          SOFTKEY_DESC input_box_menu_sk[]=
    856          {
    857            {0x0018,0x0000,(int)"Ok"},
    858            {0x0001,0x0000,(int)"Cancel"},
    859            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    860          };
    861          

   \                                 In segment DATA_C, align 4, align-sorted
    862          static const SOFTKEYSTAB input_box_menu_skt=
   \                     input_box_menu_skt:
   \   00000000   ........0000       DC32 input_box_menu_sk, 0
   \              0000        
    863          {
    864            input_box_menu_sk,0
    865          };
    866          
    867          HEADER_DESC input_box_hdr={0,0,0,0,NULL,(int)"Enter:",LGP_NULL};
    868          

   \                                 In segment CODE, align 4, keep-with-next
    869          static void input_box_ghook(GUI *data, int cmd)
    870          {
    871            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     input_box_ghook:
   \   00000000   44309FE5           LDR      R3,??input_box_ghook_0  ;; `?<Constant {4095, 0, 0}>_1`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   300093E8           LDM      R3,{R4,R5}
   \   00000010   ........           LDR      R3,??DataTable10  ;; lgpData + 100
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   300082E8           STM      R2,{R4,R5}
   \   0000001C   003093E5           LDR      R3,[R3, #+0]
    872            if (cmd==0x0A)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   04308DE5           STR      R3,[SP, #+4]
   \   00000028   0100001A           BNE      ??input_box_ghook_1
    873            {
    874              DisableIDLETMR();
   \   0000002C   7F0100EF           SWI      +383
   \   00000030   3380BDE8           POP      {R0,R1,R4,R5,PC}
    875            }
    876            if (cmd==7)
   \                     ??input_box_ghook_1:
   \   00000034   070051E3           CMP      R1,#+7
   \   00000038   3380BD18           POPNE    {R0,R1,R4,R5,PC}
    877            {
    878              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000003C   0020A0E3           MOV      R2,#+0
   \   00000040   0D10A0E1           MOV      R1,SP
   \   00000044   680100EF           SWI      +360
    879            }
    880          }
   \   00000048   3380BDE8           POP      {R0,R1,R4,R5,PC}  ;; return
   \                     ??input_box_ghook_0:
   \   0000004C   ........           DC32     `?<Constant {4095, 0, 0}>_1`
    881          

   \                                 In segment CODE, align 4, keep-with-next
    882          static void input_box_locret(void){}
   \                     input_box_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
    883          

   \                                 In segment CODE, align 4, keep-with-next
    884          void input_box_onkey_options(USR_MENU_ITEM *item)
    885          {
   \                     input_box_onkey_options:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    886            if (item->type==0)
   \   00000008   0000D4E5           LDRB     R0,[R4, #+0]
   \   0000000C   000050E3           CMP      R0,#+0
    887            {
    888              switch(item->cur_item)
   \   00000010   B800D401           LDRHEQ   R0,[R4, #+8]
   \   00000014   00005003           CMPEQ    R0,#+0
   \   00000018   0300001A           BNE      ??input_box_onkey_options_0
    889              {
    890              case 0:
    891                ascii2ws(item->ws,lgpData[LGP_Templates]);
   \   0000001C   24009FE5           LDR      R0,??input_box_onkey_options_1  ;; lgpData + 108
   \   00000020   001090E5           LDR      R1,[R0, #+0]
   \   00000024   0C0094E5           LDR      R0,[R4, #+12]
   \   00000028   ........           _BLF     ascii2ws,??ascii2ws??rA
    892                break;
    893              }
    894            }
    895            if (item->type==1)
   \                     ??input_box_onkey_options_0:
   \   0000002C   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000030   010050E3           CMP      R0,#+1
    896            {
    897              switch(item->cur_item)
   \   00000034   B800D401           LDRHEQ   R0,[R4, #+8]
   \   00000038   00005003           CMPEQ    R0,#+0
   \   0000003C   1080BD18           POPNE    {R4,PC}
    898              {
    899              case 0:
    900                createTemplatesMenu();
   \   00000040   ........           BL       createTemplatesMenu
    901                break;
    902              }
    903            }
    904          }
   \   00000044   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??input_box_onkey_options_1:
   \   00000048   ........           DC32     lgpData + 108
    905          

   \                                 In segment CODE, align 4, keep-with-next
    906          static int input_box_onkey(GUI *data, GUI_MSG *msg)
    907          {
   \                     input_box_onkey:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    908            EDITCONTROL ec;
    909            if (msg->gbsmsg->msg==KEY_DOWN&&msg->gbsmsg->submess==ENTER_BUTTON)
   \   00000004   ........           LDR      R4,??DataTable18  ;; sel_STRUCT
   \   00000008   2CD04DE2           SUB      SP,SP,#+44
   \   0000000C   042091E5           LDR      R2,[R1, #+4]
   \   00000010   9350A0E3           MOV      R5,#+147
   \   00000014   043092E5           LDR      R3,[R2, #+4]
   \   00000018   405F85E3           ORR      R5,R5,#0x100
   \   0000001C   050053E1           CMP      R3,R5
   \   00000020   08209205           LDREQ    R2,[R2, #+8]
   \   00000024   1A005203           CMPEQ    R2,#+26
   \   00000028   0600001A           BNE      ??input_box_onkey_0
    910          	{
    911              paste_gui=data;
    912              EDIT_OpenOptionMenuWithUserItems(data,input_box_onkey_options,0,1);
   \   0000002C   20119FE5           LDR      R1,??input_box_onkey_1  ;; input_box_onkey_options
   \   00000030   B80084E5           STR      R0,[R4, #+184]
   \   00000034   0130A0E3           MOV      R3,#+1
   \   00000038   0020A0E3           MOV      R2,#+0
   \   0000003C   E50100EF           SWI      +485
    913              return (-1);
   \   00000040   0000E0E3           MVN      R0,#+0
   \   00000044   3D0000EA           B        ??input_box_onkey_2
    914          	}
    915            if (msg->keys==0xFFF)
   \                     ??input_box_onkey_0:
   \   00000048   F210D1E1           LDRSH    R1,[R1, #+2]
   \   0000004C   FF20A0E3           MOV      R2,#+255
   \   00000050   F02E82E3           ORR      R2,R2,#0xF00
   \   00000054   020051E1           CMP      R1,R2
   \   00000058   3A00001A           BNE      ??input_box_onkey_3
    916            {
    917              // set value
    918              ExtractEditControl(data,1,&ec);
   \   0000005C   0D20A0E1           MOV      R2,SP
   \   00000060   0110A0E3           MOV      R1,#+1
   \   00000064   690100EF           SWI      +361
    919              FreeWS(((WSHDR *)cur_ref->data));
   \   00000068   BC0094E5           LDR      R0,[R4, #+188]
    920              cur_ref->data=(void *)AllocWS(ec.pWS->wsbody[0]);
    921              wstrcpy(((WSHDR *)cur_ref->data),ec.pWS);
    922              if (!cur_ref->no_upload)
   \   0000006C   0050A0E3           MOV      R5,#+0
   \   00000070   180090E5           LDR      R0,[R0, #+24]
   \   00000074   290100EF           SWI      +297
   \   00000078   28009DE5           LDR      R0,[SP, #+40]
   \   0000007C   000090E5           LDR      R0,[R0, #+0]
   \   00000080   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000084   250100EF           SWI      +293
   \   00000088   BC1094E5           LDR      R1,[R4, #+188]
   \   0000008C   180081E5           STR      R0,[R1, #+24]
   \   00000090   BC0094E5           LDR      R0,[R4, #+188]
   \   00000094   28109DE5           LDR      R1,[SP, #+40]
   \   00000098   180090E5           LDR      R0,[R0, #+24]
   \   0000009C   1F0100EF           SWI      +287
   \   000000A0   BC0094E5           LDR      R0,[R4, #+188]
   \   000000A4   2000D0E5           LDRB     R0,[R0, #+32]
   \   000000A8   010010E3           TST      R0,#0x1
   \   000000AC   1B00001A           BNE      ??input_box_onkey_4
    923              {
    924                goto_url=malloc(strlen(cur_vd->pageurl)+1);
   \   000000B0   C00094E5           LDR      R0,[R4, #+192]
   \   000000B4   ........           LDR      R6,??DataTable13  ;; goto_url
   \   000000B8   D80090E5           LDR      R0,[R0, #+216]
   \   000000BC   1B0000EF           SWI      +27
   \   000000C0   010080E2           ADD      R0,R0,#+1
   \   000000C4   140000EF           SWI      +20
   \   000000C8   000086E5           STR      R0,[R6, #+0]
    925                strcpy(goto_url,cur_vd->pageurl);
   \   000000CC   C00094E5           LDR      R0,[R4, #+192]
   \   000000D0   D81090E5           LDR      R1,[R0, #+216]
   \   000000D4   000096E5           LDR      R0,[R6, #+0]
    926                from_url=malloc(strlen(cur_vd->pageurl)+1);
   \   000000D8   ........           LDR      R6,??DataTable14  ;; from_url
   \   000000DC   1A0000EF           SWI      +26
   \   000000E0   C00094E5           LDR      R0,[R4, #+192]
   \   000000E4   D80090E5           LDR      R0,[R0, #+216]
   \   000000E8   1B0000EF           SWI      +27
   \   000000EC   010080E2           ADD      R0,R0,#+1
   \   000000F0   140000EF           SWI      +20
   \   000000F4   000086E5           STR      R0,[R6, #+0]
    927                strcpy(from_url,cur_vd->pageurl);
   \   000000F8   C00094E5           LDR      R0,[R4, #+192]
   \   000000FC   D81090E5           LDR      R1,[R0, #+216]
   \   00000100   000096E5           LDR      R0,[R6, #+0]
   \   00000104   1A0000EF           SWI      +26
    928                goto_params=collectItemsParams(cur_vd,cur_ref);
   \   00000108   BC1094E5           LDR      R1,[R4, #+188]
   \   0000010C   C00094E5           LDR      R0,[R4, #+192]
   \   00000110   ........           _BLF     collectItemsParams,??collectItemsParams??rA
   \   00000114   ........           LDR      R1,??DataTable15  ;; goto_params
   \   00000118   000081E5           STR      R0,[R1, #+0]
   \   0000011C   040000EA           B        ??input_box_onkey_5
    929              }
    930              else
    931              {
    932                MAIN_CSM *main_csm;
    933                if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     ??input_box_onkey_4:
   \   00000120   ........           LDR      R0,??DataTable16  ;; maincsm_id
   \   00000124   000090E5           LDR      R0,[R0, #+0]
   \   00000128   080100EF           SWI      +264
   \   0000012C   000050E3           CMP      R0,#+0
    934                {
    935                  main_csm->sel_bmk=0;
   \   00000130   30508015           STRNE    R5,[R0, #+48]
    936                }
    937              }
    938              cur_ref=NULL;
   \                     ??input_box_onkey_5:
   \   00000134   BC5084E5           STR      R5,[R4, #+188]
    939              cur_vd=NULL;
   \   00000138   C05084E5           STR      R5,[R4, #+192]
    940              return (0xFF);
   \   0000013C   FF00A0E3           MOV      R0,#+255
   \                     ??input_box_onkey_2:
   \   00000140   2CD08DE2           ADD      SP,SP,#+44
   \   00000144   7080BDE8           POP      {R4-R6,PC}
    941            }
    942            return (0);
   \                     ??input_box_onkey_3:
   \   00000148   0000A0E3           MOV      R0,#+0
   \   0000014C   2CD08DE2           ADD      SP,SP,#+44
   \   00000150   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??input_box_onkey_1:
   \   00000154   ........           DC32     input_box_onkey_options
    943          }
    944          

   \                                 In segment DATA_C, align 4, align-sorted
    945          static const INPUTDIA_DESC input_box_desc =
   \                     input_box_desc:
   \   00000000   01000000....       DC32 1, input_box_onkey, input_box_ghook, input_box_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 input_box_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
    946          {
    947            1,
    948            input_box_onkey,
    949            input_box_ghook,
    950            (void *)input_box_locret,
    951            0,
    952            &input_box_menu_skt,
    953            {0,0,0,0},
    954            FONT_SMALL,
    955            100,
    956            101,
    957            0,
    958            //  0x00000001 - Выровнять по правому краю
    959            //  0x00000002 - Выровнять по центру
    960            //  0x00000004 - Инверсия знакомест
    961            //  0x00000008 - UnderLine
    962            //  0x00000020 - Не переносить слова
    963            //  0x00000200 - bold
    964            0,
    965            //  0x00000002 - ReadOnly
    966            //  0x00000004 - Не двигается курсор
    967            //  0x40000000 - Поменять местами софт-кнопки
    968            0x40000000
    969          };
    970          

   \                                 In segment CODE, align 4, keep-with-next
    971          int CreateInputBox(VIEWDATA *vd, REFCACHE *rf)
    972          {
   \                     CreateInputBox:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
    973            cur_ref=rf;
   \   00000004   ........           LDR      R4,??DataTable18  ;; sel_STRUCT
   \   00000008   2CD04DE2           SUB      SP,SP,#+44
   \   0000000C   0160A0E1           MOV      R6,R1
   \   00000010   BC6084E5           STR      R6,[R4, #+188]
    974            cur_vd=vd;
   \   00000014   C00084E5           STR      R0,[R4, #+192]
    975            
    976            void *ma=malloc_adr();
   \   00000018   148000EF           SWI      +32788
   \   0000001C   0070A0E1           MOV      R7,R0
    977            void *eq;
    978            EDITCONTROL ec;
    979            
    980            eq=AllocEQueue(ma,mfree_adr());
   \   00000020   158000EF           SWI      +32789
   \   00000024   0010A0E1           MOV      R1,R0
   \   00000028   0700A0E1           MOV      R0,R7
   \   0000002C   630100EF           SWI      +355
   \   00000030   0050A0E1           MOV      R5,R0
    981            WSHDR *ews=AllocWS(16384);
   \   00000034   400CA0E3           MOV      R0,#+16384
   \   00000038   250100EF           SWI      +293
    982            
    983            wstrcpy(ews,((WSHDR *)rf->data));
   \   0000003C   181096E5           LDR      R1,[R6, #+24]
   \   00000040   0080A0E1           MOV      R8,R0
   \   00000044   1F0100EF           SWI      +287
    984            
    985            PrepareEditControl(&ec);
   \   00000048   0D00A0E1           MOV      R0,SP
   \   0000004C   640100EF           SWI      +356
    986            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL|(rf->tag=='p'?ECF_PASSW:NULL),ews,16384);
   \   00000050   080096E5           LDR      R0,[R6, #+8]
    987            AddEditControlToEditQend(eq,&ec,ma);
    988          
    989            FreeWS(ews);
    990            patch_header(&input_box_hdr);
    991            patch_input(&input_box_desc);
   \   00000054   70609FE5           LDR      R6,??CreateInputBox_0  ;; input_box_desc
   \   00000058   401CA0E3           MOV      R1,#+16384
   \   0000005C   02002DE9           PUSH     {R1}
   \   00000060   700050E3           CMP      R0,#+112
   \   00000064   1000A003           MOVEQ    R0,#+16
   \   00000068   0000A013           MOVNE    R0,#+0
   \   0000006C   0830A0E1           MOV      R3,R8
   \   00000070   402080E3           ORR      R2,R0,#0x40
   \   00000074   0310A0E3           MOV      R1,#+3
   \   00000078   04008DE2           ADD      R0,SP,#+4
   \   0000007C   650100EF           SWI      +357
   \   00000080   0720A0E1           MOV      R2,R7
   \   00000084   04108DE2           ADD      R1,SP,#+4
   \   00000088   0500A0E1           MOV      R0,R5
   \   0000008C   660100EF           SWI      +358
   \   00000090   0800A0E1           MOV      R0,R8
   \   00000094   290100EF           SWI      +297
   \   00000098   440084E2           ADD      R0,R4,#+68
   \   0000009C   ........           _BLF     patch_header,??patch_header??rA
   \   000000A0   0600A0E1           MOV      R0,R6
   \   000000A4   ........           _BLF     patch_input,??patch_input??rA
    992            return CreateInputTextDialog(&input_box_desc,&input_box_hdr,eq,1,0);
   \   000000A8   0000A0E3           MOV      R0,#+0
   \   000000AC   01002DE9           PUSH     {R0}
   \   000000B0   0130A0E3           MOV      R3,#+1
   \   000000B4   0520A0E1           MOV      R2,R5
   \   000000B8   441084E2           ADD      R1,R4,#+68
   \   000000BC   0600A0E1           MOV      R0,R6
   \   000000C0   670100EF           SWI      +359
   \   000000C4   34D08DE2           ADD      SP,SP,#+52
   \   000000C8   F081BDE8           POP      {R4-R8,PC}       ;; return
   \                     ??CreateInputBox_0:
   \   000000CC   ........           DC32     input_box_desc
    993          }
    994          
    995          // TEXT VIEW
    996          SOFTKEY_DESC txtview_menu_sk[]=
    997          {
    998            {0x0018,0x0000,(int)"Ok"},
    999            {0x0001,0x0000,(int)"Cancel"},
   1000            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1001          };
   1002          

   \                                 In segment DATA_C, align 4, align-sorted
   1003          static const SOFTKEYSTAB txtview_menu_skt=
   \                     txtview_menu_skt:
   \   00000000   ........0000       DC32 txtview_menu_sk, 0
   \              0000        
   1004          {
   1005            txtview_menu_sk,0
   1006          };
   1007          
   1008          HEADER_DESC txtview_hdr={0,0,0,0,NULL,(int)"Text :",LGP_NULL};
   1009          

   \                                 In segment CODE, align 4, keep-with-next
   1010          static void txtview_ghook(GUI *data, int cmd)
   1011          {
   1012            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     txtview_ghook:
   \   00000000   44309FE5           LDR      R3,??txtview_ghook_0  ;; `?<Constant {4095, 0, 0}>`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   300093E8           LDM      R3,{R4,R5}
   \   00000010   ........           LDR      R3,??DataTable10  ;; lgpData + 100
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   300082E8           STM      R2,{R4,R5}
   \   0000001C   003093E5           LDR      R3,[R3, #+0]
   1013            if (cmd==0x0A)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   04308DE5           STR      R3,[SP, #+4]
   \   00000028   0100001A           BNE      ??txtview_ghook_1
   1014            {
   1015              DisableIDLETMR();
   \   0000002C   7F0100EF           SWI      +383
   \   00000030   3380BDE8           POP      {R0,R1,R4,R5,PC}
   1016            }
   1017            if (cmd==7)
   \                     ??txtview_ghook_1:
   \   00000034   070051E3           CMP      R1,#+7
   \   00000038   3380BD18           POPNE    {R0,R1,R4,R5,PC}
   1018            {
   1019              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000003C   0020A0E3           MOV      R2,#+0
   \   00000040   0D10A0E1           MOV      R1,SP
   \   00000044   680100EF           SWI      +360
   1020            }
   1021          }
   \   00000048   3380BDE8           POP      {R0,R1,R4,R5,PC}  ;; return
   \                     ??txtview_ghook_0:
   \   0000004C   ........           DC32     `?<Constant {4095, 0, 0}>`
   1022          

   \                                 In segment CODE, align 4, keep-with-next
   1023          static void txtview_locret(void){}
   \                     txtview_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1024          

   \                                 In segment CODE, align 4, keep-with-next
   1025          static int txtview_onkey(GUI *data, GUI_MSG *msg)
   1026          {
   1027            if (msg->keys==0xFFF)
   \                     txtview_onkey:
   \   00000000   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000004   FF10A0E3           MOV      R1,#+255
   \   00000008   F01E81E3           ORR      R1,R1,#0xF00
   \   0000000C   010050E1           CMP      R0,R1
   1028            {
   1029              return (0xFF);
   \   00000010   FF00A003           MOVEQ    R0,#+255
   \   00000014   1EFF2F01           BXEQ     LR
   1030            }
   1031            return (0);
   \   00000018   0000A0E3           MOV      R0,#+0
   \   0000001C   1EFF2FE1           BX       LR               ;; return
   1032          }
   1033          

   \                                 In segment DATA_C, align 4, align-sorted
   1034          static const INPUTDIA_DESC txtview_desc =
   \                     txtview_desc:
   \   00000000   01000000....       DC32 1, txtview_onkey, txtview_ghook, txtview_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 txtview_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1035          {
   1036            1,
   1037            txtview_onkey,
   1038            txtview_ghook,
   1039            (void *)txtview_locret,
   1040            0,
   1041            &txtview_menu_skt,
   1042            {0,0,0,0},
   1043            FONT_SMALL,
   1044            100,
   1045            101,
   1046            0,
   1047            0,
   1048            0x40000000
   1049          };
   1050          

   \                                 In segment CODE, align 4, keep-with-next
   1051          void createTextView(WSHDR *ws)
   1052          {
   \                     createTextView:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0040A0E1           MOV      R4,R0
   1053            void *ma=malloc_adr();
   \   0000000C   148000EF           SWI      +32788
   \   00000010   0050A0E1           MOV      R5,R0
   1054            void *eq;
   1055            EDITCONTROL ec;
   1056            eq=AllocEQueue(ma,mfree_adr());
   \   00000014   158000EF           SWI      +32789
   \   00000018   0010A0E1           MOV      R1,R0
   \   0000001C   0500A0E1           MOV      R0,R5
   \   00000020   630100EF           SWI      +355
   \   00000024   0060A0E1           MOV      R6,R0
   1057            if (!wstrlen(ws))
   \   00000028   0400A0E1           MOV      R0,R4
   \   0000002C   230100EF           SWI      +291
   \   00000030   000050E3           CMP      R0,#+0
   \   00000034   0300001A           BNE      ??createTextView_0
   1058            {
   1059              FreeWS(ws);
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   290100EF           SWI      +297
   1060              return;
   \   00000040   2CD08DE2           ADD      SP,SP,#+44
   \   00000044   7080BDE8           POP      {R4-R6,PC}
   1061            }
   1062            PrepareEditControl(&ec);
   \                     ??createTextView_0:
   \   00000048   0D00A0E1           MOV      R0,SP
   \   0000004C   640100EF           SWI      +356
   1063            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL,ws,512);
   \   00000050   800FA0E3           MOV      R0,#+512
   \   00000054   01002DE9           PUSH     {R0}
   \   00000058   0430A0E1           MOV      R3,R4
   \   0000005C   4020A0E3           MOV      R2,#+64
   \   00000060   0310A0E3           MOV      R1,#+3
   \   00000064   04008DE2           ADD      R0,SP,#+4
   \   00000068   650100EF           SWI      +357
   1064            AddEditControlToEditQend(eq,&ec,ma);
   \   0000006C   0520A0E1           MOV      R2,R5
   1065            FreeWS(ws);
   1066            patch_header(&txtview_hdr);
   1067            patch_input(&txtview_desc);
   \   00000070   4C509FE5           LDR      R5,??createTextView_1  ;; txtview_desc
   \   00000074   04108DE2           ADD      R1,SP,#+4
   \   00000078   0600A0E1           MOV      R0,R6
   \   0000007C   660100EF           SWI      +358
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   ........           LDR      R4,??DataTable18  ;; sel_STRUCT
   \   00000088   290100EF           SWI      +297
   \   0000008C   700084E2           ADD      R0,R4,#+112
   \   00000090   ........           _BLF     patch_header,??patch_header??rA
   \   00000094   0500A0E1           MOV      R0,R5
   \   00000098   ........           _BLF     patch_input,??patch_input??rA
   1068            CreateInputTextDialog(&txtview_desc,&txtview_hdr,eq,1,0);
   \   0000009C   0000A0E3           MOV      R0,#+0
   \   000000A0   01002DE9           PUSH     {R0}
   \   000000A4   0130A0E3           MOV      R3,#+1
   \   000000A8   0620A0E1           MOV      R2,R6
   \   000000AC   701084E2           ADD      R1,R4,#+112
   \   000000B0   0500A0E1           MOV      R0,R5
   \   000000B4   670100EF           SWI      +359
   1069          }
   \   000000B8   08D08DE2           ADD      SP,SP,#+8
   \   000000BC   2CD08DE2           ADD      SP,SP,#+44
   \   000000C0   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??createTextView_1:
   \   000000C4   ........           DC32     txtview_desc
   1070          
   1071          // SELECTION MENU
   1072          typedef struct
   1073          {
   1074            void *next;
   1075            char name[256];
   1076            unsigned short value;
   1077            unsigned short id2;
   1078          }SEL_STRUCT;
   1079          

   \                                 In segment CODE, align 4, keep-with-next
   1080          int sel_menu_onkey(void *gui, GUI_MSG *msg)
   1081          {
   \                     sel_menu_onkey:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0140A0E1           MOV      R4,R1
   \   00000008   0060A0E1           MOV      R6,R0
   1082            SEL_STRUCT *ustop=MenuGetUserPointer(gui);
   \   0000000C   E00100EF           SWI      +480
   \   00000010   0070A0E1           MOV      R7,R0
   1083            if (msg->keys==0x3D || msg->keys==0x18)
   \   00000014   F200D4E1           LDRSH    R0,[R4, #+2]
   \   00000018   3D0050E3           CMP      R0,#+61
   \   0000001C   18005013           CMPNE    R0,#+24
   \   00000020   1E00001A           BNE      ??sel_menu_onkey_0
   1084            {
   1085              int i=GetCurMenuItem(gui);
   \   00000024   0600A0E1           MOV      R0,R6
   \   00000028   8F0100EF           SWI      +399
   1086              int n=0;
   \   0000002C   0010A0E3           MOV      R1,#+0
   \   00000030   000050E3           CMP      R0,#+0
   \   00000034   0300000A           BEQ      ??sel_menu_onkey_1
   1087              for (; n!=i; n++) ustop=ustop->next;
   \                     ??sel_menu_onkey_2:
   \   00000038   007097E5           LDR      R7,[R7, #+0]
   \   0000003C   011081E2           ADD      R1,R1,#+1
   \   00000040   000051E1           CMP      R1,R0
   \   00000044   FBFFFF1A           BNE      ??sel_menu_onkey_2
   1088              if (ustop)
   \                     ??sel_menu_onkey_1:
   \   00000048   000057E3           CMP      R7,#+0
   \   0000004C   1300000A           BEQ      ??sel_menu_onkey_0
   1089              {
   1090                if (cur_ref->multiselect)
   \   00000050   ........           LDR      R4,??DataTable18  ;; sel_STRUCT
   \   00000054   0050A0E3           MOV      R5,#+0
   \   00000058   BC2094E5           LDR      R2,[R4, #+188]
   \   0000005C   2030D2E5           LDRB     R3,[R2, #+32]
   \   00000060   020013E3           TST      R3,#0x2
   \   00000064   0F00000A           BEQ      ??sel_menu_onkey_3
   1091                {
   1092                  if(((char*)cur_ref->data)[n])
   \   00000068   182092E5           LDR      R2,[R2, #+24]
   \   0000006C   022081E0           ADD      R2,R1,R2
   \   00000070   0030D2E5           LDRB     R3,[R2, #+0]
   \   00000074   000053E3           CMP      R3,#+0
   1093                    ((char*)cur_ref->data)[n]=0;
   \   00000078   0050C215           STRBNE   R5,[R2, #+0]
   1094                  else
   1095                    ((char*)cur_ref->data)[n]=1;
   \   0000007C   0130A003           MOVEQ    R3,#+1
   \   00000080   0030C205           STRBEQ   R3,[R2, #+0]
   1096                  SetMenuItemIcon(gui,i,((char*)cur_ref->data)[n]);
   \   00000084   BC2094E5           LDR      R2,[R4, #+188]
   \   00000088   182092E5           LDR      R2,[R2, #+24]
   \   0000008C   0220D1E7           LDRB     R2,[R1, +R2]
   \   00000090   0010A0E1           MOV      R1,R0
   \   00000094   0600A0E1           MOV      R0,R6
   \   00000098   950100EF           SWI      +405
   1097                  RefreshGUI();
   \   0000009C   960100EF           SWI      +406
   1098                }
   1099                else
   1100                {
   1101                  cur_ref->value=ustop->value;
   1102                  cur_ref->id2=ustop->id2;
   1103                  if (!cur_ref->no_upload)
   1104                  {
   1105                    goto_url=malloc(strlen(cur_vd->pageurl)+1);
   1106                    strcpy(goto_url,cur_vd->pageurl);
   1107                    from_url=malloc(strlen(cur_vd->pageurl)+1);
   1108                    strcpy(from_url,cur_vd->pageurl);
   1109                    goto_params=collectItemsParams(cur_vd,cur_ref);
   1110                  }
   1111                  else
   1112                  {
   1113                    MAIN_CSM *main_csm;
   1114                    if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   1115                    {
   1116                      main_csm->sel_bmk=0;
   1117                    }
   1118                  }
   1119                  cur_ref=NULL;
   1120                  cur_vd=NULL;
   1121                  return 0xFF;
   1122                }
   1123              }
   1124            }
   1125            return (0);
   \                     ??sel_menu_onkey_0:
   \   000000A0   0000A0E3           MOV      R0,#+0
   \   000000A4   F080BDE8           POP      {R4-R7,PC}       ;; return
   \                     ??sel_menu_onkey_3:
   \   000000A8   410F87E2           ADD      R0,R7,#+260
   \   000000AC   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000B0   101082E5           STR      R1,[R2, #+16]
   \   000000B4   B200D0E1           LDRH     R0,[R0, #+2]
   \   000000B8   BC1094E5           LDR      R1,[R4, #+188]
   \   000000BC   140081E5           STR      R0,[R1, #+20]
   \   000000C0   BC0094E5           LDR      R0,[R4, #+188]
   \   000000C4   2000D0E5           LDRB     R0,[R0, #+32]
   \   000000C8   010010E3           TST      R0,#0x1
   \   000000CC   1B00001A           BNE      ??sel_menu_onkey_4
   \   000000D0   C00094E5           LDR      R0,[R4, #+192]
   \   000000D4   ........           LDR      R6,??DataTable13  ;; goto_url
   \   000000D8   D80090E5           LDR      R0,[R0, #+216]
   \   000000DC   1B0000EF           SWI      +27
   \   000000E0   010080E2           ADD      R0,R0,#+1
   \   000000E4   140000EF           SWI      +20
   \   000000E8   000086E5           STR      R0,[R6, #+0]
   \   000000EC   C00094E5           LDR      R0,[R4, #+192]
   \   000000F0   D81090E5           LDR      R1,[R0, #+216]
   \   000000F4   000096E5           LDR      R0,[R6, #+0]
   \   000000F8   ........           LDR      R6,??DataTable14  ;; from_url
   \   000000FC   1A0000EF           SWI      +26
   \   00000100   C00094E5           LDR      R0,[R4, #+192]
   \   00000104   D80090E5           LDR      R0,[R0, #+216]
   \   00000108   1B0000EF           SWI      +27
   \   0000010C   010080E2           ADD      R0,R0,#+1
   \   00000110   140000EF           SWI      +20
   \   00000114   000086E5           STR      R0,[R6, #+0]
   \   00000118   C00094E5           LDR      R0,[R4, #+192]
   \   0000011C   D81090E5           LDR      R1,[R0, #+216]
   \   00000120   000096E5           LDR      R0,[R6, #+0]
   \   00000124   1A0000EF           SWI      +26
   \   00000128   BC1094E5           LDR      R1,[R4, #+188]
   \   0000012C   C00094E5           LDR      R0,[R4, #+192]
   \   00000130   ........           _BLF     collectItemsParams,??collectItemsParams??rA
   \   00000134   ........           LDR      R1,??DataTable15  ;; goto_params
   \   00000138   000081E5           STR      R0,[R1, #+0]
   \   0000013C   040000EA           B        ??sel_menu_onkey_5
   \                     ??sel_menu_onkey_4:
   \   00000140   ........           LDR      R0,??DataTable16  ;; maincsm_id
   \   00000144   000090E5           LDR      R0,[R0, #+0]
   \   00000148   080100EF           SWI      +264
   \   0000014C   000050E3           CMP      R0,#+0
   \   00000150   30508015           STRNE    R5,[R0, #+48]
   \                     ??sel_menu_onkey_5:
   \   00000154   BC5084E5           STR      R5,[R4, #+188]
   \   00000158   C05084E5           STR      R5,[R4, #+192]
   \   0000015C   FF00A0E3           MOV      R0,#+255
   \   00000160   F080BDE8           POP      {R4-R7,PC}
   1126          }
   1127          

   \                                 In segment CODE, align 4, keep-with-next
   1128          void sel_menu_ghook(void *gui, int cmd)
   1129          {
   \                     sel_menu_ghook:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0140A0E1           MOV      R4,R1
   1130            SEL_STRUCT *ustop=MenuGetUserPointer(gui);
   \   00000008   E00100EF           SWI      +480
   \   0000000C   0050A0E1           MOV      R5,R0
   1131            if (cmd==3)
   \   00000010   030054E3           CMP      R4,#+3
   \   00000014   0500001A           BNE      ??sel_menu_ghook_0
   1132            {
   1133              while(ustop)
   \                     ??sel_menu_ghook_1:
   \   00000018   000055E3           CMP      R5,#+0
   \   0000001C   3080BD08           POPEQ    {R4,R5,PC}
   1134              {
   1135                SEL_STRUCT *us=ustop;
   \   00000020   0500A0E1           MOV      R0,R5
   1136                ustop=ustop->next;
   \   00000024   005095E5           LDR      R5,[R5, #+0]
   1137                mfree(us);
   \   00000028   150000EF           SWI      +21
   \   0000002C   F9FFFFEA           B        ??sel_menu_ghook_1
   1138              }    
   1139            }
   1140            if (cmd==0x0A)
   \                     ??sel_menu_ghook_0:
   \   00000030   0A0054E3           CMP      R4,#+10
   \   00000034   3080BD18           POPNE    {R4,R5,PC}
   1141            {
   1142              DisableIDLETMR();
   \   00000038   7F0100EF           SWI      +383
   1143            }
   1144          }
   \   0000003C   3080BDE8           POP      {R4,R5,PC}       ;; return
   1145          
   1146          static int icon_array[2];
   1147          

   \                                 In segment CODE, align 4, keep-with-next
   1148          void sel_menu_iconhndl(void *gui, int cur_item, void *user_pointer)
   1149          {
   \                     sel_menu_iconhndl:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0290A0E1           MOV      R9,R2
   1150            SEL_STRUCT *ustop=user_pointer;
   1151            WSHDR *ws;
   1152            int len;
   1153            int n=0;
   \   00000010   0060A0E3           MOV      R6,#+0
   \   00000014   000055E3           CMP      R5,#+0
   \   00000018   0300000A           BEQ      ??sel_menu_iconhndl_0
   1154            for (; n!=cur_item; n++) ustop=ustop->next;
   \                     ??sel_menu_iconhndl_1:
   \   0000001C   009099E5           LDR      R9,[R9, #+0]
   \   00000020   016086E2           ADD      R6,R6,#+1
   \   00000024   050056E1           CMP      R6,R5
   \   00000028   FBFFFF1A           BNE      ??sel_menu_iconhndl_1
   1155            void *item=AllocMenuItem(gui);
   \                     ??sel_menu_iconhndl_0:
   \   0000002C   970100EF           SWI      +407
   \   00000030   0070A0E1           MOV      R7,R0
   1156            if (ustop)
   \   00000034   000059E3           CMP      R9,#+0
   \   00000038   1900000A           BEQ      ??sel_menu_iconhndl_2
   1157            {
   1158              len=strlen(ustop->name);
   \   0000003C   040089E2           ADD      R0,R9,#+4
   \   00000040   1B0000EF           SWI      +27
   \   00000044   00A0A0E1           MOV      R10,R0
   1159              ws=AllocMenuWS(gui,len+4);
   \   00000048   04108AE2           ADD      R1,R10,#+4
   \   0000004C   0400A0E1           MOV      R0,R4
   \   00000050   980100EF           SWI      +408
   1160              oms2ws(ws,ustop->name,len);
   \   00000054   041089E2           ADD      R1,R9,#+4
   1161              if (cur_ref->multiselect)
   \   00000058   ........           LDR      R9,??DataTable18  ;; sel_STRUCT
   \   0000005C   0080A0E1           MOV      R8,R0
   \   00000060   0A20A0E1           MOV      R2,R10
   \   00000064   ........           _BLF     oms2ws,??oms2ws??rA
   \   00000068   BC0099E5           LDR      R0,[R9, #+188]
   \   0000006C   2000D0E5           LDRB     R0,[R0, #+32]
   \   00000070   020010E3           TST      R0,#0x2
   \   00000074   1200000A           BEQ      ??sel_menu_iconhndl_3
   1162              {
   1163                SetMenuItemIconArray(gui,item,icon_array);
   \   00000078   B02089E2           ADD      R2,R9,#+176
   \   0000007C   0710A0E1           MOV      R1,R7
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   990100EF           SWI      +409
   1164                SetMenuItemIcon(gui,cur_item,((char*)cur_ref->data)[n]);
   \   00000088   BC0099E5           LDR      R0,[R9, #+188]
   \   0000008C   0510A0E1           MOV      R1,R5
   \   00000090   180090E5           LDR      R0,[R0, #+24]
   \   00000094   0020D6E7           LDRB     R2,[R6, +R0]
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   950100EF           SWI      +405
   \   000000A0   070000EA           B        ??sel_menu_iconhndl_3
   1165              }
   1166            }
   1167            else
   1168            {
   1169              ws=AllocMenuWS(gui,10);
   \                     ??sel_menu_iconhndl_2:
   \   000000A4   0A10A0E3           MOV      R1,#+10
   \   000000A8   0400A0E1           MOV      R0,R4
   \   000000AC   980100EF           SWI      +408
   \   000000B0   0080A0E1           MOV      R8,R0
   1170              ascii2ws(ws,lgpData[LGP_Error]);//"Ошибка");
   \   000000B4   20009FE5           LDR      R0,??sel_menu_iconhndl_4  ;; lgpData + 24
   \   000000B8   001090E5           LDR      R1,[R0, #+0]
   \   000000BC   0800A0E1           MOV      R0,R8
   \   000000C0   ........           _BLF     ascii2ws,??ascii2ws??rA
   1171            }
   1172            SetMenuItemText(gui, item, ws, cur_item);
   \                     ??sel_menu_iconhndl_3:
   \   000000C4   0530A0E1           MOV      R3,R5
   \   000000C8   0820A0E1           MOV      R2,R8
   \   000000CC   0710A0E1           MOV      R1,R7
   \   000000D0   0400A0E1           MOV      R0,R4
   \   000000D4   9A0100EF           SWI      +410
   1173          }
   \   000000D8   F087BDE8           POP      {R4-R10,PC}      ;; return
   \                     ??sel_menu_iconhndl_4:
   \   000000DC   ........           DC32     lgpData + 24

   \                                 In segment DATA_I, align 4, align-sorted
   1174          
   1175          int sel_softkeys[]={0,1,2};
   1176          SOFTKEY_DESC sel_sk[]=
   1177          {
   1178            {0x0018,0x0000,(int)"Select"},
   1179            {0x0001,0x0000,(int)"Close"},
   1180            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1181          };
   1182          
   1183          SOFTKEYSTAB sel_skt=
   1184          {
   1185            sel_sk,0
   1186          };
   1187          
   1188          HEADER_DESC sel_HDR={0,0,0,0,NULL,(int)"Select:",LGP_NULL};
   1189          
   1190          MENU_DESC sel_STRUCT=
   \                     sel_STRUCT:
   \   00000000                      DS8 44
   \   0000002C                      REQUIRE `?<Initializer for sel_STRUCT>`
   \                     input_box_menu_sk:
   \   0000002C                      DS8 24
   \   00000044                      REQUIRE `?<Initializer for input_box_menu_sk>`
   \                     input_box_hdr:
   \   00000044                      DS8 20
   \   00000058                      REQUIRE `?<Initializer for input_box_hdr>`
   \                     txtview_menu_sk:
   \   00000058                      DS8 24
   \   00000070                      REQUIRE `?<Initializer for txtview_menu_sk>`
   \                     txtview_hdr:
   \   00000070                      DS8 20
   \   00000084                      REQUIRE `?<Initializer for txtview_hdr>`
   \                     sel_sk:
   \   00000084                      DS8 24
   \   0000009C                      REQUIRE `?<Initializer for sel_sk>`
   \                     sel_HDR:
   \   0000009C                      DS8 20
   \   000000B0                      REQUIRE `?<Initializer for sel_HDR>`
   \   000000B0                      DS8 8
   \   000000B8                      REQUIRE `?<Initializer for icon_array>`
   \                     paste_gui:
   \   000000B8                      DS8 4
   \   000000BC                      REQUIRE `?<Initializer for paste_gui>`
   \                     cur_ref:
   \   000000BC                      DS8 4
   \   000000C0                      REQUIRE `?<Initializer for cur_ref>`
   \                     cur_vd:
   \   000000C0                      DS8 4
   \   000000C4                      REQUIRE `?<Initializer for cur_vd>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     templ_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for templ_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     templ_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for templ_sk>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     templ_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for templ_skt>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     templ_HDR:
   \   00000000                      DS8 20
   \   00000014                      REQUIRE `?<Initializer for templ_HDR>`
   \                     templ_STRUCT:
   \   00000014                      DS8 44
   \   00000040                      REQUIRE `?<Initializer for templ_STRUCT>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     sel_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for sel_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     sel_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for sel_skt>`
   1191          {
   1192            8,sel_menu_onkey,sel_menu_ghook,NULL,
   1193            sel_softkeys,
   1194            &sel_skt,
   1195            0x10,
   1196            sel_menu_iconhndl,
   1197            NULL,   //Items
   1198            NULL,   //Procs
   1199            0   //n
   1200          };
   1201          

   \                                 In segment CODE, align 4, keep-with-next
   1202          int ChangeMenuSelection(VIEWDATA *vd, REFCACHE *rf)
   1203          {
   \                     ChangeMenuSelection:
   \   00000000   F24F2DE9           PUSH     {R1,R4-R11,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0050A0E1           MOV      R5,R0
   1204            int start=0;
   1205            SEL_STRUCT *ustop=0, *usbot=0;
   \   0000000C   0060A0E3           MOV      R6,#+0
   \   00000010   00608DE5           STR      R6,[SP, #+0]
   1206            SEL_STRUCT *us;
   1207            unsigned short i;
   1208            vd->oms_pos=rf->id;
   \   00000014   0C0091E5           LDR      R0,[R1, #+12]
   \   00000018   0090A0E3           MOV      R9,#+0
   \   0000001C   440085E5           STR      R0,[R5, #+68]
   1209            i=_rshort2(vd->oms+vd->oms_pos);
   \   00000020   3C1095E5           LDR      R1,[R5, #+60]
   \   00000024   0670A0E1           MOV      R7,R6
   \   00000028   010080E0           ADD      R0,R0,R1
   \   0000002C   ........           _BLF     _rshort2,??_rshort2??rA
   1210            vd->oms_pos+=2+i+1;
   \   00000030   441095E5           LDR      R1,[R5, #+68]
   \   00000034   0008A0E1           MOV      R0,R0, LSL #+16
   \   00000038   2008A0E1           MOV      R0,R0, LSR #+16
   \   0000003C   030080E2           ADD      R0,R0,#+3
   \   00000040   010080E0           ADD      R0,R0,R1
   \   00000044   440085E5           STR      R0,[R5, #+68]
   1211            int n_sel=_rshort2(vd->oms+vd->oms_pos);
   \   00000048   3C1095E5           LDR      R1,[R5, #+60]
   1212            vd->oms_pos+=2;
   1213            for(int o=0;o<n_sel;o++)
   \   0000004C   0680A0E1           MOV      R8,R6
   \   00000050   010080E0           ADD      R0,R0,R1
   \   00000054   ........           _BLF     _rshort2,??_rshort2??rA
   \   00000058   0040A0E1           MOV      R4,R0
   \   0000005C   440095E5           LDR      R0,[R5, #+68]
   \   00000060   010054E3           CMP      R4,#+1
   \   00000064   020080E2           ADD      R0,R0,#+2
   \   00000068   440085E5           STR      R0,[R5, #+68]
   \   0000006C   130000AA           BGE      ??ChangeMenuSelection_0
   1214            {
   1215              while(*(vd->oms+vd->oms_pos)!='o') vd->oms_pos++; // '$'
   1216              vd->oms_pos++;
   1217              if (rf->value==vd->oms_pos) start=o;
   1218              us=malloc(sizeof(SEL_STRUCT));
   1219              char *d=extract_omstr(vd,vd->oms_pos);
   1220              strcpy(us->name,d);
   1221              mfree(d);
   1222              us->value=vd->oms_pos;
   1223              int i=_rshort2(vd->oms+vd->oms_pos);
   1224              vd->oms_pos+=2+i;
   1225              us->id2=vd->oms_pos;
   1226              i=_rshort2(vd->oms+vd->oms_pos);
   1227              vd->oms_pos+=2+i+1;
   1228              us->next=0;
   1229              if (usbot)
   1230              {
   1231                usbot->next=us;
   1232                usbot=us;
   1233              }
   1234              else
   1235              {
   1236                ustop=us;
   1237                usbot=us;
   1238              }
   1239            }
   1240            cur_ref=rf;
   \                     ??ChangeMenuSelection_1:
   \   00000070   48619FE5           LDR      R6,??ChangeMenuSelection_2  ;; sel_STRUCT
   \   00000074   04009DE5           LDR      R0,[SP, #+4]
   1241            cur_vd=vd;
   \   00000078   C05086E5           STR      R5,[R6, #+192]
   \   0000007C   BC0086E5           STR      R0,[R6, #+188]
   1242            icon_array[0]=GetPicNByUnicodeSymbol(CBOX_UNCHECKED);
   \   00000080   1700A0E3           MOV      R0,#+23
   \   00000084   E10C80E3           ORR      R0,R0,#0xE100
   \   00000088   E40100EF           SWI      +484
   \   0000008C   B00086E5           STR      R0,[R6, #+176]
   1243            icon_array[1]=GetPicNByUnicodeSymbol(CBOX_CHECKED);
   \   00000090   1600A0E3           MOV      R0,#+22
   \   00000094   E10C80E3           ORR      R0,R0,#0xE100
   \   00000098   E40100EF           SWI      +484
   \   0000009C   B40086E5           STR      R0,[R6, #+180]
   1244            if (rf->multiselect) sel_STRUCT.flags2=0x11;
   \   000000A0   04009DE5           LDR      R0,[SP, #+4]
   \   000000A4   2000D0E5           LDRB     R0,[R0, #+32]
   \   000000A8   020010E3           TST      R0,#0x2
   \   000000AC   1000A003           MOVEQ    R0,#+16
   \   000000B0   1100A013           MOVNE    R0,#+17
   \   000000B4   310000EA           B        ??ChangeMenuSelection_3
   \                     ??ChangeMenuSelection_4:
   \   000000B8   0A70A0E1           MOV      R7,R10
   \   000000BC   018088E2           ADD      R8,R8,#+1
   \                     ??ChangeMenuSelection_0:
   \   000000C0   040058E1           CMP      R8,R4
   \   000000C4   E9FFFFAA           BGE      ??ChangeMenuSelection_1
   \                     ??ChangeMenuSelection_5:
   \   000000C8   441095E5           LDR      R1,[R5, #+68]
   \   000000CC   3C2095E5           LDR      R2,[R5, #+60]
   \   000000D0   010081E2           ADD      R0,R1,#+1
   \   000000D4   0210D1E7           LDRB     R1,[R1, +R2]
   \   000000D8   440085E5           STR      R0,[R5, #+68]
   \   000000DC   6F0051E3           CMP      R1,#+111
   \   000000E0   F8FFFF1A           BNE      ??ChangeMenuSelection_5
   \   000000E4   04109DE5           LDR      R1,[SP, #+4]
   \   000000E8   101091E5           LDR      R1,[R1, #+16]
   \   000000EC   000051E1           CMP      R1,R0
   \   000000F0   0890A001           MOVEQ    R9,R8
   \   000000F4   420FA0E3           MOV      R0,#+264
   \   000000F8   140000EF           SWI      +20
   \   000000FC   441095E5           LDR      R1,[R5, #+68]
   \   00000100   00A0A0E1           MOV      R10,R0
   \   00000104   0500A0E1           MOV      R0,R5
   \   00000108   ........           _BLF     extract_omstr,??extract_omstr??rA
   \   0000010C   00B0A0E1           MOV      R11,R0
   \   00000110   0B10A0E1           MOV      R1,R11
   \   00000114   04008AE2           ADD      R0,R10,#+4
   \   00000118   1A0000EF           SWI      +26
   \   0000011C   0B00A0E1           MOV      R0,R11
   \   00000120   150000EF           SWI      +21
   \   00000124   440095E5           LDR      R0,[R5, #+68]
   \   00000128   41BF8AE2           ADD      R11,R10,#+260
   \   0000012C   B000CBE1           STRH     R0,[R11, #+0]
   \   00000130   3C1095E5           LDR      R1,[R5, #+60]
   \   00000134   010080E0           ADD      R0,R0,R1
   \   00000138   ........           _BLF     _rshort2,??_rshort2??rA
   \   0000013C   441095E5           LDR      R1,[R5, #+68]
   \   00000140   020080E2           ADD      R0,R0,#+2
   \   00000144   010080E0           ADD      R0,R0,R1
   \   00000148   440085E5           STR      R0,[R5, #+68]
   \   0000014C   B200CBE1           STRH     R0,[R11, #+2]
   \   00000150   3C1095E5           LDR      R1,[R5, #+60]
   \   00000154   010080E0           ADD      R0,R0,R1
   \   00000158   ........           _BLF     _rshort2,??_rshort2??rA
   \   0000015C   441095E5           LDR      R1,[R5, #+68]
   \   00000160   030080E2           ADD      R0,R0,#+3
   \   00000164   010080E0           ADD      R0,R0,R1
   \   00000168   440085E5           STR      R0,[R5, #+68]
   \   0000016C   00608AE5           STR      R6,[R10, #+0]
   \   00000170   000057E3           CMP      R7,#+0
   \   00000174   00A08D05           STREQ    R10,[SP, #+0]
   \   00000178   00A08715           STRNE    R10,[R7, #+0]
   \   0000017C   CDFFFFEA           B        ??ChangeMenuSelection_4
   \                     ??ChangeMenuSelection_3:
   \   00000180   180086E5           STR      R0,[R6, #+24]
   1245            else sel_STRUCT.flags2=0x10;
   1246            patch_header(&sel_HDR);
   \   00000184   9C0086E2           ADD      R0,R6,#+156
   \   00000188   ........           _BLF     patch_header,??patch_header??rA
   1247            return CreateMenu(0,0,&sel_STRUCT,&sel_HDR,start,n_sel,ustop,0);
   \   0000018C   0000A0E3           MOV      R0,#+0
   \   00000190   01002DE9           PUSH     {R0}
   \   00000194   04009DE5           LDR      R0,[SP, #+4]
   \   00000198   9C3086E2           ADD      R3,R6,#+156
   \   0000019C   01002DE9           PUSH     {R0}
   \   000001A0   10002DE9           PUSH     {R4}
   \   000001A4   00022DE9           PUSH     {R9}
   \   000001A8   0620A0E1           MOV      R2,R6
   \   000001AC   0010A0E3           MOV      R1,#+0
   \   000001B0   0000A0E3           MOV      R0,#+0
   \   000001B4   520100EF           SWI      +338
   \   000001B8   18D08DE2           ADD      SP,SP,#+24
   \   000001BC   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??ChangeMenuSelection_2:
   \   000001C0   ........           DC32     sel_STRUCT
   1248          }
   1249          

   \                                 In segment CODE, align 4, keep-with-next
   1250          void initDisplayUtilsLangPack()
   1251          {
   1252            txtview_hdr.lgp_id=(int)lgpData[LGP_TextHeader];
   \                     initDisplayUtilsLangPack:
   \   00000000   4C109FE5           LDR      R1,??initDisplayUtilsLangPack_0  ;; lgpData
   \   00000004   ........           LDR      R0,??DataTable18  ;; sel_STRUCT
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   782091E5           LDR      R2,[R1, #+120]
   1253            sel_HDR.lgp_id=(int)lgpData[LGP_TextHeader];
   1254            sel_HDR.lgp_id=(int)lgpData[LGP_SelectHeader];
   1255            sel_sk[0].lgp_id=(int)lgpData[LGP_Select];
   1256            sel_sk[1].lgp_id=(int)lgpData[LGP_Close];
   1257            txtview_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   1258            txtview_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   \   00000010   683091E5           LDR      R3,[R1, #+104]
   \   00000014   7C2080E5           STR      R2,[R0, #+124]
   \   00000018   802091E5           LDR      R2,[R1, #+128]
   \   0000001C   643080E5           STR      R3,[R0, #+100]
   \   00000020   A82080E5           STR      R2,[R0, #+168]
   \   00000024   5C2091E5           LDR      R2,[R1, #+92]
   1259            input_box_hdr.lgp_id=(int)lgpData[LGP_EnterHeader];
   1260            input_box_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   1261            input_box_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   \   00000028   383080E5           STR      R3,[R0, #+56]
   \   0000002C   882080E5           STR      R2,[R0, #+136]
   \   00000030   602091E5           LDR      R2,[R1, #+96]
   \   00000034   902080E5           STR      R2,[R0, #+144]
   \   00000038   642091E5           LDR      R2,[R1, #+100]
   \   0000003C   841091E5           LDR      R1,[R1, #+132]
   \   00000040   5C2080E5           STR      R2,[R0, #+92]
   \   00000044   501080E5           STR      R1,[R0, #+80]
   \   00000048   302080E5           STR      R2,[R0, #+48]
   1262          }
   \   0000004C   0300BDE8           POP      {R0,R1}
   \   00000050   1EFF2FE1           BX       LR               ;; return
   \                     ??initDisplayUtilsLangPack_0:
   \   00000054   ........           DC32     lgpData

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable2:
   \   00000000   ........           DC32     `?<Constant "\\316\\370\\350\\341\\352\\340">` + 8

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable10:
   \   00000000   ........           DC32     lgpData + 100

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable13:
   \   00000000   ........           DC32     goto_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable14:
   \   00000000   ........           DC32     from_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable15:
   \   00000000   ........           DC32     goto_params

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable16:
   \   00000000   ........           DC32     maincsm_id

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable18:
   \   00000000   ........           DC32     sel_STRUCT

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_STRUCT>`:
   \   00000000   08000000....       DC32 8, sel_menu_onkey, sel_menu_ghook, 0H, sel_softkeys, sel_skt, 16
   \              ............
   \              00000000....
   \              ............
   \              10000000    
   \   0000001C   ........0000       DC32 sel_menu_iconhndl, 0H, 0H, 0
   \              000000000000
   \              00000000    
   \                     `?<Initializer for input_box_menu_sk>`:
   \   0000002C   18000000           DC16 24, 0
   \   00000030   ........           DC32 `?<Constant "Ok">`
   \   00000034   01000000           DC16 1, 0
   \   00000038   ........           DC32 `?<Constant "Cancel">`
   \   0000003C   3D000000           DC16 61, 0
   \   00000040   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for input_box_hdr>`:
   \   00000044   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   0000004C   00000000....       DC32 0H, `?<Constant "Enter:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for txtview_menu_sk>`:
   \   00000058   18000000           DC16 24, 0
   \   0000005C   ........           DC32 `?<Constant "Ok">`
   \   00000060   01000000           DC16 1, 0
   \   00000064   ........           DC32 `?<Constant "Cancel">`
   \   00000068   3D000000           DC16 61, 0
   \   0000006C   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for txtview_hdr>`:
   \   00000070   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000078   00000000....       DC32 0H, `?<Constant "Text :">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for sel_sk>`:
   \   00000084   18000000           DC16 24, 0
   \   00000088   ........           DC32 `?<Constant "Select">`
   \   0000008C   01000000           DC16 1, 0
   \   00000090   ........           DC32 `?<Constant "Close">`
   \   00000094   3D000000           DC16 61, 0
   \   00000098   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for sel_HDR>`:
   \   0000009C   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   000000A4   00000000....       DC32 0H, `?<Constant "Select:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for icon_array>`:
   \   000000B0   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0
   \              0000        
   \                     `?<Initializer for paste_gui>`:
   \   000000B8   00000000           DC8 0, 0, 0, 0
   \                     `?<Initializer for cur_ref>`:
   \   000000BC   00000000           DC8 0, 0, 0, 0
   \                     `?<Initializer for cur_vd>`:
   \   000000C0   00000000           DC8 0, 0, 0, 0

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templ_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templ_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Select">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Close">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templ_skt>`:
   \   00000000   ........0000       DC32 templ_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templ_HDR>`:
   \   00000000   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000008   00000000....       DC32 0H, `?<Constant "\\302\\373\\341\\356\\360">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for templ_STRUCT>`:
   \   00000014   08000000....       DC32 8, templ_menu_onkey, templ_menu_ghook, 0H, templ_softkeys
   \              ............
   \              00000000....
   \              ....        
   \   00000028   ........1000       DC32 templ_skt, 16, templ_menu_iconhndl, 0H, 0H, 0
   \              0000........
   \              000000000000
   \              000000000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_skt>`:
   \   00000000   ........0000       DC32 sel_sk, 0
   \              0000        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Cancel">`:
   \   00000000   43616E63656C       DC8 "Cancel"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     `?<Constant "Ok">`:
   \   00000000   4F6B00             DC8 "Ok"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\302\\373\\341\\356\\360">`:
   \   00000000   C2FBE1EEF000       DC8 "\302\373\341\356\360"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Close">`:
   \   00000000   436C6F736500       DC8 "Close"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Select">`:
   \   00000000   53656C656374       DC8 "Select"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_1`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\316\\370\\350\\341\\352\\340">`:
   \   00000000   CEF8E8E1EAE0       DC8 "\316\370\350\341\352\340"
   \              00          
   \   00000007   00                 DC8 0
   \   00000008   2462616C6C65       DC8 "$ballet\\templates.txt"
   \              745C74656D70
   \              6C617465732E
   \              74787400    
   \   0000001E   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Select:">`:
   \   00000000   53656C656374       DC8 "Select:"
   \              3A00        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Text :">`:
   \   00000000   54657874203A       DC8 "Text :"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Enter:">`:
   \   00000000   456E7465723A       DC8 "Enter:"
   \              00          
   \   00000007   00                 DC8 0

   Maximum stack usage in bytes:

     Function                 CSTACK
     --------                 ------
     ChangeMenuSelection         60
     CreateInputBox              76
     FindReference               12
     FindReferenceByBegin         0
     FindReferenceById           16
     FindReferenceFirst           4
     GetFontHeight                8
     LineDown                    28
     LineUp                       0
     RenderPage                 780
     SearchNextDisplayLine       36
     createTemplatesMenu        296
     createTextView              68
     initDisplayUtilsLangPack     8
     input_box_ghook             20
     input_box_locret             0
     input_box_onkey             60
     input_box_onkey_options      8
     newCacheLine                12
     patch_header                 8
     patch_input                 12
     renderForm                  60
     scrollDown                  12
     scrollUp                    12
     sel_menu_ghook              12
     sel_menu_iconhndl           32
     sel_menu_onkey              20
     templ_menu_ghook             4
     templ_menu_iconhndl        304
     templ_menu_onkey           344
     txtview_ghook               20
     txtview_locret               0
     txtview_onkey                0


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     patch_header                     52
     patch_input                      68
     GetFontHeight                    40
     SearchNextDisplayLine          1064
     newCacheLine                     88
     LineDown                        204
     LineUp                           36
     scrollDown                      224
     scrollUp                         72
     renderForm                      704
     RenderPage                     2800
     FindReferenceByBegin             56
     FindReferenceFirst               52
     FindReference                    88
     FindReferenceById                88
     templ_menu_onkey                380
     templ_menu_ghook                 20
     templ_menu_iconhndl             352
     createTemplatesMenu             308
     input_box_menu_skt                8
     input_box_ghook                  80
     input_box_locret                  4
     input_box_onkey_options          76
     input_box_onkey                 344
     input_box_desc                   56
     CreateInputBox                  208
     txtview_menu_skt                  8
     txtview_ghook                    80
     txtview_locret                    4
     txtview_onkey                    32
     txtview_desc                     56
     createTextView                  200
     sel_menu_onkey                  356
     sel_menu_ghook                   64
     sel_menu_iconhndl               224
     sel_STRUCT                      196
     templ_softkeys                   12
     templ_sk                         24
     templ_skt                         8
     templ_HDR                        64
     sel_softkeys                     12
     sel_skt                           8
     ChangeMenuSelection             452
     initDisplayUtilsLangPack         88
     ??DataTable2                      4
     ??DataTable10                     4
     ??DataTable13                     4
     ??DataTable14                     4
     ??DataTable15                     4
     ??DataTable16                     4
     ??DataTable18                     4
     ?<Initializer for sel_STRUCT>   196
     ?<Initializer for templ_softkeys>
                                      12
     ?<Initializer for templ_sk>      24
     ?<Initializer for templ_skt>      8
     ?<Initializer for templ_HDR>     64
     ?<Initializer for sel_softkeys>
                                      12
     ?<Initializer for sel_skt>        8
     ?<Constant {4095, 0, 0}>          8
     ?<Constant "Cancel">              8
     ?<Constant "Ok">                  3
     ?<Constant "\302\373\341\356\360">
                                       8
     ?<Constant "Close">               8
     ?<Constant "Select">              8
     ?<Constant {4095, 0, 0}>_1        8
     ?<Constant "\316\370\350\341\352\340">
                                      32
     ?<Constant "Select:">             8
     ?<Constant "Text :">              8
     ?<Constant "Enter:">              8
      Others                         256

 
 9 180 bytes in segment CODE
   235 bytes in segment DATA_C
   324 bytes in segment DATA_I
   324 bytes in segment DATA_ID
    12 bytes in segment INITTAB
 
 8 816 bytes of CODE  memory (+ 376 bytes shared)
   559 bytes of CONST memory
   324 bytes of DATA  memory

Errors: none
Warnings: none
