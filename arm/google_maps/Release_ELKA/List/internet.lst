##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    08/Feb/2014  18:09:02 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  C:\arm\google_maps\internet\internet.c               #
#    Command line    =  C:\arm\google_maps\internet\internet.c -D NEWSGOLD   #
#                       -D ELKA -lC C:\arm\google_maps\Release_ELKA\List\    #
#                       -o C:\arm\google_maps\Release_ELKA\Obj\ -s9          #
#                       --no_unroll --no_clustering --cpu_mode arm --endian  #
#                       little --cpu ARM926EJ-S --stack_align 4 --interwork  #
#                       -e --fpu None --dlib_config "C:\arm2\Embedded        #
#                       Workbench 4.0 Evaluation\ARM\LIB\dl5tpainl8f.h" -I   #
#                       "C:\arm2\Embedded Workbench 4.0                      #
#                       Evaluation\ARM\INC\" --inline_threshold=2            #
#    List file       =  C:\arm\google_maps\Release_ELKA\List\internet.lst    #
#    Object file     =  C:\arm\google_maps\Release_ELKA\Obj\internet.r79     #
#                                                                            #
#                                                                            #
##############################################################################

C:\arm\google_maps\internet\internet.c
      1          #include "../include.h"
      2          #include "internet.h"
      3          #include "../language/language.h"
      4          
      5          
      6          
      7          

   \                                 In segment CODE, align 4, keep-with-next
      8          unsigned int IP(const char *ip)
      9          {
   \                     IP:
   \   00000000   00402DE9           PUSH     {LR}
   \   00000004   10D04DE2           SUB      SP,SP,#+16
     10            unsigned int A,B,C,D;
     11            sscanf(ip,"%d.%d.%d.%d",&A,&B,&C,&D);
   \   00000008   0C108DE2           ADD      R1,SP,#+12
   \   0000000C   02002DE9           PUSH     {R1}
   \   00000010   0C108DE2           ADD      R1,SP,#+12
   \   00000014   02002DE9           PUSH     {R1}
   \   00000018   0C308DE2           ADD      R3,SP,#+12
   \   0000001C   2C109FE5           LDR      R1,??IP_0        ;; `?<Constant "%d.%d.%d.%d">`
   \   00000020   08208DE2           ADD      R2,SP,#+8
   \   00000024   F50100EF           SWI      +501
     12            return IP_ADDR(A,B,C,D);
   \   00000028   08009DE5           LDR      R0,[SP, #+8]
   \   0000002C   0C109DE5           LDR      R1,[SP, #+12]
   \   00000030   0118A0E1           LSL      R1,R1,#+16
   \   00000034   000C81E1           ORR      R0,R1,R0, LSL #+24
   \   00000038   10109DE5           LDR      R1,[SP, #+16]
   \   0000003C   010480E1           ORR      R0,R0,R1, LSL #+8
   \   00000040   14109DE5           LDR      R1,[SP, #+20]
   \   00000044   18D08DE2           ADD      SP,SP,#+24
   \   00000048   000081E1           ORR      R0,R1,R0
   \   0000004C   0080BDE8           POP      {PC}             ;; return
   \                     ??IP_0:
   \   00000050   ........           DC32     `?<Constant "%d.%d.%d.%d">`
     13          }
     14          

   \                                 In segment CODE, align 4, keep-with-next
     15          void create_connect()
     16          {
   \                     create_connect:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
     17             SOCK_ADDR sa;
     18             connect_state=0;
   \   00000004   ........           LDR      R4,??DataTable22  ;; connect_state
     19             sock=socket(1,1,0);
   \   00000008   ........           LDR      R5,??DataTable12  ;; sock
   \   0000000C   10D04DE2           SUB      SP,SP,#+16
   \   00000010   0000A0E3           MOV      R0,#+0
   \   00000014   000084E5           STR      R0,[R4, #+0]
   \   00000018   0020A0E3           MOV      R2,#+0
   \   0000001C   0110A0E3           MOV      R1,#+1
   \   00000020   0100A0E1           MOV      R0,R1
   \   00000024   730100EF           SWI      +371
   \   00000028   000085E5           STR      R0,[R5, #+0]
     20           if (sock!=-1)
   \   0000002C   0060E0E3           MVN      R6,#+0
   \   00000030   060050E1           CMP      R0,R6
   \   00000034   FF80BD08           POPEQ    {R0-R7,PC}
     21             {
     22              sa.family=AF_UNIX;
     23              sa.port=htons(PORT);
   \   00000038   6C009FE5           LDR      R0,??create_connect_0  ;; PORT
   \   0000003C   0170A0E3           MOV      R7,#+1
   \   00000040   B070CDE1           STRH     R7,[SP, #+0]
   \   00000044   000090E5           LDR      R0,[R0, #+0]
   \   00000048   0008A0E1           MOV      R0,R0, LSL #+16
   \   0000004C   2008A0E1           MOV      R0,R0, LSR #+16
   \   00000050   7A0100EF           SWI      +378
   \   00000054   B200CDE1           STRH     R0,[SP, #+2]
     24              sa.ip=htonl(IP(HOST));
   \   00000058   50009FE5           LDR      R0,??create_connect_0+0x4  ;; HOST
   \   0000005C   ........           BL       IP
   \   00000060   7B0100EF           SWI      +379
   \   00000064   04008DE5           STR      R0,[SP, #+4]
     25              if(connect(sock,&sa,sizeof(sa))!=SOCKET_ERROR)
   \   00000068   000095E5           LDR      R0,[R5, #+0]
   \   0000006C   1020A0E3           MOV      R2,#+16
   \   00000070   0D10A0E1           MOV      R1,SP
   \   00000074   740100EF           SWI      +372
   \   00000078   060050E1           CMP      R0,R6
   \   0000007C   0600000A           BEQ      ??create_connect_1
     26              {
     27                if(istate==1)istate=2;
   \   00000080   2C009FE5           LDR      R0,??create_connect_0+0x8  ;; istate
     28                connect_state=1;
   \   00000084   007084E5           STR      R7,[R4, #+0]
   \   00000088   001090E5           LDR      R1,[R0, #+0]
   \   0000008C   010051E3           CMP      R1,#+1
   \   00000090   0210A003           MOVEQ    R1,#+2
   \   00000094   00108005           STREQ    R1,[R0, #+0]
   \   00000098   FF80BDE8           POP      {R0-R7,PC}
     29              }
     30              else
     31              {
     32                closesocket(sock);
   \                     ??create_connect_1:
   \   0000009C   000095E5           LDR      R0,[R5, #+0]
   \   000000A0   760100EF           SWI      +374
     33                sock=-1;
   \   000000A4   006085E5           STR      R6,[R5, #+0]
     34              }
     35            }
     36          }
   \   000000A8   FF80BDE8           POP      {R0-R7,PC}       ;; return
   \                     ??create_connect_0:
   \   000000AC   ........           DC32     PORT
   \   000000B0   ........           DC32     HOST
   \   000000B4   ........           DC32     istate
     37          
     38          

   \                                 In segment CODE, align 4, keep-with-next
     39          void send_req(void)
     40          {
   \                     send_req:
   \   00000000   10402DE9           PUSH     {R4,LR}
     41          if(buf==0)buf=malloc(BUFFSIZE);
   \   00000004   ........           LDR      R4,??DataTable11  ;; buf
   \   00000008   000094E5           LDR      R0,[R4, #+0]
   \   0000000C   000050E3           CMP      R0,#+0
   \   00000010   0200001A           BNE      ??send_req_0
   \   00000014   800EA0E3           MOV      R0,#+2048
   \   00000018   140000EF           SWI      +20
   \   0000001C   000084E5           STR      R0,[R4, #+0]
     42          mode=1;
   \                     ??send_req_0:
   \   00000020   ........           LDR      R0,??DataTable24  ;; mode
     43          CreateRequest(); 
     44          all_traf+=send(sock,req_buf,strlen(req_buf),0);
   \   00000024   ........           LDR      R4,??DataTable16  ;; req_buf
   \   00000028   0110A0E3           MOV      R1,#+1
   \   0000002C   001080E5           STR      R1,[R0, #+0]
   \   00000030   ........           BL       CreateRequest
   \   00000034   0400A0E1           MOV      R0,R4
   \   00000038   1B0000EF           SWI      +27
   \   0000003C   0020A0E1           MOV      R2,R0
   \   00000040   ........           LDR      R0,??DataTable12  ;; sock
   \   00000044   0030A0E3           MOV      R3,#+0
   \   00000048   000090E5           LDR      R0,[R0, #+0]
   \   0000004C   0410A0E1           MOV      R1,R4
   \   00000050   790100EF           SWI      +377
   \   00000054   ........           LDR      R1,??DataTable13  ;; all_traf
   \   00000058   002091E5           LDR      R2,[R1, #+0]
   \   0000005C   020080E0           ADD      R0,R0,R2
   \   00000060   000081E5           STR      R0,[R1, #+0]
     45          connect_state=2;
   \   00000064   ........           LDR      R0,??DataTable22  ;; connect_state
   \   00000068   0210A0E3           MOV      R1,#+2
   \   0000006C   001080E5           STR      R1,[R0, #+0]
     46          }
   \   00000070   1080BDE8           POP      {R4,PC}          ;; return
     47          

   \                                 In segment CODE, align 4, keep-with-next
     48          void end_socket(void)
     49          {
   \                     end_socket:
   \   00000000   10402DE9           PUSH     {R4,LR}
     50             if (sock>=0)
   \   00000004   ........           LDR      R4,??DataTable12  ;; sock
   \   00000008   000094E5           LDR      R0,[R4, #+0]
   \   0000000C   000050E3           CMP      R0,#+0
   \   00000010   1080BD48           POPMI    {R4,PC}
     51               {
     52                shutdown(sock,2);
   \   00000014   0210A0E3           MOV      R1,#+2
   \   00000018   770100EF           SWI      +375
     53                closesocket(sock);
   \   0000001C   000094E5           LDR      R0,[R4, #+0]
   \   00000020   760100EF           SWI      +374
     54                connect_state=0;
   \   00000024   ........           LDR      R0,??DataTable22  ;; connect_state
   \   00000028   0010A0E3           MOV      R1,#+0
   \   0000002C   001080E5           STR      R1,[R0, #+0]
     55                SUBPROC((void *)create_connect);
   \   00000030   ........           LDR      R0,??DataTable23  ;; create_connect
   \   00000034   710100EF           SWI      +369
     56               }
     57          }
   \   00000038   1080BDE8           POP      {R4,PC}          ;; return
     58          
     59          

   \                                 In segment CODE, align 4, keep-with-next
     60          int get_headersize(char *a)
     61          {
   \                     get_headersize:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
     62          int header_size=0;
   \   00000008   0050A0E3           MOV      R5,#+0
   \   0000000C   000000EA           B        ??get_headersize_0
     63          while(header_size<strlen(a)-3)
     64          {
     65            if(a[header_size]=='\r'&&a[header_size+1]=='\n'&&a[header_size+2]=='\r'&&a[header_size+3]=='\n')return header_size+4;
     66            header_size++;
   \                     ??get_headersize_1:
   \   00000010   015085E2           ADD      R5,R5,#+1
   \                     ??get_headersize_0:
   \   00000014   0400A0E1           MOV      R0,R4
   \   00000018   1B0000EF           SWI      +27
   \   0000001C   030040E2           SUB      R0,R0,#+3
   \   00000020   000055E1           CMP      R5,R0
   \   00000024   1000002A           BCS      ??get_headersize_2
   \   00000028   0400D5E7           LDRB     R0,[R5, +R4]
   \   0000002C   0D0050E3           CMP      R0,#+13
   \   00000030   F6FFFF1A           BNE      ??get_headersize_1
   \   00000034   040085E0           ADD      R0,R5,R4
   \   00000038   0100D0E5           LDRB     R0,[R0, #+1]
   \   0000003C   0A0050E3           CMP      R0,#+10
   \   00000040   F2FFFF1A           BNE      ??get_headersize_1
   \   00000044   040085E0           ADD      R0,R5,R4
   \   00000048   0200D0E5           LDRB     R0,[R0, #+2]
   \   0000004C   0D0050E3           CMP      R0,#+13
   \   00000050   EEFFFF1A           BNE      ??get_headersize_1
   \   00000054   040085E0           ADD      R0,R5,R4
   \   00000058   0300D0E5           LDRB     R0,[R0, #+3]
   \   0000005C   0A0050E3           CMP      R0,#+10
   \   00000060   EAFFFF1A           BNE      ??get_headersize_1
   \   00000064   040085E2           ADD      R0,R5,#+4
   \   00000068   3080BDE8           POP      {R4,R5,PC}
     67          }
     68          return 0;
   \                     ??get_headersize_2:
   \   0000006C   0000A0E3           MOV      R0,#+0
   \   00000070   3080BDE8           POP      {R4,R5,PC}       ;; return
     69          }
     70          
     71          

   \                                 In segment CODE, align 4, keep-with-next
     72          void get_answer()
     73          {
   \                     get_answer:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
     74             
     75             int j=0;
     76             int header_size=0,image_size=0;
     77            pbuf=0;
   \   00000004   F4509FE5           LDR      R5,??get_answer_0  ;; pbuf
   \   00000008   ........           LDR      R7,??DataTable11  ;; buf
   \   0000000C   ........           LDR      R9,??DataTable12  ;; sock
   \   00000010   0040A0E3           MOV      R4,#+0
   \   00000014   0080A0E3           MOV      R8,#+0
   \   00000018   0460A0E1           MOV      R6,R4
   \   0000001C   006085E5           STR      R6,[R5, #+0]
   \   00000020   0A0000EA           B        ??get_answer_1
     78            while((j=recv(sock,buf+pbuf,BUFFSIZE,0))>0)//получаем весь ответ
     79            {
     80              all_traf+=j;
   \                     ??get_answer_2:
   \   00000024   ........           LDR      R1,??DataTable13  ;; all_traf
   \   00000028   002091E5           LDR      R2,[R1, #+0]
   \   0000002C   022080E0           ADD      R2,R0,R2
   \   00000030   002081E5           STR      R2,[R1, #+0]
   \   00000034   001095E5           LDR      R1,[R5, #+0]
   \   00000038   010080E0           ADD      R0,R0,R1
   \   0000003C   000085E5           STR      R0,[R5, #+0]
     81              pbuf+=j;
     82              buf=realloc(buf,pbuf+BUFFSIZE); 
   \   00000040   801E80E2           ADD      R1,R0,#+2048
   \   00000044   000097E5           LDR      R0,[R7, #+0]
   \   00000048   BA0000EF           SWI      +186
   \   0000004C   000087E5           STR      R0,[R7, #+0]
     83            }
   \                     ??get_answer_1:
   \   00000050   000095E5           LDR      R0,[R5, #+0]
   \   00000054   001097E5           LDR      R1,[R7, #+0]
   \   00000058   0030A0E3           MOV      R3,#+0
   \   0000005C   011080E0           ADD      R1,R0,R1
   \   00000060   000099E5           LDR      R0,[R9, #+0]
   \   00000064   802EA0E3           MOV      R2,#+2048
   \   00000068   780100EF           SWI      +376
   \   0000006C   010050E3           CMP      R0,#+1
   \   00000070   EBFFFFAA           BGE      ??get_answer_2
     84            buf[pbuf]=0;
   \   00000074   000095E5           LDR      R0,[R5, #+0]
   \   00000078   001097E5           LDR      R1,[R7, #+0]
   \   0000007C   0160C0E7           STRB     R6,[R0, +R1]
     85          
     86           if(header_size==0||image_size==0)
     87             {
     88                if(strstr(buf,"\r\n\r\n"))
   \   00000080   000097E5           LDR      R0,[R7, #+0]
   \   00000084   78109FE5           LDR      R1,??get_answer_0+0x4  ;; `?<Constant "\\r\\n\\r\\n">`
   \   00000088   180100EF           SWI      +280
   \   0000008C   000050E3           CMP      R0,#+0
   \   00000090   1100000A           BEQ      ??get_answer_3
     89                 {
     90                   if(header_size==0)header_size=get_headersize(buf);
   \   00000094   000097E5           LDR      R0,[R7, #+0]
   \   00000098   ........           BL       get_headersize
     91                   if(image_size==0&&(tag=findtag(buf,"Content-Length:")))
   \   0000009C   64109FE5           LDR      R1,??get_answer_0+0x8  ;; `?<Constant "Content-Length:">`
   \   000000A0   0040A0E1           MOV      R4,R0
   \   000000A4   000097E5           LDR      R0,[R7, #+0]
   \   000000A8   ........           _BLF     findtag,??findtag??rA
   \   000000AC   58309FE5           LDR      R3,??get_answer_0+0xC  ;; tag
   \   000000B0   000050E3           CMP      R0,#+0
   \   000000B4   000083E5           STR      R0,[R3, #+0]
   \   000000B8   0700000A           BEQ      ??get_answer_3
     92                     {
     93          
     94                       valuetag(tag, filename, sizeof(filename)-1);
   \   000000BC   ........           LDR      R8,??DataTable25  ;; filename
   \   000000C0   7F20A0E3           MOV      R2,#+127
   \   000000C4   0810A0E1           MOV      R1,R8
   \   000000C8   ........           _BLF     valuetag,??valuetag??rA
     95                       image_size=(int)str_to_double(filename);
   \   000000CC   0800A0E1           MOV      R0,R8
   \   000000D0   ........           _BLF     str_to_double,??str_to_double??rA
   \   000000D4   ........           _BLF     __doubleToLong,??__doubleToLong??rA
   \   000000D8   0080A0E1           MOV      R8,R0
     96                      }
     97                 }
     98             }
     99            
    100            if(pbuf>=(image_size+header_size))
   \                     ??get_answer_3:
   \   000000DC   000095E5           LDR      R0,[R5, #+0]
   \   000000E0   081084E0           ADD      R1,R4,R8
   \   000000E4   010050E1           CMP      R0,R1
   \   000000E8   F083BDB8           POPLT    {R4-R9,PC}
    101            {
    102              buf[pbuf]=0;
   \   000000EC   001097E5           LDR      R1,[R7, #+0]
   \   000000F0   0160C0E7           STRB     R6,[R0, +R1]
    103              save_image_in_cache(0);
   \   000000F4   0000A0E3           MOV      R0,#+0
   \   000000F8   ........           _BLF     save_image_in_cache,??save_image_in_cache??rA
    104              
    105            }
    106          }
   \   000000FC   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??get_answer_0:
   \   00000100   ........           DC32     pbuf
   \   00000104   ........           DC32     `?<Constant "\\r\\n\\r\\n">`
   \   00000108   ........           DC32     `?<Constant "Content-Length:">`
   \   0000010C   ........           DC32     tag
    107          
    108          

   \                                 In segment CODE, align 4, keep-with-next
    109           void CreateRequest()
    110          {
    111          
    112          if(!latitude||!longitude)
   \                     CreateRequest:
   \   00000000   ........           LDR      R0,??DataTable30  ;; latitude
   \   00000004   F0432DE9           PUSH     {R4-R9,LR}
   \   00000008   C00090E8           LDM      R0,{R6,R7}
   \   0000000C   ........           LDR      R4,??DataTable16  ;; req_buf
   \   00000010   0000A0E3           MOV      R0,#+0
   \   00000014   0010A0E3           MOV      R1,#+0
   \   00000018   0620A0E1           MOV      R2,R6
   \   0000001C   0730A0E1           MOV      R3,R7
   \   00000020   ........           _BLF     __dNotEqual,??__dNotEqual??rA
   \   00000024   000050E3           CMP      R0,#+0
   \   00000028   0800000A           BEQ      ??CreateRequest_0
   \   0000002C   ........           LDR      R0,??DataTable31  ;; longitude
   \   00000030   0010A0E3           MOV      R1,#+0
   \   00000034   000390E8           LDM      R0,{R8,R9}
   \   00000038   0000A0E3           MOV      R0,#+0
   \   0000003C   0820A0E1           MOV      R2,R8
   \   00000040   0930A0E1           MOV      R3,R9
   \   00000044   ........           _BLF     __dNotEqual,??__dNotEqual??rA
   \   00000048   000050E3           CMP      R0,#+0
   \   0000004C   1700001A           BNE      ??CreateRequest_1
    113          {
    114          ramnet=RamNet();
   \                     ??CreateRequest_0:
   \   00000050   68519FE5           LDR      R5,??CreateRequest_2  ;; ramnet
   \   00000054   CA8000EF           SWI      +32970
   \   00000058   000085E5           STR      R0,[R5, #+0]
    115          char *p=((char*)ramnet)-11;
    116          char cc1=*p;
    117          char cc2=*(p+1);
    118          char nc=*(p+2);
    119          sprintf(req_buf,"GET /maps/index.php?cell=%d&op=%d&cc=%d&lac=%d",ramnet[0].ci,(nc&0x0F)*10+(nc>>4),(cc1&0x0F)*100+(cc1>>4)*10+(cc2&0x0F),ramnet[0].lac);  
   \   0000005C   B450D0E1           LDRH     R5,[R0, #+4]
   \   00000060   0B2040E2           SUB      R2,R0,#+11
   \   00000064   0030D2E5           LDRB     R3,[R2, #+0]
   \   00000068   0210D2E5           LDRB     R1,[R2, #+2]
   \   0000006C   20002DE9           PUSH     {R5}
   \   00000070   0120D2E5           LDRB     R2,[R2, #+1]
   \   00000074   64C0A0E3           MOV      R12,#+100
   \   00000078   0AE0A0E3           MOV      LR,#+10
   \   0000007C   0F5003E2           AND      R5,R3,#0xF
   \   00000080   2332A0E1           LSR      R3,R3,#+4
   \   00000084   9E0303E0           MUL      R3,LR,R3
   \   00000088   0F2002E2           AND      R2,R2,#0xF
   \   0000008C   9C3523E0           MLA      R3,R12,R5,R3
   \   00000090   032082E0           ADD      R2,R2,R3
   \   00000094   04002DE9           PUSH     {R2}
   \   00000098   0F2001E2           AND      R2,R1,#0xF
   \   0000009C   2112A0E1           LSR      R1,R1,#+4
   \   000000A0   9E1223E0           MLA      R3,LR,R2,R1
   \   000000A4   B220D0E1           LDRH     R2,[R0, #+2]
   \   000000A8   14119FE5           LDR      R1,??CreateRequest_2+0x4  ;; `?<Constant "GET /maps/index.php?c...">`
   \   000000AC   030000EA           B        ??CreateRequest_3
    120          
    121          }
    122          else sprintf(req_buf ,"GET /maps/index.php?lat=%f&lon=%f",latitude,longitude);
   \                     ??CreateRequest_1:
   \   000000B0   10119FE5           LDR      R1,??CreateRequest_2+0x8  ;; `?<Constant "GET /maps/index.php?l...">`
   \   000000B4   00032DE9           PUSH     {R8,R9}
   \   000000B8   0620A0E1           MOV      R2,R6
   \   000000BC   0730A0E1           MOV      R3,R7
   \                     ??CreateRequest_3:
   \   000000C0   0400A0E1           MOV      R0,R4
   \   000000C4   160000EF           SWI      +22
    123          
    124          if(my_latitude&&my_longitude)sprintf(req_buf ,"%s&my_latitude=%f&my_longitude=%f",req_buf,my_latitude,my_longitude);
   \   000000C8   FC009FE5           LDR      R0,??CreateRequest_2+0xC  ;; my_latitude
   \   000000CC   08D08DE2           ADD      SP,SP,#+8
   \   000000D0   C00090E8           LDM      R0,{R6,R7}
   \   000000D4   0000A0E3           MOV      R0,#+0
   \   000000D8   0010A0E3           MOV      R1,#+0
   \   000000DC   0620A0E1           MOV      R2,R6
   \   000000E0   0730A0E1           MOV      R3,R7
   \   000000E4   ........           _BLF     __dNotEqual,??__dNotEqual??rA
   \   000000E8   000050E3           CMP      R0,#+0
   \   000000EC   1000000A           BEQ      ??CreateRequest_4
   \   000000F0   D8009FE5           LDR      R0,??CreateRequest_2+0x10  ;; my_longitude
   \   000000F4   0010A0E3           MOV      R1,#+0
   \   000000F8   000390E8           LDM      R0,{R8,R9}
   \   000000FC   0000A0E3           MOV      R0,#+0
   \   00000100   0820A0E1           MOV      R2,R8
   \   00000104   0930A0E1           MOV      R3,R9
   \   00000108   ........           _BLF     __dNotEqual,??__dNotEqual??rA
   \   0000010C   000050E3           CMP      R0,#+0
   \   00000110   0700000A           BEQ      ??CreateRequest_4
   \   00000114   B8109FE5           LDR      R1,??CreateRequest_2+0x14  ;; `?<Constant "%s&my_latitude=%f&my_...">`
   \   00000118   00032DE9           PUSH     {R8,R9}
   \   0000011C   C0002DE9           PUSH     {R6,R7}
   \   00000120   0800BDE8           POP      {R3}
   \   00000124   0420A0E1           MOV      R2,R4
   \   00000128   0400A0E1           MOV      R0,R4
   \   0000012C   160000EF           SWI      +22
   \   00000130   0CD08DE2           ADD      SP,SP,#+12
    125          
    126          sprintf(req_buf ,"%s&zoom=%d&t=%s&frmt=%s&szx=%d&szy=%d&q=%s&imgx=%d&imgy=%d&cub=%d&color=blue&hl=%s"
    127          " HTTP/1.1\r\nHost: gps.st-hunter.ru\r\n\r\n",req_buf,zoom,maptype[map_type],format[0],ScreenW(),ScreenH(),type[2],mapi,mapj,cub,lgpData[LGP_LangCode]);
   \                     ??CreateRequest_4:
   \   00000134   898100EF           SWI      +33161
   \   00000138   0050A0E1           MOV      R5,R0
   \   0000013C   888100EF           SWI      +33160
   \   00000140   90109FE5           LDR      R1,??CreateRequest_2+0x18  ;; lgpData + 20
   \   00000144   0420A0E1           MOV      R2,R4
   \   00000148   001091E5           LDR      R1,[R1, #+0]
   \   0000014C   02002DE9           PUSH     {R1}
   \   00000150   5010A0E3           MOV      R1,#+80
   \   00000154   02002DE9           PUSH     {R1}
   \   00000158   ........           LDR      R1,??DataTable28  ;; mapj
   \   0000015C   001091E5           LDR      R1,[R1, #+0]
   \   00000160   02002DE9           PUSH     {R1}
   \   00000164   ........           LDR      R1,??DataTable29  ;; mapi
   \   00000168   001091E5           LDR      R1,[R1, #+0]
   \   0000016C   02002DE9           PUSH     {R1}
   \   00000170   64109FE5           LDR      R1,??CreateRequest_2+0x1C  ;; type + 8
   \   00000174   001091E5           LDR      R1,[R1, #+0]
   \   00000178   02002DE9           PUSH     {R1}
   \   0000017C   5C109FE5           LDR      R1,??CreateRequest_2+0x20  ;; maptype
   \   00000180   20002DE9           PUSH     {R5}
   \   00000184   01002DE9           PUSH     {R0}
   \   00000188   54009FE5           LDR      R0,??CreateRequest_2+0x24  ;; format
   \   0000018C   000090E5           LDR      R0,[R0, #+0]
   \   00000190   01002DE9           PUSH     {R0}
   \   00000194   ........           LDR      R0,??DataTable26  ;; map_type
   \   00000198   000090E5           LDR      R0,[R0, #+0]
   \   0000019C   000191E7           LDR      R0,[R1, +R0, LSL #+2]
   \   000001A0   40109FE5           LDR      R1,??CreateRequest_2+0x28  ;; `?<Constant "%s&zoom=%d&t=%s&frmt=...">`
   \   000001A4   01002DE9           PUSH     {R0}
   \   000001A8   ........           LDR      R0,??DataTable27  ;; zoom
   \   000001AC   003090E5           LDR      R3,[R0, #+0]
   \   000001B0   0400A0E1           MOV      R0,R4
   \   000001B4   160000EF           SWI      +22
   \   000001B8   24D08DE2           ADD      SP,SP,#+36
    128          }
   \   000001BC   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??CreateRequest_2:
   \   000001C0   ........           DC32     ramnet
   \   000001C4   ........           DC32     `?<Constant "GET /maps/index.php?c...">`
   \   000001C8   ........           DC32     `?<Constant "GET /maps/index.php?l...">`
   \   000001CC   ........           DC32     my_latitude
   \   000001D0   ........           DC32     my_longitude
   \   000001D4   ........           DC32     `?<Constant "%s&my_latitude=%f&my_...">`
   \   000001D8   ........           DC32     lgpData + 20
   \   000001DC   ........           DC32     type + 8
   \   000001E0   ........           DC32     maptype
   \   000001E4   ........           DC32     format
   \   000001E8   ........           DC32     `?<Constant "%s&zoom=%d&t=%s&frmt=...">`
    129          

   \                                 In segment CODE, align 4, keep-with-next
    130          void c()
    131          {
    132          if(connect_state==0)
   \                     c:
   \   00000000   ........           LDR      R0,??DataTable22  ;; connect_state
   \   00000004   10402DE9           PUSH     {R4,LR}
   \   00000008   28D04DE2           SUB      SP,SP,#+40
   \   0000000C   000090E5           LDR      R0,[R0, #+0]
   \   00000010   000050E3           CMP      R0,#+0
    133          {
    134            SUBPROC((void *)create_connect);
   \   00000014   ........           LDREQ    R0,??DataTable23  ;; create_connect
   \   00000018   2600000A           BEQ      ??c_0
    135            return;
    136          }
    137            mode=1;
   \   0000001C   ........           LDR      R0,??DataTable24  ;; mode
    138            FSTATS fs;
    139           //sprintf(filename,"%scache%f_%f\\",elf_path,longitude,latitude);
    140           //sprintf(filename,"%smap_%d_%d_%d_%d.png",filename,mapi,mapj,zoom,map_type);
    141           sprintf(filename,"%scache%f_%f\\map_%d_%d_%d_%d.png",elf_path,longitude,latitude,mapi,mapj,zoom,map_type);
   \   00000020   ........           LDR      R4,??DataTable25  ;; filename
   \   00000024   98209FE5           LDR      R2,??c_1         ;; elf_path
   \   00000028   0110A0E3           MOV      R1,#+1
   \   0000002C   001080E5           STR      R1,[R0, #+0]
   \   00000030   ........           LDR      R0,??DataTable26  ;; map_type
   \   00000034   000090E5           LDR      R0,[R0, #+0]
   \   00000038   01002DE9           PUSH     {R0}
   \   0000003C   ........           LDR      R0,??DataTable27  ;; zoom
   \   00000040   000090E5           LDR      R0,[R0, #+0]
   \   00000044   01002DE9           PUSH     {R0}
   \   00000048   ........           LDR      R0,??DataTable28  ;; mapj
   \   0000004C   000090E5           LDR      R0,[R0, #+0]
   \   00000050   01002DE9           PUSH     {R0}
   \   00000054   ........           LDR      R0,??DataTable29  ;; mapi
   \   00000058   000090E5           LDR      R0,[R0, #+0]
   \   0000005C   01002DE9           PUSH     {R0}
   \   00000060   ........           LDR      R0,??DataTable30  ;; latitude
   \   00000064   030090E8           LDM      R0,{R0,R1}
   \   00000068   03002DE9           PUSH     {R0,R1}
   \   0000006C   ........           LDR      R0,??DataTable31  ;; longitude
   \   00000070   030090E8           LDM      R0,{R0,R1}
   \   00000074   03002DE9           PUSH     {R0,R1}
   \   00000078   0800BDE8           POP      {R3}
   \   0000007C   44109FE5           LDR      R1,??c_1+0x4     ;; `?<Constant "%scache%f_%f\\\\map_%d_%...">`
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   160000EF           SWI      +22
    142           if(GetFileStats(filename,&fs,0)!=-1)save_image_in_cache(1);//SUBPROC((void*)save_image_in_cache,1);
   \   00000088   0020A0E3           MOV      R2,#+0
   \   0000008C   1C108DE2           ADD      R1,SP,#+28
   \   00000090   0400A0E1           MOV      R0,R4
   \   00000094   840000EF           SWI      +132
   \   00000098   010070E3           CMN      R0,#+1
   \   0000009C   1CD08DE2           ADD      SP,SP,#+28
   \   000000A0   0300000A           BEQ      ??c_2
   \   000000A4   0100A0E3           MOV      R0,#+1
   \   000000A8   ........           _BLF     save_image_in_cache,??save_image_in_cache??rA
   \   000000AC   28D08DE2           ADD      SP,SP,#+40
   \   000000B0   1080BDE8           POP      {R4,PC}
    143           else
    144           
    145           SUBPROC((void*)send_req);
   \                     ??c_2:
   \   000000B4   10009FE5           LDR      R0,??c_1+0x8     ;; send_req
   \                     ??c_0:
   \   000000B8   710100EF           SWI      +369
   \   000000BC   28D08DE2           ADD      SP,SP,#+40
   \   000000C0   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??c_1:
   \   000000C4   ........           DC32     elf_path
   \   000000C8   ........           DC32     `?<Constant "%scache%f_%f\\\\map_%d_%...">`
   \   000000CC   ........           DC32     send_req
    146          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable11:
   \   00000000   ........           DC32     buf

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable12:
   \   00000000   ........           DC32     sock

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable13:
   \   00000000   ........           DC32     all_traf

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable16:
   \   00000000   ........           DC32     req_buf

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable22:
   \   00000000   ........           DC32     connect_state

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable23:
   \   00000000   ........           DC32     create_connect

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable24:
   \   00000000   ........           DC32     mode

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable25:
   \   00000000   ........           DC32     filename

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable26:
   \   00000000   ........           DC32     map_type

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable27:
   \   00000000   ........           DC32     zoom

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable28:
   \   00000000   ........           DC32     mapj

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable29:
   \   00000000   ........           DC32     mapi

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable30:
   \   00000000   ........           DC32     latitude

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable31:
   \   00000000   ........           DC32     longitude

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "%d.%d.%d.%d">`:
   \   00000000   25642E25642E       DC8 "%d.%d.%d.%d"
   \              25642E256400

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Content-Length:">`:
   \   00000000   436F6E74656E       DC8 "Content-Length:"
   \              742D4C656E67
   \              74683A00    

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\r\\n\\r\\n">`:
   \   00000000   0D0A0D0A00         DC8 "\015\012\015\012"
   \   00000005   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "GET /maps/index.php?c...">`:
   \   00000000   474554202F6D       DC8 "GET /maps/index.php?cell=%d&op=%d&cc=%d&lac=%d"
   \              6170732F696E
   \              6465782E7068
   \              703F63656C6C
   \              3D2564266F70
   \              3D2564266363
   \              3D2564266C61
   \              633D256400  
   \   0000002F   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "GET /maps/index.php?l...">`:
   \   00000000   474554202F6D       DC8 "GET /maps/index.php?lat=%f&lon=%f"
   \              6170732F696E
   \              6465782E7068
   \              703F6C61743D
   \              2566266C6F6E
   \              3D256600    
   \   00000022   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "%s&my_latitude=%f&my_...">`:
   \   00000000   2573266D795F       DC8 "%s&my_latitude=%f&my_longitude=%f"
   \              6C6174697475
   \              64653D256626
   \              6D795F6C6F6E
   \              676974756465
   \              3D256600    
   \   00000022   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "%s&zoom=%d&t=%s&frmt=...">`:
   \   00000000   2573267A6F6F       DC8 25H, 73H, 26H, 7AH, 6FH, 6FH, 6DH, 3DH
   \              6D3D        
   \   00000008   256426743D25       DC8 25H, 64H, 26H, 74H, 3DH, 25H, 73H, 26H
   \              7326        
   \   00000010   66726D743D25       DC8 66H, 72H, 6DH, 74H, 3DH, 25H, 73H, 26H
   \              7326        
   \   00000018   737A783D2564       DC8 73H, 7AH, 78H, 3DH, 25H, 64H, 26H, 73H
   \              2673        
   \   00000020   7A793D256426       DC8 7AH, 79H, 3DH, 25H, 64H, 26H, 71H, 3DH
   \              713D        
   \   00000028   257326696D67       DC8 25H, 73H, 26H, 69H, 6DH, 67H, 78H, 3DH
   \              783D        
   \   00000030   256426696D67       DC8 25H, 64H, 26H, 69H, 6DH, 67H, 79H, 3DH
   \              793D        
   \   00000038   256426637562       DC8 25H, 64H, 26H, 63H, 75H, 62H, 3DH, 25H
   \              3D25        
   \   00000040   6426636F6C6F       DC8 64H, 26H, 63H, 6FH, 6CH, 6FH, 72H, 3DH
   \              723D        
   \   00000048   626C75652668       DC8 62H, 6CH, 75H, 65H, 26H, 68H, 6CH, 3DH
   \              6C3D        
   \   00000050   257320485454       DC8 25H, 73H, 20H, 48H, 54H, 54H, 50H, 2FH
   \              502F        
   \   00000058   312E310D0A48       DC8 31H, 2EH, 31H, 0DH, 0AH, 48H, 6FH, 73H
   \              6F73        
   \   00000060   743A20677073       DC8 74H, 3AH, 20H, 67H, 70H, 73H, 2EH, 73H
   \              2E73        
   \   00000068   742D68756E74       DC8 74H, 2DH, 68H, 75H, 6EH, 74H, 65H, 72H
   \              6572        
   \   00000070   2E72750D0A0D       DC8 2EH, 72H, 75H, 0DH, 0AH, 0DH, 0AH, 0
   \              0A00        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "%scache%f_%f\\\\map_%d_%...">`:
   \   00000000   257363616368       DC8 "%scache%f_%f\\map_%d_%d_%d_%d.png"
   \              6525665F2566
   \              5C6D61705F25
   \              645F25645F25
   \              645F25642E70
   \              6E6700      
   \   00000021   000000             DC8 0, 0, 0

   Maximum stack usage in bytes:

     Function       CSTACK
     --------       ------
     CreateRequest     64
     IP                28
     c                 80
     create_connect    36
     end_socket         8
     get_answer        28
     get_headersize    12
     send_req           8


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     IP                               84
     create_connect                  184
     send_req                        116
     end_socket                       60
     get_headersize                  116
     get_answer                      272
     CreateRequest                   492
     c                               208
     ??DataTable11                     4
     ??DataTable12                     4
     ??DataTable13                     4
     ??DataTable16                     4
     ??DataTable22                     4
     ??DataTable23                     4
     ??DataTable24                     4
     ??DataTable25                     4
     ??DataTable26                     4
     ??DataTable27                     4
     ??DataTable28                     4
     ??DataTable29                     4
     ??DataTable30                     4
     ??DataTable31                     4
     ?<Constant "%d.%d.%d.%d">        12
     ?<Constant "Content-Length:">    16
     ?<Constant "\r\n\r\n">            8
     ?<Constant "GET /maps/index.php?c...">
                                      48
     ?<Constant "GET /maps/index.php?l...">
                                      36
     ?<Constant "%s&my_latitude=%f&my_...">
                                      36
     ?<Constant "%s&zoom=%d&t=%s&frmt=...">
                                     120
     ?<Constant "%scache%f_%f\\map_%d_%...">
                                      36
      Others                         104

 
 1 692 bytes in segment CODE
   312 bytes in segment DATA_C
 
 1 588 bytes of CODE  memory (+ 104 bytes shared)
   312 bytes of CONST memory

Errors: none
Warnings: none
