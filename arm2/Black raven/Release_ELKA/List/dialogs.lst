##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    11/Aug/2009  13:41:02 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  C:\arm\Ballet Mini test\dialogs.c                    #
#    Command line    =  "C:\arm\Ballet Mini test\dialogs.c" -D NEWSGOLD -D   #
#                       ELKA -lC "C:\arm\Ballet Mini                         #
#                       test\Release_ELKA\List\" -o "C:\arm\Ballet Mini      #
#                       test\Release_ELKA\Obj\" -s9 --no_unroll --no_inline  #
#                       --cpu_mode arm --endian little --cpu ARM926EJ-S      #
#                       --stack_align 4 --interwork -e --char_is_signed      #
#                       --fpu None -I "C:\arm2\Embedded Workbench 4.0        #
#                       Evaluation\ARM\INC\"                                 #
#    List file       =  C:\arm\Ballet Mini test\Release_ELKA\List\dialogs.ls #
#                       t                                                    #
#    Object file     =  C:\arm\Ballet Mini test\Release_ELKA\Obj\dialogs.r79 #
#                                                                            #
#                                                                            #
##############################################################################

C:\arm\Ballet Mini test\dialogs.c
      1          #include "..\inc\swilib.h"
      2          #include "rect_patcher.h"

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_header(HEADER_DESC const *)
   \                     patch_header:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B000C4E1           STRH     R0,[R4, #+0]
   \   00000010   1800A0E3           MOV      R0,#+24
   \   00000014   B200C4E1           STRH     R0,[R4, #+2]
   \   00000018   888100EF           SWI      +33160
   \   0000001C   010040E2           SUB      R0,R0,#+1
   \   00000020   B400C4E1           STRH     R0,[R4, #+4]
   \   00000024   8A8100EF           SWI      +33162
   \   00000028   170080E2           ADD      R0,R0,#+23
   \   0000002C   B600C4E1           STRH     R0,[R4, #+6]
   \   00000030   1080BDE8           POP      {R4,PC}          ;; return

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_input(INPUTDIA_DESC const *)
   \                     patch_input:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B801C4E1           STRH     R0,[R4, #+24]
   \   00000010   8A8100EF           SWI      +33162
   \   00000014   190080E2           ADD      R0,R0,#+25
   \   00000018   BA01C4E1           STRH     R0,[R4, #+26]
   \   0000001C   888100EF           SWI      +33160
   \   00000020   010040E2           SUB      R0,R0,#+1
   \   00000024   BC01C4E1           STRH     R0,[R4, #+28]
   \   00000028   898100EF           SWI      +33161
   \   0000002C   0050A0E1           MOV      R5,R0
   \   00000030   8B8100EF           SWI      +33163
   \   00000034   000045E0           SUB      R0,R5,R0
   \   00000038   010040E2           SUB      R0,R0,#+1
   \   0000003C   BE01C4E1           STRH     R0,[R4, #+30]
   \   00000040   3080BDE8           POP      {R4,R5,PC}       ;; return
      3          WSHDR *ws_info;
      4          #include "main.h"
      5          //#include "debug.c"

   \                                 In segment DATA_C, align 4, align-sorted
      6          const char percent_t[]="%t";
   \                     percent_t:
   \   00000000   257400             DC8 "%t"
      7          const char percent_d[]="%d";
      8          const char percent_s[]="%s";
   \                     percent_s:
   \   00000003   257300             DC8 "%s"
   \   00000006   0000               DC8 0, 0
   \   00000008   D8E8F0E8EDE0       DC8 "\330\350\360\350\355\340: "
   \              3A2000      
   \   00000011   000000             DC8 0, 0, 0
   \   00000014   C2FBF1EEF2E0       DC8 "\302\373\361\356\362\340: "
   \              3A2000      
   \   0000001D   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     percent_d:
   \   00000000   256400             DC8 "%d"

   \                                 In segment DATA_C, align 4, align-sorted
      9          const char percent_ss[]="%s%s";
   \                     percent_ss:
   \   00000000   2573257300         DC8 "%s%s"
   \   00000005   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
     10          const char percent_td[]="%t%d";
   \                     percent_td:
   \   00000000   2574256400         DC8 "%t%d"
   \   00000005   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
     11          const char percent_x[]="%x";
   \                     percent_x:
   \   00000000   257800             DC8 "%x"

   \                                 In segment DATA_C, align 4, align-sorted
     12          const char percent_dd[]="%05d";
   \                     percent_dd:
   \   00000000   2530356400         DC8 "%05d"
   \   00000005   000000             DC8 0, 0, 0
     13          
     14          int type1 = 0;
     15          

   \                                 In segment CODE, align 4, keep-with-next
     16          int EditcontrolOnKey(GUI *data, GUI_MSG *msg)
     17          {
   \                     EditcontrolOnKey:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   34D04DE2           SUB      SP,SP,#+52
   \   00000008   0050A0E1           MOV      R5,R0
   \   0000000C   0160A0E1           MOV      R6,R1
     18            WSHDR *ws;
     19            ws = AllocWS(32);
   \   00000010   2000A0E3           MOV      R0,#+32
   \   00000014   250100EF           SWI      +293
   \   00000018   0040A0E1           MOV      R4,R0
     20            EDITCONTROL ec;
     21            char *tmpstr;
     22            if (msg->keys==0xFFF || msg->keys == 0x18)
   \   0000001C   F200D6E1           LDRSH    R0,[R6, #+2]
   \   00000020   FF10A0E3           MOV      R1,#+255
   \   00000024   F01E81E3           ORR      R1,R1,#0xF00
   \   00000028   010050E1           CMP      R0,R1
   \   0000002C   18005013           CMPNE    R0,#+24
   \   00000030   9000001A           BNE      ??EditcontrolOnKey_0
     23            {
     24              switch (type1)
   \   00000034   48029FE5           LDR      R0,??EditcontrolOnKey_1  ;; ws_info + 4
   \   00000038   48629FE5           LDR      R6,??EditcontrolOnKey_1+0x4  ;; percent_d
   \   0000003C   000090E5           LDR      R0,[R0, #+0]
   \   00000040   020050E2           SUBS     R0,R0,#+2
   \   00000044   0400000A           BEQ      ??EditcontrolOnKey_2
   \   00000048   010050E2           SUBS     R0,R0,#+1
   \   0000004C   1A00000A           BEQ      ??EditcontrolOnKey_3
   \   00000050   010050E2           SUBS     R0,R0,#+1
   \   00000054   2F00000A           BEQ      ??EditcontrolOnKey_4
   \   00000058   6B0000EA           B        ??EditcontrolOnKey_5
     25              {
     26                case 2:
     27                  {
     28                    ExtractEditControl(data,1,&ec);
   \                     ??EditcontrolOnKey_2:
   \   0000005C   08208DE2           ADD      R2,SP,#+8
   \   00000060   0110A0E3           MOV      R1,#+1
   \   00000064   0500A0E1           MOV      R0,R5
   \   00000068   690100EF           SWI      +361
     29                    tmpstr = malloc(32);
   \   0000006C   2000A0E3           MOV      R0,#+32
   \   00000070   140000EF           SWI      +20
     30                    wstrcpy(ws,ec.pWS);
   \   00000074   30109DE5           LDR      R1,[SP, #+48]
   \   00000078   0050A0E1           MOV      R5,R0
   \   0000007C   0400A0E1           MOV      R0,R4
   \   00000080   1F0100EF           SWI      +287
     31                    ws_2str(ws, tmpstr, 32);
   \   00000084   2020A0E3           MOV      R2,#+32
   \   00000088   0510A0E1           MOV      R1,R5
   \   0000008C   0400A0E1           MOV      R0,R4
   \   00000090   A30000EF           SWI      +163
     32                    int unit = 0;
   \   00000094   0010A0E3           MOV      R1,#+0
   \   00000098   00108DE5           STR      R1,[SP, #+0]
     33                    sscanf(tmpstr, percent_d, &unit);
   \   0000009C   0D20A0E1           MOV      R2,SP
   \   000000A0   0610A0E1           MOV      R1,R6
   \   000000A4   0500A0E1           MOV      R0,R5
   \   000000A8   F50100EF           SWI      +501
     34                    writeinit(unit, 1);
   \   000000AC   00009DE5           LDR      R0,[SP, #+0]
   \   000000B0   0110A0E3           MOV      R1,#+1
   \                     ??EditcontrolOnKey_6:
   \   000000B4   ........           _BLF     writeinit,??writeinit??rA
     35                    if(tmpstr) mfree(tmpstr);
   \   000000B8   630000EA           B        ??EditcontrolOnKey_7
     36                    break;
     37                  }
     38                case 3:
     39                  {
     40                    ExtractEditControl(data,1,&ec);
   \                     ??EditcontrolOnKey_3:
   \   000000BC   08208DE2           ADD      R2,SP,#+8
   \   000000C0   0110A0E3           MOV      R1,#+1
   \   000000C4   0500A0E1           MOV      R0,R5
   \   000000C8   690100EF           SWI      +361
     41                    tmpstr = malloc(32);
   \   000000CC   2000A0E3           MOV      R0,#+32
   \   000000D0   140000EF           SWI      +20
     42                    wstrcpy(ws,ec.pWS);
   \   000000D4   30109DE5           LDR      R1,[SP, #+48]
   \   000000D8   0050A0E1           MOV      R5,R0
   \   000000DC   0400A0E1           MOV      R0,R4
   \   000000E0   1F0100EF           SWI      +287
     43                    ws_2str(ws, tmpstr, 32);
   \   000000E4   2020A0E3           MOV      R2,#+32
   \   000000E8   0510A0E1           MOV      R1,R5
   \   000000EC   0400A0E1           MOV      R0,R4
   \   000000F0   A30000EF           SWI      +163
     44                    int unit = 0;
   \   000000F4   0010A0E3           MOV      R1,#+0
   \   000000F8   00108DE5           STR      R1,[SP, #+0]
     45                    sscanf(tmpstr, percent_d, &unit);
   \   000000FC   0D20A0E1           MOV      R2,SP
   \   00000100   0610A0E1           MOV      R1,R6
   \   00000104   0500A0E1           MOV      R0,R5
   \   00000108   F50100EF           SWI      +501
     46                    writeinit(unit, 2);
   \   0000010C   00009DE5           LDR      R0,[SP, #+0]
   \   00000110   0210A0E3           MOV      R1,#+2
   \   00000114   E6FFFFEA           B        ??EditcontrolOnKey_6
     47                    if(tmpstr) mfree(tmpstr);
     48                    break;
     49                  }
     50                  case 4:
     51                  {
     52                    char *xmap = malloc(32);
   \                     ??EditcontrolOnKey_4:
   \   00000118   2000A0E3           MOV      R0,#+32
   \   0000011C   140000EF           SWI      +20
   \   00000120   0070A0E1           MOV      R7,R0
     53                    char *ymap = malloc(32);
   \   00000124   2000A0E3           MOV      R0,#+32
   \   00000128   140000EF           SWI      +20
   \   0000012C   0080A0E1           MOV      R8,R0
     54                    int x1 = 0, y1 = 0;
   \   00000130   0010A0E3           MOV      R1,#+0
   \   00000134   00108DE5           STR      R1,[SP, #+0]
   \   00000138   04108DE5           STR      R1,[SP, #+4]
     55                    ExtractEditControl(data,2,&ec);
   \   0000013C   08208DE2           ADD      R2,SP,#+8
   \   00000140   0210A0E3           MOV      R1,#+2
   \   00000144   0500A0E1           MOV      R0,R5
   \   00000148   690100EF           SWI      +361
     56                    wstrcpy(ws,ec.pWS);
   \   0000014C   30109DE5           LDR      R1,[SP, #+48]
   \   00000150   0400A0E1           MOV      R0,R4
   \   00000154   1F0100EF           SWI      +287
     57                    ws_2str(ws, xmap, 32);
   \   00000158   2020A0E3           MOV      R2,#+32
   \   0000015C   0710A0E1           MOV      R1,R7
   \   00000160   0400A0E1           MOV      R0,R4
   \   00000164   A30000EF           SWI      +163
     58                    sscanf(xmap, percent_d, &x1);
   \   00000168   0D20A0E1           MOV      R2,SP
   \   0000016C   0610A0E1           MOV      R1,R6
   \   00000170   0700A0E1           MOV      R0,R7
   \   00000174   F50100EF           SWI      +501
     59                    CutWSTR(ws, 0);
   \   00000178   0010A0E3           MOV      R1,#+0
   \   0000017C   0400A0E1           MOV      R0,R4
   \   00000180   260100EF           SWI      +294
     60                    ExtractEditControl(data,4,&ec);
   \   00000184   08208DE2           ADD      R2,SP,#+8
   \   00000188   0410A0E3           MOV      R1,#+4
   \   0000018C   0500A0E1           MOV      R0,R5
   \   00000190   690100EF           SWI      +361
     61                    wstrcpy(ws,ec.pWS);
   \   00000194   30109DE5           LDR      R1,[SP, #+48]
   \   00000198   0400A0E1           MOV      R0,R4
   \   0000019C   1F0100EF           SWI      +287
     62                    ws_2str(ws, ymap, 32);
   \   000001A0   2020A0E3           MOV      R2,#+32
   \   000001A4   0810A0E1           MOV      R1,R8
   \   000001A8   0400A0E1           MOV      R0,R4
   \   000001AC   A30000EF           SWI      +163
     63                    sscanf(ymap, percent_d, &y1);
   \   000001B0   04208DE2           ADD      R2,SP,#+4
   \   000001B4   0610A0E1           MOV      R1,R6
   \   000001B8   0800A0E1           MOV      R0,R8
   \   000001BC   F50100EF           SWI      +501
     64                    if(x1 > 128) x1 = 128;
   \   000001C0   00009DE5           LDR      R0,[SP, #+0]
   \   000001C4   810050E3           CMP      R0,#+129
   \   000001C8   8010A0A3           MOVGE    R1,#+128
   \   000001CC   00108DA5           STRGE    R1,[SP, #+0]
     65                    if(y1 > 128) y1 = 128;
   \   000001D0   04009DE5           LDR      R0,[SP, #+4]
   \   000001D4   810050E3           CMP      R0,#+129
   \   000001D8   8010A0A3           MOVGE    R1,#+128
   \   000001DC   04108DA5           STRGE    R1,[SP, #+4]
     66                    changeSize(x1, y1);
   \   000001E0   04109DE5           LDR      R1,[SP, #+4]
   \   000001E4   00009DE5           LDR      R0,[SP, #+0]
   \   000001E8   ........           _BLF     changeSize,??changeSize??rA
     67                    if(xmap) mfree(xmap);
   \   000001EC   000057E3           CMP      R7,#+0
   \   000001F0   0100000A           BEQ      ??EditcontrolOnKey_8
   \   000001F4   0700A0E1           MOV      R0,R7
   \   000001F8   150000EF           SWI      +21
     68                    if(ymap) mfree(ymap);
   \                     ??EditcontrolOnKey_8:
   \   000001FC   000058E3           CMP      R8,#+0
   \   00000200   1500000A           BEQ      ??EditcontrolOnKey_9
   \   00000204   0800A0E1           MOV      R0,R8
   \   00000208   120000EA           B        ??EditcontrolOnKey_10
     69                    break;
     70                  }        
     71                case 1:
     72                default:
     73                  {
     74                    ExtractEditControl(data,1,&ec);
   \                     ??EditcontrolOnKey_5:
   \   0000020C   08208DE2           ADD      R2,SP,#+8
   \   00000210   0110A0E3           MOV      R1,#+1
   \   00000214   0500A0E1           MOV      R0,R5
   \   00000218   690100EF           SWI      +361
     75                    tmpstr = malloc(32);
   \   0000021C   2000A0E3           MOV      R0,#+32
   \   00000220   140000EF           SWI      +20
     76                    wstrcpy(ws,ec.pWS);
   \   00000224   30109DE5           LDR      R1,[SP, #+48]
   \   00000228   0050A0E1           MOV      R5,R0
   \   0000022C   0400A0E1           MOV      R0,R4
   \   00000230   1F0100EF           SWI      +287
     77                    ws_2str(ws, tmpstr, 32);
   \   00000234   2020A0E3           MOV      R2,#+32
   \   00000238   0510A0E1           MOV      R1,R5
   \   0000023C   0400A0E1           MOV      R0,R4
   \   00000240   A30000EF           SWI      +163
     78                    writemap(tmpstr);
   \   00000244   0500A0E1           MOV      R0,R5
   \   00000248   ........           _BLF     writemap,??writemap??rA
     79                    if(tmpstr) mfree(tmpstr);
   \                     ??EditcontrolOnKey_7:
   \   0000024C   000055E3           CMP      R5,#+0
   \   00000250   0100000A           BEQ      ??EditcontrolOnKey_9
   \   00000254   0500A0E1           MOV      R0,R5
   \                     ??EditcontrolOnKey_10:
   \   00000258   150000EF           SWI      +21
     80                    break;
     81                  }
     82              }
     83              if(ws) FreeWS(ws);
   \                     ??EditcontrolOnKey_9:
   \   0000025C   000054E3           CMP      R4,#+0
   \   00000260   0100000A           BEQ      ??EditcontrolOnKey_11
   \   00000264   0400A0E1           MOV      R0,R4
   \   00000268   290100EF           SWI      +297
     84              return 1;
   \                     ??EditcontrolOnKey_11:
   \   0000026C   0100A0E3           MOV      R0,#+1
   \   00000270   34D08DE2           ADD      SP,SP,#+52
   \   00000274   F081BDE8           POP      {R4-R8,PC}
     85            }
     86            return(0); // Возвращаем стандартные кнопки
   \                     ??EditcontrolOnKey_0:
   \   00000278   0000A0E3           MOV      R0,#+0
   \   0000027C   34D08DE2           ADD      SP,SP,#+52
   \   00000280   F081BDE8           POP      {R4-R8,PC}       ;; return
   \                     ??EditcontrolOnKey_1:
   \   00000284   ........           DC32     ws_info + 4
   \   00000288   ........           DC32     percent_d
     87          }
     88          

   \                                 In segment CODE, align 4, keep-with-next
     89          void EditcontrolGHook(GUI *data, int cmd)
     90          {
   \                     EditcontrolGHook:
   \   00000000   10402DE9           PUSH     {R4,LR}
     91            //EDITCONTROL ec;
     92            static SOFTKEY_DESC sk={0x0FFF,0x0000,(int)"OK"};
     93            if(cmd==0xA)
   \   00000004   0A0051E3           CMP      R1,#+10
   \   00000008   0100001A           BNE      ??EditcontrolGHook_0
     94            {
     95              DisableIDLETMR();   // Отключаем таймер выхода по таймауту
   \   0000000C   7F0100EF           SWI      +383
   \   00000010   1080BDE8           POP      {R4,PC}
     96            }
     97            if(cmd==0x03)     // При закрытии меню
   \                     ??EditcontrolGHook_0:
   \   00000014   ........           LDR      R4,??DataTable1  ;; ws_info
   \   00000018   030051E3           CMP      R1,#+3
   \   0000001C   0400001A           BNE      ??EditcontrolGHook_1
     98            {
     99              FreeWS(ws_info);
   \   00000020   000094E5           LDR      R0,[R4, #+0]
   \   00000024   290100EF           SWI      +297
    100              ws_info = NULL;
   \   00000028   0000A0E3           MOV      R0,#+0
   \   0000002C   000084E5           STR      R0,[R4, #+0]
   \   00000030   1080BDE8           POP      {R4,PC}
    101            }
    102            if (cmd==7)
   \                     ??EditcontrolGHook_1:
   \   00000034   070051E3           CMP      R1,#+7
   \   00000038   1080BD18           POPNE    {R4,PC}
    103            {
    104              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000003C   0020A0E3           MOV      R2,#+0
   \   00000040   081084E2           ADD      R1,R4,#+8
   \   00000044   680100EF           SWI      +360
    105            }
    106          }
   \   00000048   1080BDE8           POP      {R4,PC}          ;; return
    107          

   \                                 In segment CODE, align 4, keep-with-next
    108          void edchat_locret(void){}
   \                     edchat_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return

   \                                 In segment DATA_I, align 4, align-sorted
   \                     ws_info:
   \   00000000                      DS8 4
   \   00000004                      REQUIRE `?<Initializer for ws_info>`
   \                     type1:
   \   00000004                      DS8 4
   \   00000008                      REQUIRE `?<Initializer for type1>`
   \   00000008                      DS8 8
   \   00000010                      REQUIRE `?<Initializer for sk>`
    109          
    110          SOFTKEY_DESC fmenu_sk[]=
    111          {
    112            {0x0018,0x0000,(int)"Выбор"},
    113            {0x0001,0x0000,(int)"Закрыть"},
    114            {0x003D,0x0000,(int)LGP_DOIT_PIC}
    115          };
    116          
    117          SOFTKEYSTAB fmenu_skt=
    118          {
    119            fmenu_sk,0
    120          };
    121          
    122          INPUTDIA_DESC EditcontrolStruct=
   \                     EditcontrolStruct:
   \   00000010                      DS8 56
   \   00000048                      REQUIRE `?<Initializer for EditcontrolStruct>`
    123          {
    124            1,
    125            EditcontrolOnKey,
    126            EditcontrolGHook,
    127            (void *)edchat_locret,
    128            0,
    129            &fmenu_skt,
    130            {0,22,131,153},
    131            4, 100, 101, 0, 0,
    132            0x40000000// Поменять софт-кнопки
    133          };
    134          
    135          HEADER_DESC FilenameHeader={0,0,0,0,NULL,(int)"Имя файла",LGP_NULL};
   \                     FilenameHeader:
   \   00000048                      DS8 20
   \   0000005C                      REQUIRE `?<Initializer for FilenameHeader>`
    136          HEADER_DESC GoldHeader={0,0,0,0,NULL,(int)"Золото",LGP_NULL};
   \                     GoldHeader:
   \   0000005C                      DS8 20
   \   00000070                      REQUIRE `?<Initializer for GoldHeader>`
    137          HEADER_DESC WoodHeader={0,0,0,0,NULL,(int)"Лес",LGP_NULL};
   \                     WoodHeader:
   \   00000070                      DS8 20
   \   00000084                      REQUIRE `?<Initializer for WoodHeader>`
    138          HEADER_DESC SizeHeader={0,0,0,0,NULL,(int)"Размер карты",LGP_NULL};
   \                     SizeHeader:
   \   00000084                      DS8 20
   \   00000098                      REQUIRE `?<Initializer for SizeHeader>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     fmenu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for fmenu_sk>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     fmenu_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for fmenu_skt>`
    139          

   \                                 In segment CODE, align 4, keep-with-next
    140          void DoEditcontrol(int type, char *deftext, char *def2)
    141          {
   \                     DoEditcontrol:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
    142            type1 = type;
   \   00000004   ........           LDR      R4,??DataTable1  ;; ws_info
    143            char *text = malloc(256);
    144            ws_info = AllocWS(256);
    145            EDITCONTROL ec;
    146            void *ma=malloc_adr();
    147            void *eq;
    148            PrepareEditControl(&ec);
    149            eq=AllocEQueue(ma,mfree_adr());
    150            switch (type)
   \   00000008   E0829FE5           LDR      R8,??DoEditcontrol_0  ;; percent_t
   \   0000000C   2CD04DE2           SUB      SP,SP,#+44
   \   00000010   0090A0E1           MOV      R9,R0
   \   00000014   01A0A0E1           MOV      R10,R1
   \   00000018   0270A0E1           MOV      R7,R2
   \   0000001C   049084E5           STR      R9,[R4, #+4]
   \   00000020   400FA0E3           MOV      R0,#+256
   \   00000024   140000EF           SWI      +20
   \   00000028   400FA0E3           MOV      R0,#+256
   \   0000002C   250100EF           SWI      +293
   \   00000030   000084E5           STR      R0,[R4, #+0]
   \   00000034   148000EF           SWI      +32788
   \   00000038   0060A0E1           MOV      R6,R0
   \   0000003C   0D00A0E1           MOV      R0,SP
   \   00000040   640100EF           SWI      +356
   \   00000044   158000EF           SWI      +32789
   \   00000048   0010A0E1           MOV      R1,R0
   \   0000004C   0600A0E1           MOV      R0,R6
   \   00000050   630100EF           SWI      +355
   \   00000054   0050A0E1           MOV      R5,R0
   \   00000058   029059E2           SUBS     R9,R9,#+2
   \   0000005C   0400000A           BEQ      ??DoEditcontrol_1
   \   00000060   019059E2           SUBS     R9,R9,#+1
   \   00000064   1B00000A           BEQ      ??DoEditcontrol_2
   \   00000068   019059E2           SUBS     R9,R9,#+1
   \   0000006C   3200000A           BEQ      ??DoEditcontrol_3
   \   00000070   810000EA           B        ??DoEditcontrol_4
    151            {
    152              case 2:
    153                {
    154                  // Золото
    155                  wsprintf(ws_info, percent_s,deftext);
   \                     ??DoEditcontrol_1:
   \   00000074   000094E5           LDR      R0,[R4, #+0]
   \   00000078   0A20A0E1           MOV      R2,R10
   \   0000007C   031088E2           ADD      R1,R8,#+3
   \   00000080   240100EF           SWI      +292
    156                  ConstructEditControl(&ec,2,0x40,ws_info,6); // 1
   \   00000084   0600A0E3           MOV      R0,#+6
   \   00000088   01002DE9           PUSH     {R0}
   \   0000008C   003094E5           LDR      R3,[R4, #+0]
   \   00000090   4020A0E3           MOV      R2,#+64
   \   00000094   0210A0E3           MOV      R1,#+2
   \   00000098   04008DE2           ADD      R0,SP,#+4
   \   0000009C   650100EF           SWI      +357
    157                  AddEditControlToEditQend(eq,&ec,ma);
   \   000000A0   0620A0E1           MOV      R2,R6
   \   000000A4   04108DE2           ADD      R1,SP,#+4
   \   000000A8   0500A0E1           MOV      R0,R5
   \   000000AC   660100EF           SWI      +358
    158                  patch_header(&GoldHeader);
   \   000000B0   5C0084E2           ADD      R0,R4,#+92
   \   000000B4   ........           _BLF     patch_header,??patch_header??rA
    159                  patch_input(&EditcontrolStruct);
   \   000000B8   100084E2           ADD      R0,R4,#+16
   \   000000BC   ........           _BLF     patch_input,??patch_input??rA
    160                  CreateInputTextDialog(&EditcontrolStruct,&GoldHeader,eq,1,0);
   \   000000C0   0000A0E3           MOV      R0,#+0
   \   000000C4   01002DE9           PUSH     {R0}
   \   000000C8   0130A0E3           MOV      R3,#+1
   \   000000CC   0520A0E1           MOV      R2,R5
   \   000000D0   5C1084E2           ADD      R1,R4,#+92
   \   000000D4   800000EA           B        ??DoEditcontrol_5
    161                  break;
    162                }
    163              case 3:
    164                {
    165                  // Лес
    166                  wsprintf(ws_info, percent_s,deftext);
   \                     ??DoEditcontrol_2:
   \   000000D8   000094E5           LDR      R0,[R4, #+0]
   \   000000DC   0A20A0E1           MOV      R2,R10
   \   000000E0   031088E2           ADD      R1,R8,#+3
   \   000000E4   240100EF           SWI      +292
    167                  ConstructEditControl(&ec,2,0x40,ws_info,6); // 1
   \   000000E8   0600A0E3           MOV      R0,#+6
   \   000000EC   01002DE9           PUSH     {R0}
   \   000000F0   003094E5           LDR      R3,[R4, #+0]
   \   000000F4   4020A0E3           MOV      R2,#+64
   \   000000F8   0210A0E3           MOV      R1,#+2
   \   000000FC   04008DE2           ADD      R0,SP,#+4
   \   00000100   650100EF           SWI      +357
    168                  AddEditControlToEditQend(eq,&ec,ma);
   \   00000104   0620A0E1           MOV      R2,R6
   \   00000108   04108DE2           ADD      R1,SP,#+4
   \   0000010C   0500A0E1           MOV      R0,R5
   \   00000110   660100EF           SWI      +358
    169                  patch_header(&WoodHeader);
   \   00000114   700084E2           ADD      R0,R4,#+112
   \   00000118   ........           _BLF     patch_header,??patch_header??rA
    170                  patch_input(&EditcontrolStruct);
   \   0000011C   100084E2           ADD      R0,R4,#+16
   \   00000120   ........           _BLF     patch_input,??patch_input??rA
    171                  CreateInputTextDialog(&EditcontrolStruct,&WoodHeader,eq,1,0);
   \   00000124   0000A0E3           MOV      R0,#+0
   \   00000128   01002DE9           PUSH     {R0}
   \   0000012C   0130A0E3           MOV      R3,#+1
   \   00000130   0520A0E1           MOV      R2,R5
   \   00000134   701084E2           ADD      R1,R4,#+112
   \   00000138   670000EA           B        ??DoEditcontrol_5
    172                  break;
    173                }
    174              case 4:
    175                {
    176                  // Размер карты
    177                  wsprintf(ws_info, percent_t,"Ширина: ");
   \                     ??DoEditcontrol_3:
   \   0000013C   000094E5           LDR      R0,[R4, #+0]
   \   00000140   082088E2           ADD      R2,R8,#+8
   \   00000144   0810A0E1           MOV      R1,R8
   \   00000148   240100EF           SWI      +292
    178                  ConstructEditControl(&ec,1,0x00,ws_info,256); // 1 
   \   0000014C   400FA0E3           MOV      R0,#+256
   \   00000150   01002DE9           PUSH     {R0}
   \   00000154   003094E5           LDR      R3,[R4, #+0]
   \   00000158   0020A0E3           MOV      R2,#+0
   \   0000015C   0110A0E3           MOV      R1,#+1
   \   00000160   04008DE2           ADD      R0,SP,#+4
   \   00000164   650100EF           SWI      +357
    179                  AddEditControlToEditQend(eq,&ec,ma); 
   \   00000168   0620A0E1           MOV      R2,R6
   \   0000016C   04108DE2           ADD      R1,SP,#+4
   \   00000170   0500A0E1           MOV      R0,R5
   \   00000174   660100EF           SWI      +358
    180          
    181                  CutWSTR(ws_info,0);
   \   00000178   000094E5           LDR      R0,[R4, #+0]
   \   0000017C   0010A0E3           MOV      R1,#+0
   \   00000180   260100EF           SWI      +294
    182                  wsprintf(ws_info, percent_s,deftext);
   \   00000184   000094E5           LDR      R0,[R4, #+0]
   \   00000188   0A20A0E1           MOV      R2,R10
   \   0000018C   031088E2           ADD      R1,R8,#+3
   \   00000190   240100EF           SWI      +292
    183                  ConstructEditControl(&ec,2,0x40,ws_info,3); // 2
   \   00000194   0300A0E3           MOV      R0,#+3
   \   00000198   01002DE9           PUSH     {R0}
   \   0000019C   003094E5           LDR      R3,[R4, #+0]
   \   000001A0   4020A0E3           MOV      R2,#+64
   \   000001A4   0210A0E3           MOV      R1,#+2
   \   000001A8   08008DE2           ADD      R0,SP,#+8
   \   000001AC   650100EF           SWI      +357
    184                  AddEditControlToEditQend(eq,&ec,ma);
   \   000001B0   0620A0E1           MOV      R2,R6
   \   000001B4   08108DE2           ADD      R1,SP,#+8
   \   000001B8   0500A0E1           MOV      R0,R5
   \   000001BC   660100EF           SWI      +358
    185                  
    186                  wsprintf(ws_info, percent_t,"Высота: ");
   \   000001C0   000094E5           LDR      R0,[R4, #+0]
   \   000001C4   142088E2           ADD      R2,R8,#+20
   \   000001C8   0810A0E1           MOV      R1,R8
   \   000001CC   240100EF           SWI      +292
    187                  ConstructEditControl(&ec,1,0x00,ws_info,256); // 3 
   \   000001D0   400FA0E3           MOV      R0,#+256
   \   000001D4   01002DE9           PUSH     {R0}
   \   000001D8   003094E5           LDR      R3,[R4, #+0]
   \   000001DC   0020A0E3           MOV      R2,#+0
   \   000001E0   0110A0E3           MOV      R1,#+1
   \   000001E4   0C008DE2           ADD      R0,SP,#+12
   \   000001E8   650100EF           SWI      +357
    188                  AddEditControlToEditQend(eq,&ec,ma); 
   \   000001EC   0620A0E1           MOV      R2,R6
   \   000001F0   0C108DE2           ADD      R1,SP,#+12
   \   000001F4   0500A0E1           MOV      R0,R5
   \   000001F8   660100EF           SWI      +358
    189          
    190                  CutWSTR(ws_info,0);
   \   000001FC   000094E5           LDR      R0,[R4, #+0]
   \   00000200   0010A0E3           MOV      R1,#+0
   \   00000204   260100EF           SWI      +294
    191                  wsprintf(ws_info, percent_s,def2);
   \   00000208   000094E5           LDR      R0,[R4, #+0]
   \   0000020C   0720A0E1           MOV      R2,R7
   \   00000210   031088E2           ADD      R1,R8,#+3
   \   00000214   240100EF           SWI      +292
    192                  ConstructEditControl(&ec,2,0x40,ws_info,3); // 4
   \   00000218   0300A0E3           MOV      R0,#+3
   \   0000021C   01002DE9           PUSH     {R0}
   \   00000220   003094E5           LDR      R3,[R4, #+0]
   \   00000224   4020A0E3           MOV      R2,#+64
   \   00000228   0210A0E3           MOV      R1,#+2
   \   0000022C   10008DE2           ADD      R0,SP,#+16
   \   00000230   650100EF           SWI      +357
    193                  AddEditControlToEditQend(eq,&ec,ma);
   \   00000234   0620A0E1           MOV      R2,R6
   \   00000238   10108DE2           ADD      R1,SP,#+16
   \   0000023C   0500A0E1           MOV      R0,R5
   \   00000240   660100EF           SWI      +358
    194                  
    195                  patch_header(&SizeHeader);
   \   00000244   840084E2           ADD      R0,R4,#+132
   \   00000248   ........           _BLF     patch_header,??patch_header??rA
    196                  patch_input(&EditcontrolStruct);
   \   0000024C   100084E2           ADD      R0,R4,#+16
   \   00000250   ........           _BLF     patch_input,??patch_input??rA
    197                  CreateInputTextDialog(&EditcontrolStruct,&SizeHeader,eq,1,0);
   \   00000254   0000A0E3           MOV      R0,#+0
   \   00000258   01002DE9           PUSH     {R0}
   \   0000025C   0130A0E3           MOV      R3,#+1
   \   00000260   0520A0E1           MOV      R2,R5
   \   00000264   841084E2           ADD      R1,R4,#+132
   \   00000268   100084E2           ADD      R0,R4,#+16
   \   0000026C   670100EF           SWI      +359
    198                  break;
   \   00000270   14D08DE2           ADD      SP,SP,#+20
   \   00000274   2CD08DE2           ADD      SP,SP,#+44
   \   00000278   F087BDE8           POP      {R4-R10,PC}
    199                }
    200              case 1:
    201              default:
    202                {
    203                  // Имя файла
    204                  wsprintf(ws_info, percent_s,deftext);
   \                     ??DoEditcontrol_4:
   \   0000027C   000094E5           LDR      R0,[R4, #+0]
   \   00000280   0A20A0E1           MOV      R2,R10
   \   00000284   031088E2           ADD      R1,R8,#+3
   \   00000288   240100EF           SWI      +292
    205                  ConstructEditControl(&ec,3,0x40,ws_info,256); // 1
   \   0000028C   400FA0E3           MOV      R0,#+256
   \   00000290   01002DE9           PUSH     {R0}
   \   00000294   003094E5           LDR      R3,[R4, #+0]
   \   00000298   4020A0E3           MOV      R2,#+64
   \   0000029C   0310A0E3           MOV      R1,#+3
   \   000002A0   04008DE2           ADD      R0,SP,#+4
   \   000002A4   650100EF           SWI      +357
    206                  AddEditControlToEditQend(eq,&ec,ma);
   \   000002A8   0620A0E1           MOV      R2,R6
   \   000002AC   04108DE2           ADD      R1,SP,#+4
   \   000002B0   0500A0E1           MOV      R0,R5
   \   000002B4   660100EF           SWI      +358
    207                  patch_header(&FilenameHeader);
   \   000002B8   480084E2           ADD      R0,R4,#+72
   \   000002BC   ........           _BLF     patch_header,??patch_header??rA
    208                  patch_input(&EditcontrolStruct);
   \   000002C0   100084E2           ADD      R0,R4,#+16
   \   000002C4   ........           _BLF     patch_input,??patch_input??rA
    209                  CreateInputTextDialog(&EditcontrolStruct,&FilenameHeader,eq,1,0);
   \   000002C8   0000A0E3           MOV      R0,#+0
   \   000002CC   01002DE9           PUSH     {R0}
   \   000002D0   0130A0E3           MOV      R3,#+1
   \   000002D4   0520A0E1           MOV      R2,R5
   \   000002D8   481084E2           ADD      R1,R4,#+72
   \                     ??DoEditcontrol_5:
   \   000002DC   100084E2           ADD      R0,R4,#+16
   \   000002E0   670100EF           SWI      +359
    210                  break;
   \   000002E4   08D08DE2           ADD      SP,SP,#+8
    211                }
    212            }
    213          }
   \   000002E8   2CD08DE2           ADD      SP,SP,#+44
   \   000002EC   F087BDE8           POP      {R4-R10,PC}      ;; return
   \                     ??DoEditcontrol_0:
   \   000002F0   ........           DC32     percent_t

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable1:
   \   00000000   ........           DC32     ws_info

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for ws_info>`:
   \   00000000   00000000           DC8 0, 0, 0, 0
   \                     `?<Initializer for type1>`:
   \   00000004   00000000           DC32 0
   \                     `?<Initializer for sk>`:
   \   00000008   FF0F0000           DC16 4095, 0
   \   0000000C   ........           DC32 `?<Constant "OK">`
   \                     `?<Initializer for EditcontrolStruct>`:
   \   00000010   01000000....       DC32 1, EditcontrolOnKey, EditcontrolGHook, edchat_locret, 0, fmenu_skt
   \              ............
   \              ........0000
   \              0000........
   \   00000028   000016008300       DC16 0, 22, 131, 153
   \              9900        
   \   00000030   040000006400       DC32 4, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   \                     `?<Initializer for FilenameHeader>`:
   \   00000048   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000050   00000000....       DC32 0H, `?<Constant "\\310\\354\\377 \\364\\340\\351\\353\\340"`
   \              ....        
   \   00000058   FFFFFF7F           DC32 2147483647
   \                     `?<Initializer for GoldHeader>`:
   \   0000005C   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000064   00000000....       DC32 0H, `?<Constant "\\307\\356\\353\\356\\362\\356">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for WoodHeader>`:
   \   00000070   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000078   00000000....       DC32 0H, `?<Constant "\\313\\345\\361">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for SizeHeader>`:
   \   00000084   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   0000008C   00000000....       DC32 0H, `?<Constant "\\320\\340\\347\\354\\345\\360 \\352\\340\\`
   \              ....        
   \   00000094   FFFFFF7F           DC32 2147483647

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for fmenu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "\\302\\373\\341\\356\\360">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "\\307\\340\\352\\360\\373\\362\\374">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for fmenu_skt>`:
   \   00000000   ........0000       DC32 fmenu_sk, 0
   \              0000        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\302\\373\\341\\356\\360">`:
   \   00000000   C2FBE1EEF000       DC8 "\302\373\341\356\360"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\307\\340\\352\\360\\373\\362\\374">`:
   \   00000000   C7E0EAF0FBF2       DC8 "\307\340\352\360\373\362\374"
   \              FC00        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\310\\354\\377 \\364\\340\\351\\353\\340"`:
   \   00000000   C8ECFF20F4E0       DC8 "\310\354\377 \364\340\351\353\340"
   \              E9EBE000    
   \   0000000A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\307\\356\\353\\356\\362\\356">`:
   \   00000000   C7EEEBEEF2EE       DC8 "\307\356\353\356\362\356"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\313\\345\\361">`:
   \   00000000   CBE5F100           DC8 "\313\345\361"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\320\\340\\347\\354\\345\\360 \\352\\340\\`:
   \   00000000   D0E0E7ECE5F0       DC8 "\320\340\347\354\345\360 \352\340\360\362\373"
   \              20EAE0F0F2FB
   \              00          
   \   0000000D   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     `?<Constant "OK">`:
   \   00000000   4F4B00             DC8 "OK"

   Maximum stack usage in bytes:

     Function         CSTACK
     --------         ------
     DoEditcontrol       96
     EditcontrolGHook     8
     EditcontrolOnKey    76
     edchat_locret        0
     patch_header         8
     patch_input         12


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     patch_header                     52
     patch_input                      68
     percent_t                        32
     percent_d                         3
     percent_ss                        8
     percent_td                        8
     percent_x                         3
     percent_dd                        8
     EditcontrolOnKey                652
     EditcontrolGHook                 76
     edchat_locret                     4
     ws_info                         152
     fmenu_sk                         24
     fmenu_skt                         8
     DoEditcontrol                   756
     ??DataTable1                      4
     ?<Initializer for ws_info>      152
     ?<Initializer for fmenu_sk>      24
     ?<Initializer for fmenu_skt>      8
     ?<Constant "\302\373\341\356\360">
                                       8
     ?<Constant "\307\340\352\360\373\362\374">
                                       8
     ?<Constant "\310\354\377 \364\340\351\353\340"
                                      12
     ?<Constant "\307\356\353\356\362\356">
                                       8
     ?<Constant "\313\345\361">        4
     ?<Constant "\320\340\347\354\345\360 \352\340\
                                      16
     ?<Constant "OK">                  3
      Others                          88

 
 1 688 bytes in segment CODE
   121 bytes in segment DATA_C
   184 bytes in segment DATA_I
   184 bytes in segment DATA_ID
    12 bytes in segment INITTAB
 
 1 492 bytes of CODE  memory (+ 208 bytes shared)
   305 bytes of CONST memory
   184 bytes of DATA  memory

Errors: none
Warnings: none
