##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    27/Dec/2010  18:19:59 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  C:\arm\BalletMini\display_utils.c                    #
#    Command line    =  C:\arm\BalletMini\display_utils.c -D NEWSGOLD -D     #
#                       ELKA -lC C:\arm\BalletMini\Release_ELKA\List\ -o     #
#                       C:\arm\BalletMini\Release_ELKA\Obj\ -s9 --no_unroll  #
#                       --no_inline --cpu_mode arm --endian little --cpu     #
#                       ARM926EJ-S --stack_align 4 --interwork -e --fpu      #
#                       None --dlib_config "C:\arm2\Embedded Workbench 4.0   #
#                       Evaluation\ARM\LIB\dl5tpainl8n.h" -I                 #
#                       "C:\arm2\Embedded Workbench 4.0 Evaluation\ARM\INC\" #
#    List file       =  C:\arm\BalletMini\Release_ELKA\List\display_utils.ls #
#                       t                                                    #
#    Object file     =  C:\arm\BalletMini\Release_ELKA\Obj\display_utils.r79 #
#                                                                            #
#                                                                            #
##############################################################################

C:\arm\BalletMini\display_utils.c
      1          #include "../inc/swilib.h"
      2          #include "view.h"
      3          #include "display_utils.h"
      4          #include "siemens_unicode.h"
      5          #include "string_works.h"
      6          #include "rect_patcher.h" 

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_header(HEADER_DESC const *)
   \                     patch_header:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B000C4E1           STRH     R0,[R4, #+0]
   \   00000010   1800A0E3           MOV      R0,#+24
   \   00000014   B200C4E1           STRH     R0,[R4, #+2]
   \   00000018   888100EF           SWI      +33160
   \   0000001C   010040E2           SUB      R0,R0,#+1
   \   00000020   B400C4E1           STRH     R0,[R4, #+4]
   \   00000024   8A8100EF           SWI      +33162
   \   00000028   170080E2           ADD      R0,R0,#+23
   \   0000002C   B600C4E1           STRH     R0,[R4, #+6]
   \   00000030   1080BDE8           POP      {R4,PC}          ;; return

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_input(INPUTDIA_DESC const *)
   \                     patch_input:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B801C4E1           STRH     R0,[R4, #+24]
   \   00000010   8A8100EF           SWI      +33162
   \   00000014   190080E2           ADD      R0,R0,#+25
   \   00000018   BA01C4E1           STRH     R0,[R4, #+26]
   \   0000001C   888100EF           SWI      +33160
   \   00000020   010040E2           SUB      R0,R0,#+1
   \   00000024   BC01C4E1           STRH     R0,[R4, #+28]
   \   00000028   898100EF           SWI      +33161
   \   0000002C   0050A0E1           MOV      R5,R0
   \   00000030   8B8100EF           SWI      +33163
   \   00000034   000045E0           SUB      R0,R5,R0
   \   00000038   010040E2           SUB      R0,R0,#+1
   \   0000003C   BE01C4E1           STRH     R0,[R4, #+30]
   \   00000040   3080BDE8           POP      {R4,R5,PC}       ;; return
      7          #include "main.h"
      8          #include "file_works.h"
      9          #include "urlstack.h"
     10          #include "lang.h"
     11          
     12          extern int maincsm_id;
     13          
     14          extern const int scr_shift;
     15          extern const int word_wrap;
     16          
     17          extern const int cfgPwdNormalText;
     18          extern const int cfgShowCharCounter;
     19          extern const char cfgCursorColor[4];
     20          extern const char cfgCursorColorPictures[4];
     21          extern const int cfgInvertCursor;
     22          
     23          extern WSHDR *search_string;
     24          extern int search_isCaseSens;
     25          

   \                                 In segment CODE, align 4, keep-with-next
     26          int GetFontHeight(int font, int atribute)
     27          {
   \                     GetFontHeight:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0140A0E1           MOV      R4,R1
     28            int height=GetFontYSIZE(font);
   \   00000008   C50100EF           SWI      +453
     29            if (atribute&TEXT_INVERT)   height+=1;
   \   0000000C   100014E3           TST      R4,#0x10
   \   00000010   01008012           ADDNE    R0,R0,#+1
     30            if (atribute&TEXT_UNDERLINE)   height+=1;
   \   00000014   080014E3           TST      R4,#0x8
   \   00000018   01008012           ADDNE    R0,R0,#+1
     31            if (atribute&TEXT_OUTLINE)  height+=2;
   \   0000001C   200014E3           TST      R4,#0x20
   \   00000020   02008012           ADDNE    R0,R0,#+2
     32            return height;
   \   00000024   1080BDE8           POP      {R4,PC}          ;; return
     33          }
     34          

   \                                 In segment CODE, align 4, keep-with-next
     35          int GetSymbolBitmapWidth(VIEWDATA *vd, int wchar,int font)
     36          {
   \                     GetSymbolBitmapWidth:
   \   00000000   00402DE9           PUSH     {LR}
   \   00000004   0130A0E1           MOV      R3,R1
   \   00000008   0210A0E1           MOV      R1,R2
     37            if ((wchar&0xFF00)==0xE100)
   \   0000000C   FF2C03E2           AND      R2,R3,#0xFF00
   \   00000010   E10C52E3           CMP      R2,#+57600
   \   00000014   0800001A           BNE      ??GetSymbolBitmapWidth_0
     38            {
     39              OMS_DYNPNGLIST *dpl = vd->dynpng_list;
   \   00000018   780090E5           LDR      R0,[R0, #+120]
     40              do
     41              {
     42                if (dpl->w_char == wchar)
   \                     ??GetSymbolBitmapWidth_1:
   \   0000001C   0C2090E5           LDR      R2,[R0, #+12]
   \   00000020   030052E1           CMP      R2,R3
     43                {
     44                  return (dpl->dp.img)->w;
   \   00000024   08009005           LDREQ    R0,[R0, #+8]
   \   00000028   B000D001           LDRHEQ   R0,[R0, #+0]
   \   0000002C   0080BD08           POPEQ    {PC}
     45                }
     46              }
     47              while(dpl=dpl->dp.next);
   \   00000030   000090E5           LDR      R0,[R0, #+0]
   \   00000034   000050E3           CMP      R0,#+0
   \   00000038   F7FFFF1A           BNE      ??GetSymbolBitmapWidth_1
     48            }
     49            return GetSymbolWidth(wchar,font);
   \                     ??GetSymbolBitmapWidth_0:
   \   0000003C   0300A0E1           MOV      R0,R3
   \   00000040   E10100EF           SWI      +481
   \   00000044   0080BDE8           POP      {PC}             ;; return
     50          }
     51          

   \                                 In segment CODE, align 4, keep-with-next
     52          int GetBitmapHeight(VIEWDATA *vd, int wchar)
     53          {
   \                     GetBitmapHeight:
   \   00000000   00402DE9           PUSH     {LR}
     54            OMS_DYNPNGLIST *dpl = vd->dynpng_list;
   \   00000004   780090E5           LDR      R0,[R0, #+120]
     55            do
     56            {
     57              if (dpl->w_char == wchar)
   \                     ??GetBitmapHeight_0:
   \   00000008   0C2090E5           LDR      R2,[R0, #+12]
   \   0000000C   010052E1           CMP      R2,R1
     58              {
     59                return (dpl->dp.img)->h;
   \   00000010   08009005           LDREQ    R0,[R0, #+8]
   \   00000014   B200D001           LDRHEQ   R0,[R0, #+2]
   \   00000018   0080BD08           POPEQ    {PC}
     60              }
     61            }
     62            while(dpl=dpl->dp.next);
   \   0000001C   000090E5           LDR      R0,[R0, #+0]
   \   00000020   000050E3           CMP      R0,#+0
   \   00000024   F7FFFF1A           BNE      ??GetBitmapHeight_0
     63            return GetImgHeight(GetPicNByUnicodeSymbol(wchar));;
   \   00000028   0100A0E1           MOV      R0,R1
   \   0000002C   E40100EF           SWI      +484
   \   00000030   210000EF           SWI      +33
   \   00000034   0080BDE8           POP      {PC}             ;; return
     64          }
     65          

   \                                 In segment CODE, align 4, keep-with-next
     66          unsigned int SearchNextDisplayLine(VIEWDATA *vd, LINECACHE *p/*, unsigned int *max_h*/)
     67          {
   \                     SearchNextDisplayLine:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
     68            int scrW = ScreenW()-MARGIN;
     69            int left=scrW;
     70            int c,h,cw,f=0;
   \   0000000C   0070A0E3           MOV      R7,#+0
   \   00000010   888100EF           SWI      +33160
   \   00000014   048040E2           SUB      R8,R0,#+4
     71            p->centerAtAll=0;
   \   00000018   BC00D5E1           LDRH     R0,[R5, #+12]
   \   0000001C   DF10A0E3           MOV      R1,#+223
   \   00000020   FF1C81E3           ORR      R1,R1,#0xFF00
   \   00000024   000001E0           AND      R0,R1,R0
   \   00000028   BC00C5E1           STRH     R0,[R5, #+12]
     72            p->pixheight=0;
   \   0000002C   0000A0E3           MOV      R0,#+0
   \   00000030   BE00C5E1           STRH     R0,[R5, #+14]
     73            p->pos=vd->lines_cache_pos;
   \   00000034   180094E5           LDR      R0,[R4, #+24]
   \   00000038   0860A0E1           MOV      R6,R8
   \   0000003C   000085E5           STR      R0,[R5, #+0]
   \   00000040   010000EA           B        ??SearchNextDisplayLine_0
     74            while(p->pos<vd->rawtext_size)
     75            {
     76              c=vd->rawtext[p->pos++];
     77              if ((c&0xFF00)==0xE100)
     78              {
     79                
     80                h=GetBitmapHeight(vd,c);
     81              }
     82              else
     83              {
     84                h=GetFontHeight(p->bold?FONT_SMALL_BOLD:FONT_SMALL,p->underline?TEXT_UNDERLINE:0+p->ref?TEXT_INVERT:0);
     85              }
     86              switch(c)
     87              {
     88              case UTF16_NEWLINE:
     89                f=1;
     90                h=0;
     91                break;
     92              case UTF16_ENA_CENTER:
     93                p->center=1;
   \                     ??SearchNextDisplayLine_1:
   \   00000044   080082E3           ORR      R0,R2,#0x8
   \                     ??SearchNextDisplayLine_2:
   \   00000048   BC00C5E1           STRH     R0,[R5, #+12]
     94                continue;
   \                     ??SearchNextDisplayLine_0:
   \   0000004C   000095E5           LDR      R0,[R5, #+0]
   \   00000050   0C1094E5           LDR      R1,[R4, #+12]
   \   00000054   010050E1           CMP      R0,R1
   \   00000058   6700002A           BCS      ??SearchNextDisplayLine_3
   \   0000005C   011080E2           ADD      R1,R0,#+1
   \   00000060   001085E5           STR      R1,[R5, #+0]
   \   00000064   081094E5           LDR      R1,[R4, #+8]
   \   00000068   800081E0           ADD      R0,R1,R0, LSL #+1
   \   0000006C   B090D0E1           LDRH     R9,[R0, #+0]
   \   00000070   FF0C09E2           AND      R0,R9,#0xFF00
   \   00000074   E10C50E3           CMP      R0,#+57600
   \   00000078   0300001A           BNE      ??SearchNextDisplayLine_4
   \   0000007C   0910A0E1           MOV      R1,R9
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   ........           BL       GetBitmapHeight
   \   00000088   0A0000EA           B        ??SearchNextDisplayLine_5
   \                     ??SearchNextDisplayLine_4:
   \   0000008C   BC00D5E1           LDRH     R0,[R5, #+12]
   \   00000090   020010E3           TST      R0,#0x2
   \   00000094   0810A013           MOVNE    R1,#+8
   \   00000098   0200001A           BNE      ??SearchNextDisplayLine_6
   \   0000009C   040010E3           TST      R0,#0x4
   \   000000A0   1010A013           MOVNE    R1,#+16
   \   000000A4   0010A003           MOVEQ    R1,#+0
   \                     ??SearchNextDisplayLine_6:
   \   000000A8   010010E3           TST      R0,#0x1
   \   000000AC   0900A013           MOVNE    R0,#+9
   \   000000B0   0800A003           MOVEQ    R0,#+8
   \   000000B4   ........           BL       GetFontHeight
   \                     ??SearchNextDisplayLine_5:
   \   000000B8   0C3094E5           LDR      R3,[R4, #+12]
   \   000000BC   BC20D5E1           LDRH     R2,[R5, #+12]
   \   000000C0   00A0A0E1           MOV      R10,R0
   \   000000C4   000095E5           LDR      R0,[R5, #+0]
   \   000000C8   02B043E2           SUB      R11,R3,#+2
   \   000000CC   011080E2           ADD      R1,R0,#+1
   \   000000D0   0A0059E3           CMP      R9,#+10
   \   000000D4   2A00000A           BEQ      ??SearchNextDisplayLine_7
   \   000000D8   01E0A0E3           MOV      LR,#+1
   \   000000DC   E0EC8EE3           ORR      LR,LR,#0xE000
   \   000000E0   0E0059E1           CMP      R9,LR
   \   000000E4   3C00000A           BEQ      ??SearchNextDisplayLine_8
   \   000000E8   01E08EE2           ADD      LR,LR,#+1
   \   000000EC   0E0059E1           CMP      R9,LR
   \   000000F0   3700000A           BEQ      ??SearchNextDisplayLine_9
   \   000000F4   02E08EE2           ADD      LR,LR,#+2
   \   000000F8   0E0059E1           CMP      R9,LR
   \   000000FC   2E00000A           BEQ      ??SearchNextDisplayLine_10
   \   00000100   01E08EE3           ORR      LR,LR,#0x1
   \   00000104   0E0059E1           CMP      R9,LR
   \   00000108   2F00000A           BEQ      ??SearchNextDisplayLine_11
   \   0000010C   01E08EE2           ADD      LR,LR,#+1
   \   00000110   0E0059E1           CMP      R9,LR
   \   00000114   3600000A           BEQ      ??SearchNextDisplayLine_12
   \   00000118   01E08EE3           ORR      LR,LR,#0x1
   \   0000011C   0E0059E1           CMP      R9,LR
   \   00000120   4200000A           BEQ      ??SearchNextDisplayLine_13
   \   00000124   01E08EE2           ADD      LR,LR,#+1
   \   00000128   0E0059E1           CMP      R9,LR
   \   0000012C   01E08E13           ORRNE    LR,LR,#0x1
   \   00000130   0E005911           CMPNE    R9,LR
   \   00000134   4A00000A           BEQ      ??SearchNextDisplayLine_14
   \   00000138   09E08EE2           ADD      LR,LR,#+9
   \   0000013C   0E0059E1           CMP      R9,LR
   \   00000140   2700000A           BEQ      ??SearchNextDisplayLine_15
   \   00000144   01E08EE3           ORR      LR,LR,#0x1
   \   00000148   0E0059E1           CMP      R9,LR
   \   0000014C   2600000A           BEQ      ??SearchNextDisplayLine_16
   \   00000150   09E08EE2           ADD      LR,LR,#+9
   \   00000154   0E0059E1           CMP      R9,LR
   \   00000158   1500000A           BEQ      ??SearchNextDisplayLine_17
   \   0000015C   01E08EE3           ORR      LR,LR,#0x1
   \   00000160   0E0059E1           CMP      R9,LR
   \   00000164   1000000A           BEQ      ??SearchNextDisplayLine_18
   \   00000168   01E08EE2           ADD      LR,LR,#+1
   \   0000016C   0E0059E1           CMP      R9,LR
   \   00000170   B3FFFF0A           BEQ      ??SearchNextDisplayLine_1
   \   00000174   01E08EE3           ORR      LR,LR,#0x1
   \   00000178   0E0059E1           CMP      R9,LR
   \   0000017C   0600000A           BEQ      ??SearchNextDisplayLine_19
   \   00000180   010000EA           B        ??SearchNextDisplayLine_20
   \                     ??SearchNextDisplayLine_7:
   \   00000184   0170A0E3           MOV      R7,#+1
   \   00000188   00A0A0E3           MOV      R10,#+0
     95              case UTF16_DIS_CENTER:
     96                p->center=0;
     97                continue;
     98              case UTF16_ALIGN_RIGHT:
     99                p->right=1;
    100                continue;
    101              case UTF16_ALIGN_LEFT:
    102                p->right=0;
    103                continue;
    104              case UTF16_DIS_INVERT:
    105                p->ref=0;
    106                continue;
    107              case UTF16_ENA_INVERT:
    108                p->ref=1;
    109                continue;
    110              case UTF16_DIS_UNDERLINE:
    111                p->underline=0;
    112                continue;
    113              case UTF16_ENA_UNDERLINE:
    114                p->underline=1;
    115                continue;
    116              case UTF16_FONT_SMALL:
    117                {
    118                  p->bold=0;
    119                }
    120                continue;
    121              case UTF16_FONT_SMALL_BOLD:
    122                {
    123                  p->bold=1;
    124                }
    125                continue;
    126              case UTF16_INK_RGBA:
    127                if (p->pos>(vd->rawtext_size-2)) return 0;
    128                p->ink1=vd->rawtext[p->pos++];
    129                p->ink2=vd->rawtext[p->pos++];
    130                continue;
    131              case UTF16_PAPER_RGBA:
    132                if (p->pos>(vd->rawtext_size-2)) return 0;
    133                p->paper1=vd->rawtext[p->pos++];
    134                p->paper2=vd->rawtext[p->pos++];
    135                continue;
    136              case UTF16_INK_INDEX:
    137              case UTF16_PAPER_INDEX:
    138                if (p->pos>=(vd->rawtext_size-1)) return 0;
    139                p->pos++;
    140                continue;
    141              }
    142              // компоновка элементов здесь
    143              cw=GetSymbolBitmapWidth(vd,c,p->bold?FONT_SMALL_BOLD:FONT_SMALL);
   \                     ??SearchNextDisplayLine_20:
   \   0000018C   010012E3           TST      R2,#0x1
   \   00000190   0820A003           MOVEQ    R2,#+8
   \   00000194   0920A013           MOVNE    R2,#+9
   \   00000198   360000EA           B        ??SearchNextDisplayLine_21
   \                     ??SearchNextDisplayLine_19:
   \   0000019C   F710A0E3           MOV      R1,#+247
   \                     ??SearchNextDisplayLine_22:
   \   000001A0   FF1C81E3           ORR      R1,R1,#0xFF00
   \   000001A4   020001E0           AND      R0,R1,R2
   \   000001A8   A6FFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_18:
   \   000001AC   100082E3           ORR      R0,R2,#0x10
   \   000001B0   A4FFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_17:
   \   000001B4   EF10A0E3           MOV      R1,#+239
   \   000001B8   F8FFFFEA           B        ??SearchNextDisplayLine_22
   \                     ??SearchNextDisplayLine_10:
   \   000001BC   FB10A0E3           MOV      R1,#+251
   \   000001C0   FF1C81E3           ORR      R1,R1,#0xFF00
   \   000001C4   020001E0           AND      R0,R1,R2
   \   000001C8   9EFFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_11:
   \   000001CC   040082E3           ORR      R0,R2,#0x4
   \   000001D0   9CFFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_9:
   \   000001D4   FD10A0E3           MOV      R1,#+253
   \   000001D8   F0FFFFEA           B        ??SearchNextDisplayLine_22
   \                     ??SearchNextDisplayLine_8:
   \   000001DC   020082E3           ORR      R0,R2,#0x2
   \   000001E0   98FFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_15:
   \   000001E4   FE10A0E3           MOV      R1,#+254
   \   000001E8   ECFFFFEA           B        ??SearchNextDisplayLine_22
   \                     ??SearchNextDisplayLine_16:
   \   000001EC   010082E3           ORR      R0,R2,#0x1
   \   000001F0   94FFFFEA           B        ??SearchNextDisplayLine_2
   \                     ??SearchNextDisplayLine_12:
   \   000001F4   00005BE1           CMP      R11,R0
   \   000001F8   0100002A           BCS      ??SearchNextDisplayLine_23
   \                     ??SearchNextDisplayLine_3:
   \   000001FC   0000A0E3           MOV      R0,#+0
   \   00000200   F08FBDE8           POP      {R4-R11,PC}
   \                     ??SearchNextDisplayLine_23:
   \   00000204   001085E5           STR      R1,[R5, #+0]
   \   00000208   082094E5           LDR      R2,[R4, #+8]
   \   0000020C   800082E0           ADD      R0,R2,R0, LSL #+1
   \   00000210   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000214   B400C5E1           STRH     R0,[R5, #+4]
   \   00000218   010081E2           ADD      R0,R1,#+1
   \   0000021C   000085E5           STR      R0,[R5, #+0]
   \   00000220   810082E0           ADD      R0,R2,R1, LSL #+1
   \   00000224   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000228   B600C5E1           STRH     R0,[R5, #+6]
   \   0000022C   86FFFFEA           B        ??SearchNextDisplayLine_0
   \                     ??SearchNextDisplayLine_13:
   \   00000230   00005BE1           CMP      R11,R0
   \   00000234   F0FFFF3A           BCC      ??SearchNextDisplayLine_3
   \   00000238   001085E5           STR      R1,[R5, #+0]
   \   0000023C   082094E5           LDR      R2,[R4, #+8]
   \   00000240   800082E0           ADD      R0,R2,R0, LSL #+1
   \   00000244   B000D0E1           LDRH     R0,[R0, #+0]
   \   00000248   B800C5E1           STRH     R0,[R5, #+8]
   \   0000024C   010081E2           ADD      R0,R1,#+1
   \   00000250   000085E5           STR      R0,[R5, #+0]
   \   00000254   810082E0           ADD      R0,R2,R1, LSL #+1
   \   00000258   B000D0E1           LDRH     R0,[R0, #+0]
   \   0000025C   BA00C5E1           STRH     R0,[R5, #+10]
   \   00000260   79FFFFEA           B        ??SearchNextDisplayLine_0
   \                     ??SearchNextDisplayLine_14:
   \   00000264   012043E2           SUB      R2,R3,#+1
   \   00000268   020050E1           CMP      R0,R2
   \   0000026C   E2FFFF2A           BCS      ??SearchNextDisplayLine_3
   \   00000270   001085E5           STR      R1,[R5, #+0]
   \   00000274   74FFFFEA           B        ??SearchNextDisplayLine_0
   \                     ??SearchNextDisplayLine_21:
   \   00000278   0910A0E1           MOV      R1,R9
   \   0000027C   0400A0E1           MOV      R0,R4
   \   00000280   ........           BL       GetSymbolBitmapWidth
   \   00000284   00B0A0E1           MOV      R11,R0
    144              left-=cw;
   \   00000288   0B6056E0           SUBS     R6,R6,R11
    145              if (left<0)
   \   0000028C   0490A0E3           MOV      R9,#+4
   \   00000290   E09C89E3           ORR      R9,R9,#0xE000
   \   00000294   5300005A           BPL      ??SearchNextDisplayLine_24
    146              {
    147                int b=1;
    148                int cw=0;
    149                if (p->ref)
   \   00000298   EC019FE5           LDR      R0,??SearchNextDisplayLine_25  ;; word_wrap
   \   0000029C   0160A0E3           MOV      R6,#+1
   \   000002A0   00A090E5           LDR      R10,[R0, #+0]
   \   000002A4   BC00D5E1           LDRH     R0,[R5, #+12]
   \   000002A8   0070A0E3           MOV      R7,#+0
   \   000002AC   888088E0           ADD      R8,R8,R8, LSL #+1
   \   000002B0   040010E3           TST      R0,#0x4
   \   000002B4   0300001A           BNE      ??SearchNextDisplayLine_26
    150                {
    151                  while (1)
    152                  {
    153                    cw+=GetSymbolBitmapWidth(vd,vd->rawtext[p->pos-b],p->bold?FONT_SMALL_BOLD:FONT_SMALL);
    154                    if (cw>=(scrW*3/4))
    155                    {
    156                      b=1;
    157                      break;
    158                    }
    159                    if (word_wrap && (vd->rawtext[p->pos-b]==UTF16_SPACE)) { /*b--;*/ break;}
    160                    if (vd->rawtext[p->pos-b]==UTF16_ENA_INVERT) break;
    161                    if (vd->rawtext[p->pos-b]==UTF16_NEWLINE)
    162                    {
    163                      b++;
    164                      break;
    165                    }
    166                    b++;
    167                  }
    168                }
    169                else
    170                {
    171                  if (word_wrap)
   \   000002B8   00005AE3           CMP      R10,#+0
   \   000002BC   2700001A           BNE      ??SearchNextDisplayLine_27
   \   000002C0   450000EA           B        ??SearchNextDisplayLine_28
   \                     ??SearchNextDisplayLine_29:
   \   000002C4   016086E2           ADD      R6,R6,#+1
   \                     ??SearchNextDisplayLine_26:
   \   000002C8   BC00D5E1           LDRH     R0,[R5, #+12]
   \   000002CC   081094E5           LDR      R1,[R4, #+8]
   \   000002D0   010010E3           TST      R0,#0x1
   \   000002D4   000095E5           LDR      R0,[R5, #+0]
   \   000002D8   0920A013           MOVNE    R2,#+9
   \   000002DC   0820A003           MOVEQ    R2,#+8
   \   000002E0   060040E0           SUB      R0,R0,R6
   \   000002E4   800081E0           ADD      R0,R1,R0, LSL #+1
   \   000002E8   B010D0E1           LDRH     R1,[R0, #+0]
   \   000002EC   0400A0E1           MOV      R0,R4
   \   000002F0   ........           BL       GetSymbolBitmapWidth
   \   000002F4   077080E0           ADD      R7,R0,R7
   \   000002F8   C800A0E1           ASR      R0,R8,#+1
   \   000002FC   200F88E0           ADD      R0,R8,R0, LSR #+30
   \   00000300   400157E1           CMP      R7,R0, ASR #+2
   \   00000304   010000BA           BLT      ??SearchNextDisplayLine_30
   \                     ??SearchNextDisplayLine_31:
   \   00000308   0160A0E3           MOV      R6,#+1
   \   0000030C   320000EA           B        ??SearchNextDisplayLine_28
   \                     ??SearchNextDisplayLine_30:
   \   00000310   000095E5           LDR      R0,[R5, #+0]
   \   00000314   081094E5           LDR      R1,[R4, #+8]
   \   00000318   060040E0           SUB      R0,R0,R6
   \   0000031C   800081E0           ADD      R0,R1,R0, LSL #+1
   \   00000320   00005AE3           CMP      R10,#+0
   \   00000324   0200000A           BEQ      ??SearchNextDisplayLine_32
   \   00000328   B010D0E1           LDRH     R1,[R0, #+0]
   \   0000032C   200051E3           CMP      R1,#+32
   \   00000330   2900000A           BEQ      ??SearchNextDisplayLine_28
   \                     ??SearchNextDisplayLine_32:
   \   00000334   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000338   012089E3           ORR      R2,R9,#0x1
   \   0000033C   020051E1           CMP      R1,R2
   \   00000340   2500000A           BEQ      ??SearchNextDisplayLine_28
   \   00000344   0A0051E3           CMP      R1,#+10
   \   00000348   DDFFFF1A           BNE      ??SearchNextDisplayLine_29
   \                     ??SearchNextDisplayLine_33:
   \   0000034C   016086E2           ADD      R6,R6,#+1
   \   00000350   210000EA           B        ??SearchNextDisplayLine_28
    172                  {
    173                    while (1)
    174                    {
    175                      cw+=GetSymbolBitmapWidth(vd,vd->rawtext[p->pos-b],p->bold?FONT_SMALL_BOLD:FONT_SMALL);
    176                      if (cw>=(scrW*3/4))
    177                      {
    178                        b=1;
    179                        break;
    180                      }
    181                      if ((vd->rawtext[p->pos-b]&0xFF00)==0xE100) {b--; break;}
    182                      if (vd->rawtext[p->pos-b]==UTF16_SPACE) { b--; break;}
    183                      if (vd->rawtext[p->pos-b]==UTF16_DIS_INVERT) break;
    184                      if (vd->rawtext[p->pos-b]==UTF16_NEWLINE)
   \                     ??SearchNextDisplayLine_34:
   \   00000354   0A0051E3           CMP      R1,#+10
   \   00000358   FBFFFF0A           BEQ      ??SearchNextDisplayLine_33
    185                      {
    186                        b++;
    187                        break;
    188                      }
    189                      b++;
   \   0000035C   016086E2           ADD      R6,R6,#+1
   \                     ??SearchNextDisplayLine_27:
   \   00000360   BC00D5E1           LDRH     R0,[R5, #+12]
   \   00000364   081094E5           LDR      R1,[R4, #+8]
   \   00000368   010010E3           TST      R0,#0x1
   \   0000036C   000095E5           LDR      R0,[R5, #+0]
   \   00000370   0920A013           MOVNE    R2,#+9
   \   00000374   0820A003           MOVEQ    R2,#+8
   \   00000378   060040E0           SUB      R0,R0,R6
   \   0000037C   800081E0           ADD      R0,R1,R0, LSL #+1
   \   00000380   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000384   0400A0E1           MOV      R0,R4
   \   00000388   ........           BL       GetSymbolBitmapWidth
   \   0000038C   077080E0           ADD      R7,R0,R7
   \   00000390   C800A0E1           ASR      R0,R8,#+1
   \   00000394   200F88E0           ADD      R0,R8,R0, LSR #+30
   \   00000398   400157E1           CMP      R7,R0, ASR #+2
   \   0000039C   D9FFFFAA           BGE      ??SearchNextDisplayLine_31
   \   000003A0   000095E5           LDR      R0,[R5, #+0]
   \   000003A4   081094E5           LDR      R1,[R4, #+8]
   \   000003A8   060040E0           SUB      R0,R0,R6
   \   000003AC   800081E0           ADD      R0,R1,R0, LSL #+1
   \   000003B0   B010D0E1           LDRH     R1,[R0, #+0]
   \   000003B4   FF1C01E2           AND      R1,R1,#0xFF00
   \   000003B8   E10C51E3           CMP      R1,#+57600
   \   000003BC   0100001A           BNE      ??SearchNextDisplayLine_35
   \                     ??SearchNextDisplayLine_36:
   \   000003C0   016046E2           SUB      R6,R6,#+1
   \   000003C4   040000EA           B        ??SearchNextDisplayLine_28
   \                     ??SearchNextDisplayLine_35:
   \   000003C8   B010D0E1           LDRH     R1,[R0, #+0]
   \   000003CC   200051E3           CMP      R1,#+32
   \   000003D0   FAFFFF0A           BEQ      ??SearchNextDisplayLine_36
   \   000003D4   090051E1           CMP      R1,R9
   \   000003D8   DDFFFF1A           BNE      ??SearchNextDisplayLine_34
    190                    }
    191                  }
    192                }
    193                p->pos-=b;
   \                     ??SearchNextDisplayLine_28:
   \   000003DC   000095E5           LDR      R0,[R5, #+0]
   \   000003E0   060040E0           SUB      R0,R0,R6
   \   000003E4   210000EA           B        ??SearchNextDisplayLine_37
    194                return 1; // here can be a bug with line height
    195              }
    196              
    197              /*if (cw>=(scrW/2)||h>(GetFontHeight(FONT_SMALL,0)*2)) // Картинки отдельно
    198              {
    199                if ((left+cw)<scrW) // image is last character
    200                {
    201                  if (vd->rawtext[p->pos-1]==UTF16_ENA_INVERT)
    202                  {
    203                    p->pos-=2;
    204                    return 1;
    205                  }
    206                  else
    207                  {
    208                    p->pos-=1;
    209                    return 1;
    210                  }
    211                }
    212              }*/
    213              if (h>p->pixheight) p->pixheight=h;
   \                     ??SearchNextDisplayLine_24:
   \   000003E8   BE00D5E1           LDRH     R0,[R5, #+14]
   \   000003EC   0A0050E1           CMP      R0,R10
   \   000003F0   BEA0C5B1           STRHLT   R10,[R5, #+14]
    214                
    215              if ((cw>=scrW/2)&&h>(GetFontHeight(FONT_SMALL,0)*3)) // Картинки отдельно
   \   000003F4   A80F88E0           ADD      R0,R8,R8, LSR #+31
   \   000003F8   C0005BE1           CMP      R11,R0, ASR #+1
   \   000003FC   1E0000BA           BLT      ??SearchNextDisplayLine_38
   \   00000400   0010A0E3           MOV      R1,#+0
   \   00000404   0800A0E3           MOV      R0,#+8
   \   00000408   ........           BL       GetFontHeight
   \   0000040C   800080E0           ADD      R0,R0,R0, LSL #+1
   \   00000410   0A0050E1           CMP      R0,R10
   \   00000414   180000AA           BGE      ??SearchNextDisplayLine_38
    216              {
    217                if ((left+cw)==scrW) // image is first character
   \   00000418   06008BE0           ADD      R0,R11,R6
   \   0000041C   080050E1           CMP      R0,R8
   \   00000420   1500001A           BNE      ??SearchNextDisplayLine_38
    218                {
    219                  if (p->pos>(vd->rawtext_size-1)) return 0;
   \   00000424   000095E5           LDR      R0,[R5, #+0]
   \   00000428   0C1094E5           LDR      R1,[R4, #+12]
   \   0000042C   011041E2           SUB      R1,R1,#+1
   \   00000430   000051E1           CMP      R1,R0
   \   00000434   70FFFF3A           BCC      ??SearchNextDisplayLine_3
    220                  p->centerAtAll=1;
   \   00000438   BC10D5E1           LDRH     R1,[R5, #+12]
   \   0000043C   201081E3           ORR      R1,R1,#0x20
   \   00000440   BC10C5E1           STRH     R1,[R5, #+12]
    221                  if (vd->rawtext[p->pos+1]==UTF16_DIS_INVERT)
   \   00000444   081094E5           LDR      R1,[R4, #+8]
   \   00000448   801081E0           ADD      R1,R1,R0, LSL #+1
   \   0000044C   B210D1E1           LDRH     R1,[R1, #+2]
   \   00000450   090051E1           CMP      R1,R9
   \   00000454   0600001A           BNE      ??SearchNextDisplayLine_39
    222                  {
    223                    p->ref=0;
   \   00000458   BC10D5E1           LDRH     R1,[R5, #+12]
   \   0000045C   FB20A0E3           MOV      R2,#+251
   \   00000460   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000464   011002E0           AND      R1,R2,R1
   \   00000468   BC10C5E1           STRH     R1,[R5, #+12]
    224                    p->pos+=1;
   \   0000046C   010080E2           ADD      R0,R0,#+1
   \                     ??SearchNextDisplayLine_37:
   \   00000470   000085E5           STR      R0,[R5, #+0]
    225                    return 1;
   \                     ??SearchNextDisplayLine_39:
   \   00000474   0100A0E3           MOV      R0,#+1
   \   00000478   F08FBDE8           POP      {R4-R11,PC}
    226                  }
    227                  else
    228                  {
    229                    return 1;
    230                  }
    231                }
    232              }
    233              if (f) return 1;
   \                     ??SearchNextDisplayLine_38:
   \   0000047C   000057E3           CMP      R7,#+0
   \   00000480   F1FEFF0A           BEQ      ??SearchNextDisplayLine_0
   \   00000484   0100A0E3           MOV      R0,#+1
   \   00000488   F08FBDE8           POP      {R4-R11,PC}
   \                     ??SearchNextDisplayLine_25:
   \   0000048C   ........           DC32     word_wrap
    234            }
    235            return 0;
    236          }
    237          
    238          #define LINESCACHECHUNK 256
    239          

   \                                 In segment CODE, align 4, keep-with-next
    240          static void newCacheLine(VIEWDATA *vd, LINECACHE *p)
    241          {
   \                     newCacheLine:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    242            if ((vd->lines_cache_size%LINESCACHECHUNK)==0)
   \   00000008   140094E5           LDR      R0,[R4, #+20]
   \   0000000C   0150A0E1           MOV      R5,R1
   \   00000010   001CB0E1           LSLS     R1,R0,#+24
   \   00000014   0500001A           BNE      ??newCacheLine_0
    243            {
    244              //Дошли до конца куска, реаллоцируем еще кусок
    245              vd->lines_cache=realloc(vd->lines_cache,(vd->lines_cache_size+LINESCACHECHUNK)*sizeof(LINECACHE));
   \   00000018   400F80E2           ADD      R0,R0,#+256
   \   0000001C   1420A0E3           MOV      R2,#+20
   \   00000020   920001E0           MUL      R1,R2,R0
   \   00000024   100094E5           LDR      R0,[R4, #+16]
   \   00000028   BA0000EF           SWI      +186
   \   0000002C   100084E5           STR      R0,[R4, #+16]
    246            }
    247            memcpy(vd->lines_cache+(vd->lines_cache_size++),p,sizeof(LINECACHE));
   \                     ??newCacheLine_0:
   \   00000030   140094E5           LDR      R0,[R4, #+20]
   \   00000034   1420A0E3           MOV      R2,#+20
   \   00000038   011080E2           ADD      R1,R0,#+1
   \   0000003C   141084E5           STR      R1,[R4, #+20]
   \   00000040   10C094E5           LDR      R12,[R4, #+16]
   \   00000044   0510A0E1           MOV      R1,R5
   \   00000048   92C020E0           MLA      R0,R2,R0,R12
   \   0000004C   1E0100EF           SWI      +286
    248            vd->lines_cache_pos=p->pos;
   \   00000050   000095E5           LDR      R0,[R5, #+0]
   \   00000054   180084E5           STR      R0,[R4, #+24]
    249          }
   \   00000058   3080BDE8           POP      {R4,R5,PC}       ;; return
    250          

   \                                 In segment CODE, align 4, keep-with-next
    251          int LineDown(VIEWDATA *vd)
    252          {
   \                     LineDown:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   14D04DE2           SUB      SP,SP,#+20
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   1C0094E5           LDR      R0,[R4, #+28]
   \   00000010   141094E5           LDR      R1,[R4, #+20]
   \   00000014   010080E2           ADD      R0,R0,#+1
   \   00000018   010050E1           CMP      R0,R1
   \   0000001C   3000003A           BCC      ??LineDown_0
    253            LINECACHE lc;
    254            if (vd->view_line+1<vd->lines_cache_size)
    255            {
    256              vd->view_line++;
    257            }
    258            else
    259            {
    260              LINECACHE *plc;
    261              if (!vd->lines_cache_size)
   \   00000020   000051E3           CMP      R1,#+0
   \   00000024   1700001A           BNE      ??LineDown_1
    262              {
    263                lc.ink1=0x0000;
    264                lc.ink2=0x0064;
   \   00000028   6420A0E3           MOV      R2,#+100
   \   0000002C   B620CDE1           STRH     R2,[SP, #+6]
    265                lc.paper1=0xFFFF;
   \   00000030   FF20A0E3           MOV      R2,#+255
   \   00000034   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000038   B820CDE1           STRH     R2,[SP, #+8]
    266                lc.paper2=0xFF64;
   \   0000003C   9B20C2E3           BIC      R2,R2,#0x9B
   \   00000040   BA20CDE1           STRH     R2,[SP, #+10]
    267                lc.pixheight=0;
    268                lc.ycoord = 0;
    269                lc.bold=0;
    270                lc.underline=0;
    271                lc.ref=0;
   \   00000044   BC20DDE1           LDRH     R2,[SP, #+12]
   \   00000048   0000A0E3           MOV      R0,#+0
   \   0000004C   B400CDE1           STRH     R0,[SP, #+4]
   \   00000050   BE00CDE1           STRH     R0,[SP, #+14]
   \   00000054   10008DE5           STR      R0,[SP, #+16]
   \   00000058   F830A0E3           MOV      R3,#+248
   \   0000005C   FF3C83E3           ORR      R3,R3,#0xFF00
   \   00000060   022003E0           AND      R2,R3,R2
   \   00000064   BC20CDE1           STRH     R2,[SP, #+12]
    272                lc.pos=0;
   \   00000068   00008DE5           STR      R0,[SP, #+0]
    273                lc.center=0;
    274                lc.right=0;
    275                lc.centerAtAll=0;
   \   0000006C   0210A0E1           MOV      R1,R2
   \   00000070   312043E2           SUB      R2,R3,#+49
   \   00000074   011002E0           AND      R1,R2,R1
   \   00000078   BC10CDE1           STRH     R1,[SP, #+12]
    276                newCacheLine(vd,&lc);
   \   0000007C   0D10A0E1           MOV      R1,SP
   \   00000080   0400A0E1           MOV      R0,R4
   \   00000084   ........           BL       newCacheLine
    277              }
    278              plc=vd->lines_cache+vd->lines_cache_size-1;
   \                     ??LineDown_1:
   \   00000088   140094E5           LDR      R0,[R4, #+20]
   \   0000008C   102094E5           LDR      R2,[R4, #+16]
   \   00000090   1410A0E3           MOV      R1,#+20
   \   00000094   912020E0           MLA      R0,R1,R0,R2
   \   00000098   145040E2           SUB      R5,R0,#+20
    279              if (!SearchNextDisplayLine(vd,plc)) return 0; // can't caching futher
   \   0000009C   0510A0E1           MOV      R1,R5
   \   000000A0   0400A0E1           MOV      R0,R4
   \   000000A4   ........           BL       SearchNextDisplayLine
   \   000000A8   000050E3           CMP      R0,#+0
   \   000000AC   0E00000A           BEQ      ??LineDown_2
    280              memcpy(&lc,plc,sizeof(LINECACHE));
   \   000000B0   1420A0E3           MOV      R2,#+20
   \   000000B4   0510A0E1           MOV      R1,R5
   \   000000B8   0D00A0E1           MOV      R0,SP
   \   000000BC   1E0100EF           SWI      +286
    281              lc.ycoord += plc->pixheight;
   \   000000C0   BE20D5E1           LDRH     R2,[R5, #+14]
   \   000000C4   10109DE5           LDR      R1,[SP, #+16]
    282              newCacheLine(vd,&lc);
   \   000000C8   0400A0E1           MOV      R0,R4
   \   000000CC   011082E0           ADD      R1,R2,R1
   \   000000D0   10108DE5           STR      R1,[SP, #+16]
   \   000000D4   0D10A0E1           MOV      R1,SP
   \   000000D8   ........           BL       newCacheLine
    283              vd->view_line++;
   \   000000DC   1C0094E5           LDR      R0,[R4, #+28]
   \   000000E0   010080E2           ADD      R0,R0,#+1
   \                     ??LineDown_0:
   \   000000E4   1C0084E5           STR      R0,[R4, #+28]
    284            }
    285            return 1;
   \   000000E8   0100A0E3           MOV      R0,#+1
   \                     ??LineDown_2:
   \   000000EC   14D08DE2           ADD      SP,SP,#+20       ;; stack cleaning
   \   000000F0   3080BDE8           POP      {R4,R5,PC}       ;; return
    286          }
    287          // 0 page start

   \                                 In segment CODE, align 4, keep-with-next
    288          int LineUp(VIEWDATA *vd)
    289          {
    290            int vl=vd->view_line;
   \                     LineUp:
   \   00000000   1C1090E5           LDR      R1,[R0, #+28]
    291            if (vl)
   \   00000004   000051E3           CMP      R1,#+0
   \   00000008   0300000A           BEQ      ??LineUp_0
    292            {
    293              vl--;
    294              vd->view_line=vl;
   \   0000000C   011041E2           SUB      R1,R1,#+1
   \   00000010   1C1080E5           STR      R1,[R0, #+28]
    295              return 1;
   \   00000014   0100A0E3           MOV      R0,#+1
   \   00000018   1EFF2FE1           BX       LR
    296            }
    297            else
    298              return 0;
   \                     ??LineUp_0:
   \   0000001C   0000A0E3           MOV      R0,#+0
   \   00000020   1EFF2FE1           BX       LR               ;; return
    299          }
    300          

   \                                 In segment CODE, align 4, keep-with-next
    301          void scrollDown(VIEWDATA *vd, int amount)
    302          {
   \                     scrollDown:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    303            if (!RenderPage(vd,0)||vd->lines_cache_size==0) return;
   \   0000000C   0010A0E3           MOV      R1,#+0
   \   00000010   ........           BL       RenderPage
   \   00000014   000050E3           CMP      R0,#+0
   \   00000018   14009415           LDRNE    R0,[R4, #+20]
   \   0000001C   00005013           CMPNE    R0,#+0
   \   00000020   3080BD08           POPEQ    {R4,R5,PC}
    304            
    305            vd->pixdisp+=amount;
   \   00000024   200094E5           LDR      R0,[R4, #+32]
   \   00000028   000085E0           ADD      R0,R5,R0
   \   0000002C   200084E5           STR      R0,[R4, #+32]
   \   00000030   000000EA           B        ??scrollDown_0
    306            unsigned int cl_h;
    307          L1:
    308            cl_h=vd->lines_cache[vd->view_line].pixheight;
    309            if (vd->pixdisp>cl_h)
    310            {
    311              vd->pixdisp-=cl_h;
    312              unsigned int pd=vd->pixdisp;
    313              LineDown(vd);
    314              vd->pixdisp=0;
    315              if (!RenderPage(vd,0))
    316              {
    317                while(LineDown(vd)) ;
    318                vd->pixdisp=(vd->lines_cache+vd->lines_cache_size-1)->pixheight;
    319                scrollUp(vd,ScreenH()-1-scr_shift);
    320                return;
    321              }
    322              vd->pixdisp=pd;
   \                     ??scrollDown_1:
   \   00000034   205084E5           STR      R5,[R4, #+32]
    323              goto L1;
   \                     ??scrollDown_0:
   \   00000038   1C0094E5           LDR      R0,[R4, #+28]
   \   0000003C   102094E5           LDR      R2,[R4, #+16]
   \   00000040   1410A0E3           MOV      R1,#+20
   \   00000044   912020E0           MLA      R0,R1,R0,R2
   \   00000048   201094E5           LDR      R1,[R4, #+32]
   \   0000004C   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000050   010050E1           CMP      R0,R1
   \   00000054   0F00002A           BCS      ??scrollDown_2
   \   00000058   005041E0           SUB      R5,R1,R0
   \   0000005C   205084E5           STR      R5,[R4, #+32]
   \   00000060   0400A0E1           MOV      R0,R4
   \   00000064   ........           BL       LineDown
   \   00000068   0000A0E3           MOV      R0,#+0
   \   0000006C   200084E5           STR      R0,[R4, #+32]
   \   00000070   0010A0E3           MOV      R1,#+0
   \   00000074   0400A0E1           MOV      R0,R4
   \   00000078   ........           BL       RenderPage
   \   0000007C   000050E3           CMP      R0,#+0
   \   00000080   EBFFFF1A           BNE      ??scrollDown_1
   \                     ??scrollDown_3:
   \   00000084   0400A0E1           MOV      R0,R4
   \   00000088   ........           BL       LineDown
   \   0000008C   000050E3           CMP      R0,#+0
   \   00000090   FBFFFF1A           BNE      ??scrollDown_3
   \   00000094   080000EA           B        ??scrollDown_4
    324            }
    325            else
    326            {
    327              if (!RenderPage(vd,0))
   \                     ??scrollDown_2:
   \   00000098   0010A0E3           MOV      R1,#+0
   \   0000009C   0400A0E1           MOV      R0,R4
   \   000000A0   ........           BL       RenderPage
   \   000000A4   000050E3           CMP      R0,#+0
   \   000000A8   3080BD18           POPNE    {R4,R5,PC}
    328              {
    329                while(LineDown(vd)) ;
   \                     ??scrollDown_5:
   \   000000AC   0400A0E1           MOV      R0,R4
   \   000000B0   ........           BL       LineDown
   \   000000B4   000050E3           CMP      R0,#+0
   \   000000B8   FBFFFF1A           BNE      ??scrollDown_5
    330                vd->pixdisp=(vd->lines_cache+vd->lines_cache_size-1)->pixheight;
   \                     ??scrollDown_4:
   \   000000BC   140094E5           LDR      R0,[R4, #+20]
   \   000000C0   102094E5           LDR      R2,[R4, #+16]
   \   000000C4   1410A0E3           MOV      R1,#+20
   \   000000C8   912020E0           MLA      R0,R1,R0,R2
   \   000000CC   B60050E1           LDRH     R0,[R0, #-6]
   \   000000D0   200084E5           STR      R0,[R4, #+32]
    331                scrollUp(vd,ScreenH()-1-scr_shift);
   \   000000D4   898100EF           SWI      +33161
   \   000000D8   ........           LDR      R1,??DataTable0  ;; scr_shift
   \   000000DC   010040E2           SUB      R0,R0,#+1
   \   000000E0   001091E5           LDR      R1,[R1, #+0]
   \   000000E4   011040E0           SUB      R1,R0,R1
   \   000000E8   0400A0E1           MOV      R0,R4
   \   000000EC   ........           BL       scrollUp
   \   000000F0   3080BDE8           POP      {R4,R5,PC}       ;; return
    332              }
    333            }
    334          }
    335          

   \                                 In segment CODE, align 4, keep-with-next
    336          void scrollUp(VIEWDATA *vd, int amount)
    337          {
   \                     scrollUp:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   050000EA           B        ??scrollUp_0
    338            while (vd->pixdisp-amount<0)
    339            {
    340              if (!LineUp(vd))
    341              {
    342                vd->pixdisp=0;
    343                return;
    344              }
    345              amount-=vd->lines_cache[vd->view_line].pixheight;
   \                     ??scrollUp_1:
   \   00000010   1C0094E5           LDR      R0,[R4, #+28]
   \   00000014   102094E5           LDR      R2,[R4, #+16]
   \   00000018   1410A0E3           MOV      R1,#+20
   \   0000001C   912020E0           MLA      R0,R1,R0,R2
   \   00000020   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000024   005045E0           SUB      R5,R5,R0
   \                     ??scrollUp_0:
   \   00000028   200094E5           LDR      R0,[R4, #+32]
   \   0000002C   050050E0           SUBS     R0,R0,R5
   \   00000030   0300005A           BPL      ??scrollUp_2
   \   00000034   0400A0E1           MOV      R0,R4
   \   00000038   ........           BL       LineUp
   \   0000003C   000050E3           CMP      R0,#+0
   \   00000040   F2FFFF1A           BNE      ??scrollUp_1
    346            }
    347            vd->pixdisp-=amount;
   \                     ??scrollUp_2:
   \   00000044   200084E5           STR      R0,[R4, #+32]
    348          }
   \   00000048   3080BDE8           POP      {R4,R5,PC}       ;; return
    349          
    350          #define MAX_COLORS_IN_LINE 32
    351          typedef struct {
    352            char color[4];
    353            int start_x;
    354            int end_x;
    355          } COLOR_RC;
    356          
    357          

   \                                 In segment CODE, align 4, keep-with-next
    358          void renderForm(VIEWDATA *vd, REFCACHE *rf, int x, int y, int y2, int wchar, int isRef)
    359          {
   \                     renderForm:
   \   00000000   FC4F2DE9           PUSH     {R2-R11,LR}
   \   00000004   34709DE5           LDR      R7,[SP, #+52]
   \   00000008   0060A0E1           MOV      R6,R0
   \   0000000C   0140A0E1           MOV      R4,R1
    360            int scr_w = ScreenW() - MARGIN/2;
   \   00000010   888100EF           SWI      +33160
   \   00000014   025040E2           SUB      R5,R0,#+2
    361            if (rf->tag=='x'||rf->tag=='p')
   \   00000018   080094E5           LDR      R0,[R4, #+8]
   \   0000001C   780050E3           CMP      R0,#+120
   \   00000020   70005013           CMPNE    R0,#+112
   \   00000024   5000001A           BNE      ??renderForm_0
    362            {
    363              // calc pos
    364              int d=(GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_TEXT_FORM))-GetFontHeight(FONT_SMALL,0))/2;
   \   00000028   FC0096E5           LDR      R0,[R6, #+252]
   \   0000002C   E40100EF           SWI      +484
   \   00000030   210000EF           SWI      +33
   \   00000034   0080A0E1           MOV      R8,R0
   \   00000038   0010A0E3           MOV      R1,#+0
   \   0000003C   0800A0E3           MOV      R0,#+8
   \   00000040   ........           BL       GetFontHeight
   \   00000044   000048E0           SUB      R0,R8,R0
   \   00000048   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   0000004C   C080A0E1           ASR      R8,R0,#+1
    365              // count lenght
    366              int w=GetImgWidth(GetPicNByUnicodeSymbol(vd->WCHAR_TEXT_FORM))-(d*2);
   \   00000050   FC0096E5           LDR      R0,[R6, #+252]
   \   00000054   E40100EF           SWI      +484
   \   00000058   220000EF           SWI      +34
   \   0000005C   88A040E0           SUB      R10,R0,R8, LSL #+1
    367              WSHDR *ws2=AllocWS(((WSHDR *)rf->data)->wsbody[0]);
   \   00000060   180094E5           LDR      R0,[R4, #+24]
   \   00000064   000090E5           LDR      R0,[R0, #+0]
   \   00000068   B000D0E1           LDRH     R0,[R0, #+0]
   \   0000006C   250100EF           SWI      +293
   \   00000070   0090A0E1           MOV      R9,R0
   \   00000074   020000EA           B        ??renderForm_1
    368              for (;ws2->wsbody[0]<((WSHDR *)rf->data)->wsbody[0];)
    369              {
    370                w-=GetSymbolWidth(((WSHDR *)rf->data)->wsbody[ws2->wsbody[0]+1],FONT_SMALL);
    371                if (w<=0)
    372                  break;
    373                ws2->wsbody[0]++;
    374                if (rf->tag=='p')
    375                  ws2->wsbody[ws2->wsbody[0]]='*';
   \                     ??renderForm_2:
   \   00000078   810080E0           ADD      R0,R0,R1, LSL #+1
   \   0000007C   2A10A0E3           MOV      R1,#+42
   \   00000080   B010C0E1           STRH     R1,[R0, #+0]
   \                     ??renderForm_1:
   \   00000084   180094E5           LDR      R0,[R4, #+24]
   \   00000088   002099E5           LDR      R2,[R9, #+0]
   \   0000008C   003090E5           LDR      R3,[R0, #+0]
   \   00000090   B010D2E1           LDRH     R1,[R2, #+0]
   \   00000094   B030D3E1           LDRH     R3,[R3, #+0]
   \   00000098   030051E1           CMP      R1,R3
   \   0000009C   1800002A           BCS      ??renderForm_3
   \   000000A0   B020D2E1           LDRH     R2,[R2, #+0]
   \   000000A4   000090E5           LDR      R0,[R0, #+0]
   \   000000A8   0810A0E3           MOV      R1,#+8
   \   000000AC   820080E0           ADD      R0,R0,R2, LSL #+1
   \   000000B0   B200D0E1           LDRH     R0,[R0, #+2]
   \   000000B4   E10100EF           SWI      +481
   \   000000B8   00A04AE0           SUB      R10,R10,R0
   \   000000BC   01005AE3           CMP      R10,#+1
   \   000000C0   0F0000BA           BLT      ??renderForm_3
   \   000000C4   000099E5           LDR      R0,[R9, #+0]
   \   000000C8   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000CC   011081E2           ADD      R1,R1,#+1
   \   000000D0   B010C0E1           STRH     R1,[R0, #+0]
   \   000000D4   081094E5           LDR      R1,[R4, #+8]
   \   000000D8   700051E3           CMP      R1,#+112
   \   000000DC   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000E0   E4FFFF0A           BEQ      ??renderForm_2
    376                else
    377                  ws2->wsbody[ws2->wsbody[0]]=((WSHDR *)rf->data)->wsbody[ws2->wsbody[0]];
   \   000000E4   182094E5           LDR      R2,[R4, #+24]
   \   000000E8   811080E0           ADD      R1,R0,R1, LSL #+1
   \   000000EC   B000D0E1           LDRH     R0,[R0, #+0]
   \   000000F0   002092E5           LDR      R2,[R2, #+0]
   \   000000F4   800082E0           ADD      R0,R2,R0, LSL #+1
   \   000000F8   B000D0E1           LDRH     R0,[R0, #+0]
   \   000000FC   B000C1E1           STRH     R0,[R1, #+0]
   \   00000100   DFFFFFEA           B        ??renderForm_1
    378              }
    379              DrawString(ws2,x+d,y+d,scr_w,ScreenH(),
    380                FONT_SMALL,TEXT_NOFORMAT,
    381                GetPaletteAdrByColorIndex(isRef?0:1),
    382                GetPaletteAdrByColorIndex(23));
   \                     ??renderForm_3:
   \   00000104   1700A0E3           MOV      R0,#+23
   \   00000108   2E0100EF           SWI      +302
   \   0000010C   00A0A0E1           MOV      R10,R0
   \   00000110   000057E3           CMP      R7,#+0
   \   00000114   0000A013           MOVNE    R0,#+0
   \   00000118   0100A003           MOVEQ    R0,#+1
   \   0000011C   2E0100EF           SWI      +302
   \   00000120   00B0A0E1           MOV      R11,R0
   \   00000124   898100EF           SWI      +33161
   \   00000128   00042DE9           PUSH     {R10}
   \   0000012C   00082DE9           PUSH     {R11}
   \   00000130   8010A0E3           MOV      R1,#+128
   \   00000134   02002DE9           PUSH     {R1}
   \   00000138   0530A0E1           MOV      R3,R5
   \   0000013C   0810A0E3           MOV      R1,#+8
   \   00000140   02002DE9           PUSH     {R1}
   \   00000144   01002DE9           PUSH     {R0}
   \   00000148   18009DE5           LDR      R0,[SP, #+24]
   \   0000014C   002088E0           ADD      R2,R8,R0
   \   00000150   14009DE5           LDR      R0,[SP, #+20]
   \   00000154   001088E0           ADD      R1,R8,R0
   \   00000158   0900A0E1           MOV      R0,R9
   \   0000015C   4C0100EF           SWI      +332
    383              FreeWS(ws2);
   \   00000160   0900A0E1           MOV      R0,R9
   \   00000164   290100EF           SWI      +297
   \   00000168   14D08DE2           ADD      SP,SP,#+20
    384            }
    385            if (rf->tag=='s'&&rf->value!=_NOREF)
   \                     ??renderForm_0:
   \   0000016C   080094E5           LDR      R0,[R4, #+8]
   \   00000170   730050E3           CMP      R0,#+115
   \   00000174   5400001A           BNE      ??renderForm_4
   \   00000178   100094E5           LDR      R0,[R4, #+16]
   \   0000017C   010070E3           CMN      R0,#+1
   \   00000180   F38FBD08           POPEQ    {R0,R1,R4-R11,PC}
    386            {
    387              // calc pos
    388              int d=(GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM))-GetFontHeight(FONT_SMALL,0))/2;
   \   00000184   000196E5           LDR      R0,[R6, #+256]
   \   00000188   E40100EF           SWI      +484
   \   0000018C   210000EF           SWI      +33
   \   00000190   0080A0E1           MOV      R8,R0
   \   00000194   0010A0E3           MOV      R1,#+0
   \   00000198   0800A0E3           MOV      R0,#+8
   \   0000019C   ........           BL       GetFontHeight
   \   000001A0   000048E0           SUB      R0,R8,R0
   \   000001A4   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   000001A8   C080A0E1           ASR      R8,R0,#+1
    389              // count lenght
    390              int w=GetImgWidth(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM))-(d*2)-GetImgHeight(GetPicNByUnicodeSymbol(vd->WCHAR_LIST_FORM));
   \   000001AC   000196E5           LDR      R0,[R6, #+256]
   \   000001B0   E40100EF           SWI      +484
   \   000001B4   220000EF           SWI      +34
   \   000001B8   0090A0E1           MOV      R9,R0
   \   000001BC   000196E5           LDR      R0,[R6, #+256]
   \   000001C0   889049E0           SUB      R9,R9,R8, LSL #+1
   \   000001C4   E40100EF           SWI      +484
   \   000001C8   210000EF           SWI      +33
    391              int count=_rshort2(vd->oms+rf->value);
   \   000001CC   3C1096E5           LDR      R1,[R6, #+60]
   \   000001D0   009049E0           SUB      R9,R9,R0
   \   000001D4   100094E5           LDR      R0,[R4, #+16]
   \   000001D8   010080E0           ADD      R0,R0,R1
   \   000001DC   ........           _BLF     _rshort2,??_rshort2??rA
    392              char *c=extract_omstr(vd,rf->value);
   \   000001E0   101094E5           LDR      R1,[R4, #+16]
   \   000001E4   00A0A0E1           MOV      R10,R0
   \   000001E8   0600A0E1           MOV      R0,R6
   \   000001EC   ........           _BLF     extract_omstr,??extract_omstr??rA
   \   000001F0   0060A0E1           MOV      R6,R0
    393              WSHDR *ws2=AllocWS(count);
   \   000001F4   0A00A0E1           MOV      R0,R10
   \   000001F8   250100EF           SWI      +293
   \   000001FC   00B0A0E1           MOV      R11,R0
    394              oms2ws(ws2,c,count);
   \   00000200   0A20A0E1           MOV      R2,R10
   \   00000204   0610A0E1           MOV      R1,R6
   \   00000208   ........           _BLF     oms2ws,??oms2ws??rA
    395              count=ws2->wsbody[0];
   \   0000020C   00009BE5           LDR      R0,[R11, #+0]
    396              ws2->wsbody[0]=0;
   \   00000210   0010A0E3           MOV      R1,#+0
   \   00000214   B0A0D0E1           LDRH     R10,[R0, #+0]
   \   00000218   020000EA           B        ??renderForm_5
    397              for (;ws2->wsbody[0]<count;)
    398              {
    399                w-=GetSymbolWidth(ws2->wsbody[ws2->wsbody[0]+1],FONT_SMALL);
    400                if (w<=0)
    401                  break;
    402                ws2->wsbody[0]++;
   \                     ??renderForm_6:
   \   0000021C   00009BE5           LDR      R0,[R11, #+0]
   \   00000220   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000224   011081E2           ADD      R1,R1,#+1
   \                     ??renderForm_5:
   \   00000228   B010C0E1           STRH     R1,[R0, #+0]
   \   0000022C   00009BE5           LDR      R0,[R11, #+0]
   \   00000230   B010D0E1           LDRH     R1,[R0, #+0]
   \   00000234   0A0051E1           CMP      R1,R10
   \   00000238   070000AA           BGE      ??renderForm_7
   \   0000023C   B020D0E1           LDRH     R2,[R0, #+0]
   \   00000240   0810A0E3           MOV      R1,#+8
   \   00000244   820080E0           ADD      R0,R0,R2, LSL #+1
   \   00000248   B200D0E1           LDRH     R0,[R0, #+2]
   \   0000024C   E10100EF           SWI      +481
   \   00000250   009049E0           SUB      R9,R9,R0
   \   00000254   010059E3           CMP      R9,#+1
   \   00000258   EFFFFFAA           BGE      ??renderForm_6
    403              }
    404              DrawString(ws2,x+d,y+d,scr_w,ScreenH(),
    405                FONT_SMALL,TEXT_NOFORMAT,
    406                GetPaletteAdrByColorIndex(isRef?0:1),
    407                GetPaletteAdrByColorIndex(23));
   \                     ??renderForm_7:
   \   0000025C   1700A0E3           MOV      R0,#+23
   \   00000260   2E0100EF           SWI      +302
   \   00000264   0090A0E1           MOV      R9,R0
   \   00000268   000057E3           CMP      R7,#+0
   \   0000026C   0000A013           MOVNE    R0,#+0
   \   00000270   0100A003           MOVEQ    R0,#+1
   \   00000274   2E0100EF           SWI      +302
   \   00000278   00A0A0E1           MOV      R10,R0
   \   0000027C   898100EF           SWI      +33161
   \   00000280   00022DE9           PUSH     {R9}
   \   00000284   00042DE9           PUSH     {R10}
   \   00000288   8010A0E3           MOV      R1,#+128
   \   0000028C   02002DE9           PUSH     {R1}
   \   00000290   0530A0E1           MOV      R3,R5
   \   00000294   0810A0E3           MOV      R1,#+8
   \   00000298   02002DE9           PUSH     {R1}
   \   0000029C   01002DE9           PUSH     {R0}
   \   000002A0   18009DE5           LDR      R0,[SP, #+24]
   \   000002A4   002088E0           ADD      R2,R8,R0
   \   000002A8   14009DE5           LDR      R0,[SP, #+20]
   \   000002AC   001088E0           ADD      R1,R8,R0
   \   000002B0   0B00A0E1           MOV      R0,R11
   \   000002B4   4C0100EF           SWI      +332
    408              FreeWS(ws2);
   \   000002B8   0B00A0E1           MOV      R0,R11
   \   000002BC   290100EF           SWI      +297
    409              mfree(c);
   \   000002C0   0600A0E1           MOV      R0,R6
   \   000002C4   150000EF           SWI      +21
   \   000002C8   14D08DE2           ADD      SP,SP,#+20
    410            }
    411            if (rf->tag=='u')
   \                     ??renderForm_4:
   \   000002CC   080094E5           LDR      R0,[R4, #+8]
   \   000002D0   750050E3           CMP      R0,#+117
   \   000002D4   F38FBD18           POPNE    {R0,R1,R4-R11,PC}
    412            {
    413              DrawString((WSHDR *)rf->data,x+4,y+3+(y2-y-GetImgHeight(GetPicNByUnicodeSymbol(wchar))),scr_w,ScreenH(),
    414                FONT_SMALL,TEXT_NOFORMAT,
    415                GetPaletteAdrByColorIndex(isRef?0:1),
    416                GetPaletteAdrByColorIndex(23));
   \   000002D8   1700A0E3           MOV      R0,#+23
   \   000002DC   2E0100EF           SWI      +302
   \   000002E0   0060A0E1           MOV      R6,R0
   \   000002E4   000057E3           CMP      R7,#+0
   \   000002E8   0000A013           MOVNE    R0,#+0
   \   000002EC   0100A003           MOVEQ    R0,#+1
   \   000002F0   2E0100EF           SWI      +302
   \   000002F4   0080A0E1           MOV      R8,R0
   \   000002F8   898100EF           SWI      +33161
   \   000002FC   0070A0E1           MOV      R7,R0
   \   00000300   30009DE5           LDR      R0,[SP, #+48]
   \   00000304   E40100EF           SWI      +484
   \   00000308   210000EF           SWI      +33
   \   0000030C   40002DE9           PUSH     {R6}
   \   00000310   00012DE9           PUSH     {R8}
   \   00000314   8010A0E3           MOV      R1,#+128
   \   00000318   02002DE9           PUSH     {R1}
   \   0000031C   0530A0E1           MOV      R3,R5
   \   00000320   0810A0E3           MOV      R1,#+8
   \   00000324   02002DE9           PUSH     {R1}
   \   00000328   80002DE9           PUSH     {R7}
   \   0000032C   40209DE5           LDR      R2,[SP, #+64]
   \   00000330   18109DE5           LDR      R1,[SP, #+24]
   \   00000334   011082E0           ADD      R1,R2,R1
   \   00000338   18209DE5           LDR      R2,[SP, #+24]
   \   0000033C   031081E2           ADD      R1,R1,#+3
   \   00000340   021041E0           SUB      R1,R1,R2
   \   00000344   002041E0           SUB      R2,R1,R0
   \   00000348   14009DE5           LDR      R0,[SP, #+20]
   \   0000034C   041080E2           ADD      R1,R0,#+4
   \   00000350   180094E5           LDR      R0,[R4, #+24]
   \   00000354   4C0100EF           SWI      +332
   \   00000358   14D08DE2           ADD      SP,SP,#+20
    417            }
    418          }
   \   0000035C   F38FBDE8           POP      {R0,R1,R4-R11,PC}  ;; return
    419          // возвращает 1, если видна последняя строка
    420          // возвращает 2, если виден конец страницы

   \                                 In segment CODE, align 4, keep-with-next
    421          int RenderPage(VIEWDATA *vd, int do_draw)
    422          {
   \                     RenderPage:
   \   00000000   F24F2DE9           PUSH     {R1,R4-R11,LR}
   \   00000004   F8D04DE2           SUB      SP,SP,#+248
   \   00000008   40DE4DE2           SUB      SP,SP,#+1024
   \   0000000C   0040A0E1           MOV      R4,R0
    423            int scr_w=ScreenW()-MARGIN/2;
   \   00000010   888100EF           SWI      +33160
   \   00000014   020040E2           SUB      R0,R0,#+2
   \   00000018   38008DE5           STR      R0,[SP, #+56]
    424            int scr_h=ScreenH()-1;
   \   0000001C   898100EF           SWI      +33161
   \   00000020   010040E2           SUB      R0,R0,#+1
   \   00000024   3C008DE5           STR      R0,[SP, #+60]
    425            int sc=0;
    426            int dc;
    427            WSHDR *ws=vd->ws;
   \   00000028   241094E5           LDR      R1,[R4, #+36]
   \   0000002C   0090A0E3           MOV      R9,#+0
   \   00000030   40108DE5           STR      R1,[SP, #+64]
    428            LINECACHE *lc;
    429            int ypos=scr_shift-vd->pixdisp;
   \   00000034   ........           LDR      R1,??DataTable1  ;; scr_shift
    430            unsigned int vl;
    431            unsigned int store_line=vl=vd->view_line;
    432            unsigned int len;
    433            unsigned int y2;
    434            
    435            char def_ink[4];
    436            COLOR_RC rc[MAX_COLORS_IN_LINE];
    437            int cur_rc;
    438            int ws_width;
    439            
    440            int c;
    441            int ena_ref=0;
   \   00000038   0050A0E3           MOV      R5,#+0
   \   0000003C   001091E5           LDR      R1,[R1, #+0]
   \   00000040   44108DE5           STR      R1,[SP, #+68]
   \   00000044   0100A0E1           MOV      R0,R1
   \   00000048   201094E5           LDR      R1,[R4, #+32]
   \   0000004C   016040E0           SUB      R6,R0,R1
   \   00000050   1C1094E5           LDR      R1,[R4, #+28]
   \   00000054   2C108DE5           STR      R1,[SP, #+44]
   \   00000058   6C108DE5           STR      R1,[SP, #+108]
    442            int isBold = 0;
   \   0000005C   0510A0E1           MOV      R1,R5
   \   00000060   48108DE5           STR      R1,[SP, #+72]
    443            int isUnderline = 0;
   \   00000064   50108DE5           STR      R1,[SP, #+80]
   \   00000068   4C108DE5           STR      R1,[SP, #+76]
   \   0000006C   0100E0E1           MVN      R0,R1
   \   00000070   2C0084E5           STR      R0,[R4, #+44]
    444            int max_ref_height;
    445            
    446            unsigned int flag=0;
    447            
    448            vd->pos_first_ref=0xFFFFFFFF;
    449            vd->pos_last_ref=0xFFFFFFFF;
   \   00000074   300084E5           STR      R0,[R4, #+48]
    450            vd->pos_prev_ref=0xFFFFFFFF;
   \   00000078   340084E5           STR      R0,[R4, #+52]
    451            vd->pos_next_ref=0xFFFFFFFF;
   \   0000007C   380084E5           STR      R0,[R4, #+56]
    452            
    453            int dfh=GetFontHeight(FONT_SMALL,0)*2; //double font height
   \   00000080   0800A0E3           MOV      R0,#+8
   \   00000084   ........           BL       GetFontHeight
   \   00000088   8000A0E1           LSL      R0,R0,#+1
   \   0000008C   54008DE5           STR      R0,[SP, #+84]
    454            
    455            typedef struct
    456            {
    457              REFCACHE *form_rf;
    458              int       form_x;
    459              int       form_char;
    460              int       isRef;
    461            }tFormData;
    462            
    463            REFCACHE *rnd_rf;
    464            tFormData form_data[32];
    465            int form_num;
    466            
    467            RECT rcs[32]; // cursor
    468            RECT rcs_work;
    469            RECT rc_search;
    470            int  rcs_num=0;
   \   00000090   0510A0E1           MOV      R1,R5
   \   00000094   1C108DE5           STR      R1,[SP, #+28]
    471            
    472            int lcheck=0; // last line checker
   \   00000098   20108DE5           STR      R1,[SP, #+32]
    473            int lprev=0; // prev line
   \   0000009C   68108DE5           STR      R1,[SP, #+104]
   \   000000A0   050000EA           B        ??RenderPage_0
    474            
    475            int x;
    476            
    477            while(ypos<=scr_h)
    478            {
    479              if (!lcheck) 
    480                lcheck=!LineDown(vd);
    481              else 
    482                lcheck++;
    483              if (lcheck<=1&&vd->lines_cache_size>0)
    484              {
    485          
    486                lc=vd->lines_cache+vl;
    487                if (vl) lprev=-1;
    488                dc=0;
    489                ws_width=0;
    490                cur_rc=1;
    491                rnd_rf=NULL;
    492                zeromem(&rc_search,sizeof(RECT));
    493                zeromem(&rcs_work,sizeof(RECT));
    494                zeromem(&form_data, 32*sizeof(tFormData));
    495                form_num = 0;
    496                max_ref_height = 0;
    497                rc[0].start_x=MARGIN/2;
    498                rc[0].end_x=scr_w-1;
    499                rc[0].color[0]=lc[lprev].paper1>>8;
    500                rc[0].color[1]=lc[lprev].paper1;
    501                rc[0].color[2]=lc[lprev].paper2>>8;
    502                rc[0].color[3]=lc[lprev].paper2;
    503                
    504                if (vl) sc=lc[lprev].pos;
    505                len=lc->pos-sc;
    506                
    507                if (lc[lprev].bold)
    508                {
    509                  isBold = 1;
    510                }
    511                
    512                if (lc[lprev].underline)
    513                {
    514                  isUnderline = 1;
    515                }
    516                
    517                if ((cfgInvertCursor) && (ena_ref))
    518                  ws->wsbody[++dc]=UTF16_ENA_INVERT;
    519                    
    520                while(len>0&&dc<250)
    521                {
    522                  c=vd->rawtext[sc];
    523                  
    524                  if (sc == vd->found_word_pos)
    525                  {
    526                    rc_search.x=ws_width+MARGIN/2;
    527                  }
    528                    
    529                  if ((vd->found_word_pos != -1) && (sc == vd->found_word_pos+wstrlen(search_string)))
    530                  {
    531                    rc_search.x2=ws_width+MARGIN/2;
    532                  }
    533                  
    534                  if (c==UTF16_ENA_INVERT)
    535                  {
    536                    if ((lc->pixheight<dfh)?(ypos<0):(ypos+lc->pixheight-dfh<0))
    537                      goto L1;
    538                    if ((lc->pixheight<dfh)?(ypos+lc->pixheight>scr_h):(ypos+dfh>scr_h))
    539                      goto L1;
    540                    if (vd->pos_cur_ref==sc)
    541                    { 
    542                      flag=1;
    543                      ena_ref=1;
    544                      rcs_work.x=ws_width;
    545                    }
    546                    else
    547                    {
    548                      if (vd->pos_first_ref==0xFFFFFFFF) vd->pos_first_ref=sc;
    549                      if (flag==0) vd->pos_prev_ref=sc;
    550                      if (flag==1)
    551                      {
    552                        vd->pos_next_ref=sc;
    553                        flag=2;
    554                      }
    555                      vd->pos_last_ref=sc;
    556                      if (ena_ref) ena_ref++;
    557                      goto L1;
    558                    }
    559                    if (!cfgInvertCursor)
    560                      goto L1;
    561                  }
    562                  if (c==UTF16_DIS_INVERT)
    563                  {
    564                    if (ena_ref!=1)
    565                    {
    566                      if (ena_ref) ena_ref--;
    567                      goto L1;
    568                    }
    569                    rcs_work.x2=ws_width;
    570                    ena_ref=0;
    571                    if (!cfgInvertCursor)
    572                      goto L1;
    573                  }
    574                  if (c==UTF16_PAPER_RGBA)
    575                  {
    576                    if (cur_rc<MAX_COLORS_IN_LINE)
    577                    {
    578                      COLOR_RC *prev=rc+cur_rc-1;
    579                      rc[cur_rc].color[0]=vd->rawtext[sc+1]>>8;
    580                      rc[cur_rc].color[1]=vd->rawtext[sc+1];
    581                      rc[cur_rc].color[2]=vd->rawtext[sc+2]>>8;
    582                      rc[cur_rc].color[3]=vd->rawtext[sc+2];
    583                      if (memcmp((void *)rc[cur_rc].color,(void *)prev->color,4))  // Только если цвет не равен предыдущему (очередь объектов не резиновая ;))
    584                      {
    585                        if (ws_width)
    586                          prev->end_x=ws_width-1+MARGIN/2;
    587                        else
    588                          prev->end_x = MARGIN/2;
    589                        rc[cur_rc].start_x=ws_width+MARGIN/2;
    590                        rc[cur_rc].end_x=scr_w-1;
    591                        cur_rc++;
    592                      }
    593                    }
    594                  }
    595                  if (c==UTF16_ALIGN_LEFT||c==UTF16_ALIGN_RIGHT||c==UTF16_ENA_CENTER|| \
    596                      c==UTF16_DIS_CENTER||c==UTF16_NEWLINE)
    597                  {
    598                    goto L1;
    599                  }
    600                  if ((c&0xFF00)==0xE100)
    601                  {
    602                    rnd_rf=FindReferenceByBegin(vd,sc-1);         
    603                    if ((rnd_rf) && (c==vd->WCHAR_TEXT_FORM||c==vd->WCHAR_LIST_FORM||rnd_rf->tag == 'u'))
    604                    {
    605                      form_data[form_num].form_rf = rnd_rf;
    606                      form_data[form_num].form_x = ws_width;
    607                      form_data[form_num].form_char = c;
    608                      if (cfgInvertCursor)
    609                        form_data[form_num].isRef = ena_ref;
    610                      form_num++;    
    611                    }  
    612                  }
    613                  if (c==UTF16_ENA_UNDERLINE)
    614                  {
    615                    isUnderline = 1;
    616                  }
    617                  if (c==UTF16_DIS_UNDERLINE)
    618                  {
    619                    isUnderline = 0;
    620                  }
    621                  if (c==UTF16_FONT_SMALL_BOLD)
    622                  {
    623                    isBold = 1;
    624                  }
    625                  if (c==UTF16_FONT_SMALL)
    626                  {
    627                    isBold = 0;
    628                  }
    629                  ws->wsbody[++dc]=c;
    630                  ws_width+=GetSymbolWidth(c,isBold?FONT_SMALL_BOLD:FONT_SMALL);
    631                  if (ena_ref)
    632                  {
    633                    int th;
    634                    if ((c&0xFF00)==0xE100)
    635                    {
    636                      th=GetImgHeight(GetPicNByUnicodeSymbol(c));
    637                    }
    638                    else
    639                    {
    640                      th=GetFontHeight(isBold?FONT_SMALL_BOLD:FONT_SMALL,isUnderline?TEXT_UNDERLINE:0);
    641                    }
    642                    if ( th > max_ref_height)
    643                      max_ref_height = th;
    644                  }
    645          
    646                  if ((c==UTF16_PAPER_RGBA)||(c==UTF16_INK_RGBA))
    647                  {
    648                    len--;
    649                    ws->wsbody[++dc]=vd->rawtext[++sc];
    650                    len--;
    651                    ws->wsbody[++dc]=vd->rawtext[++sc];
    652                  }
    653                  L1:
    654                  sc++;
    655                  len--;
    656                }
    657                ws->wsbody[0]=dc;
    658                y2=lc->pixheight+ypos;
    659                if (do_draw)
    660                {
    661                  if (y2!=ypos)
    662                  {
    663                    x=MARGIN/2;
    664                    if (lc->right) x=scr_w-ws_width;
    665                    if (lc->center||lc->centerAtAll) x=(ScreenW()-ws_width)/2;
    666                    
    667                    def_ink[0]=lc[lprev].ink1>>8;
    668                    def_ink[1]=lc[lprev].ink1;
    669                    def_ink[2]=lc[lprev].ink2>>8;
    670                    def_ink[3]=lc[lprev].ink2;
    671                    
    672                    for (int i=0; i!=cur_rc; i++)
    673                    {
    674                      DrawRectangle(rc[i].start_x,ypos,rc[i].end_x,y2,
    675                                    RECT_FILL_WITH_PEN,rc[i].color,rc[i].color);
    676                    }
    677                    
    678                    if (ena_ref) rcs_work.x2=ws_width;
    679                    if ((rcs_work.x!=0||rcs_work.x2!=0)&&rcs_work.x!=rcs_work.x2)
    680                    {
    681                      rcs_work.y=y2-max_ref_height;
    682                      rcs_work.y2=y2;
    683                      rcs_work.x+=x;
    684                      rcs_work.x2+=x;
    685                     
    686                      
    687                      rcs_work.x-=2;
    688                      rcs_work.x2++;
    689                      rcs_work.y--;
    690                      
    691                      if (rcs_work.x<0) rcs_work.x=0;
    692                      if (rcs_work.x2>scr_w) rcs_work.x2=scr_w;
    693                      
    694                      memcpy(&rcs[rcs_num],&rcs_work,sizeof(RECT));
    695                      rcs_num++;
    696                    }
    697                    
    698           
    699                    DrawString(ws,x,ypos,scr_w-1,y2,
    700                               lc[lprev].bold?FONT_SMALL_BOLD:FONT_SMALL,
    701                               TEXT_NOFORMAT+(lc[lprev].underline?TEXT_UNDERLINE:0),
    702                               def_ink,GetPaletteAdrByColorIndex(23));
    703                    
    704                    for (int i = 0; form_data[i].form_rf != 0; i++)
    705                    {           
    706                      renderForm(vd, form_data[i].form_rf, form_data[i].form_x+x, ypos, y2, form_data[i].form_char, form_data[i].isRef);
    707                    }
    708                    
    709                    if (rc_search.x!=rc_search.x2)
    710                    {
    711                      char cl[4];
    712                      setColor(255,0,0,100,cl);
    713                      if (rc_search.x == 0)
    714                        rc_search.x = MARGIN/2;
    715                      if (rc_search.x2 == 0)
    716                        rc_search.x2 = scr_w-1;
    717                      DrawLine(rc_search.x,y2-2,rc_search.x2,y2-2, 0, cl);
    718                      DrawLine(rc_search.x,y2-1,rc_search.x2,y2-1, 0, cl);
    719                    }
    720                     
    721                  }
    722                  
    723                  
    724                  if (y2>=scr_h||lcheck)
    725                  {
    726                    if ((!cfgInvertCursor) && (rcs_num))
    727                    {
    728                      char* cl;
    729                      cl = (char*)cfgCursorColor;
    730                      REFCACHE *rf=FindReferenceByBegin(vd,vd->pos_cur_ref);
    731                      if (rf->tag=='Z') 
    732                        cl = (char*)cfgCursorColorPictures;
    733                      for (int i=0;i<rcs_num;i++)
    734                      {
    735           
    736                         DrawLine(rcs[i].x2  ,rcs[i].y  ,rcs[i].x2  ,rcs[i].y2  ,0,cl);
    737                         DrawLine(rcs[i].x2-1,rcs[i].y  ,rcs[i].x2-1,rcs[i].y2  ,0,cl);
    738                         if (i+1<rcs_num&&rcs[i].x<rcs[i+1].x2)
    739                         {
    740                           DrawLine(rcs[i].x2,rcs[i].y2,rcs[i+1].x2,rcs[i].y2,0,cl);
    741                           if (rcs[i].x2>rcs[i+1].x2)
    742                             DrawLine(rcs[i].x2-1,rcs[i].y2+1,rcs[i+1].x2+1,rcs[i].y2+1,0,cl);
    743                           else
    744                             DrawLine(rcs[i].x2+1,rcs[i].y2+1,rcs[i+1].x2-1,rcs[i].y2+1,0,cl);
    745                         }
    746                         else
    747                         {
    748                           DrawLine(rcs[i].x2  ,rcs[i].y2  ,rcs[i].x  ,rcs[i].y2  ,0,cl);
    749                           DrawLine(rcs[i].x2-1,rcs[i].y2+1,rcs[i].x+1,rcs[i].y2+1,0,cl);
    750                         }
    751                         DrawLine(rcs[i].x  ,rcs[i].y2  ,rcs[i].x  ,rcs[i].y  ,0,cl);
    752                         DrawLine(rcs[i].x+1,rcs[i].y2  ,rcs[i].x+1,rcs[i].y  ,0,cl);
    753                         if (i>0&&rcs[i].x2>rcs[i-1].x)
    754                         {
    755                           DrawLine(rcs[i].x,rcs[i].y,rcs[i-1].x,rcs[i].y,0,cl);
    756                           if (rcs[i].x<rcs[i-1].x)
    757                             DrawLine(rcs[i].x+1,rcs[i].y-1,rcs[i-1].x-1,rcs[i].y-1,0,cl);
    758                           else
    759                             DrawLine(rcs[i].x-1,rcs[i].y-1,rcs[i-1].x+1,rcs[i].y-1,0,cl);
    760                         }
    761                         else
    762                         {
    763                           DrawLine(rcs[i].x  ,rcs[i].y  ,rcs[i].x2 , rcs[i].y  ,0,cl);
    764                           DrawLine(rcs[i].x+1,rcs[i].y-1,rcs[i].x2-1,rcs[i].y-1,0,cl);
    765                         }
    766                      }
    767                    }
    768                    
    769                    if (vd->lines_cache_size)
    770                    {
    771                      LINECACHE *lastline = vd->lines_cache + vd->lines_cache_size - 1;
    772                      int pageheight = lastline->ycoord + lastline->pixheight;
    773                      if (pageheight)
    774                      {
    775                        unsigned int ycoord = vd->lines_cache[store_line].ycoord;
    776                        unsigned int scrh = scr_h-scr_shift+1;
    777                        int b = (ycoord+vd->pixdisp)*scrh/pageheight+scr_shift;
    778                        int e = scrh*scrh/pageheight;
    779                        if (e < 4) e = 4;  
    780                        if (e < scrh)
    781                        {
    782              #ifdef ELKA
    783                          char cl1[4];
    784                          setColor(160,48,48,100,cl1);
    785                          char cl2[4];
    786                          setColor(160,16,16,100,cl2);
    787                          char cl3[4];
    788                          setColor(136,140,136,100,cl3);
    789                          char cl4[4];
    790                          setColor(200,204,200,100,cl4);
    791                          DrawLine(ScreenW()-2,scr_shift,ScreenW()-2,ScreenH()-1, 0, cl3);
    792                          DrawLine(ScreenW()-1,scr_shift,ScreenW()-1,ScreenH()-1, 0, cl4);
    793                          DrawLine(ScreenW()-2,b,ScreenW()-2,b+e, 0, cl1);
    794                          DrawLine(ScreenW()-1,b,ScreenW()-1,b+e, 0, cl2);
    795              #else
    796                          DrawRectangle(ScreenW()-1,b,ScreenW(),b+e,0,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(2));
    797              #endif
    798                        }
    799                      }
    800                    }
    801                    
    802          //        if (ballet_fexists("$ballet\\debug.txt"))
    803          //        {
    804          //          WSHDR *ws;
    805          //          ws=AllocWS(128);
    806          ////          for (int i=store_line;i<=vl;i++)
    807          ////          {
    808          ////            wsprintf(ws,"%u: %u %c%c h:%u",i,vd->lines_cache[i].pos,vd->lines_cache[i].center?'+':'-',vd->lines_cache[i].right?'>':'<',vd->lines_cache[i].pixheight);
    809          ////            DrawString(ws,3,(1+i-store_line)*14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(23));
    810          ////          }
    811          //          {
    812          //            wsprintf(ws,"%i",ws_width);
    813          //            DrawString(ws,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    814          //            wsprintf(ws,"%u %u",vd->pos_first_ref,vd->pos_last_ref);
    815          //            DrawString(ws,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    816          //            wsprintf(ws,"%u %u",vd->pos_prev_ref,vd->pos_next_ref);
    817          //            DrawString(ws,3,26,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    818          //            wsprintf(ws,"%u %c",vd->pos_cur_ref,FindReference(vd,vd->pos_cur_ref)?FindReference(vd,vd->pos_cur_ref)->tag:'0');
    819          //            DrawString(ws,3,38,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    820          //            wsprintf(ws,"%i",vd->pixdisp);
    821          //            DrawString(ws,3,50,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    822          ////            ws->wsbody[0]=10;
    823          ////            memcpy(&(ws->wsbody[1]),(vd->rawtext+store_pos),10);
    824          ////            DrawString(ws,3,50,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    825          //          }
    826          //          FreeWS(ws);
    827          //        }
    828                  }
    829                }
    830                else
    831                  vd->found_word_pos = -1;
   \                     ??RenderPage_1:
   \   000000A4   0000E0E3           MVN      R0,#+0
   \   000000A8   E80084E5           STR      R0,[R4, #+232]
    832                ypos=y2;
    833                vl++;
   \                     ??RenderPage_2:
   \   000000AC   2C109DE5           LDR      R1,[SP, #+44]
   \   000000B0   08609DE5           LDR      R6,[SP, #+8]
   \   000000B4   011081E2           ADD      R1,R1,#+1
   \   000000B8   2C108DE5           STR      R1,[SP, #+44]
   \                     ??RenderPage_0:
   \   000000BC   3C009DE5           LDR      R0,[SP, #+60]
   \   000000C0   060050E1           CMP      R0,R6
   \   000000C4   6A0300BA           BLT      ??RenderPage_3
   \   000000C8   20009DE5           LDR      R0,[SP, #+32]
   \   000000CC   000050E3           CMP      R0,#+0
   \   000000D0   0600001A           BNE      ??RenderPage_4
   \   000000D4   0400A0E1           MOV      R0,R4
   \   000000D8   ........           BL       LineDown
   \   000000DC   000050E3           CMP      R0,#+0
   \   000000E0   0600001A           BNE      ??RenderPage_5
   \   000000E4   0110A0E3           MOV      R1,#+1
   \   000000E8   20108DE5           STR      R1,[SP, #+32]
   \   000000EC   030000EA           B        ??RenderPage_5
   \                     ??RenderPage_4:
   \   000000F0   011080E2           ADD      R1,R0,#+1
   \   000000F4   20108DE5           STR      R1,[SP, #+32]
   \   000000F8   020051E3           CMP      R1,#+2
   \   000000FC   5C0300AA           BGE      ??RenderPage_3
   \                     ??RenderPage_5:
   \   00000100   140094E5           LDR      R0,[R4, #+20]
   \   00000104   000050E3           CMP      R0,#+0
   \   00000108   5903000A           BEQ      ??RenderPage_3
   \   0000010C   2C109DE5           LDR      R1,[SP, #+44]
   \   00000110   103094E5           LDR      R3,[R4, #+16]
   \   00000114   1420A0E3           MOV      R2,#+20
   \   00000118   923121E0           MLA      R1,R2,R1,R3
   \   0000011C   0070A0E3           MOV      R7,#+0
   \   00000120   04108DE5           STR      R1,[SP, #+4]
   \   00000124   2C009DE5           LDR      R0,[SP, #+44]
   \   00000128   0080A0E3           MOV      R8,#+0
   \   0000012C   000050E3           CMP      R0,#+0
   \   00000130   0010E013           MVNNE    R1,#+0
   \   00000134   68108D15           STRNE    R1,[SP, #+104]
   \   00000138   0110A0E3           MOV      R1,#+1
   \   0000013C   14108DE5           STR      R1,[SP, #+20]
   \   00000140   0810A0E3           MOV      R1,#+8
   \   00000144   24008DE2           ADD      R0,SP,#+36
   \   00000148   1D0100EF           SWI      +285
   \   0000014C   0810A0E3           MOV      R1,#+8
   \   00000150   0C008DE2           ADD      R0,SP,#+12
   \   00000154   1D0100EF           SWI      +285
   \   00000158   801FA0E3           MOV      R1,#+512
   \   0000015C   78008DE2           ADD      R0,SP,#+120
   \   00000160   1D0100EF           SWI      +285
   \   00000164   0710A0E1           MOV      R1,R7
   \   00000168   58108DE5           STR      R1,[SP, #+88]
   \   0000016C   5C108DE5           STR      R1,[SP, #+92]
   \   00000170   0210A0E3           MOV      R1,#+2
   \   00000174   7C128DE5           STR      R1,[SP, #+636]
   \   00000178   38109DE5           LDR      R1,[SP, #+56]
   \   0000017C   1420A0E3           MOV      R2,#+20
   \   00000180   011041E2           SUB      R1,R1,#+1
   \   00000184   60108DE5           STR      R1,[SP, #+96]
   \   00000188   80128DE5           STR      R1,[SP, #+640]
   \   0000018C   68109DE5           LDR      R1,[SP, #+104]
   \   00000190   04309DE5           LDR      R3,[SP, #+4]
   \   00000194   923121E0           MLA      R1,R2,R1,R3
   \   00000198   00108DE5           STR      R1,[SP, #+0]
   \   0000019C   B810D1E1           LDRH     R1,[R1, #+8]
   \   000001A0   2114A0E1           LSR      R1,R1,#+8
   \   000001A4   7812CDE5           STRB     R1,[SP, #+632]
   \   000001A8   00109DE5           LDR      R1,[SP, #+0]
   \   000001AC   B810D1E1           LDRH     R1,[R1, #+8]
   \   000001B0   7912CDE5           STRB     R1,[SP, #+633]
   \   000001B4   00109DE5           LDR      R1,[SP, #+0]
   \   000001B8   BA10D1E1           LDRH     R1,[R1, #+10]
   \   000001BC   2114A0E1           LSR      R1,R1,#+8
   \   000001C0   7A12CDE5           STRB     R1,[SP, #+634]
   \   000001C4   00109DE5           LDR      R1,[SP, #+0]
   \   000001C8   BA10D1E1           LDRH     R1,[R1, #+10]
   \   000001CC   7B12CDE5           STRB     R1,[SP, #+635]
   \   000001D0   2C009DE5           LDR      R0,[SP, #+44]
   \   000001D4   001093E5           LDR      R1,[R3, #+0]
   \   000001D8   000050E3           CMP      R0,#+0
   \   000001DC   00009D15           LDRNE    R0,[SP, #+0]
   \   000001E0   00909015           LDRNE    R9,[R0, #+0]
   \   000001E4   091041E0           SUB      R1,R1,R9
   \   000001E8   30108DE5           STR      R1,[SP, #+48]
   \   000001EC   00009DE5           LDR      R0,[SP, #+0]
   \   000001F0   BC00D0E1           LDRH     R0,[R0, #+12]
   \   000001F4   010010E3           TST      R0,#0x1
   \   000001F8   0110A013           MOVNE    R1,#+1
   \   000001FC   48108D15           STRNE    R1,[SP, #+72]
   \   00000200   00009DE5           LDR      R0,[SP, #+0]
   \   00000204   BC00D0E1           LDRH     R0,[R0, #+12]
   \   00000208   020010E3           TST      R0,#0x2
   \   0000020C   0110A013           MOVNE    R1,#+1
   \   00000210   50108D15           STRNE    R1,[SP, #+80]
   \   00000214   8C1C9FE5           LDR      R1,??RenderPage_6  ;; cfgInvertCursor
   \   00000218   001091E5           LDR      R1,[R1, #+0]
   \   0000021C   18108DE5           STR      R1,[SP, #+24]
   \   00000220   000051E3           CMP      R1,#+0
   \   00000224   00005513           CMPNE    R5,#+0
   \   00000228   2600000A           BEQ      ??RenderPage_7
   \   0000022C   40009DE5           LDR      R0,[SP, #+64]
   \   00000230   0180A0E3           MOV      R8,#+1
   \   00000234   000090E5           LDR      R0,[R0, #+0]
   \   00000238   0510A0E3           MOV      R1,#+5
   \   0000023C   E01C81E3           ORR      R1,R1,#0xE000
   \   00000240   B210C0E1           STRH     R1,[R0, #+2]
   \   00000244   1F0000EA           B        ??RenderPage_7
   \                     ??RenderPage_8:
   \   00000248   ........           BL       GetFontHeight
   \                     ??RenderPage_9:
   \   0000024C   5C109DE5           LDR      R1,[SP, #+92]
   \   00000250   000051E1           CMP      R1,R0
   \   00000254   5C008DB5           STRLT    R0,[SP, #+92]
   \                     ??RenderPage_10:
   \   00000258   0700A0E3           MOV      R0,#+7
   \   0000025C   E00C80E3           ORR      R0,R0,#0xE000
   \   00000260   00005AE1           CMP      R10,R0
   \   00000264   0100C013           BICNE    R0,R0,#0x1
   \   00000268   00005A11           CMPNE    R10,R0
   \   0000026C   1100001A           BNE      ??RenderPage_11
   \   00000270   080094E5           LDR      R0,[R4, #+8]
   \   00000274   40309DE5           LDR      R3,[SP, #+64]
   \   00000278   012089E2           ADD      R2,R9,#+1
   \   0000027C   003093E5           LDR      R3,[R3, #+0]
   \   00000280   829080E0           ADD      R9,R0,R2, LSL #+1
   \   00000284   B090D9E1           LDRH     R9,[R9, #+0]
   \   00000288   011088E2           ADD      R1,R8,#+1
   \   0000028C   818083E0           ADD      R8,R3,R1, LSL #+1
   \   00000290   B090C8E1           STRH     R9,[R8, #+0]
   \   00000294   30909DE5           LDR      R9,[SP, #+48]
   \   00000298   018081E2           ADD      R8,R1,#+1
   \   0000029C   029049E2           SUB      R9,R9,#+2
   \   000002A0   30908DE5           STR      R9,[SP, #+48]
   \   000002A4   019082E2           ADD      R9,R2,#+1
   \   000002A8   890080E0           ADD      R0,R0,R9, LSL #+1
   \   000002AC   B000D0E1           LDRH     R0,[R0, #+0]
   \   000002B0   881083E0           ADD      R1,R3,R8, LSL #+1
   \   000002B4   B000C1E1           STRH     R0,[R1, #+0]
   \                     ??RenderPage_11:
   \   000002B8   30109DE5           LDR      R1,[SP, #+48]
   \   000002BC   019089E2           ADD      R9,R9,#+1
   \   000002C0   011041E2           SUB      R1,R1,#+1
   \   000002C4   30108DE5           STR      R1,[SP, #+48]
   \                     ??RenderPage_7:
   \   000002C8   30009DE5           LDR      R0,[SP, #+48]
   \   000002CC   000050E3           CMP      R0,#+0
   \   000002D0   DE00000A           BEQ      ??RenderPage_12
   \   000002D4   FA0058E3           CMP      R8,#+250
   \   000002D8   DC0000AA           BGE      ??RenderPage_12
   \   000002DC   080094E5           LDR      R0,[R4, #+8]
   \   000002E0   02B087E2           ADD      R11,R7,#+2
   \   000002E4   890080E0           ADD      R0,R0,R9, LSL #+1
   \   000002E8   B0A0D0E1           LDRH     R10,[R0, #+0]
   \   000002EC   E80094E5           LDR      R0,[R4, #+232]
   \   000002F0   000059E1           CMP      R9,R0
   \   000002F4   B4B2CD01           STRHEQ   R11,[SP, #+36]
   \   000002F8   010070E3           CMN      R0,#+1
   \   000002FC   0600000A           BEQ      ??RenderPage_13
   \   00000300   ........           LDR      R0,??DataTable2  ;; search_string
   \   00000304   000090E5           LDR      R0,[R0, #+0]
   \   00000308   230100EF           SWI      +291
   \   0000030C   E81094E5           LDR      R1,[R4, #+232]
   \   00000310   010080E0           ADD      R0,R0,R1
   \   00000314   000059E1           CMP      R9,R0
   \   00000318   B8B2CD01           STRHEQ   R11,[SP, #+40]
   \                     ??RenderPage_13:
   \   0000031C   0500A0E3           MOV      R0,#+5
   \   00000320   E00C80E3           ORR      R0,R0,#0xE000
   \   00000324   00005AE1           CMP      R10,R0
   \   00000328   3500001A           BNE      ??RenderPage_14
   \   0000032C   04009DE5           LDR      R0,[SP, #+4]
   \   00000330   54109DE5           LDR      R1,[SP, #+84]
   \   00000334   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000338   010050E1           CMP      R0,R1
   \   0000033C   020000AA           BGE      ??RenderPage_15
   \   00000340   000056E3           CMP      R6,#+0
   \   00000344   0500005A           BPL      ??RenderPage_16
   \   00000348   DAFFFFEA           B        ??RenderPage_11
   \                     ??RenderPage_15:
   \   0000034C   04009DE5           LDR      R0,[SP, #+4]
   \   00000350   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000354   060080E0           ADD      R0,R0,R6
   \   00000358   010050E0           SUBS     R0,R0,R1
   \   0000035C   D5FFFF4A           BMI      ??RenderPage_11
   \                     ??RenderPage_16:
   \   00000360   04009DE5           LDR      R0,[SP, #+4]
   \   00000364   BE00D0E1           LDRH     R0,[R0, #+14]
   \   00000368   010050E1           CMP      R0,R1
   \   0000036C   3C009DE5           LDR      R0,[SP, #+60]
   \   00000370   050000AA           BGE      ??RenderPage_17
   \   00000374   04109DE5           LDR      R1,[SP, #+4]
   \   00000378   BE10D1E1           LDRH     R1,[R1, #+14]
   \   0000037C   061081E0           ADD      R1,R1,R6
   \   00000380   010050E1           CMP      R0,R1
   \   00000384   030000AA           BGE      ??RenderPage_18
   \   00000388   CAFFFFEA           B        ??RenderPage_11
   \                     ??RenderPage_17:
   \   0000038C   061081E0           ADD      R1,R1,R6
   \   00000390   010050E1           CMP      R0,R1
   \   00000394   C7FFFFBA           BLT      ??RenderPage_11
   \                     ??RenderPage_18:
   \   00000398   280094E5           LDR      R0,[R4, #+40]
   \   0000039C   090050E1           CMP      R0,R9
   \   000003A0   0700001A           BNE      ??RenderPage_19
   \   000003A4   0110A0E3           MOV      R1,#+1
   \   000003A8   4C108DE5           STR      R1,[SP, #+76]
   \   000003AC   0150A0E3           MOV      R5,#+1
   \   000003B0   BC70CDE1           STRH     R7,[SP, #+12]
   \                     ??RenderPage_20:
   \   000003B4   18009DE5           LDR      R0,[SP, #+24]
   \   000003B8   000050E3           CMP      R0,#+0
   \   000003BC   5600001A           BNE      ??RenderPage_21
   \   000003C0   BCFFFFEA           B        ??RenderPage_11
   \                     ??RenderPage_19:
   \   000003C4   2C0094E5           LDR      R0,[R4, #+44]
   \   000003C8   010070E3           CMN      R0,#+1
   \   000003CC   2C908405           STREQ    R9,[R4, #+44]
   \   000003D0   4C009DE5           LDR      R0,[SP, #+76]
   \   000003D4   000050E3           CMP      R0,#+0
   \   000003D8   34908405           STREQ    R9,[R4, #+52]
   \   000003DC   0300000A           BEQ      ??RenderPage_22
   \   000003E0   010050E3           CMP      R0,#+1
   \   000003E4   38908405           STREQ    R9,[R4, #+56]
   \   000003E8   0210A003           MOVEQ    R1,#+2
   \   000003EC   4C108D05           STREQ    R1,[SP, #+76]
   \                     ??RenderPage_22:
   \   000003F0   309084E5           STR      R9,[R4, #+48]
   \   000003F4   000055E3           CMP      R5,#+0
   \   000003F8   AEFFFF0A           BEQ      ??RenderPage_11
   \   000003FC   015085E2           ADD      R5,R5,#+1
   \   00000400   ACFFFFEA           B        ??RenderPage_11
   \                     ??RenderPage_14:
   \   00000404   0100C0E3           BIC      R0,R0,#0x1
   \   00000408   00005AE1           CMP      R10,R0
   \   0000040C   0800001A           BNE      ??RenderPage_23
   \   00000410   010055E3           CMP      R5,#+1
   \   00000414   0300000A           BEQ      ??RenderPage_24
   \   00000418   000055E3           CMP      R5,#+0
   \   0000041C   A5FFFF0A           BEQ      ??RenderPage_11
   \   00000420   015045E2           SUB      R5,R5,#+1
   \   00000424   A3FFFFEA           B        ??RenderPage_11
   \                     ??RenderPage_24:
   \   00000428   B071CDE1           STRH     R7,[SP, #+16]
   \   0000042C   0050A0E3           MOV      R5,#+0
   \   00000430   DFFFFFEA           B        ??RenderPage_20
   \                     ??RenderPage_23:
   \   00000434   030080E3           ORR      R0,R0,#0x3
   \   00000438   00005AE1           CMP      R10,R0
   \   0000043C   2C00001A           BNE      ??RenderPage_25
   \   00000440   14009DE5           LDR      R0,[SP, #+20]
   \   00000444   200050E3           CMP      R0,#+32
   \   00000448   330000AA           BGE      ??RenderPage_21
   \   0000044C   0C10A0E3           MOV      R1,#+12
   \   00000450   9E2F8DE2           ADD      R2,SP,#+632
   \   00000454   91202BE0           MLA      R11,R1,R0,R2
   \   00000458   0420A0E3           MOV      R2,#+4
   \   0000045C   0C104BE2           SUB      R1,R11,#+12
   \   00000460   64108DE5           STR      R1,[SP, #+100]
   \   00000464   080094E5           LDR      R0,[R4, #+8]
   \   00000468   890080E0           ADD      R0,R0,R9, LSL #+1
   \   0000046C   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000470   2004A0E1           LSR      R0,R0,#+8
   \   00000474   0000CBE5           STRB     R0,[R11, #+0]
   \   00000478   080094E5           LDR      R0,[R4, #+8]
   \   0000047C   890080E0           ADD      R0,R0,R9, LSL #+1
   \   00000480   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000484   0100CBE5           STRB     R0,[R11, #+1]
   \   00000488   080094E5           LDR      R0,[R4, #+8]
   \   0000048C   890080E0           ADD      R0,R0,R9, LSL #+1
   \   00000490   B400D0E1           LDRH     R0,[R0, #+4]
   \   00000494   2004A0E1           LSR      R0,R0,#+8
   \   00000498   0200CBE5           STRB     R0,[R11, #+2]
   \   0000049C   080094E5           LDR      R0,[R4, #+8]
   \   000004A0   890080E0           ADD      R0,R0,R9, LSL #+1
   \   000004A4   B400D0E1           LDRH     R0,[R0, #+4]
   \   000004A8   0300CBE5           STRB     R0,[R11, #+3]
   \   000004AC   64109DE5           LDR      R1,[SP, #+100]
   \   000004B0   0B00A0E1           MOV      R0,R11
   \   000004B4   1C0100EF           SWI      +284
   \   000004B8   000050E3           CMP      R0,#+0
   \   000004BC   1600000A           BEQ      ??RenderPage_21
   \   000004C0   64109DE5           LDR      R1,[SP, #+100]
   \   000004C4   000057E3           CMP      R7,#+0
   \   000004C8   01008712           ADDNE    R0,R7,#+1
   \   000004CC   0200A003           MOVEQ    R0,#+2
   \   000004D0   080081E5           STR      R0,[R1, #+8]
   \   000004D4   020087E2           ADD      R0,R7,#+2
   \   000004D8   04008BE5           STR      R0,[R11, #+4]
   \   000004DC   60009DE5           LDR      R0,[SP, #+96]
   \   000004E0   08008BE5           STR      R0,[R11, #+8]
   \   000004E4   14109DE5           LDR      R1,[SP, #+20]
   \   000004E8   011081E2           ADD      R1,R1,#+1
   \   000004EC   14108DE5           STR      R1,[SP, #+20]
   \   000004F0   090000EA           B        ??RenderPage_21
   \                     ??RenderPage_25:
   \   000004F4   150080E2           ADD      R0,R0,#+21
   \   000004F8   00005AE1           CMP      R10,R0
   \   000004FC   01008013           ORRNE    R0,R0,#0x1
   \   00000500   00005A11           CMPNE    R10,R0
   \   00000504   01008012           ADDNE    R0,R0,#+1
   \   00000508   00005A11           CMPNE    R10,R0
   \   0000050C   01008013           ORRNE    R0,R0,#0x1
   \   00000510   00005A11           CMPNE    R10,R0
   \   00000514   0A005A13           CMPNE    R10,#+10
   \   00000518   66FFFF0A           BEQ      ??RenderPage_11
   \                     ??RenderPage_21:
   \   0000051C   FF0C0AE2           AND      R0,R10,#0xFF00
   \   00000520   E10C50E3           CMP      R0,#+57600
   \   00000524   1700001A           BNE      ??RenderPage_26
   \   00000528   011049E2           SUB      R1,R9,#+1
   \   0000052C   0400A0E1           MOV      R0,R4
   \   00000530   ........           BL       FindReferenceByBegin
   \   00000534   000050E3           CMP      R0,#+0
   \   00000538   1200000A           BEQ      ??RenderPage_26
   \   0000053C   FC1094E5           LDR      R1,[R4, #+252]
   \   00000540   01005AE1           CMP      R10,R1
   \   00000544   00119415           LDRNE    R1,[R4, #+256]
   \   00000548   01005A11           CMPNE    R10,R1
   \   0000054C   08109015           LDRNE    R1,[R0, #+8]
   \   00000550   75005113           CMPNE    R1,#+117
   \   00000554   0B00001A           BNE      ??RenderPage_26
   \   00000558   58109DE5           LDR      R1,[SP, #+88]
   \   0000055C   78208DE2           ADD      R2,SP,#+120
   \   00000560   011282E0           ADD      R1,R2,R1, LSL #+4
   \   00000564   000081E5           STR      R0,[R1, #+0]
   \   00000568   047081E5           STR      R7,[R1, #+4]
   \   0000056C   08A081E5           STR      R10,[R1, #+8]
   \   00000570   18009DE5           LDR      R0,[SP, #+24]
   \   00000574   000050E3           CMP      R0,#+0
   \   00000578   0C508115           STRNE    R5,[R1, #+12]
   \   0000057C   58109DE5           LDR      R1,[SP, #+88]
   \   00000580   011081E2           ADD      R1,R1,#+1
   \   00000584   58108DE5           STR      R1,[SP, #+88]
   \                     ??RenderPage_26:
   \   00000588   0100A0E3           MOV      R0,#+1
   \   0000058C   E00C80E3           ORR      R0,R0,#0xE000
   \   00000590   00005AE1           CMP      R10,R0
   \   00000594   0200001A           BNE      ??RenderPage_27
   \   00000598   0110A0E3           MOV      R1,#+1
   \                     ??RenderPage_28:
   \   0000059C   50108DE5           STR      R1,[SP, #+80]
   \   000005A0   0C0000EA           B        ??RenderPage_29
   \                     ??RenderPage_27:
   \   000005A4   010080E2           ADD      R0,R0,#+1
   \   000005A8   00005AE1           CMP      R10,R0
   \   000005AC   0010A003           MOVEQ    R1,#+0
   \   000005B0   F9FFFF0A           BEQ      ??RenderPage_28
   \   000005B4   110080E3           ORR      R0,R0,#0x11
   \   000005B8   00005AE1           CMP      R10,R0
   \   000005BC   0110A003           MOVEQ    R1,#+1
   \   000005C0   0300000A           BEQ      ??RenderPage_30
   \   000005C4   0100C0E3           BIC      R0,R0,#0x1
   \   000005C8   00005AE1           CMP      R10,R0
   \   000005CC   0100001A           BNE      ??RenderPage_29
   \   000005D0   0010A0E3           MOV      R1,#+0
   \                     ??RenderPage_30:
   \   000005D4   48108DE5           STR      R1,[SP, #+72]
   \                     ??RenderPage_29:
   \   000005D8   40009DE5           LDR      R0,[SP, #+64]
   \   000005DC   018088E2           ADD      R8,R8,#+1
   \   000005E0   000090E5           LDR      R0,[R0, #+0]
   \   000005E4   880080E0           ADD      R0,R0,R8, LSL #+1
   \   000005E8   B0A0C0E1           STRH     R10,[R0, #+0]
   \   000005EC   48009DE5           LDR      R0,[SP, #+72]
   \   000005F0   000050E3           CMP      R0,#+0
   \   000005F4   0910A013           MOVNE    R1,#+9
   \   000005F8   0810A003           MOVEQ    R1,#+8
   \   000005FC   0A00A0E1           MOV      R0,R10
   \   00000600   E10100EF           SWI      +481
   \   00000604   077080E0           ADD      R7,R0,R7
   \   00000608   000055E3           CMP      R5,#+0
   \   0000060C   11FFFF0A           BEQ      ??RenderPage_10
   \   00000610   FF0C0AE2           AND      R0,R10,#0xFF00
   \   00000614   E10C50E3           CMP      R0,#+57600
   \   00000618   0300001A           BNE      ??RenderPage_31
   \   0000061C   0A00A0E1           MOV      R0,R10
   \   00000620   E40100EF           SWI      +484
   \   00000624   210000EF           SWI      +33
   \   00000628   07FFFFEA           B        ??RenderPage_9
   \                     ??RenderPage_31:
   \   0000062C   50009DE5           LDR      R0,[SP, #+80]
   \   00000630   000050E3           CMP      R0,#+0
   \   00000634   48009DE5           LDR      R0,[SP, #+72]
   \   00000638   0810A013           MOVNE    R1,#+8
   \   0000063C   0010A003           MOVEQ    R1,#+0
   \   00000640   000050E3           CMP      R0,#+0
   \   00000644   0800A003           MOVEQ    R0,#+8
   \   00000648   0900A013           MOVNE    R0,#+9
   \   0000064C   FDFEFFEA           B        ??RenderPage_8
   \                     ??RenderPage_12:
   \   00000650   40009DE5           LDR      R0,[SP, #+64]
   \   00000654   000090E5           LDR      R0,[R0, #+0]
   \   00000658   B080C0E1           STRH     R8,[R0, #+0]
   \   0000065C   04109DE5           LDR      R1,[SP, #+4]
   \   00000660   BE10D1E1           LDRH     R1,[R1, #+14]
   \   00000664   011086E0           ADD      R1,R6,R1
   \   00000668   08108DE5           STR      R1,[SP, #+8]
   \   0000066C   F8049DE5           LDR      R0,[SP, #+1272]
   \   00000670   000050E3           CMP      R0,#+0
   \   00000674   8AFEFF0A           BEQ      ??RenderPage_1
   \   00000678   060051E1           CMP      R1,R6
   \   0000067C   BC00000A           BEQ      ??RenderPage_32
   \   00000680   04009DE5           LDR      R0,[SP, #+4]
   \   00000684   0280A0E3           MOV      R8,#+2
   \   00000688   BC00D0E1           LDRH     R0,[R0, #+12]
   \   0000068C   100010E3           TST      R0,#0x10
   \   00000690   38009D15           LDRNE    R0,[SP, #+56]
   \   00000694   07804010           SUBNE    R8,R0,R7
   \   00000698   04009DE5           LDR      R0,[SP, #+4]
   \   0000069C   BC00D0E1           LDRH     R0,[R0, #+12]
   \   000006A0   080010E3           TST      R0,#0x8
   \   000006A4   0300001A           BNE      ??RenderPage_33
   \   000006A8   04009DE5           LDR      R0,[SP, #+4]
   \   000006AC   BC00D0E1           LDRH     R0,[R0, #+12]
   \   000006B0   200010E3           TST      R0,#0x20
   \   000006B4   0300000A           BEQ      ??RenderPage_34
   \                     ??RenderPage_33:
   \   000006B8   888100EF           SWI      +33160
   \   000006BC   070040E0           SUB      R0,R0,R7
   \   000006C0   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   000006C4   C080A0E1           ASR      R8,R0,#+1
   \                     ??RenderPage_34:
   \   000006C8   00109DE5           LDR      R1,[SP, #+0]
   \   000006CC   00A0A0E3           MOV      R10,#+0
   \   000006D0   B410D1E1           LDRH     R1,[R1, #+4]
   \   000006D4   2114A0E1           LSR      R1,R1,#+8
   \   000006D8   3410CDE5           STRB     R1,[SP, #+52]
   \   000006DC   00109DE5           LDR      R1,[SP, #+0]
   \   000006E0   B410D1E1           LDRH     R1,[R1, #+4]
   \   000006E4   3510CDE5           STRB     R1,[SP, #+53]
   \   000006E8   00109DE5           LDR      R1,[SP, #+0]
   \   000006EC   B610D1E1           LDRH     R1,[R1, #+6]
   \   000006F0   2114A0E1           LSR      R1,R1,#+8
   \   000006F4   3610CDE5           STRB     R1,[SP, #+54]
   \   000006F8   00109DE5           LDR      R1,[SP, #+0]
   \   000006FC   B610D1E1           LDRH     R1,[R1, #+6]
   \   00000700   3710CDE5           STRB     R1,[SP, #+55]
   \   00000704   14009DE5           LDR      R0,[SP, #+20]
   \   00000708   000050E3           CMP      R0,#+0
   \   0000070C   1100000A           BEQ      ??RenderPage_35
   \                     ??RenderPage_36:
   \   00000710   0C10A0E3           MOV      R1,#+12
   \   00000714   9E0F8DE2           ADD      R0,SP,#+632
   \   00000718   910A20E0           MLA      R0,R1,R10,R0
   \   0000071C   01A08AE2           ADD      R10,R10,#+1
   \   00000720   0010A0E1           MOV      R1,R0
   \   00000724   02002DE9           PUSH     {R1}
   \   00000728   02002DE9           PUSH     {R1}
   \   0000072C   0210A0E3           MOV      R1,#+2
   \   00000730   02002DE9           PUSH     {R1}
   \   00000734   14309DE5           LDR      R3,[SP, #+20]
   \   00000738   082090E5           LDR      R2,[R0, #+8]
   \   0000073C   040090E5           LDR      R0,[R0, #+4]
   \   00000740   0610A0E1           MOV      R1,R6
   \   00000744   B40100EF           SWI      +436
   \   00000748   20009DE5           LDR      R0,[SP, #+32]
   \   0000074C   0CD08DE2           ADD      SP,SP,#+12
   \   00000750   00005AE1           CMP      R10,R0
   \   00000754   EDFFFF1A           BNE      ??RenderPage_36
   \                     ??RenderPage_35:
   \   00000758   000055E3           CMP      R5,#+0
   \   0000075C   B071CD11           STRHNE   R7,[SP, #+16]
   \   00000760   F001DDE1           LDRSH    R0,[SP, #+16]
   \   00000764   FC10DDE1           LDRSH    R1,[SP, #+12]
   \   00000768   000051E3           CMP      R1,#+0
   \   0000076C   00005003           CMPEQ    R0,#+0
   \   00000770   00005111           CMPNE    R1,R0
   \   00000774   2200000A           BEQ      ??RenderPage_37
   \   00000778   08109DE5           LDR      R1,[SP, #+8]
   \   0000077C   5C209DE5           LDR      R2,[SP, #+92]
   \   00000780   000088E0           ADD      R0,R8,R0
   \   00000784   021041E0           SUB      R1,R1,R2
   \   00000788   BE10CDE1           STRH     R1,[SP, #+14]
   \   0000078C   08309DE5           LDR      R3,[SP, #+8]
   \   00000790   011041E2           SUB      R1,R1,#+1
   \   00000794   B231CDE1           STRH     R3,[SP, #+18]
   \   00000798   FC30DDE1           LDRSH    R3,[SP, #+12]
   \   0000079C   033088E0           ADD      R3,R8,R3
   \   000007A0   BC30CDE1           STRH     R3,[SP, #+12]
   \   000007A4   B001CDE1           STRH     R0,[SP, #+16]
   \   000007A8   FC30DDE1           LDRSH    R3,[SP, #+12]
   \   000007AC   010080E2           ADD      R0,R0,#+1
   \   000007B0   023043E2           SUB      R3,R3,#+2
   \   000007B4   BC30CDE1           STRH     R3,[SP, #+12]
   \   000007B8   B001CDE1           STRH     R0,[SP, #+16]
   \   000007BC   BE10CDE1           STRH     R1,[SP, #+14]
   \   000007C0   FC10DDE1           LDRSH    R1,[SP, #+12]
   \   000007C4   0008A0E1           MOV      R0,R0, LSL #+16
   \   000007C8   FE3F8DE2           ADD      R3,SP,#+1016
   \   000007CC   000051E3           CMP      R1,#+0
   \   000007D0   0020A043           MOVMI    R2,#+0
   \   000007D4   BC20CD41           STRHMI   R2,[SP, #+12]
   \   000007D8   38109DE5           LDR      R1,[SP, #+56]
   \   000007DC   0820A0E3           MOV      R2,#+8
   \   000007E0   400851E1           CMP      R1,R0, ASR #+16
   \   000007E4   B011CDB1           STRHLT   R1,[SP, #+16]
   \   000007E8   1C009DE5           LDR      R0,[SP, #+28]
   \   000007EC   0C108DE2           ADD      R1,SP,#+12
   \   000007F0   800183E0           ADD      R0,R3,R0, LSL #+3
   \   000007F4   1E0100EF           SWI      +286
   \   000007F8   1C109DE5           LDR      R1,[SP, #+28]
   \   000007FC   011081E2           ADD      R1,R1,#+1
   \   00000800   1C108DE5           STR      R1,[SP, #+28]
   \                     ??RenderPage_37:
   \   00000804   1700A0E3           MOV      R0,#+23
   \   00000808   2E0100EF           SWI      +302
   \   0000080C   00109DE5           LDR      R1,[SP, #+0]
   \   00000810   00209DE5           LDR      R2,[SP, #+0]
   \   00000814   BC10D1E1           LDRH     R1,[R1, #+12]
   \   00000818   BC20D2E1           LDRH     R2,[R2, #+12]
   \   0000081C   01002DE9           PUSH     {R0}
   \   00000820   020011E3           TST      R1,#0x2
   \   00000824   0810A013           MOVNE    R1,#+8
   \   00000828   0010A003           MOVEQ    R1,#+0
   \   0000082C   38008DE2           ADD      R0,SP,#+56
   \   00000830   01002DE9           PUSH     {R0}
   \   00000834   010012E3           TST      R2,#0x1
   \   00000838   0920A013           MOVNE    R2,#+9
   \   0000083C   0820A003           MOVEQ    R2,#+8
   \   00000840   800081E2           ADD      R0,R1,#+128
   \   00000844   01002DE9           PUSH     {R0}
   \   00000848   04002DE9           PUSH     {R2}
   \   0000084C   18009DE5           LDR      R0,[SP, #+24]
   \   00000850   0620A0E1           MOV      R2,R6
   \   00000854   01002DE9           PUSH     {R0}
   \   00000858   74309DE5           LDR      R3,[SP, #+116]
   \   0000085C   54009DE5           LDR      R0,[SP, #+84]
   \   00000860   0810A0E1           MOV      R1,R8
   \   00000864   4C0100EF           SWI      +332
   \   00000868   8C009DE5           LDR      R0,[SP, #+140]
   \   0000086C   0070A0E3           MOV      R7,#+0
   \   00000870   000050E3           CMP      R0,#+0
   \   00000874   14D08DE2           ADD      SP,SP,#+20
   \   00000878   0E00001A           BNE      ??RenderPage_38
   \   0000087C   120000EA           B        ??RenderPage_39
   \                     ??RenderPage_40:
   \   00000880   0C1090E5           LDR      R1,[R0, #+12]
   \   00000884   0630A0E1           MOV      R3,R6
   \   00000888   02002DE9           PUSH     {R1}
   \   0000088C   081090E5           LDR      R1,[R0, #+8]
   \   00000890   017087E2           ADD      R7,R7,#+1
   \   00000894   02002DE9           PUSH     {R1}
   \   00000898   10109DE5           LDR      R1,[SP, #+16]
   \   0000089C   02002DE9           PUSH     {R1}
   \   000008A0   041090E5           LDR      R1,[R0, #+4]
   \   000008A4   012088E0           ADD      R2,R8,R1
   \   000008A8   001090E5           LDR      R1,[R0, #+0]
   \   000008AC   0400A0E1           MOV      R0,R4
   \   000008B0   ........           BL       renderForm
   \   000008B4   0CD08DE2           ADD      SP,SP,#+12
   \                     ??RenderPage_38:
   \   000008B8   78008DE2           ADD      R0,SP,#+120
   \   000008BC   070280E0           ADD      R0,R0,R7, LSL #+4
   \   000008C0   001090E5           LDR      R1,[R0, #+0]
   \   000008C4   000051E3           CMP      R1,#+0
   \   000008C8   ECFFFF1A           BNE      ??RenderPage_40
   \                     ??RenderPage_39:
   \   000008CC   F402DDE1           LDRSH    R0,[SP, #+36]
   \   000008D0   F812DDE1           LDRSH    R1,[SP, #+40]
   \   000008D4   010050E1           CMP      R0,R1
   \   000008D8   2500000A           BEQ      ??RenderPage_32
   \   000008DC   0D00A0E1           MOV      R0,SP
   \   000008E0   01002DE9           PUSH     {R0}
   \   000008E4   6430A0E3           MOV      R3,#+100
   \   000008E8   0020A0E3           MOV      R2,#+0
   \   000008EC   0010A0E3           MOV      R1,#+0
   \   000008F0   FF00A0E3           MOV      R0,#+255
   \   000008F4   310100EF           SWI      +305
   \   000008F8   F802DDE1           LDRSH    R0,[SP, #+40]
   \   000008FC   04D08DE2           ADD      SP,SP,#+4
   \   00000900   000050E3           CMP      R0,#+0
   \   00000904   0210A003           MOVEQ    R1,#+2
   \   00000908   B412CD01           STRHEQ   R1,[SP, #+36]
   \   0000090C   F802DDE1           LDRSH    R0,[SP, #+40]
   \   00000910   000050E3           CMP      R0,#+0
   \   00000914   38109D05           LDREQ    R1,[SP, #+56]
   \   00000918   01104102           SUBEQ    R1,R1,#+1
   \   0000091C   B812CD01           STRHEQ   R1,[SP, #+40]
   \   00000920   08009DE5           LDR      R0,[SP, #+8]
   \   00000924   021040E2           SUB      R1,R0,#+2
   \   00000928   0D00A0E1           MOV      R0,SP
   \   0000092C   01002DE9           PUSH     {R0}
   \   00000930   0130A0E1           MOV      R3,R1
   \   00000934   0000A0E3           MOV      R0,#+0
   \   00000938   01002DE9           PUSH     {R0}
   \   0000093C   F023DDE1           LDRSH    R2,[SP, #+48]
   \   00000940   FC02DDE1           LDRSH    R0,[SP, #+44]
   \   00000944   B30100EF           SWI      +435
   \   00000948   10009DE5           LDR      R0,[SP, #+16]
   \   0000094C   011040E2           SUB      R1,R0,#+1
   \   00000950   08008DE2           ADD      R0,SP,#+8
   \   00000954   01002DE9           PUSH     {R0}
   \   00000958   0130A0E1           MOV      R3,R1
   \   0000095C   0000A0E3           MOV      R0,#+0
   \   00000960   01002DE9           PUSH     {R0}
   \   00000964   F823DDE1           LDRSH    R2,[SP, #+56]
   \   00000968   F403DDE1           LDRSH    R0,[SP, #+52]
   \   0000096C   B30100EF           SWI      +435
   \   00000970   10D08DE2           ADD      SP,SP,#+16
   \                     ??RenderPage_32:
   \   00000974   08009DE5           LDR      R0,[SP, #+8]
   \   00000978   3C109DE5           LDR      R1,[SP, #+60]
   \   0000097C   010050E1           CMP      R0,R1
   \   00000980   0200002A           BCS      ??RenderPage_41
   \   00000984   20009DE5           LDR      R0,[SP, #+32]
   \   00000988   000050E3           CMP      R0,#+0
   \   0000098C   C6FDFF0A           BEQ      ??RenderPage_2
   \                     ??RenderPage_41:
   \   00000990   18009DE5           LDR      R0,[SP, #+24]
   \   00000994   000050E3           CMP      R0,#+0
   \   00000998   0E00001A           BNE      ??RenderPage_42
   \   0000099C   1C009DE5           LDR      R0,[SP, #+28]
   \   000009A0   000050E3           CMP      R0,#+0
   \   000009A4   0B00000A           BEQ      ??RenderPage_42
   \   000009A8   281094E5           LDR      R1,[R4, #+40]
   \   000009AC   F8649FE5           LDR      R6,??RenderPage_6+0x4  ;; cfgCursorColor
   \   000009B0   0400A0E1           MOV      R0,R4
   \   000009B4   ........           BL       FindReferenceByBegin
   \   000009B8   080090E5           LDR      R0,[R0, #+8]
   \   000009BC   0070A0E3           MOV      R7,#+0
   \   000009C0   5A0050E3           CMP      R0,#+90
   \   000009C4   1C009DE5           LDR      R0,[SP, #+28]
   \   000009C8   E0649F05           LDREQ    R6,??RenderPage_6+0x8  ;; cfgCursorColorPictures
   \   000009CC   010050E3           CMP      R0,#+1
   \   000009D0   07B0E0E3           MVN      R11,#+7
   \   000009D4   8D0000AA           BGE      ??RenderPage_43
   \                     ??RenderPage_42:
   \   000009D8   141094E5           LDR      R1,[R4, #+20]
   \   000009DC   000051E3           CMP      R1,#+0
   \   000009E0   B1FDFF0A           BEQ      ??RenderPage_2
   \   000009E4   100094E5           LDR      R0,[R4, #+16]
   \   000009E8   1420A0E3           MOV      R2,#+20
   \   000009EC   920121E0           MLA      R1,R2,R1,R0
   \   000009F0   141041E2           SUB      R1,R1,#+20
   \   000009F4   102091E5           LDR      R2,[R1, #+16]
   \   000009F8   BE10D1E1           LDRH     R1,[R1, #+14]
   \   000009FC   022091E0           ADDS     R2,R1,R2
   \   00000A00   A9FDFF0A           BEQ      ??RenderPage_2
   \   00000A04   3C109DE5           LDR      R1,[SP, #+60]
   \   00000A08   44309DE5           LDR      R3,[SP, #+68]
   \   00000A0C   1460A0E3           MOV      R6,#+20
   \   00000A10   031041E0           SUB      R1,R1,R3
   \   00000A14   013081E2           ADD      R3,R1,#+1
   \   00000A18   6C109DE5           LDR      R1,[SP, #+108]
   \   00000A1C   960120E0           MLA      R0,R6,R1,R0
   \   00000A20   201094E5           LDR      R1,[R4, #+32]
   \   00000A24   100090E5           LDR      R0,[R0, #+16]
   \   00000A28   000081E0           ADD      R0,R1,R0
   \   00000A2C   930000E0           MUL      R0,R3,R0
   \   00000A30   0210A0E1           MOV      R1,R2
   \   00000A34   ........           _BLF     ??divu32_a,??rA??divu32_a
   \   00000A38   44009DE5           LDR      R0,[SP, #+68]
   \   00000A3C   016080E0           ADD      R6,R0,R1
   \   00000A40   930300E0           MUL      R0,R3,R3
   \   00000A44   0210A0E1           MOV      R1,R2
   \   00000A48   ........           _BLF     ??divu32_a,??rA??divu32_a
   \   00000A4C   0170A0E1           MOV      R7,R1
   \   00000A50   040057E3           CMP      R7,#+4
   \   00000A54   0470A0B3           MOVLT    R7,#+4
   \   00000A58   030057E1           CMP      R7,R3
   \   00000A5C   92FDFF2A           BCS      ??RenderPage_2
   \   00000A60   0D00A0E1           MOV      R0,SP
   \   00000A64   01002DE9           PUSH     {R0}
   \   00000A68   6430A0E3           MOV      R3,#+100
   \   00000A6C   3020A0E3           MOV      R2,#+48
   \   00000A70   3010A0E3           MOV      R1,#+48
   \   00000A74   A000A0E3           MOV      R0,#+160
   \   00000A78   310100EF           SWI      +305
   \   00000A7C   08008DE2           ADD      R0,SP,#+8
   \   00000A80   01002DE9           PUSH     {R0}
   \   00000A84   6430A0E3           MOV      R3,#+100
   \   00000A88   1020A0E3           MOV      R2,#+16
   \   00000A8C   0210A0E1           MOV      R1,R2
   \   00000A90   A000A0E3           MOV      R0,#+160
   \   00000A94   310100EF           SWI      +305
   \   00000A98   1C008DE2           ADD      R0,SP,#+28
   \   00000A9C   01002DE9           PUSH     {R0}
   \   00000AA0   6430A0E3           MOV      R3,#+100
   \   00000AA4   8820A0E3           MOV      R2,#+136
   \   00000AA8   8C10A0E3           MOV      R1,#+140
   \   00000AAC   0200A0E1           MOV      R0,R2
   \   00000AB0   310100EF           SWI      +305
   \   00000AB4   24008DE2           ADD      R0,SP,#+36
   \   00000AB8   01002DE9           PUSH     {R0}
   \   00000ABC   6430A0E3           MOV      R3,#+100
   \   00000AC0   C820A0E3           MOV      R2,#+200
   \   00000AC4   CC10A0E3           MOV      R1,#+204
   \   00000AC8   0200A0E1           MOV      R0,R2
   \   00000ACC   310100EF           SWI      +305
   \   00000AD0   898100EF           SWI      +33161
   \   00000AD4   0080A0E1           MOV      R8,R0
   \   00000AD8   888100EF           SWI      +33160
   \   00000ADC   00A0A0E1           MOV      R10,R0
   \   00000AE0   888100EF           SWI      +33160
   \   00000AE4   24108DE2           ADD      R1,SP,#+36
   \   00000AE8   02002DE9           PUSH     {R1}
   \   00000AEC   013048E2           SUB      R3,R8,#+1
   \   00000AF0   02204AE2           SUB      R2,R10,#+2
   \   00000AF4   020040E2           SUB      R0,R0,#+2
   \   00000AF8   0010A0E3           MOV      R1,#+0
   \   00000AFC   02002DE9           PUSH     {R1}
   \   00000B00   5C109DE5           LDR      R1,[SP, #+92]
   \   00000B04   067087E0           ADD      R7,R7,R6
   \   00000B08   B30100EF           SWI      +435
   \   00000B0C   898100EF           SWI      +33161
   \   00000B10   0080A0E1           MOV      R8,R0
   \   00000B14   888100EF           SWI      +33160
   \   00000B18   00A0A0E1           MOV      R10,R0
   \   00000B1C   888100EF           SWI      +33160
   \   00000B20   30108DE2           ADD      R1,SP,#+48
   \   00000B24   02002DE9           PUSH     {R1}
   \   00000B28   013048E2           SUB      R3,R8,#+1
   \   00000B2C   01204AE2           SUB      R2,R10,#+1
   \   00000B30   010040E2           SUB      R0,R0,#+1
   \   00000B34   0010A0E3           MOV      R1,#+0
   \   00000B38   02002DE9           PUSH     {R1}
   \   00000B3C   64109DE5           LDR      R1,[SP, #+100]
   \   00000B40   B30100EF           SWI      +435
   \   00000B44   888100EF           SWI      +33160
   \   00000B48   0080A0E1           MOV      R8,R0
   \   00000B4C   888100EF           SWI      +33160
   \   00000B50   20108DE2           ADD      R1,SP,#+32
   \   00000B54   02002DE9           PUSH     {R1}
   \   00000B58   0730A0E1           MOV      R3,R7
   \   00000B5C   022048E2           SUB      R2,R8,#+2
   \   00000B60   020040E2           SUB      R0,R0,#+2
   \   00000B64   0010A0E3           MOV      R1,#+0
   \   00000B68   02002DE9           PUSH     {R1}
   \   00000B6C   0610A0E1           MOV      R1,R6
   \   00000B70   B30100EF           SWI      +435
   \   00000B74   28D08DE2           ADD      SP,SP,#+40
   \   00000B78   888100EF           SWI      +33160
   \   00000B7C   0080A0E1           MOV      R8,R0
   \   00000B80   888100EF           SWI      +33160
   \   00000B84   04108DE2           ADD      R1,SP,#+4
   \   00000B88   02002DE9           PUSH     {R1}
   \   00000B8C   0730A0E1           MOV      R3,R7
   \   00000B90   012048E2           SUB      R2,R8,#+1
   \   00000B94   010040E2           SUB      R0,R0,#+1
   \   00000B98   0010A0E3           MOV      R1,#+0
   \   00000B9C   02002DE9           PUSH     {R1}
   \   00000BA0   0610A0E1           MOV      R1,R6
   \   00000BA4   B30100EF           SWI      +435
   \   00000BA8   08D08DE2           ADD      SP,SP,#+8
   \   00000BAC   3EFDFFEA           B        ??RenderPage_2
   \                     ??RenderPage_44:
   \   00000BB0   0600A0E1           MOV      R0,R6
   \   00000BB4   01002DE9           PUSH     {R0}
   \   00000BB8   0000A0E3           MOV      R0,#+0
   \   00000BBC   01002DE9           PUSH     {R0}
   \   00000BC0   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000BC4   F220D8E1           LDRSH    R2,[R8, #+2]
   \   00000BC8   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000BCC   0310A0E1           MOV      R1,R3
   \   00000BD0   B30100EF           SWI      +435
   \   00000BD4   0600A0E1           MOV      R0,R6
   \   00000BD8   01002DE9           PUSH     {R0}
   \   00000BDC   0000A0E3           MOV      R0,#+0
   \   00000BE0   01002DE9           PUSH     {R0}
   \   00000BE4   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000BE8   013040E2           SUB      R3,R0,#+1
   \   00000BEC   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000BF0   012040E2           SUB      R2,R0,#+1
   \   00000BF4   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000BF8   011040E2           SUB      R1,R0,#+1
   \   00000BFC   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000C00   010080E2           ADD      R0,R0,#+1
   \   00000C04   B30100EF           SWI      +435
   \   00000C08   10D08DE2           ADD      SP,SP,#+16
   \                     ??RenderPage_45:
   \   00000C0C   017087E2           ADD      R7,R7,#+1
   \                     ??RenderPage_43:
   \   00000C10   1C009DE5           LDR      R0,[SP, #+28]
   \   00000C14   000057E1           CMP      R7,R0
   \   00000C18   6EFFFFAA           BGE      ??RenderPage_42
   \   00000C1C   FE0F8DE2           ADD      R0,SP,#+1016
   \   00000C20   87A180E0           ADD      R10,R0,R7, LSL #+3
   \   00000C24   0600A0E1           MOV      R0,R6
   \   00000C28   01002DE9           PUSH     {R0}
   \   00000C2C   02808AE2           ADD      R8,R10,#+2
   \   00000C30   0000A0E3           MOV      R0,#+0
   \   00000C34   01002DE9           PUSH     {R0}
   \   00000C38   F220D8E1           LDRSH    R2,[R8, #+2]
   \   00000C3C   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000C40   F010D8E1           LDRSH    R1,[R8, #+0]
   \   00000C44   0200A0E1           MOV      R0,R2
   \   00000C48   B30100EF           SWI      +435
   \   00000C4C   0600A0E1           MOV      R0,R6
   \   00000C50   01002DE9           PUSH     {R0}
   \   00000C54   0000A0E3           MOV      R0,#+0
   \   00000C58   01002DE9           PUSH     {R0}
   \   00000C5C   F010D8E1           LDRSH    R1,[R8, #+0]
   \   00000C60   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000C64   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000C68   012040E2           SUB      R2,R0,#+1
   \   00000C6C   010040E2           SUB      R0,R0,#+1
   \   00000C70   B30100EF           SWI      +435
   \   00000C74   2C109DE5           LDR      R1,[SP, #+44]
   \   00000C78   010087E2           ADD      R0,R7,#+1
   \   00000C7C   010050E1           CMP      R0,R1
   \   00000C80   10D08DE2           ADD      SP,SP,#+16
   \   00000C84   260000AA           BGE      ??RenderPage_46
   \   00000C88   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000C8C   FA10D8E1           LDRSH    R1,[R8, #+10]
   \   00000C90   010050E1           CMP      R0,R1
   \   00000C94   220000AA           BGE      ??RenderPage_46
   \   00000C98   0600A0E1           MOV      R0,R6
   \   00000C9C   01002DE9           PUSH     {R0}
   \   00000CA0   0000A0E3           MOV      R0,#+0
   \   00000CA4   01002DE9           PUSH     {R0}
   \   00000CA8   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000CAC   FA20D8E1           LDRSH    R2,[R8, #+10]
   \   00000CB0   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000CB4   0310A0E1           MOV      R1,R3
   \   00000CB8   B30100EF           SWI      +435
   \   00000CBC   FA00D8E1           LDRSH    R0,[R8, #+10]
   \   00000CC0   F210D8E1           LDRSH    R1,[R8, #+2]
   \   00000CC4   08D08DE2           ADD      SP,SP,#+8
   \   00000CC8   010050E1           CMP      R0,R1
   \   00000CCC   0600A0E1           MOV      R0,R6
   \   00000CD0   01002DE9           PUSH     {R0}
   \   00000CD4   0000A0E3           MOV      R0,#+0
   \   00000CD8   01002DE9           PUSH     {R0}
   \   00000CDC   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000CE0   013080E2           ADD      R3,R0,#+1
   \   00000CE4   FA00D8E1           LDRSH    R0,[R8, #+10]
   \   00000CE8   070000AA           BGE      ??RenderPage_47
   \   00000CEC   012080E2           ADD      R2,R0,#+1
   \   00000CF0   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000CF4   011080E2           ADD      R1,R0,#+1
   \   00000CF8   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000CFC   010040E2           SUB      R0,R0,#+1
   \                     ??RenderPage_48:
   \   00000D00   B30100EF           SWI      +435
   \   00000D04   08D08DE2           ADD      SP,SP,#+8
   \   00000D08   1C0000EA           B        ??RenderPage_49
   \                     ??RenderPage_47:
   \   00000D0C   012040E2           SUB      R2,R0,#+1
   \   00000D10   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000D14   011080E2           ADD      R1,R0,#+1
   \   00000D18   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000D1C   010080E2           ADD      R0,R0,#+1
   \   00000D20   F6FFFFEA           B        ??RenderPage_48
   \                     ??RenderPage_46:
   \   00000D24   0600A0E1           MOV      R0,R6
   \   00000D28   01002DE9           PUSH     {R0}
   \   00000D2C   0000A0E3           MOV      R0,#+0
   \   00000D30   01002DE9           PUSH     {R0}
   \   00000D34   F430D8E1           LDRSH    R3,[R8, #+4]
   \   00000D38   F020DAE1           LDRSH    R2,[R10, #+0]
   \   00000D3C   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000D40   0310A0E1           MOV      R1,R3
   \   00000D44   B30100EF           SWI      +435
   \   00000D48   0600A0E1           MOV      R0,R6
   \   00000D4C   01002DE9           PUSH     {R0}
   \   00000D50   0000A0E3           MOV      R0,#+0
   \   00000D54   01002DE9           PUSH     {R0}
   \   00000D58   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000D5C   013080E2           ADD      R3,R0,#+1
   \   00000D60   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000D64   012080E2           ADD      R2,R0,#+1
   \   00000D68   F400D8E1           LDRSH    R0,[R8, #+4]
   \   00000D6C   011080E2           ADD      R1,R0,#+1
   \   00000D70   F200D8E1           LDRSH    R0,[R8, #+2]
   \   00000D74   010040E2           SUB      R0,R0,#+1
   \   00000D78   B30100EF           SWI      +435
   \   00000D7C   10D08DE2           ADD      SP,SP,#+16
   \                     ??RenderPage_49:
   \   00000D80   0600A0E1           MOV      R0,R6
   \   00000D84   01002DE9           PUSH     {R0}
   \   00000D88   0000A0E3           MOV      R0,#+0
   \   00000D8C   01002DE9           PUSH     {R0}
   \   00000D90   F020DAE1           LDRSH    R2,[R10, #+0]
   \   00000D94   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000D98   F410D8E1           LDRSH    R1,[R8, #+4]
   \   00000D9C   0200A0E1           MOV      R0,R2
   \   00000DA0   B30100EF           SWI      +435
   \   00000DA4   0600A0E1           MOV      R0,R6
   \   00000DA8   01002DE9           PUSH     {R0}
   \   00000DAC   0000A0E3           MOV      R0,#+0
   \   00000DB0   01002DE9           PUSH     {R0}
   \   00000DB4   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000DB8   F410D8E1           LDRSH    R1,[R8, #+4]
   \   00000DBC   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000DC0   012080E2           ADD      R2,R0,#+1
   \   00000DC4   010080E2           ADD      R0,R0,#+1
   \   00000DC8   B30100EF           SWI      +435
   \   00000DCC   010057E3           CMP      R7,#+1
   \   00000DD0   10D08DE2           ADD      SP,SP,#+16
   \   00000DD4   75FFFFBA           BLT      ??RenderPage_44
   \   00000DD8   FA009BE1           LDRSH    R0,[R11, +R10]
   \   00000DDC   F210D8E1           LDRSH    R1,[R8, #+2]
   \   00000DE0   010050E1           CMP      R0,R1
   \   00000DE4   71FFFFAA           BGE      ??RenderPage_44
   \   00000DE8   0600A0E1           MOV      R0,R6
   \   00000DEC   01002DE9           PUSH     {R0}
   \   00000DF0   0000A0E3           MOV      R0,#+0
   \   00000DF4   01002DE9           PUSH     {R0}
   \   00000DF8   F030D8E1           LDRSH    R3,[R8, #+0]
   \   00000DFC   FA209BE1           LDRSH    R2,[R11, +R10]
   \   00000E00   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000E04   0310A0E1           MOV      R1,R3
   \   00000E08   B30100EF           SWI      +435
   \   00000E0C   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000E10   FA109BE1           LDRSH    R1,[R11, +R10]
   \   00000E14   08D08DE2           ADD      SP,SP,#+8
   \   00000E18   010050E1           CMP      R0,R1
   \   00000E1C   0600A0E1           MOV      R0,R6
   \   00000E20   01002DE9           PUSH     {R0}
   \   00000E24   0000A0E3           MOV      R0,#+0
   \   00000E28   01002DE9           PUSH     {R0}
   \   00000E2C   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000E30   013040E2           SUB      R3,R0,#+1
   \   00000E34   FA009BE1           LDRSH    R0,[R11, +R10]
   \   00000E38   070000AA           BGE      ??RenderPage_50
   \   00000E3C   012040E2           SUB      R2,R0,#+1
   \   00000E40   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000E44   011040E2           SUB      R1,R0,#+1
   \   00000E48   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000E4C   010080E2           ADD      R0,R0,#+1
   \                     ??RenderPage_51:
   \   00000E50   B30100EF           SWI      +435
   \   00000E54   08D08DE2           ADD      SP,SP,#+8
   \   00000E58   6BFFFFEA           B        ??RenderPage_45
   \                     ??RenderPage_50:
   \   00000E5C   012080E2           ADD      R2,R0,#+1
   \   00000E60   F000D8E1           LDRSH    R0,[R8, #+0]
   \   00000E64   011040E2           SUB      R1,R0,#+1
   \   00000E68   F000DAE1           LDRSH    R0,[R10, #+0]
   \   00000E6C   010040E2           SUB      R0,R0,#+1
   \   00000E70   F6FFFFEA           B        ??RenderPage_51
    834              }
    835              else
    836              {
    837                break;
    838              }
    839            }
    840            
    841           
    842          
    843            if (flag==0) vd->pos_cur_ref=0xFFFFFFFF;
   \                     ??RenderPage_3:
   \   00000E74   4C009DE5           LDR      R0,[SP, #+76]
   \   00000E78   000050E3           CMP      R0,#+0
   \   00000E7C   0000E003           MVNEQ    R0,#+0
   \   00000E80   28008405           STREQ    R0,[R4, #+40]
    844            vd->view_line=store_line;
   \   00000E84   6C009DE5           LDR      R0,[SP, #+108]
   \   00000E88   1C0084E5           STR      R0,[R4, #+28]
    845            
    846          //  WSHDR *ws2;
    847          //  ws2=AllocWS(128);
    848          //  wsprintf(ws2,"lcheck:%i",lcheck);
    849          //  DrawString(ws2,3,14,scr_w,scr_h,FONT_SMALL,TEXT_NOFORMAT,GetPaletteAdrByColorIndex(2),GetPaletteAdrByColorIndex(21));
    850          //  FreeWS(ws2);
    851            
    852            if (lcheck==2)
   \   00000E8C   20009DE5           LDR      R0,[SP, #+32]
    853              return 0;
    854            else
    855              return 1;
   \   00000E90   FCD08DE2           ADD      SP,SP,#+252
   \   00000E94   020050E3           CMP      R0,#+2
   \   00000E98   0000A003           MOVEQ    R0,#+0
   \   00000E9C   0100A013           MOVNE    R0,#+1
   \   00000EA0   40DE8DE2           ADD      SP,SP,#+1024
   \   00000EA4   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??RenderPage_6:
   \   00000EA8   ........           DC32     cfgInvertCursor
   \   00000EAC   ........           DC32     cfgCursorColor
   \   00000EB0   ........           DC32     cfgCursorColorPictures
    856          }
    857          

   \                                 In segment CODE, align 4, keep-with-next
    858          REFCACHE *FindReferenceByBegin(VIEWDATA *vd, unsigned int pos)
    859          {
    860            int i=vd->ref_cache_size;
   \                     FindReferenceByBegin:
   \   00000000   D02090E5           LDR      R2,[R0, #+208]
    861            REFCACHE *rf;
    862            if (!i) return NULL;
   \   00000004   000052E3           CMP      R2,#+0
   \   00000008   0100001A           BNE      ??FindReferenceByBegin_0
   \                     ??FindReferenceByBegin_1:
   \   0000000C   0000A0E3           MOV      R0,#+0
   \   00000010   1EFF2FE1           BX       LR
    863            rf=vd->ref_cache;
   \                     ??FindReferenceByBegin_0:
   \   00000014   CC0090E5           LDR      R0,[R0, #+204]
   \   00000018   020000EA           B        ??FindReferenceByBegin_2
    864            do
    865            {
    866              if (rf->begin==pos) return rf;
    867              rf++;
   \                     ??FindReferenceByBegin_3:
   \   0000001C   280080E2           ADD      R0,R0,#+40
    868            }
    869            while(--i);
   \   00000020   012052E2           SUBS     R2,R2,#+1
   \   00000024   F8FFFF0A           BEQ      ??FindReferenceByBegin_1
   \                     ??FindReferenceByBegin_2:
   \   00000028   003090E5           LDR      R3,[R0, #+0]
   \   0000002C   010053E1           CMP      R3,R1
   \   00000030   F9FFFF1A           BNE      ??FindReferenceByBegin_3
   \   00000034   1EFF2FE1           BX       LR               ;; return
    870            return NULL;
    871          }
    872          

   \                                 In segment CODE, align 4, keep-with-next
    873          REFCACHE *FindReferenceFirst(VIEWDATA *vd, unsigned int pos)
    874          {
   \                     FindReferenceFirst:
   \   00000000   0530A0E3           MOV      R3,#+5
   \   00000004   E03C83E3           ORR      R3,R3,#0xE000
   \   00000008   000000EA           B        ??FindReferenceFirst_0
    875            while (pos<vd->rawtext_size&&vd->rawtext[pos]!=UTF16_ENA_INVERT)
    876              pos++;
   \                     ??FindReferenceFirst_1:
   \   0000000C   011081E2           ADD      R1,R1,#+1
   \                     ??FindReferenceFirst_0:
   \   00000010   0C2090E5           LDR      R2,[R0, #+12]
   \   00000014   020051E1           CMP      R1,R2
   \   00000018   0400002A           BCS      ??FindReferenceFirst_2
   \   0000001C   082090E5           LDR      R2,[R0, #+8]
   \   00000020   812082E0           ADD      R2,R2,R1, LSL #+1
   \   00000024   B020D2E1           LDRH     R2,[R2, #+0]
   \   00000028   030052E1           CMP      R2,R3
   \   0000002C   F6FFFF1A           BNE      ??FindReferenceFirst_1
    877            return FindReferenceByBegin(vd,pos);
   \                     ??FindReferenceFirst_2:
   \   00000030   ........           B        FindReferenceByBegin  ;; tailcall
    878          }
    879          

   \                                 In segment CODE, align 4, keep-with-next
    880          REFCACHE *FindReference(VIEWDATA *vd, unsigned int pos)
    881          {
   \                     FindReference:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
    882            REFCACHE *rf=FindReferenceByBegin(vd,pos);
   \   0000000C   ........           BL       FindReferenceByBegin
    883            if (rf!=NULL) return rf;
   \   00000010   000050E3           CMP      R0,#+0
   \   00000014   3080BD18           POPNE    {R4,R5,PC}
    884            else
    885            {
    886              int i=vd->ref_cache_size;
   \   00000018   D01094E5           LDR      R1,[R4, #+208]
    887              if (!i) return NULL;
   \   0000001C   000051E3           CMP      R1,#+0
   \   00000020   0000A003           MOVEQ    R0,#+0
   \   00000024   3080BD08           POPEQ    {R4,R5,PC}
    888              rf=vd->ref_cache;
   \   00000028   CC0094E5           LDR      R0,[R4, #+204]
    889              do
    890              {
    891                if ((rf->begin<=pos)&&(pos<rf->end)) return rf;
   \                     ??FindReference_0:
   \   0000002C   002090E5           LDR      R2,[R0, #+0]
   \   00000030   020055E1           CMP      R5,R2
   \   00000034   0200003A           BCC      ??FindReference_1
   \   00000038   042090E5           LDR      R2,[R0, #+4]
   \   0000003C   020055E1           CMP      R5,R2
   \   00000040   3080BD38           POPCC    {R4,R5,PC}
    892                rf++;
   \                     ??FindReference_1:
   \   00000044   280080E2           ADD      R0,R0,#+40
    893              }
    894              while(--i);
   \   00000048   011051E2           SUBS     R1,R1,#+1
   \   0000004C   F6FFFF1A           BNE      ??FindReference_0
   \   00000050   0000A0E3           MOV      R0,#+0
   \   00000054   3080BDE8           POP      {R4,R5,PC}
    895            }
    896            return NULL;
    897          }
    898          

   \                                 In segment CODE, align 4, keep-with-next
    899          int FindReferenceById(VIEWDATA *vd, unsigned int id, int i) // Находит index'ы всех ref'ов с заданным id
    900          {
   \                     FindReferenceById:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
    901            unsigned int sz=*(vd->oms+id);
    902            sz<<=8;
    903            sz|=*(vd->oms+id+1);
   \   00000010   000000EA           B        ??FindReferenceById_0
    904            while(i<vd->ref_cache_size)
    905            {
    906              if (!omstrcmp(vd,(vd->ref_cache+i)->id,id)) return i;
    907              i++;
   \                     ??FindReferenceById_1:
   \   00000014   016086E2           ADD      R6,R6,#+1
   \                     ??FindReferenceById_0:
   \   00000018   D00094E5           LDR      R0,[R4, #+208]
   \   0000001C   000056E1           CMP      R6,R0
   \   00000020   0A0000AA           BGE      ??FindReferenceById_2
   \   00000024   CC1094E5           LDR      R1,[R4, #+204]
   \   00000028   2800A0E3           MOV      R0,#+40
   \   0000002C   901621E0           MLA      R1,R0,R6,R1
   \   00000030   0520A0E1           MOV      R2,R5
   \   00000034   0C1091E5           LDR      R1,[R1, #+12]
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   ........           _BLF     omstrcmp,??omstrcmp??rA
   \   00000040   000050E3           CMP      R0,#+0
   \   00000044   F2FFFF1A           BNE      ??FindReferenceById_1
   \   00000048   0600A0E1           MOV      R0,R6
   \   0000004C   7080BDE8           POP      {R4-R6,PC}
    908            }
    909            return -1;
   \                     ??FindReferenceById_2:
   \   00000050   0000E0E3           MVN      R0,#+0
   \   00000054   7080BDE8           POP      {R4-R6,PC}       ;; return
    910          }
    911          
    912          /*******************************************************************************
    913            Templates menu
    914          *******************************************************************************/
    915          //GUI *paste_gui;
    916          
    917          //Templates
    918          char * templates_chars; //Собственно файл
    919          char ** templates_lines; //Массив указателей на строки
    920          

   \                                 In segment CODE, align 4, keep-with-next
    921          void FreeTemplates(void)
    922          {
   \                     FreeTemplates:
   \   00000000   10402DE9           PUSH     {R4,LR}
    923            if (templates_lines) mfree(templates_lines);
   \   00000004   ........           LDR      R4,??DataTable6  ;; templates_chars
   \   00000008   040094E5           LDR      R0,[R4, #+4]
   \   0000000C   000050E3           CMP      R0,#+0
   \   00000010   0000000A           BEQ      ??FreeTemplates_0
   \   00000014   150000EF           SWI      +21
    924            if (templates_chars) mfree(templates_chars);
   \                     ??FreeTemplates_0:
   \   00000018   000094E5           LDR      R0,[R4, #+0]
   \   0000001C   000050E3           CMP      R0,#+0
   \   00000020   0100000A           BEQ      ??FreeTemplates_1
   \   00000024   150000EF           SWI      +21
    925            templates_lines=NULL;
   \   00000028   0000A0E3           MOV      R0,#+0
   \                     ??FreeTemplates_1:
   \   0000002C   040084E5           STR      R0,[R4, #+4]
    926            templates_chars=NULL;
   \   00000030   000084E5           STR      R0,[R4, #+0]
    927          }
   \   00000034   1080BDE8           POP      {R4,PC}          ;; return
    928          

   \                                 In segment CODE, align 4, keep-with-next
    929          SaveTextToTemplate(WSHDR* ws)
    930          {
   \                     SaveTextToTemplate:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0040A0E1           MOV      R4,R0
    931            int hFile;
    932            unsigned int io_error;
    933            char* s = malloc(wstrlen(ws)+2);
   \   0000000C   230100EF           SWI      +291
   \   00000010   020080E2           ADD      R0,R0,#+2
   \   00000014   140000EF           SWI      +20
   \   00000018   0050A0E1           MOV      R5,R0
    934            ws2ascii(s, ws);
   \   0000001C   0410A0E1           MOV      R1,R4
   \   00000020   ........           _BLF     ws2ascii,??ws2ascii??rA
    935            strcat(s,"\n");
   \   00000024   171F8FE2           ADR      R1,??SaveTextToTemplate_0  ;; "\n"
   \   00000028   0500A0E1           MOV      R0,R5
   \   0000002C   170000EF           SWI      +23
    936            char * templates_file = getSymbolicPath("$ballet\\templates.txt");
   \   00000030   ........           LDR      R0,??DataTable5  ;; `?<Constant "$ballet\\\\templates.txt">`
   \   00000034   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
    937            if ((hFile = fopen(templates_file, A_ReadWrite+A_Create+A_Append,P_READ+P_WRITE, &io_error)) != -1)
   \   00000038   0D30A0E1           MOV      R3,SP
   \   0000003C   602FA0E3           MOV      R2,#+384
   \   00000040   761042E2           SUB      R1,R2,#+118
   \   00000044   0A0000EF           SWI      +10
   \   00000048   0040A0E1           MOV      R4,R0
   \   0000004C   010074E3           CMN      R4,#+1
   \   00000050   0900000A           BEQ      ??SaveTextToTemplate_1
    938            {
    939              fwrite(hFile,s,strlen(s),&io_error);
   \   00000054   0500A0E1           MOV      R0,R5
   \   00000058   1B0000EF           SWI      +27
   \   0000005C   0020A0E1           MOV      R2,R0
   \   00000060   0D30A0E1           MOV      R3,SP
   \   00000064   0510A0E1           MOV      R1,R5
   \   00000068   0400A0E1           MOV      R0,R4
   \   0000006C   0C0000EF           SWI      +12
    940              fclose(hFile,&io_error);
   \   00000070   0D10A0E1           MOV      R1,SP
   \   00000074   0400A0E1           MOV      R0,R4
   \   00000078   0D0000EF           SWI      +13
    941            }
    942            mfree(s);
   \                     ??SaveTextToTemplate_1:
   \   0000007C   0500A0E1           MOV      R0,R5
   \   00000080   150000EF           SWI      +21
    943          }
   \   00000084   3180BDE8           POP      {R0,R4,R5,PC}    ;; return
   \                     ??SaveTextToTemplate_0:
   \   00000088   0A000000           DC8      "\n",+0,+0
    944          

   \                                 In segment CODE, align 4, keep-with-next
    945          int LoadTemplates()
    946          {
    947            FSTATS fstat;
    948            int hFile;
    949            unsigned int io_error = NULL;
    950            int templates_num = NULL;
    951            char * p;
    952            char * pp;
    953            int c;
    954            char * templates_file = getSymbolicPath("$ballet\\templates.txt");
   \                     LoadTemplates:
   \   00000000   ........           LDR      R0,??DataTable5  ;; `?<Constant "$ballet\\\\templates.txt">`
   \   00000004   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000008   2CD04DE2           SUB      SP,SP,#+44
   \   0000000C   0040A0E3           MOV      R4,#+0
   \   00000010   00408DE5           STR      R4,[SP, #+0]
   \   00000014   ........           _BLF     getSymbolicPath,??getSymbolicPath??rA
   \   00000018   0060A0E1           MOV      R6,R0
    955          
    956            FreeTemplates();
   \   0000001C   ........           BL       FreeTemplates
    957            if (GetFileStats(templates_file, &fstat, &io_error) != -1)
   \   00000020   0470E0E1           MVN      R7,R4
   \   00000024   0D20A0E1           MOV      R2,SP
   \   00000028   04108DE2           ADD      R1,SP,#+4
   \   0000002C   0600A0E1           MOV      R0,R6
   \   00000030   840000EF           SWI      +132
   \   00000034   070050E1           CMP      R0,R7
    958            {
    959              if (fstat.size > 0)
   \   00000038   08009D15           LDRNE    R0,[SP, #+8]
   \   0000003C   0050A0E3           MOV      R5,#+0
   \   00000040   00005013           CMPNE    R0,#+0
   \   00000044   2C00000A           BEQ      ??LoadTemplates_0
    960              {
    961                if ((hFile = fopen(templates_file, A_ReadOnly + A_BIN, P_READ, &io_error)) != -1)
   \   00000048   0D30A0E1           MOV      R3,SP
   \   0000004C   8020A0E3           MOV      R2,#+128
   \   00000050   801CA0E3           MOV      R1,#+32768
   \   00000054   0600A0E1           MOV      R0,R6
   \   00000058   0A0000EF           SWI      +10
   \   0000005C   0090A0E1           MOV      R9,R0
   \   00000060   070059E1           CMP      R9,R7
   \   00000064   2400000A           BEQ      ??LoadTemplates_0
    962                {
    963                  p = templates_chars = malloc(fstat.size + 1);
   \   00000068   ........           LDR      R7,??DataTable6  ;; templates_chars
   \   0000006C   08009DE5           LDR      R0,[SP, #+8]
   \   00000070   010080E2           ADD      R0,R0,#+1
   \   00000074   140000EF           SWI      +20
   \   00000078   000087E5           STR      R0,[R7, #+0]
    964                  p[fread(hFile, p, fstat.size, &io_error)] = NULL;
   \   0000007C   08209DE5           LDR      R2,[SP, #+8]
   \   00000080   0080A0E1           MOV      R8,R0
   \   00000084   0D30A0E1           MOV      R3,SP
   \   00000088   0810A0E1           MOV      R1,R8
   \   0000008C   0900A0E1           MOV      R0,R9
   \   00000090   0B0000EF           SWI      +11
   \   00000094   0840C0E7           STRB     R4,[R0, +R8]
    965                  fclose(hFile, &io_error);
   \   00000098   0D10A0E1           MOV      R1,SP
   \   0000009C   0900A0E1           MOV      R0,R9
   \   000000A0   0D0000EF           SWI      +13
    966                  pp = p;
   \   000000A4   0890A0E1           MOV      R9,R8
   \   000000A8   020000EA           B        ??LoadTemplates_1
    967                  for(;;)
    968                  {
    969                    c = *p;
    970                    if (c < 32)
    971                    {
    972                      if (pp && (pp != p))
    973                      {
    974                        templates_lines = realloc(templates_lines,(templates_num + 1)*sizeof(char *));
    975                        templates_lines[templates_num ++] = pp;
    976                      }
    977                      pp = NULL;
    978                      if (!c) break;
    979                      *p = NULL;
    980                    }
    981                    else
    982                    {
    983                      if (!pp) pp = p;
   \                     ??LoadTemplates_2:
   \   000000AC   000059E3           CMP      R9,#+0
   \   000000B0   0890A001           MOVEQ    R9,R8
    984                    }
    985                    p++;
   \                     ??LoadTemplates_3:
   \   000000B4   018088E2           ADD      R8,R8,#+1
   \                     ??LoadTemplates_1:
   \   000000B8   00A0D8E5           LDRB     R10,[R8, #+0]
   \   000000BC   20005AE3           CMP      R10,#+32
   \   000000C0   F9FFFFAA           BGE      ??LoadTemplates_2
   \   000000C4   000059E3           CMP      R9,#+0
   \   000000C8   08005911           CMPNE    R9,R8
   \   000000CC   0600000A           BEQ      ??LoadTemplates_4
   \   000000D0   040097E5           LDR      R0,[R7, #+4]
   \   000000D4   01B085E2           ADD      R11,R5,#+1
   \   000000D8   0B11A0E1           LSL      R1,R11,#+2
   \   000000DC   BA0000EF           SWI      +186
   \   000000E0   040087E5           STR      R0,[R7, #+4]
   \   000000E4   059180E7           STR      R9,[R0, +R5, LSL #+2]
   \   000000E8   0B50A0E1           MOV      R5,R11
   \                     ??LoadTemplates_4:
   \   000000EC   0090A0E3           MOV      R9,#+0
   \   000000F0   00005AE3           CMP      R10,#+0
   \   000000F4   0040C815           STRBNE   R4,[R8, #+0]
   \   000000F8   EDFFFF1A           BNE      ??LoadTemplates_3
    986                  }
    987                }
    988              }
    989            }
    990            mfree(templates_file);
   \                     ??LoadTemplates_0:
   \   000000FC   0600A0E1           MOV      R0,R6
   \   00000100   150000EF           SWI      +21
    991            return templates_num;
   \   00000104   0500A0E1           MOV      R0,R5
   \   00000108   2CD08DE2           ADD      SP,SP,#+44
   \   0000010C   F08FBDE8           POP      {R4-R11,PC}      ;; return
    992          }

   \                                 In segment DATA_Z, align 4, align-sorted
   \                     templates_chars:
   \   00000000                      DS8 4
   \                     templates_lines:
   \   00000004                      DS8 4
    993          
    994          int curpos;
   \                     curpos:
   \   00000008                      DS8 4
    995          int curpos_changed = 0;
   \                     curpos_changed:
   \   0000000C                      DS8 4
    996          

   \                                 In segment CODE, align 4, keep-with-next
    997          int templates_menu_onkey(void *gui, GUI_MSG *msg)
    998          {
   \                     templates_menu_onkey:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0060A0E1           MOV      R6,R0
    999            if (msg->keys == 0x3D || msg->keys == 0x18)
   \   0000000C   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000010   3D0050E3           CMP      R0,#+61
   \   00000014   18005013           CMPNE    R0,#+24
   \   00000018   2600001A           BNE      ??templates_menu_onkey_0
   1000            {
   1001              int i = GetCurMenuItem(gui);
   1002              if (templates_lines[i])
   \   0000001C   ........           LDR      R5,??DataTable11  ;; templates_chars
   \   00000020   0600A0E1           MOV      R0,R6
   \   00000024   8F0100EF           SWI      +399
   \   00000028   0040A0E1           MOV      R4,R0
   \   0000002C   040095E5           LDR      R0,[R5, #+4]
   \   00000030   040190E7           LDR      R0,[R0, +R4, LSL #+2]
   \   00000034   000050E3           CMP      R0,#+0
   \   00000038   1B00000A           BEQ      ??templates_menu_onkey_1
   1003              {
   1004                GUI* paste_gui = (GUI*)MenuGetUserPointer(gui);
   \   0000003C   0600A0E1           MOV      R0,R6
   \   00000040   E00100EF           SWI      +480
   \   00000044   0060A0E1           MOV      R6,R0
   1005                EDITCONTROL ec;
   1006                ExtractEditControl(paste_gui, 1, &ec);
   \   00000048   0D20A0E1           MOV      R2,SP
   \   0000004C   0110A0E3           MOV      R1,#+1
   \   00000050   690100EF           SWI      +361
   1007                curpos=EDIT_GetCursorPos(paste_gui);
   \   00000054   0600A0E1           MOV      R0,R6
   \   00000058   D30100EF           SWI      +467
   \   0000005C   080085E5           STR      R0,[R5, #+8]
   \   00000060   070000EA           B        ??templates_menu_onkey_2
   1008                char c;
   1009                while((c=*(templates_lines[i])++))
   1010                {
   1011                  wsInsertChar(ec.pWS,char8to16(c),curpos++);
   \                     ??templates_menu_onkey_3:
   \   00000064   086095E5           LDR      R6,[R5, #+8]
   \   00000068   011086E2           ADD      R1,R6,#+1
   \   0000006C   081085E5           STR      R1,[R5, #+8]
   \   00000070   ........           _BLF     char8to16,??char8to16??rA
   \   00000074   0620A0E1           MOV      R2,R6
   \   00000078   0010A0E1           MOV      R1,R0
   \   0000007C   28009DE5           LDR      R0,[SP, #+40]
   \   00000080   1D0000EF           SWI      +29
   \                     ??templates_menu_onkey_2:
   \   00000084   040095E5           LDR      R0,[R5, #+4]
   \   00000088   040180E0           ADD      R0,R0,R4, LSL #+2
   \   0000008C   001090E5           LDR      R1,[R0, #+0]
   \   00000090   012081E2           ADD      R2,R1,#+1
   \   00000094   002080E5           STR      R2,[R0, #+0]
   \   00000098   0000D1E5           LDRB     R0,[R1, #+0]
   \   0000009C   0010B0E1           MOVS     R1,R0
   \   000000A0   EFFFFF1A           BNE      ??templates_menu_onkey_3
   1012                }
   1013                curpos_changed = 1;
   \   000000A4   0100A0E3           MOV      R0,#+1
   \   000000A8   0C0085E5           STR      R0,[R5, #+12]
   1014              }
   1015              return (1);
   \                     ??templates_menu_onkey_1:
   \   000000AC   0100A0E3           MOV      R0,#+1
   \   000000B0   2CD08DE2           ADD      SP,SP,#+44
   \   000000B4   7080BDE8           POP      {R4-R6,PC}
   1016            }
   1017            return (0);
   \                     ??templates_menu_onkey_0:
   \   000000B8   0000A0E3           MOV      R0,#+0
   \   000000BC   2CD08DE2           ADD      SP,SP,#+44
   \   000000C0   7080BDE8           POP      {R4-R6,PC}       ;; return
   1018          }
   1019          

   \                                 In segment CODE, align 4, keep-with-next
   1020          void templates_menu_ghook(void *gui, int cmd)
   1021          {
   \                     templates_menu_ghook:
   \   00000000   00402DE9           PUSH     {LR}
   1022            if (cmd == TI_CMD_DESTROY) // free
   \   00000004   030051E3           CMP      R1,#+3
   \   00000008   0100001A           BNE      ??templates_menu_ghook_0
   1023            {
   1024              FreeTemplates();
   \   0000000C   0040BDE8           POP      {LR}             ;; Pop
   \   00000010   ........           B        FreeTemplates    ;; tailcall
   1025            }
   1026            if (cmd == TI_CMD_FOCUS)
   \                     ??templates_menu_ghook_0:
   \   00000014   0A0051E3           CMP      R1,#+10
   \   00000018   0080BD18           POPNE    {PC}
   1027            {
   1028              DisableIDLETMR();
   \   0000001C   7F0100EF           SWI      +383
   1029            }
   1030          }
   \   00000020   0080BDE8           POP      {PC}             ;; return

   \                                 In segment CODE, align 4, keep-with-next
   1031          void templates_menu_iconhndl(void *gui, int cur_item, void *user_pointer)
   1032          {
   \                     templates_menu_iconhndl:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   1033            int len = strlen(templates_lines[cur_item]);
   \   00000004   ........           LDR      R6,??DataTable11  ;; templates_chars
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   040096E5           LDR      R0,[R6, #+4]
   \   00000010   0150A0E1           MOV      R5,R1
   \   00000014   050190E7           LDR      R0,[R0, +R5, LSL #+2]
   \   00000018   1B0000EF           SWI      +27
   1034            WSHDR * ws = AllocMenuWS(gui, len + 4);
   \   0000001C   041080E2           ADD      R1,R0,#+4
   \   00000020   0400A0E1           MOV      R0,R4
   \   00000024   980100EF           SWI      +408
   \   00000028   0070A0E1           MOV      R7,R0
   1035            void * item = AllocMenuItem(gui);
   \   0000002C   0400A0E1           MOV      R0,R4
   \   00000030   970100EF           SWI      +407
   \   00000034   0080A0E1           MOV      R8,R0
   1036            ascii2ws(ws, templates_lines[cur_item]);
   \   00000038   040096E5           LDR      R0,[R6, #+4]
   \   0000003C   051190E7           LDR      R1,[R0, +R5, LSL #+2]
   \   00000040   0700A0E1           MOV      R0,R7
   \   00000044   ........           _BLF     ascii2ws,??ascii2ws??rA
   1037            SetMenuItemText(gui, item, ws, cur_item);
   \   00000048   0530A0E1           MOV      R3,R5
   \   0000004C   0720A0E1           MOV      R2,R7
   \   00000050   0810A0E1           MOV      R1,R8
   \   00000054   0400A0E1           MOV      R0,R4
   \   00000058   9A0100EF           SWI      +410
   1038          }
   \   0000005C   F081BDE8           POP      {R4-R8,PC}       ;; return
   1039          

   \                                 In segment DATA_I, align 4, align-sorted
   1040          int templates_menu_softkeys[]={0,1,2};
   \                     templates_menu_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for templates_menu_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
   1041          SOFTKEY_DESC templates_menu_sk[]=
   \                     templates_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for templates_menu_sk>`
   1042          {
   1043            {0x0018,0x0000,(int)"Select"},
   1044            {0x0001,0x0000,(int)"Close"},
   1045            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1046          };
   1047          
   1048          SOFTKEYSTAB templates_menu_skt=
   1049          {
   1050            templates_menu_sk,0
   1051          };
   1052          
   1053          HEADER_DESC templates_menu_header={0,0,0,0,NULL,(int)"Выбор",LGP_NULL};
   \                     templates_menu_header:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for templates_menu_header>`
   1054          
   1055          MENU_DESC templates_menu_struct=
   \                     templates_menu_struct:
   \   0000002C                      DS8 44
   \   00000058                      REQUIRE `?<Initializer for templates_menu_struct>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     templates_menu_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for templates_menu_skt>`
   1056          {
   1057            8, templates_menu_onkey, templates_menu_ghook, NULL,
   1058            templates_menu_softkeys,
   1059            &templates_menu_skt,
   1060            0x10,
   1061            templates_menu_iconhndl,
   1062            NULL,   //Items
   1063            NULL,   //Procs
   1064            0   //n
   1065          };
   1066          

   \                                 In segment CODE, align 4, keep-with-next
   1067          void createTemplatesMenu(void* data)
   1068          {
   \                     createTemplatesMenu:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   1069            patch_header(&templates_menu_header);
   \   00000004   50509FE5           LDR      R5,??createTemplatesMenu_0  ;; templates_menu_sk
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   180085E2           ADD      R0,R5,#+24
   \   00000010   ........           _BLF     patch_header,??patch_header??rA
   1070            
   1071            templates_menu_sk[0].lgp_id=(int)lgpData[LGP_Select];
   \   00000014   ........           LDR      R0,??DataTable30  ;; lgpData
   \   00000018   641090E5           LDR      R1,[R0, #+100]
   \   0000001C   041085E5           STR      R1,[R5, #+4]
   1072            templates_menu_sk[1].lgp_id=(int)lgpData[LGP_Back];
   \   00000020   BC1090E5           LDR      R1,[R0, #+188]
   1073            templates_menu_header.lgp_id=(int)lgpData[LGP_Templates];
   \   00000024   740090E5           LDR      R0,[R0, #+116]
   \   00000028   0C1085E5           STR      R1,[R5, #+12]
   \   0000002C   240085E5           STR      R0,[R5, #+36]
   1074            
   1075            CreateMenu(0, 0, &templates_menu_struct, &templates_menu_header, 0, LoadTemplates(), data, 0);
   \   00000030   ........           BL       LoadTemplates
   \   00000034   0010A0E3           MOV      R1,#+0
   \   00000038   02002DE9           PUSH     {R1}
   \   0000003C   10002DE9           PUSH     {R4}
   \   00000040   01002DE9           PUSH     {R0}
   \   00000044   183085E2           ADD      R3,R5,#+24
   \   00000048   2C2085E2           ADD      R2,R5,#+44
   \   0000004C   0000A0E3           MOV      R0,#+0
   \   00000050   01002DE9           PUSH     {R0}
   \   00000054   520100EF           SWI      +338
   1076          }
   \   00000058   3F80BDE8           POP      {R0-R5,PC}       ;; return
   \                     ??createTemplatesMenu_0:
   \   0000005C   ........           DC32     templates_menu_sk
   1077          
   1078          // EDIT BOX
   1079          VIEWDATA *cur_vd;
   1080          unsigned int pos_ref;
   1081          
   1082          extern char *goto_url;
   1083          extern char *from_url;
   1084          extern char *goto_params;
   1085          
   1086          char *collectItemsParams(VIEWDATA *vd, REFCACHE *rf);
   1087          
   1088          SOFTKEY_DESC input_box_menu_sk[]=
   1089          {
   1090            {0x0018,0x0000,(int)"Ok"},
   1091            {0x0001,0x0000,(int)"Cancel"},
   1092            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1093          };
   1094          

   \                                 In segment DATA_C, align 4, align-sorted
   1095          static const SOFTKEYSTAB input_box_menu_skt=
   \                     input_box_menu_skt:
   \   00000000   ........0000       DC32 input_box_menu_sk, 0
   \              0000        
   1096          {
   1097            input_box_menu_sk,0
   1098          };
   1099          
   1100          HEADER_DESC input_box_hdr={0,0,0,0,NULL,(int)"Enter:",LGP_NULL};
   1101          

   \                                 In segment CODE, align 4, keep-with-next
   1102          static void input_box_ghook(GUI *data, int cmd)
   1103          {
   \                     input_box_ghook:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   1104            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \   00000004   E4509FE5           LDR      R5,??input_box_ghook_0  ;; `?<Constant {4095, 0, 0}>_2`
   \   00000008   34D04DE2           SUB      SP,SP,#+52
   \   0000000C   0C0095E8           LDM      R5,{R2,R3}
   \   00000010   ........           LDR      R6,??DataTable30  ;; lgpData
   \   00000014   0040A0E1           MOV      R4,R0
   \   00000018   0D00A0E1           MOV      R0,SP
   \   0000001C   0C0080E8           STM      R0,{R2,R3}
   \   00000020   6C2096E5           LDR      R2,[R6, #+108]
   1105            if (cmd==0x0A)
   \   00000024   0A0051E3           CMP      R1,#+10
   \   00000028   04208DE5           STR      R2,[SP, #+4]
   \   0000002C   0B00001A           BNE      ??input_box_ghook_1
   1106            {
   1107              DisableIDLETMR();
   \   00000030   7F0100EF           SWI      +383
   1108            }
   1109            if (cmd==7)
   1110            {
   1111              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   1112              if (cfgShowCharCounter)
   1113              {
   1114                void *ma=malloc_adr();
   1115                void *mf=mfree_adr();
   1116                WSHDR* htext = AllocWS(256);
   1117                EDITCONTROL ec;
   1118                ExtractEditControl(data,1,&ec);
   1119                wsprintf(htext,"%t    %d", lgpData[LGP_EnterHeader], ec.pWS->wsbody[0]);
   1120                SetHeaderText(GetHeaderPointer(data), htext, ma, mf);
   1121              }
   1122            }
   1123            if(cmd==TI_CMD_FOCUS)
   1124            {
   1125              if (curpos_changed)
   \   00000034   ........           LDR      R0,??DataTable11  ;; templates_chars
   \   00000038   0C1090E5           LDR      R1,[R0, #+12]
   \   0000003C   000051E3           CMP      R1,#+0
   \   00000040   0400000A           BEQ      ??input_box_ghook_2
   1126              {
   1127                curpos_changed = 0;
   \   00000044   0010A0E3           MOV      R1,#+0
   \   00000048   0C1080E5           STR      R1,[R0, #+12]
   1128                EDIT_SetCursorPos(data, curpos);
   \   0000004C   081090E5           LDR      R1,[R0, #+8]
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   D40100EF           SWI      +468
   1129              }
   1130            }
   1131          }
   \                     ??input_box_ghook_2:
   \   00000058   34D08DE2           ADD      SP,SP,#+52       ;; stack cleaning
   \   0000005C   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??input_box_ghook_1:
   \   00000060   070051E3           CMP      R1,#+7
   \   00000064   FBFFFF1A           BNE      ??input_box_ghook_2
   \   00000068   0020A0E3           MOV      R2,#+0
   \   0000006C   0D10A0E1           MOV      R1,SP
   \   00000070   0400A0E1           MOV      R0,R4
   \   00000074   680100EF           SWI      +360
   \   00000078   74009FE5           LDR      R0,??input_box_ghook_0+0x4  ;; cfgShowCharCounter
   \   0000007C   000090E5           LDR      R0,[R0, #+0]
   \   00000080   000050E3           CMP      R0,#+0
   \   00000084   F3FFFF0A           BEQ      ??input_box_ghook_2
   \   00000088   148000EF           SWI      +32788
   \   0000008C   0070A0E1           MOV      R7,R0
   \   00000090   158000EF           SWI      +32789
   \   00000094   0080A0E1           MOV      R8,R0
   \   00000098   400FA0E3           MOV      R0,#+256
   \   0000009C   250100EF           SWI      +293
   \   000000A0   0090A0E1           MOV      R9,R0
   \   000000A4   08208DE2           ADD      R2,SP,#+8
   \   000000A8   0110A0E3           MOV      R1,#+1
   \   000000AC   0400A0E1           MOV      R0,R4
   \   000000B0   690100EF           SWI      +361
   \   000000B4   30009DE5           LDR      R0,[SP, #+48]
   \   000000B8   942096E5           LDR      R2,[R6, #+148]
   \   000000BC   000090E5           LDR      R0,[R0, #+0]
   \   000000C0   081085E2           ADD      R1,R5,#+8
   \   000000C4   B030D0E1           LDRH     R3,[R0, #+0]
   \   000000C8   0900A0E1           MOV      R0,R9
   \   000000CC   240100EF           SWI      +292
   \   000000D0   0400A0E1           MOV      R0,R4
   \   000000D4   AE0200EF           SWI      +686
   \   000000D8   0830A0E1           MOV      R3,R8
   \   000000DC   0720A0E1           MOV      R2,R7
   \   000000E0   0910A0E1           MOV      R1,R9
   \   000000E4   AF0200EF           SWI      +687
   \   000000E8   34D08DE2           ADD      SP,SP,#+52
   \   000000EC   F083BDE8           POP      {R4-R9,PC}
   \                     ??input_box_ghook_0:
   \   000000F0   ........           DC32     `?<Constant {4095, 0, 0}>_2`
   \   000000F4   ........           DC32     cfgShowCharCounter
   1132          

   \                                 In segment CODE, align 4, keep-with-next
   1133          static void input_box_locret(void){}
   \                     input_box_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1134          

   \                                 In segment CODE, align 4, keep-with-next
   1135          void input_box_onkey_options(USR_MENU_ITEM *item)
   1136          {
   \                     input_box_onkey_options:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0040A0E1           MOV      R4,R0
   1137            if (item->type==0)
   \   0000000C   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000010   000050E3           CMP      R0,#+0
   \   00000014   0F00001A           BNE      ??input_box_onkey_options_0
   1138            {
   1139              switch(item->cur_item)
   \   00000018   B820D4E1           LDRH     R2,[R4, #+8]
   \   0000001C   0C0094E5           LDR      R0,[R4, #+12]
   \   00000020   ........           LDR      R1,??DataTable30  ;; lgpData
   \   00000024   000052E3           CMP      R2,#+0
   \   00000028   0400000A           BEQ      ??input_box_onkey_options_1
   \   0000002C   012052E2           SUBS     R2,R2,#+1
   \   00000030   0400000A           BEQ      ??input_box_onkey_options_2
   \   00000034   012052E2           SUBS     R2,R2,#+1
   \   00000038   0400000A           BEQ      ??input_box_onkey_options_3
   \   0000003C   050000EA           B        ??input_box_onkey_options_0
   1140              {
   1141              case 0:
   1142                ascii2ws(item->ws,lgpData[LGP_Templates]);
   \                     ??input_box_onkey_options_1:
   \   00000040   741091E5           LDR      R1,[R1, #+116]
   \   00000044   020000EA           B        ??input_box_onkey_options_4
   1143                break;
   1144              case 1:
   1145                ascii2ws(item->ws,lgpData[LGP_AddToTemplate]);
   \                     ??input_box_onkey_options_2:
   \   00000048   301191E5           LDR      R1,[R1, #+304]
   \   0000004C   000000EA           B        ??input_box_onkey_options_4
   1146                break;
   1147              case 2:
   1148                ascii2ws(item->ws,lgpData[LGP_Clear]);
   \                     ??input_box_onkey_options_3:
   \   00000050   2C1191E5           LDR      R1,[R1, #+300]
   \                     ??input_box_onkey_options_4:
   \   00000054   ........           _BLF     ascii2ws,??ascii2ws??rA
   1149                break;
   1150              }
   1151            }
   1152            if (item->type==1)
   \                     ??input_box_onkey_options_0:
   \   00000058   0000D4E5           LDRB     R0,[R4, #+0]
   \   0000005C   010050E3           CMP      R0,#+1
   \   00000060   1600001A           BNE      ??input_box_onkey_options_5
   1153            {
   1154              GUI *data = item->user_pointer;
   \   00000064   045094E5           LDR      R5,[R4, #+4]
   1155              EDITCONTROL ec;
   1156              ExtractEditControl(data,1,&ec);
   \   00000068   0D20A0E1           MOV      R2,SP
   \   0000006C   0110A0E3           MOV      R1,#+1
   \   00000070   0500A0E1           MOV      R0,R5
   \   00000074   690100EF           SWI      +361
   1157              switch(item->cur_item)
   \   00000078   B800D4E1           LDRH     R0,[R4, #+8]
   \   0000007C   000050E3           CMP      R0,#+0
   \   00000080   0400000A           BEQ      ??input_box_onkey_options_6
   \   00000084   010050E2           SUBS     R0,R0,#+1
   \   00000088   0600000A           BEQ      ??input_box_onkey_options_7
   \   0000008C   010050E2           SUBS     R0,R0,#+1
   \   00000090   0700000A           BEQ      ??input_box_onkey_options_8
   \   00000094   010000EA           B        ??input_box_onkey_options_9
   1158              {
   1159              case 0:
   1160                createTemplatesMenu(data);
   \                     ??input_box_onkey_options_6:
   \   00000098   0500A0E1           MOV      R0,R5
   \   0000009C   ........           BL       createTemplatesMenu
   \                     ??input_box_onkey_options_9:
   \   000000A0   2CD08DE2           ADD      SP,SP,#+44
   \   000000A4   3080BDE8           POP      {R4,R5,PC}
   1161                break;
   1162              case 1:
   1163                SaveTextToTemplate(ec.pWS);
   \                     ??input_box_onkey_options_7:
   \   000000A8   28009DE5           LDR      R0,[SP, #+40]
   \   000000AC   ........           BL       SaveTextToTemplate
   \   000000B0   FAFFFFEA           B        ??input_box_onkey_options_9
   1164                break;
   1165              case 2:
   1166                CutWSTR(ec.pWS,0);
   \                     ??input_box_onkey_options_8:
   \   000000B4   28009DE5           LDR      R0,[SP, #+40]
   \   000000B8   0010A0E3           MOV      R1,#+0
   \   000000BC   260100EF           SWI      +294
   1167                break;
   1168              }
   1169            }
   1170          }
   \                     ??input_box_onkey_options_5:
   \   000000C0   2CD08DE2           ADD      SP,SP,#+44       ;; stack cleaning
   \   000000C4   3080BDE8           POP      {R4,R5,PC}       ;; return
   1171          

   \                                 In segment CODE, align 4, keep-with-next
   1172          static int input_box_onkey(GUI *data, GUI_MSG *msg)
   1173          {
   \                     input_box_onkey:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   1174            EDITCONTROL ec;
   1175            int gb_pressed = 0;
   1176            if ((msg->gbsmsg->msg==KEY_DOWN)&&(msg->gbsmsg->submess==ENTER_BUTTON))
   \   00000008   042091E5           LDR      R2,[R1, #+4]
   \   0000000C   9330A0E3           MOV      R3,#+147
   \   00000010   044092E5           LDR      R4,[R2, #+4]
   \   00000014   403F83E3           ORR      R3,R3,#0x100
   \   00000018   030054E1           CMP      R4,R3
   \   0000001C   08409205           LDREQ    R4,[R2, #+8]
   \   00000020   0060A0E3           MOV      R6,#+0
   \   00000024   1A005403           CMPEQ    R4,#+26
   \   00000028   0500001A           BNE      ??input_box_onkey_0
   1177            {
   1178              //paste_gui=data;
   1179              EDIT_OpenOptionMenuWithUserItems(data,input_box_onkey_options,data,3);
   \   0000002C   48119FE5           LDR      R1,??input_box_onkey_1  ;; input_box_onkey_options
   \   00000030   0330A0E3           MOV      R3,#+3
   \   00000034   0020A0E1           MOV      R2,R0
   \   00000038   E50100EF           SWI      +485
   1180              return (-1);
   \   0000003C   0600E0E1           MVN      R0,R6
   \   00000040   480000EA           B        ??input_box_onkey_2
   1181            }
   1182            if ((msg->gbsmsg->msg==KEY_DOWN)&&(msg->gbsmsg->submess==GREEN_BUTTON))
   \                     ??input_box_onkey_0:
   \   00000044   044092E5           LDR      R4,[R2, #+4]
   1183              gb_pressed = 1;
   1184            if ((msg->keys==0xFFF) || (gb_pressed))
   \   00000048   F210D1E1           LDRSH    R1,[R1, #+2]
   \   0000004C   030054E1           CMP      R4,R3
   \   00000050   08209205           LDREQ    R2,[R2, #+8]
   \   00000054   0B005203           CMPEQ    R2,#+11
   \   00000058   0160A003           MOVEQ    R6,#+1
   \   0000005C   FF20A0E3           MOV      R2,#+255
   \   00000060   F02E82E3           ORR      R2,R2,#0xF00
   \   00000064   020051E1           CMP      R1,R2
   \   00000068   0100000A           BEQ      ??input_box_onkey_3
   \   0000006C   000056E3           CMP      R6,#+0
   \   00000070   3E00000A           BEQ      ??input_box_onkey_4
   1185            {
   1186              // set value
   1187              ExtractEditControl(data,1,&ec);
   1188              REFCACHE* text_ref = FindReference(cur_vd,pos_ref);
   \                     ??input_box_onkey_3:
   \   00000074   ........           LDR      R4,??DataTable27  ;; sel_STRUCT
   \   00000078   0D20A0E1           MOV      R2,SP
   \   0000007C   0110A0E3           MOV      R1,#+1
   \   00000080   690100EF           SWI      +361
   \   00000084   8C0094E5           LDR      R0,[R4, #+140]
   \   00000088   901094E5           LDR      R1,[R4, #+144]
   1189              FreeWS(((WSHDR *)text_ref->data));
   1190              text_ref->data=(void *)AllocWS(ec.pWS->wsbody[0]);
   1191              wstrcpy(((WSHDR *)text_ref->data),ec.pWS);
   1192              setUserText(text_ref->id, ec.pWS);
   1193              if ((!text_ref->no_upload) || (gb_pressed))
   \   0000008C   0050A0E3           MOV      R5,#+0
   \   00000090   ........           BL       FindReference
   \   00000094   0070A0E1           MOV      R7,R0
   \   00000098   180097E5           LDR      R0,[R7, #+24]
   \   0000009C   290100EF           SWI      +297
   \   000000A0   28009DE5           LDR      R0,[SP, #+40]
   \   000000A4   000090E5           LDR      R0,[R0, #+0]
   \   000000A8   B000D0E1           LDRH     R0,[R0, #+0]
   \   000000AC   250100EF           SWI      +293
   \   000000B0   180087E5           STR      R0,[R7, #+24]
   \   000000B4   28109DE5           LDR      R1,[SP, #+40]
   \   000000B8   1F0100EF           SWI      +287
   \   000000BC   28109DE5           LDR      R1,[SP, #+40]
   \   000000C0   0C0097E5           LDR      R0,[R7, #+12]
   \   000000C4   ........           _BLF     setUserText,??setUserText??rA
   \   000000C8   2000D7E5           LDRB     R0,[R7, #+32]
   \   000000CC   010010E3           TST      R0,#0x1
   \   000000D0   0100000A           BEQ      ??input_box_onkey_5
   \   000000D4   000056E3           CMP      R6,#+0
   \   000000D8   1B00000A           BEQ      ??input_box_onkey_6
   1194              {
   1195                goto_url=malloc(strlen(cur_vd->pageurl)+1);
   \                     ??input_box_onkey_5:
   \   000000DC   8C0094E5           LDR      R0,[R4, #+140]
   \   000000E0   ........           LDR      R6,??DataTable23  ;; goto_url
   \   000000E4   E00090E5           LDR      R0,[R0, #+224]
   \   000000E8   1B0000EF           SWI      +27
   \   000000EC   010080E2           ADD      R0,R0,#+1
   \   000000F0   140000EF           SWI      +20
   \   000000F4   000086E5           STR      R0,[R6, #+0]
   1196                strcpy(goto_url,cur_vd->pageurl);
   \   000000F8   8C0094E5           LDR      R0,[R4, #+140]
   \   000000FC   E01090E5           LDR      R1,[R0, #+224]
   \   00000100   000096E5           LDR      R0,[R6, #+0]
   1197                from_url=malloc(strlen(cur_vd->pageurl)+1);
   \   00000104   ........           LDR      R6,??DataTable24  ;; from_url
   \   00000108   1A0000EF           SWI      +26
   \   0000010C   8C0094E5           LDR      R0,[R4, #+140]
   \   00000110   E00090E5           LDR      R0,[R0, #+224]
   \   00000114   1B0000EF           SWI      +27
   \   00000118   010080E2           ADD      R0,R0,#+1
   \   0000011C   140000EF           SWI      +20
   \   00000120   000086E5           STR      R0,[R6, #+0]
   1198                strcpy(from_url,cur_vd->pageurl);
   \   00000124   8C0094E5           LDR      R0,[R4, #+140]
   \   00000128   E01090E5           LDR      R1,[R0, #+224]
   \   0000012C   000096E5           LDR      R0,[R6, #+0]
   \   00000130   1A0000EF           SWI      +26
   1199                goto_params=collectItemsParams(cur_vd,text_ref);
   \   00000134   8C0094E5           LDR      R0,[R4, #+140]
   \   00000138   0710A0E1           MOV      R1,R7
   \   0000013C   ........           _BLF     collectItemsParams,??collectItemsParams??rA
   \   00000140   ........           LDR      R1,??DataTable25  ;; goto_params
   \   00000144   000081E5           STR      R0,[R1, #+0]
   \   00000148   040000EA           B        ??input_box_onkey_7
   1200              }
   1201              else
   1202              {
   1203                MAIN_CSM *main_csm;
   1204                if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   \                     ??input_box_onkey_6:
   \   0000014C   ........           LDR      R0,??DataTable26  ;; maincsm_id
   \   00000150   000090E5           LDR      R0,[R0, #+0]
   \   00000154   080100EF           SWI      +264
   \   00000158   000050E3           CMP      R0,#+0
   1205                {
   1206                  main_csm->sel_bmk=0;
   \   0000015C   30508015           STRNE    R5,[R0, #+48]
   1207                }
   1208              }
   1209              cur_vd=NULL;
   \                     ??input_box_onkey_7:
   \   00000160   8C5084E5           STR      R5,[R4, #+140]
   1210              return (0xFF);
   \   00000164   FF00A0E3           MOV      R0,#+255
   \                     ??input_box_onkey_2:
   \   00000168   2CD08DE2           ADD      SP,SP,#+44
   \   0000016C   F080BDE8           POP      {R4-R7,PC}
   1211            }
   1212            return (0);
   \                     ??input_box_onkey_4:
   \   00000170   0000A0E3           MOV      R0,#+0
   \   00000174   2CD08DE2           ADD      SP,SP,#+44
   \   00000178   F080BDE8           POP      {R4-R7,PC}       ;; return
   \                     ??input_box_onkey_1:
   \   0000017C   ........           DC32     input_box_onkey_options
   1213          }
   1214          

   \                                 In segment DATA_C, align 4, align-sorted
   1215          static const INPUTDIA_DESC input_box_desc =
   \                     input_box_desc:
   \   00000000   01000000....       DC32 1, input_box_onkey, input_box_ghook, input_box_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 input_box_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1216          {
   1217            1,
   1218            input_box_onkey,
   1219            input_box_ghook,
   1220            (void *)input_box_locret,
   1221            0,
   1222            &input_box_menu_skt,
   1223            {0,0,0,0},
   1224            FONT_SMALL,
   1225            100,
   1226            101,
   1227            0,
   1228            //  0x00000001 - Выровнять по правому краю
   1229            //  0x00000002 - Выровнять по центру
   1230            //  0x00000004 - Инверсия знакомест
   1231            //  0x00000008 - UnderLine
   1232            //  0x00000020 - Не переносить слова
   1233            //  0x00000200 - bold
   1234            0,
   1235            //  0x00000002 - ReadOnly
   1236            //  0x00000004 - Не двигается курсор
   1237            //  0x40000000 - Поменять местами софт-кнопки
   1238            0x40000000
   1239          };
   1240          

   \                                 In segment CODE, align 4, keep-with-next
   1241          int CreateInputBox(VIEWDATA *vd, REFCACHE* rf, unsigned int cur_pos_ref)
   1242          {
   \                     CreateInputBox:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   1243            pos_ref=cur_pos_ref;
   \   00000004   ........           LDR      R4,??DataTable27  ;; sel_STRUCT
   \   00000008   2CD04DE2           SUB      SP,SP,#+44
   \   0000000C   0180A0E1           MOV      R8,R1
   \   00000010   902084E5           STR      R2,[R4, #+144]
   1244            cur_vd=vd;
   \   00000014   8C0084E5           STR      R0,[R4, #+140]
   1245            
   1246            void *ma=malloc_adr();
   \   00000018   148000EF           SWI      +32788
   \   0000001C   0060A0E1           MOV      R6,R0
   1247            void *eq;
   1248            EDITCONTROL ec;
   1249            
   1250            eq=AllocEQueue(ma,mfree_adr());
   \   00000020   158000EF           SWI      +32789
   \   00000024   0010A0E1           MOV      R1,R0
   \   00000028   0600A0E1           MOV      R0,R6
   \   0000002C   630100EF           SWI      +355
   \   00000030   0050A0E1           MOV      R5,R0
   1251            WSHDR *ews=AllocWS(16384);
   \   00000034   400CA0E3           MOV      R0,#+16384
   \   00000038   250100EF           SWI      +293
   1252            
   1253            wstrcpy(ews,((WSHDR *)rf->data));
   \   0000003C   181098E5           LDR      R1,[R8, #+24]
   \   00000040   0070A0E1           MOV      R7,R0
   \   00000044   1F0100EF           SWI      +287
   1254            
   1255            PrepareEditControl(&ec);
   \   00000048   0D00A0E1           MOV      R0,SP
   \   0000004C   640100EF           SWI      +356
   1256            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL|(((rf->tag=='p')&&(!cfgPwdNormalText))?ECF_PASSW:NULL),ews,16384);
   \   00000050   080098E5           LDR      R0,[R8, #+8]
   \   00000054   700050E3           CMP      R0,#+112
   \   00000058   0400001A           BNE      ??CreateInputBox_0
   \   0000005C   98009FE5           LDR      R0,??CreateInputBox_1  ;; cfgPwdNormalText
   \   00000060   000090E5           LDR      R0,[R0, #+0]
   \   00000064   000050E3           CMP      R0,#+0
   \   00000068   1000A003           MOVEQ    R0,#+16
   \   0000006C   0000000A           BEQ      ??CreateInputBox_2
   \                     ??CreateInputBox_0:
   \   00000070   0000A0E3           MOV      R0,#+0
   \                     ??CreateInputBox_2:
   \   00000074   401CA0E3           MOV      R1,#+16384
   \   00000078   02002DE9           PUSH     {R1}
   \   0000007C   0730A0E1           MOV      R3,R7
   \   00000080   402080E3           ORR      R2,R0,#0x40
   \   00000084   04008DE2           ADD      R0,SP,#+4
   \   00000088   0310A0E3           MOV      R1,#+3
   \   0000008C   650100EF           SWI      +357
   1257            AddEditControlToEditQend(eq,&ec,ma);
   \   00000090   0620A0E1           MOV      R2,R6
   1258          
   1259            FreeWS(ews);
   1260            patch_header(&input_box_hdr);
   1261            patch_input(&input_box_desc);
   \   00000094   64609FE5           LDR      R6,??CreateInputBox_1+0x4  ;; input_box_desc
   \   00000098   04108DE2           ADD      R1,SP,#+4
   \   0000009C   0500A0E1           MOV      R0,R5
   \   000000A0   660100EF           SWI      +358
   \   000000A4   0700A0E1           MOV      R0,R7
   \   000000A8   290100EF           SWI      +297
   \   000000AC   440084E2           ADD      R0,R4,#+68
   \   000000B0   ........           _BLF     patch_header,??patch_header??rA
   \   000000B4   0600A0E1           MOV      R0,R6
   \   000000B8   ........           _BLF     patch_input,??patch_input??rA
   1262            input_box_hdr.lgp_id=(int)lgpData[LGP_EnterHeader];
   \   000000BC   ........           LDR      R0,??DataTable30  ;; lgpData
   1263            input_box_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   1264            input_box_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1265            return CreateInputTextDialog(&input_box_desc,&input_box_hdr,eq,1,0);
   \   000000C0   0130A0E3           MOV      R3,#+1
   \   000000C4   941090E5           LDR      R1,[R0, #+148]
   \   000000C8   0520A0E1           MOV      R2,R5
   \   000000CC   501084E5           STR      R1,[R4, #+80]
   \   000000D0   6C1090E5           LDR      R1,[R0, #+108]
   \   000000D4   700090E5           LDR      R0,[R0, #+112]
   \   000000D8   301084E5           STR      R1,[R4, #+48]
   \   000000DC   380084E5           STR      R0,[R4, #+56]
   \   000000E0   0000A0E3           MOV      R0,#+0
   \   000000E4   01002DE9           PUSH     {R0}
   \   000000E8   441084E2           ADD      R1,R4,#+68
   \   000000EC   0600A0E1           MOV      R0,R6
   \   000000F0   670100EF           SWI      +359
   \   000000F4   34D08DE2           ADD      SP,SP,#+52
   \   000000F8   F081BDE8           POP      {R4-R8,PC}       ;; return
   \                     ??CreateInputBox_1:
   \   000000FC   ........           DC32     cfgPwdNormalText
   \   00000100   ........           DC32     input_box_desc
   1266          }
   1267          
   1268          // TEXT VIEW
   1269          SOFTKEY_DESC txtview_menu_sk[]=
   1270          {
   1271            {0x0018,0x0000,(int)"Ok"},
   1272            {0x0001,0x0000,(int)"Cancel"},
   1273            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1274          };
   1275          

   \                                 In segment DATA_C, align 4, align-sorted
   1276          static const SOFTKEYSTAB txtview_menu_skt=
   \                     txtview_menu_skt:
   \   00000000   ........0000       DC32 txtview_menu_sk, 0
   \              0000        
   1277          {
   1278            txtview_menu_sk,0
   1279          };
   1280          
   1281          HEADER_DESC txtview_hdr={0,0,0,0,NULL,(int)"Text :",LGP_NULL};
   1282          

   \                                 In segment CODE, align 4, keep-with-next
   1283          static void txtview_ghook(GUI *data, int cmd)
   1284          {
   1285            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     txtview_ghook:
   \   00000000   58309FE5           LDR      R3,??txtview_ghook_0  ;; `?<Constant {4095, 0, 0}>`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   300093E8           LDM      R3,{R4,R5}
   \   00000010   ........           LDR      R3,??DataTable29  ;; lgpData + 108
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   300082E8           STM      R2,{R4,R5}
   \   0000001C   003093E5           LDR      R3,[R3, #+0]
   1286            if (cmd==0x0A)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   04308DE5           STR      R3,[SP, #+4]
   \   00000028   0100001A           BNE      ??txtview_ghook_1
   1287            {
   1288              DisableIDLETMR();
   \   0000002C   7F0100EF           SWI      +383
   \   00000030   3380BDE8           POP      {R0,R1,R4,R5,PC}
   1289            }
   1290            if (cmd==0x0C)
   \                     ??txtview_ghook_1:
   \   00000034   0C0051E3           CMP      R1,#+12
   \   00000038   0200001A           BNE      ??txtview_ghook_2
   1291              EDIT_SetCursorPos(data, 1);
   \   0000003C   0110A0E3           MOV      R1,#+1
   \   00000040   D40100EF           SWI      +468
   \   00000044   3380BDE8           POP      {R0,R1,R4,R5,PC}
   1292            if (cmd==7)
   \                     ??txtview_ghook_2:
   \   00000048   070051E3           CMP      R1,#+7
   \   0000004C   3380BD18           POPNE    {R0,R1,R4,R5,PC}
   1293            {
   1294              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   00000050   0020A0E3           MOV      R2,#+0
   \   00000054   0D10A0E1           MOV      R1,SP
   \   00000058   680100EF           SWI      +360
   1295            }
   1296          }
   \   0000005C   3380BDE8           POP      {R0,R1,R4,R5,PC}  ;; return
   \                     ??txtview_ghook_0:
   \   00000060   ........           DC32     `?<Constant {4095, 0, 0}>`
   1297          

   \                                 In segment CODE, align 4, keep-with-next
   1298          static void txtview_locret(void){}
   \                     txtview_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1299          

   \                                 In segment CODE, align 4, keep-with-next
   1300          static int txtview_onkey(GUI *data, GUI_MSG *msg)
   1301          {
   1302            if (msg->keys==0xFFF)
   \                     txtview_onkey:
   \   00000000   F200D1E1           LDRSH    R0,[R1, #+2]
   \   00000004   FF10A0E3           MOV      R1,#+255
   \   00000008   F01E81E3           ORR      R1,R1,#0xF00
   \   0000000C   010050E1           CMP      R0,R1
   1303            {
   1304              return (0xFF);
   \   00000010   FF00A003           MOVEQ    R0,#+255
   \   00000014   1EFF2F01           BXEQ     LR
   1305            }
   1306            return (0);
   \   00000018   0000A0E3           MOV      R0,#+0
   \   0000001C   1EFF2FE1           BX       LR               ;; return
   1307          }
   1308          

   \                                 In segment DATA_C, align 4, align-sorted
   1309          static const INPUTDIA_DESC txtview_desc =
   \                     txtview_desc:
   \   00000000   01000000....       DC32 1, txtview_onkey, txtview_ghook, txtview_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 txtview_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1310          {
   1311            1,
   1312            txtview_onkey,
   1313            txtview_ghook,
   1314            (void *)txtview_locret,
   1315            0,
   1316            &txtview_menu_skt,
   1317            {0,0,0,0},
   1318            FONT_SMALL,
   1319            100,
   1320            101,
   1321            0,
   1322            0,
   1323            0x40000000
   1324          };
   1325          

   \                                 In segment CODE, align 4, keep-with-next
   1326          void createTextView(WSHDR *ws)
   1327          {
   \                     createTextView:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   3CD04DE2           SUB      SP,SP,#+60
   \   00000008   0050A0E1           MOV      R5,R0
   1328            void *ma=malloc_adr();
   \   0000000C   148000EF           SWI      +32788
   \   00000010   0060A0E1           MOV      R6,R0
   1329            void *eq;
   1330            EDITCONTROL ec;
   1331            EDITC_OPTIONS ec_options;
   1332            eq=AllocEQueue(ma,mfree_adr());
   \   00000014   158000EF           SWI      +32789
   \   00000018   0010A0E1           MOV      R1,R0
   \   0000001C   0600A0E1           MOV      R0,R6
   \   00000020   630100EF           SWI      +355
   \   00000024   0040A0E1           MOV      R4,R0
   1333            if (!wstrlen(ws))
   \   00000028   0500A0E1           MOV      R0,R5
   \   0000002C   230100EF           SWI      +291
   \   00000030   000050E3           CMP      R0,#+0
   \   00000034   0300001A           BNE      ??createTextView_0
   1334            {
   1335              FreeWS(ws);
   \   00000038   0500A0E1           MOV      R0,R5
   \   0000003C   290100EF           SWI      +297
   1336              return;
   \   00000040   3CD08DE2           ADD      SP,SP,#+60
   \   00000044   7080BDE8           POP      {R4-R6,PC}
   1337            }
   1338            PrepareEditControl(&ec);
   \                     ??createTextView_0:
   \   00000048   10008DE2           ADD      R0,SP,#+16
   \   0000004C   640100EF           SWI      +356
   1339            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL,ws,2048);
   \   00000050   800EA0E3           MOV      R0,#+2048
   \   00000054   01002DE9           PUSH     {R0}
   \   00000058   0530A0E1           MOV      R3,R5
   \   0000005C   4020A0E3           MOV      R2,#+64
   \   00000060   0310A0E3           MOV      R1,#+3
   \   00000064   14008DE2           ADD      R0,SP,#+20
   \   00000068   650100EF           SWI      +357
   1340            PrepareEditCOptions(&ec_options);
   \   0000006C   04008DE2           ADD      R0,SP,#+4
   \   00000070   C80100EF           SWI      +456
   1341            SetFontToEditCOptions(&ec_options,FONT_SMALL);
   \   00000074   0810A0E3           MOV      R1,#+8
   \   00000078   04008DE2           ADD      R0,SP,#+4
   \   0000007C   CA0100EF           SWI      +458
   1342            CopyOptionsToEditControl(&ec,&ec_options);
   \   00000080   04108DE2           ADD      R1,SP,#+4
   \   00000084   14008DE2           ADD      R0,SP,#+20
   \   00000088   CE0100EF           SWI      +462
   1343            AddEditControlToEditQend(eq,&ec,ma);
   \   0000008C   0620A0E1           MOV      R2,R6
   1344            FreeWS(ws);
   1345            patch_header(&txtview_hdr);
   1346            patch_input(&txtview_desc);
   \   00000090   68609FE5           LDR      R6,??createTextView_1  ;; txtview_desc
   \   00000094   14108DE2           ADD      R1,SP,#+20
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   660100EF           SWI      +358
   \   000000A0   0500A0E1           MOV      R0,R5
   \   000000A4   58509FE5           LDR      R5,??createTextView_1+0x4  ;; txtview_menu_sk
   \   000000A8   290100EF           SWI      +297
   \   000000AC   180085E2           ADD      R0,R5,#+24
   \   000000B0   ........           _BLF     patch_header,??patch_header??rA
   \   000000B4   0600A0E1           MOV      R0,R6
   \   000000B8   ........           _BLF     patch_input,??patch_input??rA
   1347            txtview_hdr.lgp_id=(int)lgpData[LGP_TextHeader];
   \   000000BC   ........           LDR      R0,??DataTable30  ;; lgpData
   1348            txtview_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   1349            txtview_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1350            CreateInputTextDialog(&txtview_desc,&txtview_hdr,eq,1,0);
   \   000000C0   0130A0E3           MOV      R3,#+1
   \   000000C4   801090E5           LDR      R1,[R0, #+128]
   \   000000C8   0420A0E1           MOV      R2,R4
   \   000000CC   241085E5           STR      R1,[R5, #+36]
   \   000000D0   6C1090E5           LDR      R1,[R0, #+108]
   \   000000D4   700090E5           LDR      R0,[R0, #+112]
   \   000000D8   041085E5           STR      R1,[R5, #+4]
   \   000000DC   0C0085E5           STR      R0,[R5, #+12]
   \   000000E0   0000A0E3           MOV      R0,#+0
   \   000000E4   01002DE9           PUSH     {R0}
   \   000000E8   181085E2           ADD      R1,R5,#+24
   \   000000EC   0600A0E1           MOV      R0,R6
   \   000000F0   670100EF           SWI      +359
   1351          }
   \   000000F4   08D08DE2           ADD      SP,SP,#+8
   \   000000F8   3CD08DE2           ADD      SP,SP,#+60
   \   000000FC   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??createTextView_1:
   \   00000100   ........           DC32     txtview_desc
   \   00000104   ........           DC32     txtview_menu_sk
   1352          
   1353          // SELECTION MENU
   1354          typedef struct
   1355          {
   1356            void *next;
   1357            char name[256];
   1358            unsigned short value;
   1359            unsigned short id2;
   1360          }SEL_STRUCT;
   1361          

   \                                 In segment CODE, align 4, keep-with-next
   1362          int sel_menu_onkey(void *gui, GUI_MSG *msg)
   1363          {
   \                     sel_menu_onkey:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   0060A0E1           MOV      R6,R0
   \   00000008   0140A0E1           MOV      R4,R1
   1364            SEL_STRUCT *ustop=MenuGetUserPointer(gui);
   \   0000000C   E00100EF           SWI      +480
   \   00000010   0070A0E1           MOV      R7,R0
   1365            if (msg->keys==0x3D || msg->keys==0x18)
   \   00000014   F200D4E1           LDRSH    R0,[R4, #+2]
   \   00000018   3D0050E3           CMP      R0,#+61
   \   0000001C   18005013           CMPNE    R0,#+24
   \   00000020   2100001A           BNE      ??sel_menu_onkey_0
   1366            {
   1367              int i=GetCurMenuItem(gui);
   1368              int n=0;
   1369              REFCACHE* sel_ref = FindReference(cur_vd,pos_ref);
   \   00000024   ........           LDR      R4,??DataTable27  ;; sel_STRUCT
   \   00000028   0600A0E1           MOV      R0,R6
   \   0000002C   8F0100EF           SWI      +399
   \   00000030   901094E5           LDR      R1,[R4, #+144]
   \   00000034   0090A0E1           MOV      R9,R0
   \   00000038   8C0094E5           LDR      R0,[R4, #+140]
   \   0000003C   00A0A0E3           MOV      R10,#+0
   \   00000040   ........           BL       FindReference
   \   00000044   0080A0E1           MOV      R8,R0
   \   00000048   000059E3           CMP      R9,#+0
   \   0000004C   0300000A           BEQ      ??sel_menu_onkey_1
   1370              for (; n!=i; n++) ustop=ustop->next;
   \                     ??sel_menu_onkey_2:
   \   00000050   007097E5           LDR      R7,[R7, #+0]
   \   00000054   01A08AE2           ADD      R10,R10,#+1
   \   00000058   09005AE1           CMP      R10,R9
   \   0000005C   FBFFFF1A           BNE      ??sel_menu_onkey_2
   1371              if (ustop)
   \                     ??sel_menu_onkey_1:
   \   00000060   000057E3           CMP      R7,#+0
   \   00000064   1000000A           BEQ      ??sel_menu_onkey_0
   1372              {
   1373                if (sel_ref->multiselect)
   \   00000068   2000D8E5           LDRB     R0,[R8, #+32]
   \   0000006C   0050A0E3           MOV      R5,#+0
   \   00000070   020010E3           TST      R0,#0x2
   \   00000074   0E00000A           BEQ      ??sel_menu_onkey_3
   1374                {
   1375                  if(((char*)sel_ref->data)[n])
   \   00000078   180098E5           LDR      R0,[R8, #+24]
   \   0000007C   00008AE0           ADD      R0,R10,R0
   \   00000080   0010D0E5           LDRB     R1,[R0, #+0]
   \   00000084   000051E3           CMP      R1,#+0
   1376                    ((char*)sel_ref->data)[n]=0;
   \   00000088   0050C015           STRBNE   R5,[R0, #+0]
   1377                  else
   1378                    ((char*)sel_ref->data)[n]=1;
   \   0000008C   0110A003           MOVEQ    R1,#+1
   \   00000090   0010C005           STRBEQ   R1,[R0, #+0]
   1379                  SetMenuItemIcon(gui,i,((char*)sel_ref->data)[n]);
   \   00000094   180098E5           LDR      R0,[R8, #+24]
   \   00000098   0910A0E1           MOV      R1,R9
   \   0000009C   0020DAE7           LDRB     R2,[R10, +R0]
   \   000000A0   0600A0E1           MOV      R0,R6
   \   000000A4   950100EF           SWI      +405
   1380                  RefreshGUI();
   \   000000A8   960100EF           SWI      +406
   1381                }
   1382                else
   1383                {
   1384                  sel_ref->value=ustop->value;
   1385                  sel_ref->id2=ustop->id2;
   1386                  setUserList(sel_ref->id, sel_ref->value, sel_ref->id2);
   1387                  if (!sel_ref->no_upload)
   1388                  {
   1389                    goto_url=malloc(strlen(cur_vd->pageurl)+1);
   1390                    strcpy(goto_url,cur_vd->pageurl);
   1391                    from_url=malloc(strlen(cur_vd->pageurl)+1);
   1392                    strcpy(from_url,cur_vd->pageurl);
   1393                    goto_params=collectItemsParams(cur_vd,sel_ref);
   1394                  }
   1395                  else
   1396                  {
   1397                    MAIN_CSM *main_csm;
   1398                    if ((main_csm=(MAIN_CSM *)FindCSMbyID(maincsm_id)))
   1399                    {
   1400                      main_csm->sel_bmk=0;
   1401                    }
   1402                  }
   1403          
   1404                  cur_vd=NULL;
   1405                  return 0xFF;
   1406                }
   1407              }
   1408            }
   1409            return (0);
   \                     ??sel_menu_onkey_0:
   \   000000AC   0000A0E3           MOV      R0,#+0
   \   000000B0   F087BDE8           POP      {R4-R10,PC}      ;; return
   \                     ??sel_menu_onkey_3:
   \   000000B4   410F87E2           ADD      R0,R7,#+260
   \   000000B8   B010D0E1           LDRH     R1,[R0, #+0]
   \   000000BC   101088E5           STR      R1,[R8, #+16]
   \   000000C0   B220D0E1           LDRH     R2,[R0, #+2]
   \   000000C4   142088E5           STR      R2,[R8, #+20]
   \   000000C8   0C0098E5           LDR      R0,[R8, #+12]
   \   000000CC   ........           _BLF     setUserList,??setUserList??rA
   \   000000D0   2000D8E5           LDRB     R0,[R8, #+32]
   \   000000D4   010010E3           TST      R0,#0x1
   \   000000D8   1D00001A           BNE      ??sel_menu_onkey_4
   \   000000DC   8C0094E5           LDR      R0,[R4, #+140]
   \   000000E0   ........           LDR      R6,??DataTable23  ;; goto_url
   \   000000E4   E00090E5           LDR      R0,[R0, #+224]
   \   000000E8   1B0000EF           SWI      +27
   \   000000EC   010080E2           ADD      R0,R0,#+1
   \   000000F0   140000EF           SWI      +20
   \   000000F4   000086E5           STR      R0,[R6, #+0]
   \   000000F8   8C0094E5           LDR      R0,[R4, #+140]
   \   000000FC   E01090E5           LDR      R1,[R0, #+224]
   \   00000100   000096E5           LDR      R0,[R6, #+0]
   \   00000104   ........           LDR      R6,??DataTable24  ;; from_url
   \   00000108   1A0000EF           SWI      +26
   \   0000010C   8C0094E5           LDR      R0,[R4, #+140]
   \   00000110   E00090E5           LDR      R0,[R0, #+224]
   \   00000114   1B0000EF           SWI      +27
   \   00000118   010080E2           ADD      R0,R0,#+1
   \   0000011C   140000EF           SWI      +20
   \   00000120   000086E5           STR      R0,[R6, #+0]
   \   00000124   8C0094E5           LDR      R0,[R4, #+140]
   \   00000128   E01090E5           LDR      R1,[R0, #+224]
   \   0000012C   000096E5           LDR      R0,[R6, #+0]
   \   00000130   1A0000EF           SWI      +26
   \   00000134   8C0094E5           LDR      R0,[R4, #+140]
   \   00000138   0810A0E1           MOV      R1,R8
   \   0000013C   ........           _BLF     collectItemsParams,??collectItemsParams??rA
   \   00000140   ........           LDR      R1,??DataTable25  ;; goto_params
   \   00000144   8C5084E5           STR      R5,[R4, #+140]
   \   00000148   000081E5           STR      R0,[R1, #+0]
   \   0000014C   FF00A0E3           MOV      R0,#+255
   \   00000150   F087BDE8           POP      {R4-R10,PC}
   \                     ??sel_menu_onkey_4:
   \   00000154   ........           LDR      R0,??DataTable26  ;; maincsm_id
   \   00000158   000090E5           LDR      R0,[R0, #+0]
   \   0000015C   080100EF           SWI      +264
   \   00000160   000050E3           CMP      R0,#+0
   \   00000164   30508015           STRNE    R5,[R0, #+48]
   \   00000168   8C5084E5           STR      R5,[R4, #+140]
   \   0000016C   FF00A0E3           MOV      R0,#+255
   \   00000170   F087BDE8           POP      {R4-R10,PC}
   1410          }
   1411          

   \                                 In segment CODE, align 4, keep-with-next
   1412          void sel_menu_ghook(void *gui, int cmd)
   1413          {
   \                     sel_menu_ghook:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0140A0E1           MOV      R4,R1
   1414            SEL_STRUCT *ustop=MenuGetUserPointer(gui);
   \   00000008   E00100EF           SWI      +480
   \   0000000C   0050A0E1           MOV      R5,R0
   1415            if (cmd==3)
   \   00000010   030054E3           CMP      R4,#+3
   \   00000014   0500001A           BNE      ??sel_menu_ghook_0
   1416            {
   1417              while(ustop)
   \                     ??sel_menu_ghook_1:
   \   00000018   000055E3           CMP      R5,#+0
   \   0000001C   3080BD08           POPEQ    {R4,R5,PC}
   1418              {
   1419                SEL_STRUCT *us=ustop;
   \   00000020   0500A0E1           MOV      R0,R5
   1420                ustop=ustop->next;
   \   00000024   005095E5           LDR      R5,[R5, #+0]
   1421                mfree(us);
   \   00000028   150000EF           SWI      +21
   \   0000002C   F9FFFFEA           B        ??sel_menu_ghook_1
   1422              }    
   1423            }
   1424            if (cmd==0x0A)
   \                     ??sel_menu_ghook_0:
   \   00000030   0A0054E3           CMP      R4,#+10
   \   00000034   3080BD18           POPNE    {R4,R5,PC}
   1425            {
   1426              DisableIDLETMR();
   \   00000038   7F0100EF           SWI      +383
   1427            }
   1428          }
   \   0000003C   3080BDE8           POP      {R4,R5,PC}       ;; return
   1429          
   1430          static int icon_array[2];
   1431          

   \                                 In segment CODE, align 4, keep-with-next
   1432          void sel_menu_iconhndl(void *gui, int cur_item, void *user_pointer)
   1433          {
   \                     sel_menu_iconhndl:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0290A0E1           MOV      R9,R2
   1434            SEL_STRUCT *ustop=user_pointer;
   1435            WSHDR *ws;
   1436            int len;
   1437            int n=0;
   \   00000010   0060A0E3           MOV      R6,#+0
   \   00000014   000055E3           CMP      R5,#+0
   \   00000018   0300000A           BEQ      ??sel_menu_iconhndl_0
   1438            for (; n!=cur_item; n++) ustop=ustop->next;
   \                     ??sel_menu_iconhndl_1:
   \   0000001C   009099E5           LDR      R9,[R9, #+0]
   \   00000020   016086E2           ADD      R6,R6,#+1
   \   00000024   050056E1           CMP      R6,R5
   \   00000028   FBFFFF1A           BNE      ??sel_menu_iconhndl_1
   1439            void *item=AllocMenuItem(gui);
   \                     ??sel_menu_iconhndl_0:
   \   0000002C   970100EF           SWI      +407
   \   00000030   0070A0E1           MOV      R7,R0
   1440            if (ustop)
   \   00000034   000059E3           CMP      R9,#+0
   \   00000038   1B00000A           BEQ      ??sel_menu_iconhndl_2
   1441            {
   1442              len=strlen(ustop->name);
   \   0000003C   040089E2           ADD      R0,R9,#+4
   \   00000040   1B0000EF           SWI      +27
   \   00000044   00A0A0E1           MOV      R10,R0
   1443              ws=AllocMenuWS(gui,len+4);
   \   00000048   04108AE2           ADD      R1,R10,#+4
   \   0000004C   0400A0E1           MOV      R0,R4
   \   00000050   980100EF           SWI      +408
   1444              oms2ws(ws,ustop->name,len);
   \   00000054   041089E2           ADD      R1,R9,#+4
   1445              REFCACHE* sel_ref = FindReference(cur_vd,pos_ref);
   \   00000058   ........           LDR      R9,??DataTable27  ;; sel_STRUCT
   \   0000005C   0080A0E1           MOV      R8,R0
   \   00000060   0A20A0E1           MOV      R2,R10
   \   00000064   ........           _BLF     oms2ws,??oms2ws??rA
   \   00000068   8C0099E5           LDR      R0,[R9, #+140]
   \   0000006C   901099E5           LDR      R1,[R9, #+144]
   \   00000070   ........           BL       FindReference
   \   00000074   00A0A0E1           MOV      R10,R0
   1446              if (sel_ref->multiselect)
   \   00000078   2000DAE5           LDRB     R0,[R10, #+32]
   \   0000007C   020010E3           TST      R0,#0x2
   \   00000080   1100000A           BEQ      ??sel_menu_iconhndl_3
   1447              {
   1448                SetMenuItemIconArray(gui,item,icon_array);
   \   00000084   842089E2           ADD      R2,R9,#+132
   \   00000088   0710A0E1           MOV      R1,R7
   \   0000008C   0400A0E1           MOV      R0,R4
   \   00000090   990100EF           SWI      +409
   1449                SetMenuItemIcon(gui,cur_item,((char*)sel_ref->data)[n]);
   \   00000094   18009AE5           LDR      R0,[R10, #+24]
   \   00000098   0510A0E1           MOV      R1,R5
   \   0000009C   0020D6E7           LDRB     R2,[R6, +R0]
   \   000000A0   0400A0E1           MOV      R0,R4
   \   000000A4   950100EF           SWI      +405
   \   000000A8   070000EA           B        ??sel_menu_iconhndl_3
   1450              }
   1451            }
   1452            else
   1453            {
   1454              ws=AllocMenuWS(gui,10);
   \                     ??sel_menu_iconhndl_2:
   \   000000AC   0A10A0E3           MOV      R1,#+10
   \   000000B0   0400A0E1           MOV      R0,R4
   \   000000B4   980100EF           SWI      +408
   \   000000B8   0080A0E1           MOV      R8,R0
   1455              ascii2ws(ws,lgpData[LGP_Error]);//"Ошибка");
   \   000000BC   20009FE5           LDR      R0,??sel_menu_iconhndl_4  ;; lgpData + 24
   \   000000C0   001090E5           LDR      R1,[R0, #+0]
   \   000000C4   0800A0E1           MOV      R0,R8
   \   000000C8   ........           _BLF     ascii2ws,??ascii2ws??rA
   1456            }
   1457            SetMenuItemText(gui, item, ws, cur_item);
   \                     ??sel_menu_iconhndl_3:
   \   000000CC   0530A0E1           MOV      R3,R5
   \   000000D0   0820A0E1           MOV      R2,R8
   \   000000D4   0710A0E1           MOV      R1,R7
   \   000000D8   0400A0E1           MOV      R0,R4
   \   000000DC   9A0100EF           SWI      +410
   1458          }
   \   000000E0   F087BDE8           POP      {R4-R10,PC}      ;; return
   \                     ??sel_menu_iconhndl_4:
   \   000000E4   ........           DC32     lgpData + 24

   \                                 In segment DATA_I, align 4, align-sorted
   1459          
   1460          int sel_softkeys[]={0,1,2};
   1461          SOFTKEY_DESC sel_sk[]=
   1462          {
   1463            {0x0018,0x0000,(int)"Select"},
   1464            {0x0001,0x0000,(int)"Close"},
   1465            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1466          };
   1467          
   1468          SOFTKEYSTAB sel_skt=
   1469          {
   1470            sel_sk,0
   1471          };
   1472          
   1473          HEADER_DESC sel_HDR={0,0,0,0,NULL,(int)"Select:",LGP_NULL};
   1474          
   1475          MENU_DESC sel_STRUCT=
   \                     sel_STRUCT:
   \   00000000                      DS8 44
   \   0000002C                      REQUIRE `?<Initializer for sel_STRUCT>`
   \                     input_box_menu_sk:
   \   0000002C                      DS8 24
   \   00000044                      REQUIRE `?<Initializer for input_box_menu_sk>`
   \                     input_box_hdr:
   \   00000044                      DS8 20
   \   00000058                      REQUIRE `?<Initializer for input_box_hdr>`
   \                     sel_sk:
   \   00000058                      DS8 24
   \   00000070                      REQUIRE `?<Initializer for sel_sk>`
   \                     sel_HDR:
   \   00000070                      DS8 20
   \   00000084                      REQUIRE `?<Initializer for sel_HDR>`
   \   00000084                      DS8 8
   \   0000008C                      REQUIRE `?<Initializer for icon_array>`
   \                     cur_vd:
   \   0000008C                      DS8 4
   \   00000090                      REQUIRE `?<Initializer for cur_vd>`
   \                     pos_ref:
   \   00000090                      DS8 4
   \   00000094                      REQUIRE `?<Initializer for pos_ref>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     txtview_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for txtview_menu_sk>`
   \                     txtview_hdr:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for txtview_hdr>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     sel_softkeys:
   \   00000000                      DS8 12
   \   0000000C                      REQUIRE `?<Initializer for sel_softkeys>`

   \                                 In segment DATA_I, align 4, align-sorted
   \                     sel_skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for sel_skt>`
   1476          {
   1477            8,sel_menu_onkey,sel_menu_ghook,NULL,
   1478            sel_softkeys,
   1479            &sel_skt,
   1480            0x10,
   1481            sel_menu_iconhndl,
   1482            NULL,   //Items
   1483            NULL,   //Procs
   1484            0   //n
   1485          };
   1486          

   \                                 In segment CODE, align 4, keep-with-next
   1487          int ChangeMenuSelection(VIEWDATA *vd, REFCACHE *rf, unsigned int cur_pos_ref)
   1488          {
   \                     ChangeMenuSelection:
   \   00000000   F64F2DE9           PUSH     {R1,R2,R4-R11,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0050A0E1           MOV      R5,R0
   1489            int start=0;
   1490            SEL_STRUCT *ustop=0, *usbot=0;
   \   0000000C   0060A0E3           MOV      R6,#+0
   \   00000010   00608DE5           STR      R6,[SP, #+0]
   1491            SEL_STRUCT *us;
   1492            unsigned short i;
   1493            vd->oms_pos=rf->id;
   \   00000014   0C0091E5           LDR      R0,[R1, #+12]
   \   00000018   0090A0E3           MOV      R9,#+0
   \   0000001C   440085E5           STR      R0,[R5, #+68]
   1494            i=_rshort2(vd->oms+vd->oms_pos);
   \   00000020   3C1095E5           LDR      R1,[R5, #+60]
   \   00000024   0670A0E1           MOV      R7,R6
   \   00000028   010080E0           ADD      R0,R0,R1
   \   0000002C   ........           _BLF     _rshort2,??_rshort2??rA
   1495            vd->oms_pos+=2+i+1;
   \   00000030   441095E5           LDR      R1,[R5, #+68]
   \   00000034   0008A0E1           MOV      R0,R0, LSL #+16
   \   00000038   2008A0E1           MOV      R0,R0, LSR #+16
   \   0000003C   030080E2           ADD      R0,R0,#+3
   \   00000040   010080E0           ADD      R0,R0,R1
   \   00000044   440085E5           STR      R0,[R5, #+68]
   1496            int n_sel=_rshort2(vd->oms+vd->oms_pos);
   \   00000048   3C1095E5           LDR      R1,[R5, #+60]
   1497            vd->oms_pos+=2;
   1498            for(int o=0;o<n_sel;o++)
   \   0000004C   0680A0E1           MOV      R8,R6
   \   00000050   010080E0           ADD      R0,R0,R1
   \   00000054   ........           _BLF     _rshort2,??_rshort2??rA
   \   00000058   0040A0E1           MOV      R4,R0
   \   0000005C   440095E5           LDR      R0,[R5, #+68]
   \   00000060   010054E3           CMP      R4,#+1
   \   00000064   020080E2           ADD      R0,R0,#+2
   \   00000068   440085E5           STR      R0,[R5, #+68]
   \   0000006C   130000AA           BGE      ??ChangeMenuSelection_0
   1499            {
   1500              while(*(vd->oms+vd->oms_pos)!='o') vd->oms_pos++; // '$'
   1501              vd->oms_pos++;
   1502              if (rf->value==vd->oms_pos) start=o;
   1503              us=malloc(sizeof(SEL_STRUCT));
   1504              char *d=extract_omstr(vd,vd->oms_pos);
   1505              strcpy(us->name,d);
   1506              mfree(d);
   1507              us->value=vd->oms_pos;
   1508              int i=_rshort2(vd->oms+vd->oms_pos);
   1509              vd->oms_pos+=2+i;
   1510              us->id2=vd->oms_pos;
   1511              i=_rshort2(vd->oms+vd->oms_pos);
   1512              vd->oms_pos+=2+i+1;
   1513              us->next=0;
   1514              if (usbot)
   1515              {
   1516                usbot->next=us;
   1517                usbot=us;
   1518              }
   1519              else
   1520              {
   1521                ustop=us;
   1522                usbot=us;
   1523              }
   1524            }
   1525            cur_vd=vd;
   \                     ??ChangeMenuSelection_1:
   \   00000070   64619FE5           LDR      R6,??ChangeMenuSelection_2  ;; sel_STRUCT
   \   00000074   8C5086E5           STR      R5,[R6, #+140]
   1526            pos_ref = cur_pos_ref;
   \   00000078   08009DE5           LDR      R0,[SP, #+8]
   \   0000007C   900086E5           STR      R0,[R6, #+144]
   1527            icon_array[0]=GetPicNByUnicodeSymbol(CBOX_UNCHECKED);
   \   00000080   1700A0E3           MOV      R0,#+23
   \   00000084   E10C80E3           ORR      R0,R0,#0xE100
   \   00000088   E40100EF           SWI      +484
   \   0000008C   840086E5           STR      R0,[R6, #+132]
   1528            icon_array[1]=GetPicNByUnicodeSymbol(CBOX_CHECKED);
   \   00000090   1600A0E3           MOV      R0,#+22
   \   00000094   E10C80E3           ORR      R0,R0,#0xE100
   \   00000098   E40100EF           SWI      +484
   \   0000009C   880086E5           STR      R0,[R6, #+136]
   1529            if (rf->multiselect) sel_STRUCT.flags2=0x11;
   \   000000A0   04009DE5           LDR      R0,[SP, #+4]
   \   000000A4   2000D0E5           LDRB     R0,[R0, #+32]
   \   000000A8   020010E3           TST      R0,#0x2
   \   000000AC   1000A003           MOVEQ    R0,#+16
   \   000000B0   1100A013           MOVNE    R0,#+17
   \   000000B4   310000EA           B        ??ChangeMenuSelection_3
   \                     ??ChangeMenuSelection_4:
   \   000000B8   0A70A0E1           MOV      R7,R10
   \   000000BC   018088E2           ADD      R8,R8,#+1
   \                     ??ChangeMenuSelection_0:
   \   000000C0   040058E1           CMP      R8,R4
   \   000000C4   E9FFFFAA           BGE      ??ChangeMenuSelection_1
   \                     ??ChangeMenuSelection_5:
   \   000000C8   441095E5           LDR      R1,[R5, #+68]
   \   000000CC   3C2095E5           LDR      R2,[R5, #+60]
   \   000000D0   010081E2           ADD      R0,R1,#+1
   \   000000D4   0210D1E7           LDRB     R1,[R1, +R2]
   \   000000D8   440085E5           STR      R0,[R5, #+68]
   \   000000DC   6F0051E3           CMP      R1,#+111
   \   000000E0   F8FFFF1A           BNE      ??ChangeMenuSelection_5
   \   000000E4   04109DE5           LDR      R1,[SP, #+4]
   \   000000E8   101091E5           LDR      R1,[R1, #+16]
   \   000000EC   000051E1           CMP      R1,R0
   \   000000F0   0890A001           MOVEQ    R9,R8
   \   000000F4   420FA0E3           MOV      R0,#+264
   \   000000F8   140000EF           SWI      +20
   \   000000FC   441095E5           LDR      R1,[R5, #+68]
   \   00000100   00A0A0E1           MOV      R10,R0
   \   00000104   0500A0E1           MOV      R0,R5
   \   00000108   ........           _BLF     extract_omstr,??extract_omstr??rA
   \   0000010C   00B0A0E1           MOV      R11,R0
   \   00000110   0B10A0E1           MOV      R1,R11
   \   00000114   04008AE2           ADD      R0,R10,#+4
   \   00000118   1A0000EF           SWI      +26
   \   0000011C   0B00A0E1           MOV      R0,R11
   \   00000120   150000EF           SWI      +21
   \   00000124   440095E5           LDR      R0,[R5, #+68]
   \   00000128   41BF8AE2           ADD      R11,R10,#+260
   \   0000012C   B000CBE1           STRH     R0,[R11, #+0]
   \   00000130   3C1095E5           LDR      R1,[R5, #+60]
   \   00000134   010080E0           ADD      R0,R0,R1
   \   00000138   ........           _BLF     _rshort2,??_rshort2??rA
   \   0000013C   441095E5           LDR      R1,[R5, #+68]
   \   00000140   020080E2           ADD      R0,R0,#+2
   \   00000144   010080E0           ADD      R0,R0,R1
   \   00000148   440085E5           STR      R0,[R5, #+68]
   \   0000014C   B200CBE1           STRH     R0,[R11, #+2]
   \   00000150   3C1095E5           LDR      R1,[R5, #+60]
   \   00000154   010080E0           ADD      R0,R0,R1
   \   00000158   ........           _BLF     _rshort2,??_rshort2??rA
   \   0000015C   441095E5           LDR      R1,[R5, #+68]
   \   00000160   030080E2           ADD      R0,R0,#+3
   \   00000164   010080E0           ADD      R0,R0,R1
   \   00000168   440085E5           STR      R0,[R5, #+68]
   \   0000016C   00608AE5           STR      R6,[R10, #+0]
   \   00000170   000057E3           CMP      R7,#+0
   \   00000174   00A08D05           STREQ    R10,[SP, #+0]
   \   00000178   00A08715           STRNE    R10,[R7, #+0]
   \   0000017C   CDFFFFEA           B        ??ChangeMenuSelection_4
   \                     ??ChangeMenuSelection_3:
   \   00000180   180086E5           STR      R0,[R6, #+24]
   1530            else sel_STRUCT.flags2=0x10;
   1531            patch_header(&sel_HDR);
   \   00000184   700086E2           ADD      R0,R6,#+112
   \   00000188   ........           _BLF     patch_header,??patch_header??rA
   1532            sel_HDR.lgp_id=(int)lgpData[LGP_SelectHeader];
   \   0000018C   ........           LDR      R0,??DataTable30  ;; lgpData
   1533            sel_sk[0].lgp_id=(int)lgpData[LGP_Select];
   1534            sel_sk[1].lgp_id=(int)lgpData[LGP_Close];
   1535            return CreateMenu(0,0,&sel_STRUCT,&sel_HDR,start,n_sel,ustop,0);
   \   00000190   703086E2           ADD      R3,R6,#+112
   \   00000194   901090E5           LDR      R1,[R0, #+144]
   \   00000198   0620A0E1           MOV      R2,R6
   \   0000019C   7C1086E5           STR      R1,[R6, #+124]
   \   000001A0   641090E5           LDR      R1,[R0, #+100]
   \   000001A4   680090E5           LDR      R0,[R0, #+104]
   \   000001A8   5C1086E5           STR      R1,[R6, #+92]
   \   000001AC   640086E5           STR      R0,[R6, #+100]
   \   000001B0   0000A0E3           MOV      R0,#+0
   \   000001B4   01002DE9           PUSH     {R0}
   \   000001B8   04009DE5           LDR      R0,[SP, #+4]
   \   000001BC   0010A0E3           MOV      R1,#+0
   \   000001C0   01002DE9           PUSH     {R0}
   \   000001C4   10002DE9           PUSH     {R4}
   \   000001C8   00022DE9           PUSH     {R9}
   \   000001CC   0000A0E3           MOV      R0,#+0
   \   000001D0   520100EF           SWI      +338
   \   000001D4   1CD08DE2           ADD      SP,SP,#+28
   \   000001D8   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??ChangeMenuSelection_2:
   \   000001DC   ........           DC32     sel_STRUCT
   1536          }
   1537          
   1538          
   1539          SOFTKEY_DESC link_box_menu_sk[]=
   1540          {
   1541            {0x0018,0x0000,(int)"Ok"},
   1542            {0x0001,0x0000,(int)"Cancel"},
   1543            {0x003D,0x0000,(int)LGP_DOIT_PIC}
   1544          };
   1545          

   \                                 In segment DATA_C, align 4, align-sorted
   1546          static const SOFTKEYSTAB link_box_menu_skt=
   \                     link_box_menu_skt:
   \   00000000   ........0000       DC32 link_box_menu_sk, 0
   \              0000        

   \                                 In segment DATA_I, align 4, align-sorted
   \                     link_box_menu_sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for link_box_menu_sk>`
   1547          {
   1548            link_box_menu_sk,0
   1549          };
   1550          
   1551          HEADER_DESC link_box_hdr={0,0,0,0,NULL,(int)"Link:",LGP_NULL};
   \                     link_box_hdr:
   \   00000018                      DS8 20
   \   0000002C                      REQUIRE `?<Initializer for link_box_hdr>`
   1552          

   \                                 In segment CODE, align 4, keep-with-next
   1553          static void link_box_locret(void){}
   \                     link_box_locret:
   \   00000000   1EFF2FE1           BX       LR               ;; return
   1554          

   \                                 In segment CODE, align 4, keep-with-next
   1555          static void link_box_ghook(GUI *data, int cmd)
   1556          {
   1557            SOFTKEY_DESC sk={0x0FFF,0x0000,(int)lgpData[LGP_Ok]};
   \                     link_box_ghook:
   \   00000000   44309FE5           LDR      R3,??link_box_ghook_0  ;; `?<Constant {4095, 0, 0}>_1`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   300093E8           LDM      R3,{R4,R5}
   \   00000010   ........           LDR      R3,??DataTable29  ;; lgpData + 108
   \   00000014   0D20A0E1           MOV      R2,SP
   \   00000018   300082E8           STM      R2,{R4,R5}
   \   0000001C   003093E5           LDR      R3,[R3, #+0]
   1558            if (cmd==0x0A)
   \   00000020   0A0051E3           CMP      R1,#+10
   \   00000024   04308DE5           STR      R3,[SP, #+4]
   \   00000028   0100001A           BNE      ??link_box_ghook_1
   1559            {
   1560              DisableIDLETMR();
   \   0000002C   7F0100EF           SWI      +383
   \   00000030   3380BDE8           POP      {R0,R1,R4,R5,PC}
   1561            }
   1562            if (cmd==7)
   \                     ??link_box_ghook_1:
   \   00000034   070051E3           CMP      R1,#+7
   \   00000038   3380BD18           POPNE    {R0,R1,R4,R5,PC}
   1563            {
   1564              SetSoftKey(data,&sk,SET_SOFT_KEY_N);
   \   0000003C   0020A0E3           MOV      R2,#+0
   \   00000040   0D10A0E1           MOV      R1,SP
   \   00000044   680100EF           SWI      +360
   1565            }
   1566          }
   \   00000048   3380BDE8           POP      {R0,R1,R4,R5,PC}  ;; return
   \                     ??link_box_ghook_0:
   \   0000004C   ........           DC32     `?<Constant {4095, 0, 0}>_1`
   1567          

   \                                 In segment CODE, align 4, keep-with-next
   1568          void link_options(USR_MENU_ITEM *item)
   1569          {
   1570            const char per_t[] = "%t";
   \                     link_options:
   \   00000000   FC109FE5           LDR      R1,??link_options_1  ;; `?<Constant "%t">`
   \   00000004   30402DE9           PUSH     {R4,R5,LR}
   \   00000008   30D04DE2           SUB      SP,SP,#+48
   \   0000000C   0020D1E5           LDRB     R2,[R1, #0]
   \   00000010   0040A0E1           MOV      R4,R0
   \   00000014   0D00A0E1           MOV      R0,SP
   \   00000018   0020C0E5           STRB     R2,[R0, #+0]
   \   0000001C   0120D1E5           LDRB     R2,[R1, #+1]
   \   00000020   0120C0E5           STRB     R2,[R0, #+1]
   \   00000024   0220D1E5           LDRB     R2,[R1, #+2]
   \   00000028   0220C0E5           STRB     R2,[R0, #+2]
   1571            if (item->type==0)
   \   0000002C   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000030   000050E3           CMP      R0,#+0
   \   00000034   1500001A           BNE      ??link_options_2
   1572            {
   1573              switch(item->cur_item)
   \   00000038   B820D4E1           LDRH     R2,[R4, #+8]
   \   0000003C   0C0094E5           LDR      R0,[R4, #+12]
   \   00000040   040052E3           CMP      R2,#+4
   \   00000044   1100008A           BHI      ??link_options_2
   \   00000048   013F8FE2           ADR      R3,??link_options_0
   \   0000004C   0230D3E7           LDRB     R3,[R3, R2]
   \   00000050   03F18FE0           ADD      PC,PC,R3, LSL #+2
   \                     ??link_options_0:
   \   00000054   01050709           DC8      +1,+5,+7,+9
   \   00000058   0B000000           DC8      +11,+0,+0,+0
   1574              {
   1575                case 0: wsprintf(item->ws,per_t,"ballet"); break;
   \                     ??link_options_3:
   \   0000005C   0C2081E2           ADD      R2,R1,#+12
   \                     ??link_options_4:
   \   00000060   0D10A0E1           MOV      R1,SP
   \   00000064   240100EF           SWI      +292
   \   00000068   080000EA           B        ??link_options_2
   1576                case 1: wsprintf(item->ws,per_t,"browser");break;
   \                     ??link_options_5:
   \   0000006C   042081E2           ADD      R2,R1,#+4
   \   00000070   FAFFFFEA           B        ??link_options_4
   1577                case 2: wsprintf(item->ws,per_t,"nrss");break;
   \                     ??link_options_6:
   \   00000074   142081E2           ADD      R2,R1,#+20
   \   00000078   F8FFFFEA           B        ??link_options_4
   1578                case 3: wsprintf(item->ws,per_t,"sieget");break;
   \                     ??link_options_7:
   \   0000007C   1C2081E2           ADD      R2,R1,#+28
   \   00000080   F6FFFFEA           B        ??link_options_4
   1579                case 4: ascii2ws(item->ws,lgpData[LGP_Clear]);break;
   \                     ??link_options_8:
   \   00000084   7C109FE5           LDR      R1,??link_options_1+0x4  ;; lgpData + 300
   \   00000088   001091E5           LDR      R1,[R1, #+0]
   \   0000008C   ........           _BLF     ascii2ws,??ascii2ws??rA
   1580              }
   1581            }
   1582            if (item->type==1)
   \                     ??link_options_2:
   \   00000090   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000094   010050E3           CMP      R0,#+1
   \   00000098   1700001A           BNE      ??link_options_9
   1583            {
   1584              GUI *gui = (GUI*)(item->user_pointer);
   1585              EDITCONTROL ec;
   1586              ExtractEditControl(gui,1,&ec);
   \   0000009C   040094E5           LDR      R0,[R4, #+4]
   \   000000A0   04208DE2           ADD      R2,SP,#+4
   \   000000A4   0110A0E3           MOV      R1,#+1
   \   000000A8   690100EF           SWI      +361
   1587              if (item->cur_item == 4)
   \   000000AC   B800D4E1           LDRH     R0,[R4, #+8]
   \   000000B0   040050E3           CMP      R0,#+4
   \   000000B4   0400001A           BNE      ??link_options_10
   1588                CutWSTR(ec.pWS,0);
   \   000000B8   2C009DE5           LDR      R0,[SP, #+44]
   \   000000BC   0010A0E3           MOV      R1,#+0
   \   000000C0   260100EF           SWI      +294
   \   000000C4   30D08DE2           ADD      SP,SP,#+48
   \   000000C8   3080BDE8           POP      {R4,R5,PC}
   1589              else
   1590              {
   1591                char* s = malloc(wstrlen(ec.pWS)+1);
   \                     ??link_options_10:
   \   000000CC   2C009DE5           LDR      R0,[SP, #+44]
   \   000000D0   230100EF           SWI      +291
   \   000000D4   010080E2           ADD      R0,R0,#+1
   \   000000D8   140000EF           SWI      +20
   1592                ws2ascii(s, ec.pWS);
   \   000000DC   2C109DE5           LDR      R1,[SP, #+44]
   \   000000E0   0050A0E1           MOV      R5,R0
   \   000000E4   ........           _BLF     ws2ascii,??ws2ascii??rA
   1593                RunOtherByURL(s,item->cur_item);
   \   000000E8   B810D4E1           LDRH     R1,[R4, #+8]
   \   000000EC   0500A0E1           MOV      R0,R5
   \   000000F0   ........           _BLF     RunOtherByURL,??RunOtherByURL??rA
   1594                mfree(s);
   \   000000F4   0500A0E1           MOV      R0,R5
   \   000000F8   150000EF           SWI      +21
   1595              }
   1596            }   
   1597          }
   \                     ??link_options_9:
   \   000000FC   30D08DE2           ADD      SP,SP,#+48       ;; stack cleaning
   \   00000100   3080BDE8           POP      {R4,R5,PC}       ;; return
   \                     ??link_options_1:
   \   00000104   ........           DC32     `?<Constant "%t">`
   \   00000108   ........           DC32     lgpData + 300
   1598          

   \                                 In segment CODE, align 4, keep-with-next
   1599          static int link_box_onkey(GUI *data, GUI_MSG *msg)
   1600          {
   \                     link_box_onkey:
   \   00000000   00402DE9           PUSH     {LR}
   1601            if (msg->keys==0xFFF)
   \   00000004   F220D1E1           LDRSH    R2,[R1, #+2]
   \   00000008   FF30A0E3           MOV      R3,#+255
   \   0000000C   F03E83E3           ORR      R3,R3,#0xF00
   \   00000010   030052E1           CMP      R2,R3
   1602            {
   1603              return (0xFF);
   \   00000014   FF00A003           MOVEQ    R0,#+255
   \   00000018   0080BD08           POPEQ    {PC}
   1604            }
   1605            if ((msg->gbsmsg->msg==KEY_DOWN) && (msg->gbsmsg->submess == ENTER_BUTTON))
   \   0000001C   041091E5           LDR      R1,[R1, #+4]
   \   00000020   9330A0E3           MOV      R3,#+147
   \   00000024   042091E5           LDR      R2,[R1, #+4]
   \   00000028   403F83E3           ORR      R3,R3,#0x100
   \   0000002C   030052E1           CMP      R2,R3
   \   00000030   08109105           LDREQ    R1,[R1, #+8]
   \   00000034   1A005103           CMPEQ    R1,#+26
   \   00000038   0500001A           BNE      ??link_box_onkey_0
   1606            {
   1607              EDIT_OpenOptionMenuWithUserItems(data,link_options,data,5);
   \   0000003C   18109FE5           LDR      R1,??link_box_onkey_1  ;; link_options
   \   00000040   0530A0E3           MOV      R3,#+5
   \   00000044   0020A0E1           MOV      R2,R0
   \   00000048   E50100EF           SWI      +485
   1608              return -1;
   \   0000004C   0000E0E3           MVN      R0,#+0
   \   00000050   0080BDE8           POP      {PC}
   1609            }
   1610            return (0);
   \                     ??link_box_onkey_0:
   \   00000054   0000A0E3           MOV      R0,#+0
   \   00000058   0080BDE8           POP      {PC}             ;; return
   \                     ??link_box_onkey_1:
   \   0000005C   ........           DC32     link_options
   1611          }
   1612          

   \                                 In segment DATA_C, align 4, align-sorted
   1613          static const INPUTDIA_DESC link_box_desc =
   \                     link_box_desc:
   \   00000000   01000000....       DC32 1, link_box_onkey, link_box_ghook, link_box_locret, 0
   \              ............
   \              ........0000
   \              0000        
   \   00000014   ........           DC32 link_box_menu_skt
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   080000006400       DC32 8, 100, 101, 0, 0, 1073741824
   \              000065000000
   \              000000000000
   \              000000000040
   1614          {
   1615            1,
   1616            link_box_onkey,
   1617            link_box_ghook,
   1618            (void *)link_box_locret,
   1619            0,
   1620            &link_box_menu_skt,
   1621            {0,0,0,0},
   1622            FONT_SMALL,
   1623            100,
   1624            101,
   1625            0,
   1626            //  0x00000001 - Выровнять по правому краю
   1627            //  0x00000002 - Выровнять по центру
   1628            //  0x00000004 - Инверсия знакомест
   1629            //  0x00000008 - UnderLine
   1630            //  0x00000020 - Не переносить слова
   1631            //  0x00000200 - bold
   1632            0,
   1633            //  0x00000002 - ReadOnly
   1634            //  0x00000004 - Не двигается курсор
   1635            //  0x40000000 - Поменять местами софт-кнопки
   1636            0x40000000
   1637          };
   1638          

   \                                 In segment CODE, align 4, keep-with-next
   1639          int ShowLink(char *link)
   1640          {
   \                     ShowLink:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   2CD04DE2           SUB      SP,SP,#+44
   \   00000008   0040A0E1           MOV      R4,R0
   1641            
   1642            void *ma=malloc_adr();
   \   0000000C   148000EF           SWI      +32788
   \   00000010   0050A0E1           MOV      R5,R0
   1643            void *eq;
   1644            EDITCONTROL ec;
   1645            WSHDR* wslink = AllocWS(strlen(link));
   \   00000014   0400A0E1           MOV      R0,R4
   \   00000018   1B0000EF           SWI      +27
   \   0000001C   250100EF           SWI      +293
   \   00000020   0060A0E1           MOV      R6,R0
   1646            ascii2ws(wslink, link);
   \   00000024   0410A0E1           MOV      R1,R4
   \   00000028   ........           _BLF     ascii2ws,??ascii2ws??rA
   1647            
   1648            eq=AllocEQueue(ma,mfree_adr());
   \   0000002C   158000EF           SWI      +32789
   \   00000030   0010A0E1           MOV      R1,R0
   \   00000034   0500A0E1           MOV      R0,R5
   \   00000038   630100EF           SWI      +355
   \   0000003C   0040A0E1           MOV      R4,R0
   1649            
   1650            PrepareEditControl(&ec);
   \   00000040   0D00A0E1           MOV      R0,SP
   \   00000044   640100EF           SWI      +356
   1651            ConstructEditControl(&ec,ECT_NORMAL_TEXT,ECF_APPEND_EOL,wslink,wstrlen(wslink)*2);
   \   00000048   0600A0E1           MOV      R0,R6
   \   0000004C   230100EF           SWI      +291
   \   00000050   8000A0E1           LSL      R0,R0,#+1
   \   00000054   01002DE9           PUSH     {R0}
   \   00000058   0630A0E1           MOV      R3,R6
   \   0000005C   4020A0E3           MOV      R2,#+64
   \   00000060   0310A0E3           MOV      R1,#+3
   \   00000064   04008DE2           ADD      R0,SP,#+4
   \   00000068   650100EF           SWI      +357
   1652            AddEditControlToEditQend(eq,&ec,ma);
   \   0000006C   0520A0E1           MOV      R2,R5
   1653            FreeWS(wslink);
   1654          
   1655            patch_header(&link_box_hdr);
   \   00000070   5C509FE5           LDR      R5,??ShowLink_0  ;; link_box_menu_sk
   \   00000074   04108DE2           ADD      R1,SP,#+4
   \   00000078   0400A0E1           MOV      R0,R4
   \   0000007C   660100EF           SWI      +358
   \   00000080   0600A0E1           MOV      R0,R6
   1656            patch_input(&link_box_desc);
   \   00000084   4C609FE5           LDR      R6,??ShowLink_0+0x4  ;; link_box_desc
   \   00000088   290100EF           SWI      +297
   \   0000008C   180085E2           ADD      R0,R5,#+24
   \   00000090   ........           _BLF     patch_header,??patch_header??rA
   \   00000094   0600A0E1           MOV      R0,R6
   \   00000098   ........           _BLF     patch_input,??patch_input??rA
   1657            link_box_menu_sk[0].lgp_id=(int)lgpData[LGP_Ok];
   \   0000009C   ........           LDR      R0,??DataTable30  ;; lgpData
   1658            link_box_menu_sk[1].lgp_id=(int)lgpData[LGP_Cancel];
   1659            return CreateInputTextDialog(&link_box_desc,&link_box_hdr,eq,1,0);
   \   000000A0   0130A0E3           MOV      R3,#+1
   \   000000A4   6C1090E5           LDR      R1,[R0, #+108]
   \   000000A8   700090E5           LDR      R0,[R0, #+112]
   \   000000AC   041085E5           STR      R1,[R5, #+4]
   \   000000B0   0C0085E5           STR      R0,[R5, #+12]
   \   000000B4   0000A0E3           MOV      R0,#+0
   \   000000B8   01002DE9           PUSH     {R0}
   \   000000BC   0420A0E1           MOV      R2,R4
   \   000000C0   181085E2           ADD      R1,R5,#+24
   \   000000C4   0600A0E1           MOV      R0,R6
   \   000000C8   670100EF           SWI      +359
   \   000000CC   34D08DE2           ADD      SP,SP,#+52
   \   000000D0   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??ShowLink_0:
   \   000000D4   ........           DC32     link_box_menu_sk
   \   000000D8   ........           DC32     link_box_desc
   1660          }
   1661          

   \                                 In segment CODE, align 4, keep-with-next
   1662          void FindStringOnPage(VIEWDATA* cur_vd)
   1663          {
   \                     FindStringOnPage:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   1664              int ld = LineDown(cur_vd);
   1665              int i;
   1666              i = (cur_vd->lines_cache[cur_vd->view_line]).pos+1;
   1667              int j = 0;
   1668              int found = 0;
   \   00000004   ........           LDR      R9,??DataTable31  ;; search_string
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0080A0E3           MOV      R8,#+0
   \   00000010   ........           BL       LineDown
   \   00000014   102094E5           LDR      R2,[R4, #+16]
   \   00000018   0050A0E1           MOV      R5,R0
   \   0000001C   1C0094E5           LDR      R0,[R4, #+28]
   \   00000020   1410A0E3           MOV      R1,#+20
   \   00000024   912020E0           MLA      R0,R1,R0,R2
   \   00000028   0070A0E3           MOV      R7,#+0
   \   0000002C   000090E5           LDR      R0,[R0, #+0]
   \   00000030   016080E2           ADD      R6,R0,#+1
   \   00000034   010000EA           B        ??FindStringOnPage_0
   1669              while ((i < cur_vd->rawtext_size) && (!found))
   1670              {
   1671                while ((j < wstrlen(search_string)) && 
   1672                       CompareWchar(cur_vd->rawtext[i+j], search_string->wsbody[1+j], search_isCaseSens))
   1673                  j++;
   1674                if (j == wstrlen(search_string))
   1675                {
   1676                  found = 1;
   \                     ??FindStringOnPage_1:
   \   00000038   0170A0E3           MOV      R7,#+1
   1677                  cur_vd->found_word_pos = i;
   \   0000003C   E86084E5           STR      R6,[R4, #+232]
   1678                }
   \                     ??FindStringOnPage_0:
   \   00000040   0C0094E5           LDR      R0,[R4, #+12]
   \   00000044   000056E1           CMP      R6,R0
   \   00000048   0100002A           BCS      ??FindStringOnPage_2
   \   0000004C   000057E3           CMP      R7,#+0
   \   00000050   1600000A           BEQ      ??FindStringOnPage_3
   1679                else
   1680                {
   1681                  i += 1+j;
   1682                  j = 0;
   1683                }
   1684              }
   1685              if (found)
   \                     ??FindStringOnPage_2:
   \   00000054   000057E3           CMP      R7,#+0
   \   00000058   0E00000A           BEQ      ??FindStringOnPage_4
   1686              {
   1687                if (LineDown(cur_vd))
   \   0000005C   0400A0E1           MOV      R0,R4
   \   00000060   ........           BL       LineDown
   \   00000064   000050E3           CMP      R0,#+0
   \   00000068   0A00000A           BEQ      ??FindStringOnPage_4
   1688                {
   1689                  while (((cur_vd->lines_cache[cur_vd->view_line]).pos < i) && (LineDown(cur_vd)));
   \                     ??FindStringOnPage_5:
   \   0000006C   1C0094E5           LDR      R0,[R4, #+28]
   \   00000070   102094E5           LDR      R2,[R4, #+16]
   \   00000074   1410A0E3           MOV      R1,#+20
   \   00000078   912020E0           MLA      R0,R1,R0,R2
   \   0000007C   000090E5           LDR      R0,[R0, #+0]
   \   00000080   060050E1           CMP      R0,R6
   \   00000084   0300002A           BCS      ??FindStringOnPage_4
   \   00000088   0400A0E1           MOV      R0,R4
   \   0000008C   ........           BL       LineDown
   \   00000090   000050E3           CMP      R0,#+0
   \   00000094   F4FFFF1A           BNE      ??FindStringOnPage_5
   1690                }
   1691              }
   1692              if (ld)
   \                     ??FindStringOnPage_4:
   \   00000098   000055E3           CMP      R5,#+0
   \   0000009C   F083BD08           POPEQ    {R4-R9,PC}
   1693                LineUp(cur_vd);
   \   000000A0   0400A0E1           MOV      R0,R4
   \   000000A4   ........           BL       LineUp
   1694          }
   \   000000A8   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??FindStringOnPage_6:
   \   000000AC   018088E2           ADD      R8,R8,#+1
   \                     ??FindStringOnPage_3:
   \   000000B0   000099E5           LDR      R0,[R9, #+0]
   \   000000B4   230100EF           SWI      +291
   \   000000B8   000058E1           CMP      R8,R0
   \   000000BC   0C0000AA           BGE      ??FindStringOnPage_7
   \   000000C0   4C009FE5           LDR      R0,??FindStringOnPage_8  ;; search_isCaseSens
   \   000000C4   083094E5           LDR      R3,[R4, #+8]
   \   000000C8   002090E5           LDR      R2,[R0, #+0]
   \   000000CC   000099E5           LDR      R0,[R9, #+0]
   \   000000D0   000090E5           LDR      R0,[R0, #+0]
   \   000000D4   880080E0           ADD      R0,R0,R8, LSL #+1
   \   000000D8   F210D0E1           LDRSH    R1,[R0, #+2]
   \   000000DC   060088E0           ADD      R0,R8,R6
   \   000000E0   800083E0           ADD      R0,R3,R0, LSL #+1
   \   000000E4   F000D0E1           LDRSH    R0,[R0, #+0]
   \   000000E8   ........           _BLF     CompareWchar,??CompareWchar??rA
   \   000000EC   000050E3           CMP      R0,#+0
   \   000000F0   EDFFFF1A           BNE      ??FindStringOnPage_6
   \                     ??FindStringOnPage_7:
   \   000000F4   000099E5           LDR      R0,[R9, #+0]
   \   000000F8   230100EF           SWI      +291
   \   000000FC   000058E1           CMP      R8,R0
   \   00000100   CCFFFF0A           BEQ      ??FindStringOnPage_1
   \   00000104   010088E2           ADD      R0,R8,#+1
   \   00000108   066080E0           ADD      R6,R0,R6
   \   0000010C   0080A0E3           MOV      R8,#+0
   \   00000110   CAFFFFEA           B        ??FindStringOnPage_0
   \                     ??FindStringOnPage_8:
   \   00000114   ........           DC32     search_isCaseSens

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable0:
   \   00000000   ........           DC32     scr_shift

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable1:
   \   00000000   ........           DC32     scr_shift

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable2:
   \   00000000   ........           DC32     search_string

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable5:
   \   00000000   ........           DC32     `?<Constant "$ballet\\\\templates.txt">`

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable6:
   \   00000000   ........           DC32     templates_chars

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable11:
   \   00000000   ........           DC32     templates_chars

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable23:
   \   00000000   ........           DC32     goto_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable24:
   \   00000000   ........           DC32     from_url

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable25:
   \   00000000   ........           DC32     goto_params

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable26:
   \   00000000   ........           DC32     maincsm_id

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable27:
   \   00000000   ........           DC32     sel_STRUCT

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable29:
   \   00000000   ........           DC32     lgpData + 108

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable30:
   \   00000000   ........           DC32     lgpData

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable31:
   \   00000000   ........           DC32     search_string

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templates_menu_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templates_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Select">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Close">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for templates_menu_header>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "\\302\\373\\341\\356\\360">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for templates_menu_struct>`:
   \   0000002C   08000000....       DC32 8, templates_menu_onkey, templates_menu_ghook, 0H
   \              ............
   \              00000000    
   \   0000003C   ............       DC32 templates_menu_softkeys, templates_menu_skt, 16
   \              ....10000000
   \   00000048   ........0000       DC32 templates_menu_iconhndl, 0H, 0H, 0
   \              000000000000
   \              00000000    

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for templates_menu_skt>`:
   \   00000000   ........0000       DC32 templates_menu_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_STRUCT>`:
   \   00000000   08000000....       DC32 8, sel_menu_onkey, sel_menu_ghook, 0H, sel_softkeys, sel_skt, 16
   \              ............
   \              00000000....
   \              ............
   \              10000000    
   \   0000001C   ........0000       DC32 sel_menu_iconhndl, 0H, 0H, 0
   \              000000000000
   \              00000000    
   \                     `?<Initializer for input_box_menu_sk>`:
   \   0000002C   18000000           DC16 24, 0
   \   00000030   ........           DC32 `?<Constant "Ok">`
   \   00000034   01000000           DC16 1, 0
   \   00000038   ........           DC32 `?<Constant "Cancel">`
   \   0000003C   3D000000           DC16 61, 0
   \   00000040   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for input_box_hdr>`:
   \   00000044   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   0000004C   00000000....       DC32 0H, `?<Constant "Enter:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for sel_sk>`:
   \   00000058   18000000           DC16 24, 0
   \   0000005C   ........           DC32 `?<Constant "Select">`
   \   00000060   01000000           DC16 1, 0
   \   00000064   ........           DC32 `?<Constant "Close">`
   \   00000068   3D000000           DC16 61, 0
   \   0000006C   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for sel_HDR>`:
   \   00000070   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000078   00000000....       DC32 0H, `?<Constant "Select:">`, 2147483647
   \              ....FFFFFF7F
   \                     `?<Initializer for icon_array>`:
   \   00000084   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0
   \              0000        
   \                     `?<Initializer for cur_vd>`:
   \   0000008C   00000000           DC8 0, 0, 0, 0
   \                     `?<Initializer for pos_ref>`:
   \   00000090   00000000           DC8 0, 0, 0, 0

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for txtview_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Ok">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Cancel">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for txtview_hdr>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "Text :">`, 2147483647
   \              ....FFFFFF7F

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_softkeys>`:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sel_skt>`:
   \   00000000   ........0000       DC32 sel_sk, 0
   \              0000        

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for link_box_menu_sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "Ok">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "Cancel">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515
   \                     `?<Initializer for link_box_hdr>`:
   \   00000018   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000020   00000000....       DC32 0H, `?<Constant "Link:">`, 2147483647
   \              ....FFFFFF7F

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "%t">`:
   \   00000000   257400             DC8 "%t"
   \   00000003   00                 DC8 0
   \   00000004   62726F777365       DC8 "browser"
   \              7200        
   \   0000000C   62616C6C6574       DC8 "ballet"
   \              00          
   \   00000013   00                 DC8 0
   \   00000014   6E72737300         DC8 "nrss"
   \   00000019   000000             DC8 0, 0, 0
   \   0000001C   736965676574       DC8 "sieget"
   \              00          
   \   00000023   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_1`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant {4095, 0, 0}>_2`:
   \   00000000   FF0F0000           DC16 4095, 0
   \   00000004   00000000           DC32 0
   \   00000008   257420202020       DC8 "%t    %d"
   \              256400      
   \   00000011   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "$ballet\\\\templates.txt">`:
   \   00000000   2462616C6C65       DC8 "$ballet\\templates.txt"
   \              745C74656D70
   \              6C617465732E
   \              74787400    
   \   00000016   0000               DC8 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \   00000000   0A00               DC8 "\012"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Link:">`:
   \   00000000   4C696E6B3A00       DC8 "Link:"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Select:">`:
   \   00000000   53656C656374       DC8 "Select:"
   \              3A00        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Text :">`:
   \   00000000   54657874203A       DC8 "Text :"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Close">`:
   \   00000000   436C6F736500       DC8 "Close"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Enter:">`:
   \   00000000   456E7465723A       DC8 "Enter:"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Cancel">`:
   \   00000000   43616E63656C       DC8 "Cancel"
   \              00          
   \   00000007   00                 DC8 0

   \                                 In segment DATA_C, align 1, align-sorted
   \                     `?<Constant "Ok">`:
   \   00000000   4F6B00             DC8 "Ok"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\302\\373\\341\\356\\360">`:
   \   00000000   C2FBE1EEF000       DC8 "\302\373\341\356\360"
   \   00000006   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "Select">`:
   \   00000000   53656C656374       DC8 "Select"
   \              00          
   \   00000007   00                 DC8 0

   Maximum stack usage in bytes:

     Function                CSTACK
     --------                ------
     ChangeMenuSelection        64
     CreateInputBox             76
     FindReference              12
     FindReferenceByBegin        0
     FindReferenceById          16
     FindReferenceFirst          4
     FindStringOnPage           28
     FreeTemplates               8
     GetBitmapHeight             4
     GetFontHeight               8
     GetSymbolBitmapWidth        4
     LineDown                   32
     LineUp                      0
     LoadTemplates              80
     RenderPage               1352
     SaveTextToTemplate         16
     SearchNextDisplayLine      36
     ShowLink                   68
     createTemplatesMenu        28
     createTextView             84
     input_box_ghook            80
     input_box_locret            0
     input_box_onkey            64
     input_box_onkey_options    56
     link_box_ghook             20
     link_box_locret             0
     link_box_onkey              4
     link_options               60
     newCacheLine               12
     patch_header                8
     patch_input                12
     renderForm                 64
     scrollDown                 12
     scrollUp                   12
     sel_menu_ghook             12
     sel_menu_iconhndl          32
     sel_menu_onkey             32
     templates_menu_ghook        4
     templates_menu_iconhndl    24
     templates_menu_onkey       60
     txtview_ghook              20
     txtview_locret              0
     txtview_onkey               0


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     patch_header                     52
     patch_input                      68
     GetFontHeight                    40
     GetSymbolBitmapWidth             72
     GetBitmapHeight                  56
     SearchNextDisplayLine          1168
     newCacheLine                     92
     LineDown                        244
     LineUp                           36
     scrollDown                      244
     scrollUp                         76
     renderForm                      864
     RenderPage                     3764
     FindReferenceByBegin             56
     FindReferenceFirst               52
     FindReference                    88
     FindReferenceById                88
     FreeTemplates                    56
     SaveTextToTemplate              140
     LoadTemplates                   272
     templates_chars                  16
     templates_menu_onkey            196
     templates_menu_ghook             36
     templates_menu_iconhndl          96
     templates_menu_softkeys          12
     templates_menu_sk                88
     templates_menu_skt                8
     createTemplatesMenu              96
     input_box_menu_skt                8
     input_box_ghook                 248
     input_box_locret                  4
     input_box_onkey_options         200
     input_box_onkey                 384
     input_box_desc                   56
     CreateInputBox                  260
     txtview_menu_skt                  8
     txtview_ghook                   100
     txtview_locret                    4
     txtview_onkey                    32
     txtview_desc                     56
     createTextView                  264
     sel_menu_onkey                  372
     sel_menu_ghook                   64
     sel_menu_iconhndl               232
     sel_STRUCT                      148
     txtview_menu_sk                  44
     sel_softkeys                     12
     sel_skt                           8
     ChangeMenuSelection             480
     link_box_menu_skt                 8
     link_box_menu_sk                 44
     link_box_locret                   4
     link_box_ghook                   80
     link_options                    268
     link_box_onkey                   96
     link_box_desc                    56
     ShowLink                        220
     FindStringOnPage                280
     ??DataTable0                      4
     ??DataTable1                      4
     ??DataTable2                      4
     ??DataTable5                      4
     ??DataTable6                      4
     ??DataTable11                     4
     ??DataTable23                     4
     ??DataTable24                     4
     ??DataTable25                     4
     ??DataTable26                     4
     ??DataTable27                     4
     ??DataTable29                     4
     ??DataTable30                     4
     ??DataTable31                     4
     ?<Initializer for templates_menu_softkeys>
                                      12
     ?<Initializer for templates_menu_sk>
                                      88
     ?<Initializer for templates_menu_skt>
                                       8
     ?<Initializer for sel_STRUCT>   148
     ?<Initializer for txtview_menu_sk>
                                      44
     ?<Initializer for sel_softkeys>
                                      12
     ?<Initializer for sel_skt>        8
     ?<Initializer for link_box_menu_sk>
                                      44
     ?<Constant {4095, 0, 0}>          8
     ?<Constant "%t">                 36
     ?<Constant {4095, 0, 0}>_1        8
     ?<Constant {4095, 0, 0}>_2       20
     ?<Constant "$ballet\\templates.txt">
                                      24
     ?<Constant "\n">                  2
     ?<Constant "Link:">               8
     ?<Constant "Select:">             8
     ?<Constant "Text :">              8
     ?<Constant "Close">               8
     ?<Constant "Enter:">              8
     ?<Constant "Cancel">              8
     ?<Constant "Ok">                  3
     ?<Constant "\302\373\341\356\360">
                                       8
     ?<Constant "Select">              8
      Others                         380

 
 11 956 bytes in segment CODE
    357 bytes in segment DATA_C
    364 bytes in segment DATA_I
    364 bytes in segment DATA_ID
     16 bytes in segment DATA_Z
     24 bytes in segment INITTAB
 
 11 480 bytes of CODE  memory (+ 500 bytes shared)
    721 bytes of CONST memory
    380 bytes of DATA  memory

Errors: none
Warnings: none
